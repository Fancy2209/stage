require=function e(t,a,r){function s(l,n){if(!a[l]){if(!t[l]){var o=typeof require=="function"&&require;if(!n&&o)return o(l,!0);if(i)return i(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var f=a[l]={exports:{}};t[l][0].call(f.exports,function(e){var a=t[l][1][e];return s(a?a:e)},f,f.exports,e,t,a,r)}return a[l].exports}var i=typeof require=="function"&&require;for(var l=0;l<r.length;l++)s(r[l]);return s}({1:[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl");a.aglsl=r;var s=e("awayjs-stagegl/lib/attributes");a.attributes=s;var i=e("awayjs-stagegl/lib/base");a.base=i;var l=e("awayjs-stagegl/lib/events");a.events=l;var n=e("awayjs-stagegl/lib/image");a.image=n;var o=e("awayjs-stagegl/lib/library");a.library=o;var u=e("awayjs-stagegl/lib/managers");a.managers=u;var f=e("awayjs-core/lib/attributes/AttributesBuffer");var g=e("awayjs-core/lib/image/BitmapImage2D");var c=e("awayjs-core/lib/image/BitmapImageCube");var d=e("awayjs-core/lib/image/Image2D");var h=e("awayjs-core/lib/image/ImageCube");var b=e("awayjs-core/lib/image/SpecularImage2D");var _=e("awayjs-core/lib/image/Sampler2D");var p=e("awayjs-core/lib/image/SamplerCube");i.Stage.registerAbstraction(s.GL_AttributesBuffer,f.default);i.Stage.registerAbstraction(n.GL_RenderImage2D,d.default);i.Stage.registerAbstraction(n.GL_RenderImageCube,h.default);i.Stage.registerAbstraction(n.GL_BitmapImage2D,g.default);i.Stage.registerAbstraction(n.GL_BitmapImageCube,c.default);i.Stage.registerAbstraction(n.GL_BitmapImage2D,b.default);i.Stage.registerAbstraction(n.GL_Sampler2D,_.default);i.Stage.registerAbstraction(n.GL_SamplerCube,p.default)},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/image/BitmapImage2D":undefined,"awayjs-core/lib/image/BitmapImageCube":undefined,"awayjs-core/lib/image/Image2D":undefined,"awayjs-core/lib/image/ImageCube":undefined,"awayjs-core/lib/image/Sampler2D":undefined,"awayjs-core/lib/image/SamplerCube":undefined,"awayjs-core/lib/image/SpecularImage2D":undefined,"awayjs-stagegl/lib/aglsl":"awayjs-stagegl/lib/aglsl","awayjs-stagegl/lib/attributes":"awayjs-stagegl/lib/attributes","awayjs-stagegl/lib/base":"awayjs-stagegl/lib/base","awayjs-stagegl/lib/events":"awayjs-stagegl/lib/events","awayjs-stagegl/lib/image":"awayjs-stagegl/lib/image","awayjs-stagegl/lib/library":"awayjs-stagegl/lib/library","awayjs-stagegl/lib/managers":"awayjs-stagegl/lib/managers"}],"awayjs-stagegl/lib/aglsl/AGALTokenizer":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/Description");var s=e("awayjs-stagegl/lib/aglsl/Header");var i=e("awayjs-stagegl/lib/aglsl/Mapping");var l=e("awayjs-stagegl/lib/aglsl/Token");var n=function(){function e(){}e.prototype.decribeAGALByteArray=function(e){var t=new s.default;if(e.readUnsignedByte()!=160){throw"Bad AGAL: Missing 0xa0 magic byte."}t.version=e.readUnsignedInt();if(t.version>=16){e.readUnsignedByte();t.version>>=1}if(e.readUnsignedByte()!=161){throw"Bad AGAL: Missing 0xa1 magic byte."}t.progid=e.readUnsignedByte();switch(t.progid){case 1:t.type="fragment";break;case 0:t.type="vertex";break;case 2:t.type="cpu";break;default:t.type="";break}var a=new r.default;var n=[];while(e.position<e.length){var o=new l.default;o.opcode=e.readUnsignedInt();var u=i.default.agal2glsllut[o.opcode];if(!u){throw"Opcode not valid or not implemented yet: "+o.opcode}if(u.matrixheight){a.hasmatrix=true}if(u.dest){o.dest.regnum=e.readUnsignedShort();o.dest.mask=e.readUnsignedByte();o.dest.regtype=e.readUnsignedByte();a.regwrite[o.dest.regtype][o.dest.regnum]|=o.dest.mask}else{o.dest=null;e.readUnsignedInt()}if(u.a){this.readReg(o.a,1,a,e)}else{o.a=null;e.readUnsignedInt();e.readUnsignedInt()}if(u.b){this.readReg(o.b,u.matrixheight|0,a,e)}else{o.b=null;e.readUnsignedInt();e.readUnsignedInt()}n.push(o)}a.header=t;a.tokens=n;return a};e.prototype.readReg=function(e,t,a,r){e.regnum=r.readUnsignedShort();e.indexoffset=r.readByte();e.swizzle=r.readUnsignedByte();e.regtype=r.readUnsignedByte();a.regread[e.regtype][e.regnum]=15;if(e.regtype==5){e.lodbiad=e.indexoffset;e.indexoffset=undefined;e.swizzle=undefined;e.readmode=r.readUnsignedByte();e.dim=e.readmode>>4;e.readmode&=15;e.special=r.readUnsignedByte();e.wrap=e.special>>4;e.special&=15;e.mipmap=r.readUnsignedByte();e.filter=e.mipmap>>4;e.mipmap&=15;a.samplers[e.regnum]=e}else{e.indexregtype=r.readUnsignedByte();e.indexselect=r.readUnsignedByte();e.indirectflag=r.readUnsignedByte()}if(e.indirectflag){a.hasindirect=true}if(!e.indirectflag&&t){for(var s=0;s<t;s++){a.regread[e.regtype][e.regnum+s]=a.regread[e.regtype][e.regnum]}}};return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=n},{"awayjs-stagegl/lib/aglsl/Description":"awayjs-stagegl/lib/aglsl/Description","awayjs-stagegl/lib/aglsl/Header":"awayjs-stagegl/lib/aglsl/Header","awayjs-stagegl/lib/aglsl/Mapping":"awayjs-stagegl/lib/aglsl/Mapping","awayjs-stagegl/lib/aglsl/Token":"awayjs-stagegl/lib/aglsl/Token"}],"awayjs-stagegl/lib/aglsl/AGLSLParser":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/Mapping");var s=function(){function e(){}e.prototype.parse=function(t){var a="";var s="";a+="precision highp float;\n";var i=t.header.type[0];if(t.header.type=="vertex"){a+="uniform float yflip;\n"}if(!t.hasindirect){for(var l=0;l<t.regread[1].length;l++){if(t.regread[1][l]){a+="uniform vec4 "+i+"c"+l+";\n"}}}else{a+="uniform vec4 "+i+"carrr["+e.maxvertexconstants+"];\n"}for(var l=0;l<t.regread[2].length||l<t.regwrite[2].length;l++){if(t.regread[2][l]||t.regwrite[2][l]){a+="vec4 "+i+"t"+l+";\n"}}for(var l=0;l<t.regread[0].length;l++){if(t.regread[0][l]){a+="attribute vec4 va"+l+";\n"}}for(var l=0;l<t.regread[4].length||l<t.regwrite[4].length;l++){if(t.regread[4][l]||t.regwrite[4][l]){a+="varying vec4 vi"+l+";\n"}}var n=["2D","Cube","3D",""];for(var l=0;l<t.samplers.length;l++){if(t.samplers[l]){a+="uniform sampler"+n[t.samplers[l].dim&3]+" fs"+l+";\n"}}if(t.header.type=="vertex"){a+="vec4 outpos;\n"}if(t.writedepth){a+="vec4 tmp_FragDepth;\n"}var o=false;s+="void main() {\n";for(var l=0;l<t.tokens.length;l++){var u=r.default.agal2glsllut[t.tokens[l].opcode];if(u.s.indexOf("dFdx")!=-1||u.s.indexOf("dFdy")!=-1)o=true;if(!u){throw"Opcode not valid or not implemented yet: "}var f=u.matrixheight||1;for(var g=0;g<f;g++){var c="  "+u.s;if(t.tokens[l].dest){if(u.matrixheight){if((t.tokens[l].dest.mask>>g&1)!=1){continue}var d=this.regtostring(t.tokens[l].dest.regtype,t.tokens[l].dest.regnum,t,i);var h="float";var b=["x","y","z","w"][g];d+="."+b}else{var d=this.regtostring(t.tokens[l].dest.regtype,t.tokens[l].dest.regnum,t,i);var h;var b;if(t.tokens[l].dest.mask!=15){var _=0;b="";if(t.tokens[l].dest.mask&1){_++;b+="x"}if(t.tokens[l].dest.mask&2){_++;b+="y"}if(t.tokens[l].dest.mask&4){_++;b+="z"}if(t.tokens[l].dest.mask&8){_++;b+="w"}d+="."+b;switch(_){case 1:h="float";break;case 2:h="vec2";break;case 3:h="vec3";break;default:throw"Unexpected destination mask"}}else{h="vec4";b="xyzw"}}c=c.replace("%dest",d);c=c.replace("%cast",h);c=c.replace("%dm",b)}var p=15;if(!u.ndwm&&u.dest&&t.tokens[l].dest){p=t.tokens[l].dest.mask}if(t.tokens[l].a){c=c.replace("%a",this.sourcetostring(t.tokens[l].a,0,p,u.scalar,t,i))}if(t.tokens[l].b){c=c.replace("%b",this.sourcetostring(t.tokens[l].b,g,p,u.scalar,t,i));if(t.tokens[l].b.regtype==5){var y=["2D","Cube","3D"][t.tokens[l].b.dim];var w=["vec2","vec3","vec3"][t.tokens[l].b.dim];c=c.replace("%texdim",y);c=c.replace("%texsize",w);var m="";c=c.replace("%lod",m)}}s+=c}}if(t.header.type=="vertex"){s+="  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\n"}if(o&&t.header.type=="fragment"){a="#extension GL_OES_standard_derivatives : enable\n"+a}if(t.writedepth){s+="  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\n"}s+="}\n";return a+s};e.prototype.regtostring=function(e,t,a,r){switch(e){case 0:return"va"+t;case 1:if(a.hasindirect&&a.header.type=="vertex"){return"vcarrr["+t+"]"}else{return r+"c"+t}case 2:return r+"t"+t;case 3:return a.header.type=="vertex"?"outpos":"gl_FragColor";case 4:return"vi"+t;case 5:return"fs"+t;case 6:return"tmp_FragDepth";default:throw"Unknown register type"}};e.prototype.sourcetostring=function(e,t,a,r,s,i){var l=["x","y","z","w"];var n;if(e.indirectflag){n="vcarrr[int("+this.regtostring(e.indexregtype,e.regnum,s,i)+"."+l[e.indexselect]+")";var o=t+e.indexoffset;if(o<0)n+=o.toString();if(o>0)n+="+"+o.toString();n+="]"}else{n=this.regtostring(e.regtype,e.regnum+t,s,i)}if(e.regtype==5){return n}if(r){return n+"."+l[e.swizzle>>0&3]}if(e.swizzle==228&&a==15){return n}n+=".";if(a&1)n+=l[e.swizzle>>0&3];if(a&2)n+=l[e.swizzle>>2&3];if(a&4)n+=l[e.swizzle>>4&3];if(a&8)n+=l[e.swizzle>>6&3];return n};e.maxvertexconstants=128;e.maxfragconstants=28;e.maxtemp=8;e.maxstreams=8;e.maxtextures=8;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-stagegl/lib/aglsl/Mapping":"awayjs-stagegl/lib/aglsl/Mapping"}],"awayjs-stagegl/lib/aglsl/Description":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/Header");var s=function(){function e(){this.regread=[[],[],[],[],[],[],[]];this.regwrite=[[],[],[],[],[],[],[]];this.hasindirect=false;this.writedepth=false;this.hasmatrix=false;this.samplers=[];this.tokens=[];this.header=new r.default}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-stagegl/lib/aglsl/Header":"awayjs-stagegl/lib/aglsl/Header"}],"awayjs-stagegl/lib/aglsl/Destination":[function(e,t,a){"use strict";var r=function(){function e(){this.mask=0;this.regnum=0;this.regtype=0;this.dim=0;this.indexoffset=0;this.swizzle=0;this.lodbiad=0;this.readmode=0;this.special=0;this.wrap=0;this.filter=0;this.indexregtype=0;this.indexselect=0;this.indirectflag=0}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/aglsl/Header":[function(e,t,a){"use strict";var r=function(){function e(){this.progid=0;this.version=0;this.type=""}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/aglsl/Mapping":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/OpLUT");var s=function(){function e(e){}e.agal2glsllut=[new r.default("%dest = %cast(%a);\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(%a + %b);\n",0,true,true,true,null,null,null,null,null,null),new r.default("%dest = %cast(%a - %b);\n",0,true,true,true,null,null,null,null,null,null),new r.default("%dest = %cast(%a * %b);\n",0,true,true,true,null,null,null,null,null,null),new r.default("%dest = %cast(%a / %b);\n",0,true,true,true,null,null,null,null,null,null),new r.default("%dest = %cast(1.0) / %a;\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(min(%a,%b));\n",0,true,true,true,null,null,null,null,null,null),new r.default("%dest = %cast(max(%a,%b));\n",0,true,true,true,null,null,null,null,null,null),new r.default("%dest = %cast(fract(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(sqrt(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(inversesqrt(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(pow(abs(%a),%b));\n",0,true,true,true,null,null,null,null,null,null),new r.default("%dest = %cast(log2(abs(%a)));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(exp2(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(normalize(vec3( %a ) ));\n",0,true,true,false,null,null,true,null,null,null),new r.default("%dest = %cast(sin(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(cos(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(cross(vec3(%a),vec3(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r.default("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r.default("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",0,true,true,true,null,null,true,null,null,null),new r.default("%dest = %cast(abs(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(%a * -1.0);\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(clamp(%a,0.0,1.0));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",null,true,true,true,3,3,true,null,null,null),new r.default("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,true,true,true,4,4,true,null,null,null),new r.default("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,true,true,true,4,3,true,null,null,null),new r.default("%dest = %cast(dFdx(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(dFdy(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("if (float(%a)==float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r.default("if (float(%a)!=float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r.default("if (float(%a)>=float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r.default("if (float(%a)<float(%b)) {;\n",0,false,true,true,null,null,null,true,null,null),new r.default("} else {;\n",0,false,false,false,null,null,null,null,null,null),new r.default("};\n",0,false,false,false,null,null,null,null,null,null),new r.default(null,null,null,null,false,null,null,null,null,null,null),new r.default(null,null,null,null,false,null,null,null,null,null,null),new r.default(null,null,null,null,false,null,null,null,null,null,null),new r.default(null,null,null,null,false,null,null,null,null,null,null),new r.default("%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\n",null,true,true,true,null,null,null,null,true,null),new r.default("if ( float(%a)<0.0 ) discard;\n",null,false,true,false,null,null,null,true,null,null),new r.default("%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\n",null,true,true,true,null,null,true,null,true,true),new r.default("%dest = %cast(greaterThanEqual(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r.default("%dest = %cast(lessThan(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r.default("%dest = %cast(sign(%a));\n",0,true,true,false,null,null,null,null,null,null),new r.default("%dest = %cast(equal(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null),new r.default("%dest = %cast(notEqual(%a,%b).%dm);\n",0,true,true,true,null,null,true,null,true,null)];return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-stagegl/lib/aglsl/OpLUT":"awayjs-stagegl/lib/aglsl/OpLUT"}],"awayjs-stagegl/lib/aglsl/OpLUT":[function(e,t,a){"use strict";var r=function(){function e(e,t,a,r,s,i,l,n,o,u,f){this.s=e;this.flags=t;this.dest=a;this.a=r;this.b=s;this.matrixwidth=i;this.matrixheight=l;this.ndwm=n;this.scalar=o;this.dm=u;this.lod=f}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/aglsl/Token":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/Destination");var s=function(){function e(){this.dest=new r.default;this.opcode=0;this.a=new r.default;this.b=new r.default}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-stagegl/lib/aglsl/Destination":"awayjs-stagegl/lib/aglsl/Destination"}],"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/assembler/OpcodeMap");var s=e("awayjs-stagegl/lib/aglsl/assembler/Part");var i=e("awayjs-stagegl/lib/aglsl/assembler/RegMap");var l=e("awayjs-stagegl/lib/aglsl/assembler/SamplerMap");var n=function(){function e(){this.r={};this.cur=new s.default}e.prototype.assemble=function(e,t,a){if(t===void 0){t=null}if(a===void 0){a=null}if(!a){a=1}if(t){this.addHeader(t,a)}var r=e.replace(/[\f\n\r\v]+/g,"\n").split("\n");for(var s in r){this.processLine(r[s],s)}return this.r};e.prototype.processLine=function(e,t){var a=e.search("//");if(a!=-1){e=e.slice(0,a)}e=e.replace(/^\s+|\s+$/g,"");if(!(e.length>0)){return}var s=e.search(/<.*>/g);var i=null;if(s!=-1){i=e.slice(s).match(/([\w\.\-\+]+)/gi);e=e.slice(0,s)}var l=e.match(/([\w\.\+\[\]]+)/gi);if(!l||l.length<1){if(e.length>=3){console.log("Warning: bad line "+t+": "+e)}return}switch(l[0]){case"part":this.addHeader(l[1],Number(l[2]));break;case"endpart":if(!this.cur){throw"Unexpected endpart"}this.cur.data.position=0;this.cur=null;return;default:if(!this.cur){console.log("Warning: bad line "+t+": "+e+" (Outside of any part definition)");return}if(this.cur.name=="comment"){return}var n=r.default.map[l[0]];if(!n){throw"Bad opcode "+l[0]+" "+t+": "+e}this.emitOpcode(this.cur,n.opcode);var o=1;if(n.dest&&n.dest!="none"){if(!this.emitDest(this.cur,l[o++],n.dest)){throw"Bad destination register "+l[o-1]+" "+t+": "+e}}else{this.emitZeroDword(this.cur)}if(n.a&&n.a.format!="none"){if(!this.emitSource(this.cur,l[o++],n.a))throw"Bad source register "+l[o-1]+" "+t+": "+e}else{this.emitZeroQword(this.cur)}if(n.b&&n.b.format!="none"){if(n.b.format=="sampler"){if(!this.emitSampler(this.cur,l[o++],n.b,i)){throw"Bad sampler register "+l[o-1]+" "+t+": "+e}}else{if(!this.emitSource(this.cur,l[o++],n.b)){throw"Bad source register "+l[o-1]+" "+t+": "+e}}}else{this.emitZeroQword(this.cur)}break}};e.prototype.emitHeader=function(e){e.data.writeUnsignedByte(160);e.data.writeUnsignedInt(e.version);if(e.version>=16){e.data.writeUnsignedByte(0)}e.data.writeUnsignedByte(161);switch(e.name){case"fragment":e.data.writeUnsignedByte(1);break;case"vertex":e.data.writeUnsignedByte(0);break;case"cpu":e.data.writeUnsignedByte(2);break;default:e.data.writeUnsignedByte(255);break}};e.prototype.emitOpcode=function(e,t){e.data.writeUnsignedInt(t)};e.prototype.emitZeroDword=function(e){e.data.writeUnsignedInt(0)};e.prototype.emitZeroQword=function(e){e.data.writeUnsignedInt(0);e.data.writeUnsignedInt(0)};e.prototype.emitDest=function(e,t,a){var r=t.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!i.default.map[r[1]])return false;var s={num:r[2]?r[2]:0,code:i.default.map[r[1]].code,mask:this.stringToMask(r[3])};e.data.writeUnsignedShort(s.num);e.data.writeUnsignedByte(s.mask);e.data.writeUnsignedByte(s.code);return true};e.prototype.stringToMask=function(e){if(!e)return 15;var t=0;if(e.indexOf("x")!=-1)t|=1;if(e.indexOf("y")!=-1)t|=2;if(e.indexOf("z")!=-1)t|=4;if(e.indexOf("w")!=-1)t|=8;return t};e.prototype.stringToSwizzle=function(e){if(!e){return 228}var t={x:0,y:1,z:2,w:3};var a=0;if(e.charAt(0)!="."){throw"Missing . for swizzle"}if(e.length>1){a|=t[e.charAt(1)]}if(e.length>2){a|=t[e.charAt(2)]<<2}else{a|=(a&3)<<2}if(e.length>3){a|=t[e.charAt(3)]<<4}else{a|=(a&3<<2)<<2}if(e.length>4){a|=t[e.charAt(4)]<<6}else{a|=(a&3<<4)<<2}return a};e.prototype.emitSampler=function(e,t,a,r){var s=t.match(/fs(\d*)/i);if(!s||!s[1]){return false}e.data.writeUnsignedShort(parseInt(s[1]));e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(0);var i=5;var n=0;for(var o=0;o<r.length;o++){var u=l.default.map[r[o].toLowerCase()];if(u){if((n>>u.shift&u.mask)!=0){console.log("Warning, duplicate sampler option")}n|=u.mask<<u.shift;i&=~(u.mask<<u.shift);i|=u.value<<u.shift}else{console.log("Warning, unknown sampler option: ",r[o])}}e.data.writeUnsignedInt(i);return true};e.prototype.emitSource=function(e,t,a){var r=t.match(/vc\[(v[tcai])(\d+)\.([xyzw])([\+\-]\d+)?\](\.[xyzw]{1,4})?/i);var s;if(r){if(!i.default.map[r[1]]){return false}var l={x:0,y:1,z:2,w:3};var n={num:r[2]|0,code:i.default.map[r[1]].code,swizzle:this.stringToSwizzle(r[5]),select:l[r[3]],offset:r[4]|0};e.data.writeUnsignedShort(n.num);e.data.writeByte(n.offset);e.data.writeUnsignedByte(n.swizzle);e.data.writeUnsignedByte(1);e.data.writeUnsignedByte(n.code);e.data.writeUnsignedByte(n.select);e.data.writeUnsignedByte(1<<7)}else{s=t.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!i.default.map[s[1]]){return false}var n={num:s[2]|0,code:i.default.map[s[1]].code,swizzle:this.stringToSwizzle(s[3])};e.data.writeUnsignedShort(n.num);e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(n.swizzle);e.data.writeUnsignedByte(n.code);e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(0);e.data.writeUnsignedByte(0)}return true};e.prototype.addHeader=function(e,t){if(!t){t=1}if(this.r[e]==undefined){this.r[e]=new s.default(e,t);this.emitHeader(this.r[e])}else if(this.r[e].version!=t){throw"Multiple versions for part "+e}this.cur=this.r[e]};return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=n},{"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap","awayjs-stagegl/lib/aglsl/assembler/Part":"awayjs-stagegl/lib/aglsl/assembler/Part","awayjs-stagegl/lib/aglsl/assembler/RegMap":"awayjs-stagegl/lib/aglsl/assembler/RegMap","awayjs-stagegl/lib/aglsl/assembler/SamplerMap":"awayjs-stagegl/lib/aglsl/assembler/SamplerMap"}],"awayjs-stagegl/lib/aglsl/assembler/FS":[function(e,t,a){"use strict";var r=function(){function e(){}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/aglsl/assembler/Flags":[function(e,t,a){"use strict";var r=function(){function e(){}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/assembler/Opcode");var s=function(){function e(){}Object.defineProperty(e,"map",{get:function(){if(!e._map){e._map=new Array;e._map["mov"]=new r.default("vector","vector",4,"none",0,0,true,null,null,null);e._map["add"]=new r.default("vector","vector",4,"vector",4,1,true,null,null,null);e._map["sub"]=new r.default("vector","vector",4,"vector",4,2,true,null,null,null);e._map["mul"]=new r.default("vector","vector",4,"vector",4,3,true,null,null,null);e._map["div"]=new r.default("vector","vector",4,"vector",4,4,true,null,null,null);e._map["rcp"]=new r.default("vector","vector",4,"none",0,5,true,null,null,null);e._map["min"]=new r.default("vector","vector",4,"vector",4,6,true,null,null,null);e._map["max"]=new r.default("vector","vector",4,"vector",4,7,true,null,null,null);e._map["frc"]=new r.default("vector","vector",4,"none",0,8,true,null,null,null);e._map["sqt"]=new r.default("vector","vector",4,"none",0,9,true,null,null,null);e._map["rsq"]=new r.default("vector","vector",4,"none",0,10,true,null,null,null);e._map["pow"]=new r.default("vector","vector",4,"vector",4,11,true,null,null,null);e._map["log"]=new r.default("vector","vector",4,"none",0,12,true,null,null,null);e._map["exp"]=new r.default("vector","vector",4,"none",0,13,true,null,null,null);e._map["nrm"]=new r.default("vector","vector",4,"none",0,14,true,null,null,null);e._map["sin"]=new r.default("vector","vector",4,"none",0,15,true,null,null,null);e._map["cos"]=new r.default("vector","vector",4,"none",0,16,true,null,null,null);e._map["crs"]=new r.default("vector","vector",4,"vector",4,17,true,true,null,null);e._map["dp3"]=new r.default("vector","vector",4,"vector",4,18,true,true,null,null);e._map["dp4"]=new r.default("vector","vector",4,"vector",4,19,true,true,null,null);e._map["abs"]=new r.default("vector","vector",4,"none",0,20,true,null,null,null);e._map["neg"]=new r.default("vector","vector",4,"none",0,21,true,null,null,null);e._map["sat"]=new r.default("vector","vector",4,"none",0,22,true,null,null,null);e._map["ted"]=new r.default("vector","vector",4,"sampler",1,38,true,null,true,null);e._map["kil"]=new r.default("none","scalar",1,"none",0,39,true,null,true,null);e._map["tex"]=new r.default("vector","vector",4,"sampler",1,40,true,null,true,null);e._map["m33"]=new r.default("vector","matrix",3,"vector",3,23,true,null,null,true);e._map["m44"]=new r.default("vector","matrix",4,"vector",4,24,true,null,null,true);e._map["m43"]=new r.default("vector","matrix",3,"vector",4,25,true,null,null,true);e._map["ddx"]=new r.default("vector","vector",4,"none",0,26,true,null,true,null);e._map["ddy"]=new r.default("vector","vector",4,"none",0,27,true,null,true,null);e._map["sge"]=new r.default("vector","vector",4,"vector",4,41,true,null,null,null);e._map["slt"]=new r.default("vector","vector",4,"vector",4,42,true,null,null,null);e._map["sgn"]=new r.default("vector","vector",4,"vector",4,43,true,null,null,null);e._map["seq"]=new r.default("vector","vector",4,"vector",4,44,true,null,null,null);e._map["sne"]=new r.default("vector","vector",4,"vector",4,45,true,null,null,null)}return e._map},enumerable:true,configurable:true});return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-stagegl/lib/aglsl/assembler/Opcode":"awayjs-stagegl/lib/aglsl/assembler/Opcode"}],"awayjs-stagegl/lib/aglsl/assembler/Opcode":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/assembler/Flags");var s=e("awayjs-stagegl/lib/aglsl/assembler/FS");var i=function(){function e(e,t,a,i,l,n,o,u,f,g){this.a=new s.default;this.b=new s.default;this.flags=new r.default;this.dest=e;this.a.format=t;this.a.size=a;this.b.format=i;this.b.size=l;this.opcode=n;this.flags.simple=o;this.flags.horizontal=u;this.flags.fragonly=f;this.flags.matrix=g}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/aglsl/assembler/FS":"awayjs-stagegl/lib/aglsl/assembler/FS","awayjs-stagegl/lib/aglsl/assembler/Flags":"awayjs-stagegl/lib/aglsl/assembler/Flags"}],"awayjs-stagegl/lib/aglsl/assembler/Part":[function(e,t,a){"use strict";var r=e("awayjs-core/lib/utils/ByteArray");var s=function(){function e(e,t){if(e===void 0){e=null}if(t===void 0){t=null}this.name="";this.version=0;this.name=e;this.version=t;this.data=new r.default}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-core/lib/utils/ByteArray":undefined}],"awayjs-stagegl/lib/aglsl/assembler/RegMap":[function(e,t,a){"use strict";var r=function(){function e(e,t){this.code=e;this.desc=t}return e}();var s=function(){function e(){}Object.defineProperty(e,"map",{get:function(){if(!e._map){e._map=new Array;e._map["va"]=new r(0,"vertex attribute");e._map["fc"]=new r(1,"fragment constant");e._map["vc"]=new r(1,"vertex constant");e._map["ft"]=new r(2,"fragment temporary");e._map["vt"]=new r(2,"vertex temporary");e._map["vo"]=new r(3,"vertex output");e._map["op"]=new r(3,"vertex output");e._map["fd"]=new r(3,"fragment depth output");e._map["fo"]=new r(3,"fragment output");e._map["oc"]=new r(3,"fragment output");e._map["v"]=new r(4,"varying");e._map["vi"]=new r(4,"varying output");e._map["fi"]=new r(4,"varying input");e._map["fs"]=new r(5,"sampler")}return e._map},enumerable:true,configurable:true});return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{}],"awayjs-stagegl/lib/aglsl/assembler/SamplerMap":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/assembler/Sampler");var s=function(){function e(){}Object.defineProperty(e,"map",{get:function(){if(!e._map){e._map=new Array;e._map["rgba"]=new r.default(8,15,0);e._map["rg"]=new r.default(8,15,5);e._map["r"]=new r.default(8,15,4);e._map["compressed"]=new r.default(8,15,1);e._map["compressed_alpha"]=new r.default(8,15,2);e._map["dxt1"]=new r.default(8,15,1);e._map["dxt5"]=new r.default(8,15,2);e._map["2d"]=new r.default(12,15,0);e._map["cube"]=new r.default(12,15,1);e._map["3d"]=new r.default(12,15,2);e._map["centroid"]=new r.default(16,1,1);e._map["ignoresampler"]=new r.default(16,4,4);e._map["clamp"]=new r.default(20,15,0);e._map["repeat"]=new r.default(20,15,1);e._map["wrap"]=new r.default(20,15,1);e._map["nomip"]=new r.default(24,15,0);e._map["mipnone"]=new r.default(24,15,0);e._map["mipnearest"]=new r.default(24,15,1);e._map["miplinear"]=new r.default(24,15,2);e._map["nearest"]=new r.default(28,15,0);e._map["linear"]=new r.default(28,15,1)}return e._map},enumerable:true,configurable:true});return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-stagegl/lib/aglsl/assembler/Sampler":"awayjs-stagegl/lib/aglsl/assembler/Sampler"}],"awayjs-stagegl/lib/aglsl/assembler/Sampler":[function(e,t,a){"use strict";var r=function(){function e(e,t,a){this.shift=e;this.mask=t;this.value=a}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/aglsl":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");a.AGALMiniAssembler=r.default;var s=e("awayjs-stagegl/lib/aglsl/assembler/Flags");a.Flags=s.default;var i=e("awayjs-stagegl/lib/aglsl/assembler/FS");a.FS=i.default;var l=e("awayjs-stagegl/lib/aglsl/assembler/Opcode");a.Opcode=l.default;var n=e("awayjs-stagegl/lib/aglsl/assembler/OpcodeMap");a.OpcodeMap=n.default;var o=e("awayjs-stagegl/lib/aglsl/assembler/Part");a.Part=o.default;var u=e("awayjs-stagegl/lib/aglsl/assembler/RegMap");a.RegMap=u.default;var f=e("awayjs-stagegl/lib/aglsl/assembler/Sampler");a.Sampler=f.default;var g=e("awayjs-stagegl/lib/aglsl/assembler/SamplerMap");a.SamplerMap=g.default;var c=e("awayjs-stagegl/lib/aglsl/AGALTokenizer");a.AGALTokenizer=c.default;var d=e("awayjs-stagegl/lib/aglsl/AGLSLParser");a.AGLSLParser=d.default;var h=e("awayjs-stagegl/lib/aglsl/Description");a.Description=h.default;var b=e("awayjs-stagegl/lib/aglsl/Destination");a.Destination=b.default;var _=e("awayjs-stagegl/lib/aglsl/Header");a.Header=_.default;var p=e("awayjs-stagegl/lib/aglsl/Mapping");a.Mapping=p.default;var y=e("awayjs-stagegl/lib/aglsl/OpLUT");a.OpLUT=y.default;var w=e("awayjs-stagegl/lib/aglsl/Token");a.Token=w.default},{"awayjs-stagegl/lib/aglsl/AGALTokenizer":"awayjs-stagegl/lib/aglsl/AGALTokenizer","awayjs-stagegl/lib/aglsl/AGLSLParser":"awayjs-stagegl/lib/aglsl/AGLSLParser","awayjs-stagegl/lib/aglsl/Description":"awayjs-stagegl/lib/aglsl/Description","awayjs-stagegl/lib/aglsl/Destination":"awayjs-stagegl/lib/aglsl/Destination","awayjs-stagegl/lib/aglsl/Header":"awayjs-stagegl/lib/aglsl/Header","awayjs-stagegl/lib/aglsl/Mapping":"awayjs-stagegl/lib/aglsl/Mapping","awayjs-stagegl/lib/aglsl/OpLUT":"awayjs-stagegl/lib/aglsl/OpLUT","awayjs-stagegl/lib/aglsl/Token":"awayjs-stagegl/lib/aglsl/Token","awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler","awayjs-stagegl/lib/aglsl/assembler/FS":"awayjs-stagegl/lib/aglsl/assembler/FS","awayjs-stagegl/lib/aglsl/assembler/Flags":"awayjs-stagegl/lib/aglsl/assembler/Flags","awayjs-stagegl/lib/aglsl/assembler/Opcode":"awayjs-stagegl/lib/aglsl/assembler/Opcode","awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap","awayjs-stagegl/lib/aglsl/assembler/Part":"awayjs-stagegl/lib/aglsl/assembler/Part","awayjs-stagegl/lib/aglsl/assembler/RegMap":"awayjs-stagegl/lib/aglsl/assembler/RegMap","awayjs-stagegl/lib/aglsl/assembler/Sampler":"awayjs-stagegl/lib/aglsl/assembler/Sampler","awayjs-stagegl/lib/aglsl/assembler/SamplerMap":"awayjs-stagegl/lib/aglsl/assembler/SamplerMap"}],"awayjs-stagegl/lib/attributes/GL_AttributesBuffer":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/library/AbstractionBase");var i=function(e){r(t,e);function t(t,a){e.call(this,t,a);this._stage=a;this._attributesBuffer=t}t.prototype.onClear=function(t){e.prototype.onClear.call(this,t);this._attributesBuffer=null;if(this._indexBuffer){this._indexBuffer.dispose();this._indexBuffer=null}if(this._vertexBuffer){this._vertexBuffer.dispose();this._vertexBuffer=null}};t.prototype.activate=function(e,t,a,r,s){if(s===void 0){s=false}this._stage.setVertexBuffer(e,this._getVertexBuffer(),t,a,r,s)};t.prototype.draw=function(e,t,a){this._stage.context.drawIndices(e,this._getIndexBuffer(),t,a)};t.prototype._getIndexBuffer=function(){if(!this._indexBuffer){this._invalid=true;this._indexBuffer=this._stage.context.createIndexBuffer(this._attributesBuffer.count*this._attributesBuffer.stride/2);
}if(this._invalid){this._invalid=false;this._indexBuffer.uploadFromByteArray(this._attributesBuffer.buffer,0,this._attributesBuffer.length)}return this._indexBuffer};t.prototype._getVertexBuffer=function(){if(!this._vertexBuffer){this._invalid=true;this._vertexBuffer=this._stage.context.createVertexBuffer(this._attributesBuffer.count,this._attributesBuffer.stride)}if(this._invalid){this._invalid=false;this._vertexBuffer.uploadFromByteArray(this._attributesBuffer.buffer,0,this._attributesBuffer.count)}return this._vertexBuffer};return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-core/lib/library/AbstractionBase":undefined}],"awayjs-stagegl/lib/attributes":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/attributes/GL_AttributesBuffer");a.GL_AttributesBuffer=r.default},{"awayjs-stagegl/lib/attributes/GL_AttributesBuffer":"awayjs-stagegl/lib/attributes/GL_AttributesBuffer"}],"awayjs-stagegl/lib/base/ContextGLBlendFactor":[function(e,t,a){"use strict";var r=function(){function e(){}e.DESTINATION_ALPHA="destinationAlpha";e.DESTINATION_COLOR="destinationColor";e.ONE="one";e.ONE_MINUS_DESTINATION_ALPHA="oneMinusDestinationAlpha";e.ONE_MINUS_DESTINATION_COLOR="oneMinusDestinationColor";e.ONE_MINUS_SOURCE_ALPHA="oneMinusSourceAlpha";e.ONE_MINUS_SOURCE_COLOR="oneMinusSourceColor";e.SOURCE_ALPHA="sourceAlpha";e.SOURCE_COLOR="sourceColor";e.ZERO="zero";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLClearMask":[function(e,t,a){"use strict";var r=function(){function e(){}e.COLOR=1;e.DEPTH=2;e.STENCIL=4;e.ALL=e.COLOR|e.DEPTH|e.STENCIL;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLCompareMode":[function(e,t,a){"use strict";var r=function(){function e(){}e.ALWAYS="always";e.EQUAL="equal";e.GREATER="greater";e.GREATER_EQUAL="greaterEqual";e.LESS="less";e.LESS_EQUAL="lessEqual";e.NEVER="never";e.NOT_EQUAL="notEqual";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLDrawMode":[function(e,t,a){"use strict";var r=function(){function e(){}e.TRIANGLES="triangles";e.LINES="lines";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLMipFilter":[function(e,t,a){"use strict";var r=function(){function e(){}e.MIPLINEAR="miplinear";e.MIPNEAREST="mipnearest";e.MIPNONE="mipnone";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLProfile":[function(e,t,a){"use strict";var r=function(){function e(){}e.BASELINE="baseline";e.BASELINE_CONSTRAINED="baselineConstrained";e.BASELINE_EXTENDED="baselineExtended";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLProgramType":[function(e,t,a){"use strict";var r=function(){function e(){}e.FRAGMENT=0;e.SAMPLER=1;e.VERTEX=2;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLStencilAction":[function(e,t,a){"use strict";var r=function(){function e(){}e.DECREMENT_SATURATE="decrementSaturate";e.DECREMENT_WRAP="decrementWrap";e.INCREMENT_SATURATE="incrementSaturate";e.INCREMENT_WRAP="incrementWrap";e.INVERT="invert";e.KEEP="keep";e.SET="set";e.ZERO="zero";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLTextureFilter":[function(e,t,a){"use strict";var r=function(){function e(){}e.LINEAR="linear";e.NEAREST="nearest";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLTextureFormat":[function(e,t,a){"use strict";var r=function(){function e(){}e.BGRA="bgra";e.BGRA_PACKED="bgraPacked4444";e.BGR_PACKED="bgrPacked565";e.COMPRESSED="compressed";e.COMPRESSED_ALPHA="compressedAlpha";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLTriangleFace":[function(e,t,a){"use strict";var r=function(){function e(){}e.BACK="back";e.FRONT="front";e.FRONT_AND_BACK="frontAndBack";e.NONE="none";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":[function(e,t,a){"use strict";var r=function(){function e(){}e.FLOAT_1=0;e.FLOAT_2=1;e.FLOAT_3=2;e.FLOAT_4=3;e.BYTE_1=4;e.BYTE_2=5;e.BYTE_3=6;e.BYTE_4=7;e.UNSIGNED_BYTE_1=8;e.UNSIGNED_BYTE_2=9;e.UNSIGNED_BYTE_3=10;e.UNSIGNED_BYTE_4=11;e.SHORT_1=12;e.SHORT_2=13;e.SHORT_3=14;e.SHORT_4=15;e.UNSIGNED_SHORT_1=16;e.UNSIGNED_SHORT_2=17;e.UNSIGNED_SHORT_3=18;e.UNSIGNED_SHORT_4=19;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextGLWrapMode":[function(e,t,a){"use strict";var r=function(){function e(){}e.CLAMP="clamp";e.REPEAT="repeat";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextMode":[function(e,t,a){"use strict";var r=function(){function e(){}e.AUTO="auto";e.WEBGL="webgl";e.FLASH="flash";e.NATIVE="native";e.SOFTWARE="software";return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ContextSoftware":[function(e,t,a){"use strict";var r=e("awayjs-core/lib/image/BitmapImage2D");var s=e("awayjs-core/lib/geom/Matrix3D");var i=e("awayjs-core/lib/geom/Matrix");var l=e("awayjs-core/lib/geom/Point");var n=e("awayjs-core/lib/geom/Vector3D");var o=e("awayjs-core/lib/geom/Rectangle");var u=e("awayjs-core/lib/utils/ColorUtils");var f=e("awayjs-core/lib/geom/Matrix3DUtils");var g=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var c=e("awayjs-stagegl/lib/base/ContextGLClearMask");var d=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var h=e("awayjs-stagegl/lib/base/ContextGLProgramType");var b=e("awayjs-stagegl/lib/base/ContextGLTriangleFace");var _=e("awayjs-stagegl/lib/base/IndexBufferSoftware");var p=e("awayjs-stagegl/lib/base/VertexBufferSoftware");var y=e("awayjs-stagegl/lib/base/TextureSoftware");var w=e("awayjs-stagegl/lib/base/ProgramSoftware");var m=e("awayjs-stagegl/lib/base/SoftwareSamplerState");var v=function(){function e(e){this._backBufferRect=new o.default;this._backBufferWidth=100;this._backBufferHeight=100;this._zbuffer=[];this._cullingMode=b.default.BACK;this._blendSource=g.default.ONE;this._blendDestination=g.default.ZERO;this._colorMaskR=true;this._colorMaskG=true;this._colorMaskB=true;this._colorMaskA=true;this._writeDepth=true;this._depthCompareMode=d.default.LESS;this._screenMatrix=new s.default;this._frontBufferMatrix=new i.default;this._bboxMin=new l.default;this._bboxMax=new l.default;this._clamp=new l.default;this._samplerStates=[];this._textures=[];this._vertexBuffers=[];this._vertexBufferOffsets=[];this._vertexBufferFormats=[];this._fragmentConstants=[];this._vertexConstants=[];this._antialias=0;this._canvas=e;this._backBufferColor=new r.default(this._backBufferWidth,this._backBufferHeight,false,0,false);this._frontBuffer=new r.default(this._backBufferWidth,this._backBufferHeight,true,0,false);if(document&&document.body){document.body.appendChild(this._frontBuffer.getCanvas())}}Object.defineProperty(e.prototype,"frontBuffer",{get:function(){return this._frontBuffer},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"container",{get:function(){return this._canvas},enumerable:true,configurable:true});e.prototype.clear=function(e,t,a,r,s,i,l){if(e===void 0){e=0}if(t===void 0){t=0}if(a===void 0){a=0}if(r===void 0){r=1}if(s===void 0){s=1}if(i===void 0){i=0}if(l===void 0){l=c.default.ALL}console.log("clear: "+e+", "+t+", "+a+", alpha: "+r);if(l&c.default.COLOR){this._backBufferColor.fillRect(this._backBufferRect,u.default.ARGBtoFloat32(r*255,e*255,t*255,a*255))}if(l&c.default.DEPTH){this._zbuffer.length=0;var n=this._backBufferWidth*this._backBufferHeight;for(var o=0;o<n;o++){this._zbuffer[o]=1e7}}};e.prototype.configureBackBuffer=function(e,t,a,r){console.log("configureBackBuffer antiAlias: "+a);this._antialias=a;if(this._antialias%2!=0){this._antialias=Math.floor(this._antialias-.5)}if(this._antialias==0){this._antialias=1}this._frontBuffer._setSize(e,t);this._backBufferWidth=e*this._antialias;this._backBufferHeight=t*this._antialias;this._backBufferRect.width=this._backBufferWidth;this._backBufferRect.height=this._backBufferHeight;this._backBufferColor._setSize(this._backBufferWidth,this._backBufferHeight);var s=this._screenMatrix.rawData;s[0]=this._backBufferWidth/2;s[1]=0;s[2]=0;s[3]=this._backBufferWidth/2;s[4]=0;s[5]=-this._backBufferHeight/2;s[6]=0;s[7]=this._backBufferHeight/2;s[8]=0;s[9]=0;s[10]=1;s[11]=0;s[12]=0;s[13]=0;s[14]=0;s[15]=0;this._screenMatrix.transpose();this._frontBufferMatrix=new i.default;this._frontBufferMatrix.scale(1/this._antialias,1/this._antialias)};e.prototype.createCubeTexture=function(e,t,a,r){return undefined};e.prototype.createIndexBuffer=function(e){return new _.default(e)};e.prototype.createProgram=function(){return new w.default};e.prototype.createTexture=function(e,t,a,r,s){return new y.default(e,t)};e.prototype.createVertexBuffer=function(e,t){return new p.default(e,t)};e.prototype.dispose=function(){};e.prototype.setBlendFactors=function(e,t){console.log("setBlendFactors sourceFactor: "+e+" destinationFactor: "+t);this._blendSource=e;this._blendDestination=t};e.prototype.setColorMask=function(e,t,a,r){this._colorMaskR=e;this._colorMaskG=t;this._colorMaskB=a;this._colorMaskA=r};e.prototype.setStencilActions=function(e,t,a,r,s,i){};e.prototype.setStencilReferenceValue=function(e,t,a){};e.prototype.setCulling=function(e,t){this._cullingMode=e};e.prototype.setDepthTest=function(e,t){console.log("setDepthTest: "+e+" , "+t);this._writeDepth=e;this._depthCompareMode=t};e.prototype.setProgram=function(e){this._program=e};e.prototype.setProgramConstantsFromMatrix=function(e,t,a,r){console.log("setProgramConstantsFromMatrix: programType"+e+" firstRegister: "+t+" matrix: "+a+" transposedMatrix: "+r);var s=a.rawData;if(r){var i=f.default.RAW_DATA_CONTAINER;i[0]=s[0];i[1]=s[4];i[2]=s[8];i[3]=s[12];i[4]=s[1];i[5]=s[5];i[6]=s[9];i[7]=s[13];i[8]=s[2];i[9]=s[6];i[10]=s[10];i[11]=s[14];i[12]=s[3];i[13]=s[7];i[14]=s[11];i[15]=s[15];this.setProgramConstantsFromArray(e,t,i,4)}else{this.setProgramConstantsFromArray(e,t,s,4)}};e.prototype.setProgramConstantsFromArray=function(e,t,a,r){console.log("setProgramConstantsFromArray: programType"+e+" firstRegister: "+t+" data: "+a+" numRegisters: "+r);var s;if(e==h.default.VERTEX){s=this._vertexConstants}else if(e==h.default.FRAGMENT){s=this._fragmentConstants}var i=0;for(var l=t;l<t+r;l++){s[l]=new n.default(a[i++],a[i++],a[i++],a[i++])}};e.prototype.setTextureAt=function(e,t){console.log("setTextureAt sample: "+e+" texture: "+t);this._textures[e]=t};e.prototype.setVertexBufferAt=function(e,t,a,r){console.log("setVertexBufferAt index: "+e+" buffer: "+t+" bufferOffset: "+a+" format: "+r);this._vertexBuffers[e]=t;this._vertexBufferOffsets[e]=a;this._vertexBufferFormats[e]=r};e.prototype.present=function(){console.log("present()");this._frontBuffer.fillRect(this._frontBuffer.rect,u.default.ARGBtoFloat32(0,0,0,0));this._frontBuffer.draw(this._backBufferColor,this._frontBufferMatrix)};e.prototype.drawToBitmapImage2D=function(e){};e.prototype.drawIndices=function(e,t,a,r){console.log("drawIndices mode: "+e+" firstIndex: "+a+" numIndices: "+r);if(!this._program){return}this._backBufferColor.lock();var s;var i;var l;var n;var o;var u;if(this._cullingMode==b.default.BACK){for(var f=a;f<r;f+=3){s=t.data[t.startOffset+f];i=t.data[t.startOffset+f+1];l=t.data[t.startOffset+f+2];n=this._program.vertex(this,s);o=this._program.vertex(this,i);u=this._program.vertex(this,l);this.triangle(n,o,u)}}else if(this._cullingMode==b.default.FRONT){for(var f=a;f<r;f+=3){s=t.data[t.startOffset+f+2];i=t.data[t.startOffset+f+1];l=t.data[t.startOffset+f+0];n=this._program.vertex(this,s);o=this._program.vertex(this,i);u=this._program.vertex(this,l);this.triangle(n,o,u)}}else if(this._cullingMode==b.default.FRONT_AND_BACK||this._cullingMode==b.default.NONE){for(var f=a;f<r;f+=3){s=t.data[t.startOffset+f+2];i=t.data[t.startOffset+f+1];l=t.data[t.startOffset+f+0];n=this._program.vertex(this,s);o=this._program.vertex(this,i);u=this._program.vertex(this,l);this.triangle(n,o,u);s=t.data[t.startOffset+f];i=t.data[t.startOffset+f+1];l=t.data[t.startOffset+f+2];n=this._program.vertex(this,s);o=this._program.vertex(this,i);u=this._program.vertex(this,l);this.triangle(n,o,u)}}this._backBufferColor.unlock()};e.prototype.drawVertices=function(e,t,a){};e.prototype.setScissorRectangle=function(e){};e.prototype.setSamplerStateAt=function(e,t,a,r){var s=this._samplerStates[e];if(!s){s=this._samplerStates[e]=new m.default}s.wrap=t;s.filter=a;s.mipfilter=r};e.prototype.setRenderToTexture=function(e,t,a,r){};e.prototype.setRenderToBackBuffer=function(){};e.prototype.putPixel=function(e,t,a){var r=u.default.float32ColorToARGB(this._backBufferColor.getPixel32(e,t));r[0]/=255;r[1]/=255;r[2]/=255;r[3]/=255;var s=u.default.float32ColorToARGB(a);s[0]/=255;s[1]/=255;s[2]/=255;s[3]/=255;var i=this.applyBlendMode(r,this._blendDestination,r,s);var l=this.applyBlendMode(s,this._blendSource,r,s);var n=i[0]+l[0];var o=i[1]+l[1];var f=i[2]+l[2];var g=i[3]+l[3];n=Math.max(0,Math.min(n,1));o=Math.max(0,Math.min(o,1));f=Math.max(0,Math.min(f,1));g=Math.max(0,Math.min(g,1));this._backBufferColor.setPixel32(e,t,u.default.ARGBtoFloat32(n*255,o*255,f*255,g*255))};e.prototype.applyBlendMode=function(e,t,a,r){var s=[];s[0]=e[0];s[1]=e[1];s[2]=e[2];s[3]=e[3];if(t==g.default.DESTINATION_ALPHA){s[0]*=a[0];s[1]*=a[0];s[2]*=a[0];s[3]*=a[0]}else if(t==g.default.DESTINATION_COLOR){s[0]*=a[0];s[1]*=a[1];s[2]*=a[2];s[3]*=a[3]}else if(t==g.default.ZERO){s[0]=0;s[1]=0;s[2]=0;s[3]=0}else if(t==g.default.ONE_MINUS_DESTINATION_ALPHA){s[0]*=1-a[0];s[1]*=1-a[0];s[2]*=1-a[0];s[3]*=1-a[0]}else if(t==g.default.ONE_MINUS_DESTINATION_COLOR){s[0]*=1-a[0];s[1]*=1-a[1];s[2]*=1-a[2];s[3]*=1-a[3]}else if(t==g.default.ONE_MINUS_SOURCE_ALPHA){s[0]*=1-r[0];s[1]*=1-r[0];s[2]*=1-r[0];s[3]*=1-r[0]}else if(t==g.default.ONE_MINUS_SOURCE_COLOR){s[0]*=1-r[0];s[1]*=1-r[1];s[2]*=1-r[2];s[3]*=1-r[3]}else if(t==g.default.SOURCE_ALPHA){s[0]*=r[0];s[1]*=r[0];s[2]*=r[0];s[3]*=r[0]}else if(t==g.default.SOURCE_COLOR){s[0]*=r[0];s[1]*=r[1];s[2]*=r[2];s[3]*=r[3]}return s};e.prototype.clamp=function(e,t,a){if(t===void 0){t=0}if(a===void 0){a=1}return Math.max(t,Math.min(e,a))};e.prototype.interpolate=function(e,t,a){return e+(t-e)*this.clamp(a)};e.prototype.triangle=function(e,t,a){var r=e.outputPosition[0];if(!r||r.w==0||isNaN(r.w)){console.error("wrong position");return}var s=t.outputPosition[0];var i=a.outputPosition[0];r.z=r.z*2-r.w;s.z=s.z*2-s.w;i.z=i.z*2-i.w;r.scaleBy(1/r.w);s.scaleBy(1/s.w);i.scaleBy(1/i.w);var l=new n.default(r.w,s.w,i.w);r=this._screenMatrix.transformVector(r);s=this._screenMatrix.transformVector(s);i=this._screenMatrix.transformVector(i);var o=new n.default(r.z,s.z,i.z);this._bboxMin.x=1e6;this._bboxMin.y=1e6;this._bboxMax.x=-1e6;this._bboxMax.y=-1e6;this._clamp.x=this._backBufferWidth-1;this._clamp.y=this._backBufferHeight-1;this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,r.x));this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,r.y));this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,s.x));this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,s.y));this._bboxMin.x=Math.max(0,Math.min(this._bboxMin.x,i.x));this._bboxMin.y=Math.max(0,Math.min(this._bboxMin.y,i.y));this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,r.x));this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,r.y));this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,s.x));this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,s.y));this._bboxMax.x=Math.min(this._clamp.x,Math.max(this._bboxMax.x,i.x));this._bboxMax.y=Math.min(this._clamp.y,Math.max(this._bboxMax.y,i.y));this._bboxMin.x=Math.floor(this._bboxMin.x);this._bboxMin.y=Math.floor(this._bboxMin.y);this._bboxMax.x=Math.floor(this._bboxMax.x);this._bboxMax.y=Math.floor(this._bboxMax.y);for(var f=this._bboxMin.x;f<=this._bboxMax.x;f++){for(var g=this._bboxMin.y;g<=this._bboxMax.y;g++){var c=this.calcPixel(f,g,r,s,i,l,o,e,t,a);if(c){this.putPixel(f,g,u.default.ARGBtoFloat32(c.w,c.x,c.y,c.z))}}}};e.prototype.calcPixel=function(e,t,a,r,s,i,l,o,u,f){var g=this.barycentric(a,r,s,e,t);var c=this.barycentric(a,r,s,e+1,t);var h=this.barycentric(a,r,s,e,t+1);var b=new n.default(g.x/i.x,g.y/i.y,g.z/i.z);b.scaleBy(1/(b.x+b.y+b.z));var _=new n.default(c.x/i.x,c.y/i.y,c.z/i.z);_.scaleBy(1/(_.x+_.y+_.z));var p=new n.default(h.x/i.x,h.y/i.y,h.z/i.z);p.scaleBy(1/(p.x+p.y+p.z));var y=e%this._backBufferWidth+t*this._backBufferWidth;var w=l.x*g.x+l.y*g.y+l.z*g.z;if(g.x<0||g.y<0||g.z<0){return null}var m=this._zbuffer[y];var v=false;switch(this._depthCompareMode){case d.default.ALWAYS:v=true;break;case d.default.EQUAL:v=w==m;break;case d.default.GREATER:v=w>m;break;case d.default.GREATER_EQUAL:v=w>=m;break;case d.default.LESS:v=w<m;break;case d.default.LESS_EQUAL:v=w<=m;break;case d.default.NEVER:v=false;break;case d.default.NOT_EQUAL:v=w!=m;break;default:}if(!v){return null}var x=this._program.fragment(this,b,_,p,o,u,f,w);if(x.discard){return null}if(this._writeDepth){this._zbuffer[y]=w}var j=x.outputColor[0];j.x=Math.max(0,Math.min(j.x,1));j.y=Math.max(0,Math.min(j.y,1));j.z=Math.max(0,Math.min(j.z,1));j.w=Math.max(0,Math.min(j.w,1));j.x*=255;j.y*=255;j.z*=255;j.w*=255;return j};e.prototype.barycentric=function(e,t,a,r,s){var i=new n.default;i.x=a.x-e.x;i.y=t.x-e.x;i.z=e.x-r;var l=new n.default;l.x=a.y-e.y;l.y=t.y-e.y;l.z=e.y-s;var o=i.crossProduct(l);if(o.z<.01){return new n.default(1-(o.x+o.y)/o.z,o.y/o.z,o.x/o.z)}return new n.default(-1,1,1)};e.MAX_SAMPLERS=8;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=v;var x=function(){function e(e,t,a){this.size=e;this.type=t;this.normalized=a}return e}()},{"awayjs-core/lib/geom/Matrix":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Point":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/image/BitmapImage2D":undefined,"awayjs-core/lib/utils/ColorUtils":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":"awayjs-stagegl/lib/base/ContextGLBlendFactor","awayjs-stagegl/lib/base/ContextGLClearMask":"awayjs-stagegl/lib/base/ContextGLClearMask","awayjs-stagegl/lib/base/ContextGLCompareMode":"awayjs-stagegl/lib/base/ContextGLCompareMode","awayjs-stagegl/lib/base/ContextGLProgramType":"awayjs-stagegl/lib/base/ContextGLProgramType","awayjs-stagegl/lib/base/ContextGLTriangleFace":"awayjs-stagegl/lib/base/ContextGLTriangleFace","awayjs-stagegl/lib/base/IndexBufferSoftware":"awayjs-stagegl/lib/base/IndexBufferSoftware","awayjs-stagegl/lib/base/ProgramSoftware":"awayjs-stagegl/lib/base/ProgramSoftware","awayjs-stagegl/lib/base/SoftwareSamplerState":"awayjs-stagegl/lib/base/SoftwareSamplerState","awayjs-stagegl/lib/base/TextureSoftware":"awayjs-stagegl/lib/base/TextureSoftware","awayjs-stagegl/lib/base/VertexBufferSoftware":"awayjs-stagegl/lib/base/VertexBufferSoftware"}],"awayjs-stagegl/lib/base/ContextStage3D":[function(e,t,a){"use strict";var r=e("awayjs-core/lib/geom/Matrix3DUtils");var s=e("awayjs-stagegl/lib/base/ContextGLClearMask");var i=e("awayjs-stagegl/lib/base/ContextGLProgramType");var l=e("awayjs-stagegl/lib/base/CubeTextureFlash");var n=e("awayjs-stagegl/lib/base/IndexBufferFlash");var o=e("awayjs-stagegl/lib/base/OpCodes");var u=e("awayjs-stagegl/lib/base/ProgramFlash");var f=e("awayjs-stagegl/lib/base/TextureFlash");var g=e("awayjs-stagegl/lib/base/VertexBufferFlash");var c=function(){function e(t,a){this._cmdStream="";this._resources=new Array;var r="11.0.0";var s={id:t.id};var i={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"sameDomain",allowfullscreen:"true",wmode:"direct"};this._errorCheckingEnabled=false;this._iDriverInfo="Unknown";var l={salign:"tl",id:t.id,name:t["name"]};this._oldCanvas=t.cloneNode();this._oldParent=t.parentNode;var n=this;e.contexts[t.id]=this;function o(e){if(!e.success)return;n._container=e.ref;n._iCallback=a}}Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"driverInfo",{get:function(){return this._iDriverInfo},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"errorCheckingEnabled",{get:function(){return this._errorCheckingEnabled},set:function(e){if(this._errorCheckingEnabled==e)return;this._errorCheckingEnabled=e;this.addStream(String.fromCharCode(o.default.enableErrorChecking,e?o.default.trueValue:o.default.falseValue));this.execute()},enumerable:true,configurable:true});e.prototype._iAddResource=function(e){this._resources.push(e)};e.prototype._iRemoveResource=function(e){this._resources.splice(this._resources.indexOf(e))};e.prototype.createTexture=function(e,t,a,r,s){if(s===void 0){s=0}return new f.default(this,e,t,a,r)};e.prototype.createCubeTexture=function(e,t,a,r){if(r===void 0){r=0}return new l.default(this,e,t,a)};e.prototype.setTextureAt=function(t,a){if(a){this.addStream(String.fromCharCode(o.default.setTextureAt)+t+","+a.id+",")}else{this.addStream(String.fromCharCode(o.default.clearTextureAt)+t.toString()+",")}if(e.debug)this.execute()};e.prototype.setSamplerStateAt=function(e,t,a,r){};e.prototype.setStencilActions=function(t,a,r,s,i,l){if(t===void 0){t="frontAndBack"}if(a===void 0){a="always"}if(r===void 0){r="keep"}if(s===void 0){s="keep"}if(i===void 0){i="keep"}if(l===void 0){l="leftHanded"}this.addStream(String.fromCharCode(o.default.setStencilActions)+t+"$"+a+"$"+r+"$"+s+"$"+i+"$");if(e.debug)this.execute()};e.prototype.setStencilReferenceValue=function(t,a,r){if(a===void 0){a=255}if(r===void 0){r=255}this.addStream(String.fromCharCode(o.default.setStencilReferenceValue,t+o.default.intMask,a+o.default.intMask,r+o.default.intMask));if(e.debug)this.execute()};e.prototype.setCulling=function(t,a){if(a===void 0){a="leftHanded"}this.addStream(String.fromCharCode(o.default.setCulling)+t+"$");if(e.debug)this.execute()};e.prototype.drawIndices=function(t,a,r,s){if(r===void 0){r=0}if(s===void 0){s=-1}r=r||0;if(!s||s<0)s=a.numIndices;this.addStream(String.fromCharCode(o.default.drawTriangles,a.id+o.default.intMask)+r+","+s+",");if(e.debug)this.execute()};e.prototype.drawVertices=function(e,t,a){if(t===void 0){t=0}if(a===void 0){a=-1}};e.prototype.setProgramConstantsFromMatrix=function(e,t,a,s){if(s===void 0){s=false}var i=a.rawData;if(s){var l=r.default.RAW_DATA_CONTAINER;l[0]=i[0];l[1]=i[4];l[2]=i[8];l[3]=i[12];l[4]=i[1];l[5]=i[5];l[6]=i[9];l[7]=i[13];l[8]=i[2];l[9]=i[6];l[10]=i[10];l[11]=i[14];l[12]=i[3];l[13]=i[7];l[14]=i[11];l[15]=i[15];this.setProgramConstantsFromArray(e,t,l,4)}else{this.setProgramConstantsFromArray(e,t,i,4)}};e.prototype.setProgramConstantsFromArray=function(t,a,r,s){if(s===void 0){s=-1}var l;var n=t==i.default.VERTEX?o.default.trueValue:o.default.falseValue;for(var u=0;u<s;u++){l=u*4;this.addStream(String.fromCharCode(o.default.setProgramConstant,n,a+u+o.default.intMask)+r[l]+","+r[l+1]+","+r[l+2]+","+r[l+3]+",");if(e.debug)this.execute()}};e.prototype.setProgram=function(t){this.addStream(String.fromCharCode(o.default.setProgram,t.id+o.default.intMask));if(e.debug)this.execute()};e.prototype.present=function(){this.addStream(String.fromCharCode(o.default.present));this.execute()};e.prototype.clear=function(t,a,r,i,l,n,u){if(t===void 0){t=0}if(a===void 0){a=0}if(r===void 0){r=0}if(i===void 0){i=1}if(l===void 0){l=1}if(n===void 0){n=0}if(u===void 0){u=s.default.ALL}this.addStream(String.fromCharCode(o.default.clear)+t+","+a+","+r+","+i+","+l+","+n+","+u+",");if(e.debug)this.execute()};e.prototype.createProgram=function(){return new u.default(this)};e.prototype.createVertexBuffer=function(e,t){return new g.default(this,e,t)};e.prototype.createIndexBuffer=function(e){return new n.default(this,e)};e.prototype.configureBackBuffer=function(e,t,a,r){if(r===void 0){r=true}this._width=e;this._height=t;this.addStream(String.fromCharCode(o.default.configureBackBuffer)+e+","+t+",")};e.prototype.drawToBitmapImage2D=function(e){};e.prototype.setVertexBufferAt=function(t,a,r,s){if(r===void 0){r=0}if(s===void 0){s=null}if(a){this.addStream(String.fromCharCode(o.default.setVertexBufferAt,t+o.default.intMask)+a.id+","+r+","+s+"$")}else{this.addStream(String.fromCharCode(o.default.clearVertexBufferAt,t+o.default.intMask))}if(e.debug)this.execute()};e.prototype.setColorMask=function(t,a,r,s){this.addStream(String.fromCharCode(o.default.setColorMask,t?o.default.trueValue:o.default.falseValue,a?o.default.trueValue:o.default.falseValue,r?o.default.trueValue:o.default.falseValue,s?o.default.trueValue:o.default.falseValue));if(e.debug)this.execute()};e.prototype.setBlendFactors=function(t,a){this.addStream(String.fromCharCode(o.default.setBlendFactors)+t+"$"+a+"$");if(e.debug)this.execute()};e.prototype.setRenderToTexture=function(t,a,r,s){if(a===void 0){a=false}if(r===void 0){r=0}if(s===void 0){s=0}if(t===null||t===undefined){this.addStream(String.fromCharCode(o.default.clearRenderToTexture))}else{this.addStream(String.fromCharCode(o.default.setRenderToTexture,a?o.default.trueValue:o.default.falseValue)+t.id+","+(r||0)+",")}if(e.debug)this.execute()};e.prototype.setRenderToBackBuffer=function(){this.addStream(String.fromCharCode(o.default.clearRenderToTexture));if(e.debug)this.execute()};e.prototype.setScissorRectangle=function(t){if(t){this.addStream(String.fromCharCode(o.default.setScissorRect)+t.x+","+t.y+","+t.width+","+t.height+",")}else{this.addStream(String.fromCharCode(o.default.clearScissorRect))}if(e.debug)this.execute()};e.prototype.setDepthTest=function(t,a){this.addStream(String.fromCharCode(o.default.setDepthTest,t?o.default.trueValue:o.default.falseValue)+a+"$");if(e.debug)this.execute()};e.prototype.dispose=function(){if(this._container==null)return;console.log("Context3D dispose, releasing "+this._resources.length+" resources.");while(this._resources.length)this._resources[0].dispose();if(this._container){this.addStream(String.fromCharCode(o.default.disposeContext));this.execute();if(this._oldCanvas&&this._oldParent){this._oldParent.appendChild(this._oldCanvas);this._oldParent=null}this._container=null}this._oldCanvas=null};e.prototype.addStream=function(e){this._cmdStream+=e};e.prototype.execute=function(){if(e.logStream)console.log(this._cmdStream);var t=this._container["CallFunction"]('<invoke name="execStage3dOpStream" returntype="javascript"><arguments><string>'+this._cmdStream+"</string></arguments></invoke>");if(Number(t)<=-3)throw"Exec stream failed";this._cmdStream="";return Number(t)};e.contexts=new Object;e.debug=false;e.logStream=false;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=c;function d(e,t){var a=c.contexts[e];if(a._iCallback){a._iDriverInfo=t;var r=window.setTimeout(function(){window.clearTimeout(r);try{a._iCallback(a)}catch(e){console.log("Callback failed during flash initialization with '"+e.toString()+"'")}},1)}}},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-stagegl/lib/base/ContextGLClearMask":"awayjs-stagegl/lib/base/ContextGLClearMask","awayjs-stagegl/lib/base/ContextGLProgramType":"awayjs-stagegl/lib/base/ContextGLProgramType","awayjs-stagegl/lib/base/CubeTextureFlash":"awayjs-stagegl/lib/base/CubeTextureFlash","awayjs-stagegl/lib/base/IndexBufferFlash":"awayjs-stagegl/lib/base/IndexBufferFlash","awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ProgramFlash":"awayjs-stagegl/lib/base/ProgramFlash","awayjs-stagegl/lib/base/TextureFlash":"awayjs-stagegl/lib/base/TextureFlash","awayjs-stagegl/lib/base/VertexBufferFlash":"awayjs-stagegl/lib/base/VertexBufferFlash"}],"awayjs-stagegl/lib/base/ContextWebGL":[function(e,t,a){"use strict";var r=e("awayjs-core/lib/geom/Matrix3DUtils");var s=e("awayjs-core/lib/geom/Rectangle");var i=e("awayjs-core/lib/utils/ByteArray");var l=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");var n=e("awayjs-stagegl/lib/base/ContextGLDrawMode");var o=e("awayjs-stagegl/lib/base/ContextGLClearMask");var u=e("awayjs-stagegl/lib/base/ContextGLCompareMode");var f=e("awayjs-stagegl/lib/base/ContextGLMipFilter");var g=e("awayjs-stagegl/lib/base/ContextGLProgramType");var c=e("awayjs-stagegl/lib/base/ContextGLStencilAction");var d=e("awayjs-stagegl/lib/base/ContextGLTextureFilter");var h=e("awayjs-stagegl/lib/base/ContextGLTriangleFace");var b=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var _=e("awayjs-stagegl/lib/base/ContextGLWrapMode");var p=e("awayjs-stagegl/lib/base/CubeTextureWebGL");var y=e("awayjs-stagegl/lib/base/IndexBufferWebGL");var w=e("awayjs-stagegl/lib/base/ProgramWebGL");var m=e("awayjs-stagegl/lib/base/TextureWebGL");var v=e("awayjs-stagegl/lib/base/SamplerState");var x=e("awayjs-stagegl/lib/base/VertexBufferWebGL");var j=function(){function e(t){this._blendFactorDictionary=new Object;this._drawModeDictionary=new Object;this._compareModeDictionary=new Object;this._stencilActionDictionary=new Object;this._textureIndexDictionary=new Array(8);this._textureTypeDictionary=new Object;this._wrapDictionary=new Object;this._filterDictionary=new Object;this._mipmapFilterDictionary=new Object;this._vertexBufferPropertiesDictionary=[];this._samplerStates=new Array(8);this._stencilReferenceValue=0;this._stencilReadMask=255;this._separateStencil=false;this._container=t;try{this._gl=t.getContext("experimental-webgl",{premultipliedAlpha:false,alpha:false,stencil:true});if(!this._gl)this._gl=t.getContext("webgl",{premultipliedAlpha:false,alpha:false,stencil:true})}catch(a){}if(this._gl){if(this._gl.getExtension("OES_standard_derivatives")){this._standardDerivatives=true}else{this._standardDerivatives=false}this._blendFactorDictionary[l.default.ONE]=this._gl.ONE;this._blendFactorDictionary[l.default.DESTINATION_ALPHA]=this._gl.DST_ALPHA;this._blendFactorDictionary[l.default.DESTINATION_COLOR]=this._gl.DST_COLOR;this._blendFactorDictionary[l.default.ONE]=this._gl.ONE;this._blendFactorDictionary[l.default.ONE_MINUS_DESTINATION_ALPHA]=this._gl.ONE_MINUS_DST_ALPHA;this._blendFactorDictionary[l.default.ONE_MINUS_DESTINATION_COLOR]=this._gl.ONE_MINUS_DST_COLOR;this._blendFactorDictionary[l.default.ONE_MINUS_SOURCE_ALPHA]=this._gl.ONE_MINUS_SRC_ALPHA;this._blendFactorDictionary[l.default.ONE_MINUS_SOURCE_COLOR]=this._gl.ONE_MINUS_SRC_COLOR;this._blendFactorDictionary[l.default.SOURCE_ALPHA]=this._gl.SRC_ALPHA;this._blendFactorDictionary[l.default.SOURCE_COLOR]=this._gl.SRC_COLOR;this._blendFactorDictionary[l.default.ZERO]=this._gl.ZERO;this._drawModeDictionary[n.default.LINES]=this._gl.LINES;this._drawModeDictionary[n.default.TRIANGLES]=this._gl.TRIANGLES;this._compareModeDictionary[u.default.ALWAYS]=this._gl.ALWAYS;this._compareModeDictionary[u.default.EQUAL]=this._gl.EQUAL;this._compareModeDictionary[u.default.GREATER]=this._gl.GREATER;this._compareModeDictionary[u.default.GREATER_EQUAL]=this._gl.GEQUAL;this._compareModeDictionary[u.default.LESS]=this._gl.LESS;this._compareModeDictionary[u.default.LESS_EQUAL]=this._gl.LEQUAL;this._compareModeDictionary[u.default.NEVER]=this._gl.NEVER;this._compareModeDictionary[u.default.NOT_EQUAL]=this._gl.NOTEQUAL;this._stencilActionDictionary[c.default.DECREMENT_SATURATE]=this._gl.DECR;this._stencilActionDictionary[c.default.DECREMENT_WRAP]=this._gl.DECR_WRAP;this._stencilActionDictionary[c.default.INCREMENT_SATURATE]=this._gl.INCR;this._stencilActionDictionary[c.default.INCREMENT_WRAP]=this._gl.INCR_WRAP;this._stencilActionDictionary[c.default.INVERT]=this._gl.INVERT;this._stencilActionDictionary[c.default.KEEP]=this._gl.KEEP;this._stencilActionDictionary[c.default.SET]=this._gl.REPLACE;this._stencilActionDictionary[c.default.ZERO]=this._gl.ZERO;
this._textureIndexDictionary[0]=this._gl.TEXTURE0;this._textureIndexDictionary[1]=this._gl.TEXTURE1;this._textureIndexDictionary[2]=this._gl.TEXTURE2;this._textureIndexDictionary[3]=this._gl.TEXTURE3;this._textureIndexDictionary[4]=this._gl.TEXTURE4;this._textureIndexDictionary[5]=this._gl.TEXTURE5;this._textureIndexDictionary[6]=this._gl.TEXTURE6;this._textureIndexDictionary[7]=this._gl.TEXTURE7;this._textureTypeDictionary["texture2d"]=this._gl.TEXTURE_2D;this._textureTypeDictionary["textureCube"]=this._gl.TEXTURE_CUBE_MAP;this._wrapDictionary[_.default.REPEAT]=this._gl.REPEAT;this._wrapDictionary[_.default.CLAMP]=this._gl.CLAMP_TO_EDGE;this._filterDictionary[d.default.LINEAR]=this._gl.LINEAR;this._filterDictionary[d.default.NEAREST]=this._gl.NEAREST;this._mipmapFilterDictionary[d.default.LINEAR]=new Object;this._mipmapFilterDictionary[d.default.LINEAR][f.default.MIPNEAREST]=this._gl.LINEAR_MIPMAP_NEAREST;this._mipmapFilterDictionary[d.default.LINEAR][f.default.MIPLINEAR]=this._gl.LINEAR_MIPMAP_LINEAR;this._mipmapFilterDictionary[d.default.LINEAR][f.default.MIPNONE]=this._gl.LINEAR;this._mipmapFilterDictionary[d.default.NEAREST]=new Object;this._mipmapFilterDictionary[d.default.NEAREST][f.default.MIPNEAREST]=this._gl.NEAREST_MIPMAP_NEAREST;this._mipmapFilterDictionary[d.default.NEAREST][f.default.MIPLINEAR]=this._gl.NEAREST_MIPMAP_LINEAR;this._mipmapFilterDictionary[d.default.NEAREST][f.default.MIPNONE]=this._gl.NEAREST;this._vertexBufferPropertiesDictionary[b.default.FLOAT_1]=new S(1,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[b.default.FLOAT_2]=new S(2,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[b.default.FLOAT_3]=new S(3,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[b.default.FLOAT_4]=new S(4,this._gl.FLOAT,false);this._vertexBufferPropertiesDictionary[b.default.BYTE_1]=new S(1,this._gl.BYTE,true);this._vertexBufferPropertiesDictionary[b.default.BYTE_2]=new S(2,this._gl.BYTE,true);this._vertexBufferPropertiesDictionary[b.default.BYTE_3]=new S(3,this._gl.BYTE,true);this._vertexBufferPropertiesDictionary[b.default.BYTE_4]=new S(4,this._gl.BYTE,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_BYTE_1]=new S(1,this._gl.UNSIGNED_BYTE,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_BYTE_2]=new S(2,this._gl.UNSIGNED_BYTE,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_BYTE_3]=new S(3,this._gl.UNSIGNED_BYTE,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_BYTE_4]=new S(4,this._gl.UNSIGNED_BYTE,true);this._vertexBufferPropertiesDictionary[b.default.SHORT_1]=new S(1,this._gl.SHORT,true);this._vertexBufferPropertiesDictionary[b.default.SHORT_2]=new S(2,this._gl.SHORT,true);this._vertexBufferPropertiesDictionary[b.default.SHORT_3]=new S(3,this._gl.SHORT,true);this._vertexBufferPropertiesDictionary[b.default.SHORT_4]=new S(4,this._gl.SHORT,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_SHORT_1]=new S(1,this._gl.UNSIGNED_SHORT,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_SHORT_2]=new S(2,this._gl.UNSIGNED_SHORT,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_SHORT_3]=new S(3,this._gl.UNSIGNED_SHORT,true);this._vertexBufferPropertiesDictionary[b.default.UNSIGNED_SHORT_4]=new S(4,this._gl.UNSIGNED_SHORT,true);this._stencilCompareMode=this._gl.ALWAYS;this._stencilCompareModeBack=this._gl.ALWAYS;this._stencilCompareModeFront=this._gl.ALWAYS}else{alert("WebGL is not available.")}for(var r=0;r<e.MAX_SAMPLERS;++r){this._samplerStates[r]=new v.default;this._samplerStates[r].wrap=this._gl.REPEAT;this._samplerStates[r].filter=this._gl.LINEAR;this._samplerStates[r].mipfilter=this._gl.LINEAR}}Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"standardDerivatives",{get:function(){return this._standardDerivatives},enumerable:true,configurable:true});e.prototype.gl=function(){return this._gl};e.prototype.clear=function(e,t,a,r,s,i,l){if(e===void 0){e=0}if(t===void 0){t=0}if(a===void 0){a=0}if(r===void 0){r=1}if(s===void 0){s=1}if(i===void 0){i=0}if(l===void 0){l=o.default.ALL}if(!this._drawing){this.updateBlendStatus();this._drawing=true}var n=0;if(l&o.default.COLOR)n|=this._gl.COLOR_BUFFER_BIT;if(l&o.default.STENCIL)n|=this._gl.STENCIL_BUFFER_BIT;if(l&o.default.DEPTH)n|=this._gl.DEPTH_BUFFER_BIT;this._gl.clearColor(e,t,a,r);this._gl.clearDepth(s);this._gl.clearStencil(i);this._gl.clear(n)};e.prototype.configureBackBuffer=function(e,t,a,r){if(r===void 0){r=true}this._width=e;this._height=t;if(r){this._gl.enable(this._gl.STENCIL_TEST);this._gl.enable(this._gl.DEPTH_TEST)}this._gl.viewport["width"]=e;this._gl.viewport["height"]=t;this._gl.viewport(0,0,e,t)};e.prototype.createCubeTexture=function(e,t,a,r){if(r===void 0){r=0}return new p.default(this._gl,e)};e.prototype.createIndexBuffer=function(e){return new y.default(this._gl,e)};e.prototype.createProgram=function(){return new w.default(this._gl)};e.prototype.createTexture=function(e,t,a,r,s){if(s===void 0){s=0}return new m.default(this._gl,e,t)};e.prototype.createVertexBuffer=function(e,t){return new x.default(this._gl,e,t)};e.prototype.dispose=function(){for(var e=0;e<this._samplerStates.length;++e)this._samplerStates[e]=null};e.prototype.drawToBitmapImage2D=function(e){var t=new ArrayBuffer(e.width*e.height*4);this._gl.readPixels(0,0,e.width,e.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,new Uint8Array(t));var a=new i.default;a.setArrayBuffer(t);e.setPixels(new s.default(0,0,e.width,e.height),a)};e.prototype.drawIndices=function(e,t,a,r){if(a===void 0){a=0}if(r===void 0){r=-1}if(!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,t.glBuffer);this._gl.drawElements(this._drawModeDictionary[e],r==-1?t.numIndices:r,this._gl.UNSIGNED_SHORT,a*2)};e.prototype.drawVertices=function(e,t,a){if(t===void 0){t=0}if(a===void 0){a=-1}if(!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";this._gl.drawArrays(this._drawModeDictionary[e],t,a)};e.prototype.present=function(){this._drawing=false};e.prototype.setBlendFactors=function(e,t){this._blendEnabled=true;this._blendSourceFactor=this._blendFactorDictionary[e];this._blendDestinationFactor=this._blendFactorDictionary[t];this.updateBlendStatus()};e.prototype.setColorMask=function(e,t,a,r){this._gl.colorMask(e,t,a,r)};e.prototype.setCulling=function(e,t){if(t===void 0){t="leftHanded"}if(e==h.default.NONE){this._gl.disable(this._gl.CULL_FACE)}else{this._gl.enable(this._gl.CULL_FACE);this._gl.cullFace(this.translateTriangleFace(e,t))}};e.prototype.setDepthTest=function(e,t){this._gl.depthFunc(this._compareModeDictionary[t]);this._gl.depthMask(e)};e.prototype.setStencilActions=function(e,t,a,r,s,i){if(e===void 0){e="frontAndBack"}if(t===void 0){t="always"}if(a===void 0){a="keep"}if(r===void 0){r="keep"}if(s===void 0){s="keep"}if(i===void 0){i="leftHanded"}this._separateStencil=e!="frontAndBack";var l=this._compareModeDictionary[t];var n=this._stencilActionDictionary[s];var o=this._stencilActionDictionary[r];var u=this._stencilActionDictionary[a];if(!this._separateStencil){this._stencilCompareMode=l;this._gl.stencilFunc(l,this._stencilReferenceValue,this._stencilReadMask);this._gl.stencilOp(n,o,u)}else if(e=="back"){this._stencilCompareModeBack=l;this._gl.stencilFuncSeparate(this._gl.BACK,l,this._stencilReferenceValue,this._stencilReadMask);this._gl.stencilOpSeparate(this._gl.BACK,n,o,u)}else if(e=="front"){this._stencilCompareModeFront=l;this._gl.stencilFuncSeparate(this._gl.FRONT,l,this._stencilReferenceValue,this._stencilReadMask);this._gl.stencilOpSeparate(this._gl.FRONT,n,o,u)}};e.prototype.setStencilReferenceValue=function(e,t,a){this._stencilReferenceValue=e;this._stencilReadMask=t;if(this._separateStencil){this._gl.stencilFuncSeparate(this._gl.FRONT,this._stencilCompareModeFront,e,t);this._gl.stencilFuncSeparate(this._gl.BACK,this._stencilCompareModeBack,e,t)}else{this._gl.stencilFunc(this._stencilCompareMode,e,t)}this._gl.stencilMask(a)};e.prototype.setProgram=function(e){this._currentProgram=e;e.focusProgram()};e.prototype.setProgramConstantsFromMatrix=function(e,t,a,s){if(s===void 0){s=false}var i=a.rawData;if(s){var l=r.default.RAW_DATA_CONTAINER;l[0]=i[0];l[1]=i[4];l[2]=i[8];l[3]=i[12];l[4]=i[1];l[5]=i[5];l[6]=i[9];l[7]=i[13];l[8]=i[2];l[9]=i[6];l[10]=i[10];l[11]=i[14];l[12]=i[3];l[13]=i[7];l[14]=i[11];l[15]=i[15];this.setProgramConstantsFromArray(e,t,l,4)}else{this.setProgramConstantsFromArray(e,t,i,4)}};e.prototype.setProgramConstantsFromArray=function(e,t,a,r){if(r===void 0){r=-1}var s;for(var i=0;i<r;i++){s=i*4;this._gl.uniform4f(this._currentProgram.getUniformLocation(e,t+i),a[s],a[s+1],a[s+2],a[s+3])}};e.prototype.setScissorRectangle=function(e){if(!e){this._gl.disable(this._gl.SCISSOR_TEST);return}this._gl.enable(this._gl.SCISSOR_TEST);this._gl.scissor(e.x,e.y,e.width,e.height)};e.prototype.setTextureAt=function(e,t){var a=this._samplerStates[e];if(this._activeTexture!=e&&(t||a.type)){this._activeTexture=e;this._gl.activeTexture(this._textureIndexDictionary[e])}if(!t){if(a.type){this._gl.bindTexture(a.type,null);a.type=null}return}var r=this._textureTypeDictionary[t.textureType];a.type=r;this._gl.bindTexture(r,t.glTexture);this._gl.uniform1i(this._currentProgram.getUniformLocation(g.default.SAMPLER,e),e);this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_S,a.wrap);this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_T,a.wrap);this._gl.texParameteri(r,this._gl.TEXTURE_MAG_FILTER,a.filter);this._gl.texParameteri(r,this._gl.TEXTURE_MIN_FILTER,a.mipfilter)};e.prototype.setSamplerStateAt=function(t,a,r,s){if(0<=t&&t<e.MAX_SAMPLERS){this._samplerStates[t].wrap=this._wrapDictionary[a];this._samplerStates[t].filter=this._filterDictionary[r];this._samplerStates[t].mipfilter=this._mipmapFilterDictionary[r][s]}else{throw"Sampler is out of bounds."}};e.prototype.setVertexBufferAt=function(e,t,a,r){if(a===void 0){a=0}if(r===void 0){r=4}var s=this._currentProgram?this._currentProgram.getAttribLocation(e):-1;if(!t){if(s>-1)this._gl.disableVertexAttribArray(s);return}if(this._currentArrayBuffer!=t){this._currentArrayBuffer=t;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,t?t.glBuffer:null)}var i=this._vertexBufferPropertiesDictionary[r];this._gl.enableVertexAttribArray(s);this._gl.vertexAttribPointer(s,i.size,i.type,i.normalized,t.dataPerVertex,a)};e.prototype.setRenderToTexture=function(e,t,a,r){if(t===void 0){t=false}if(a===void 0){a=0}if(r===void 0){r=0}var s=e;var i=s.frameBuffer;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,i);if(t){this._gl.enable(this._gl.STENCIL_TEST);this._gl.enable(this._gl.DEPTH_TEST)}this._gl.viewport(0,0,s.width,s.height)};e.prototype.setRenderToBackBuffer=function(){this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)};e.prototype.updateBlendStatus=function(){if(this._blendEnabled){this._gl.enable(this._gl.BLEND);this._gl.blendEquation(this._gl.FUNC_ADD);this._gl.blendFunc(this._blendSourceFactor,this._blendDestinationFactor)}else{this._gl.disable(this._gl.BLEND)}};e.prototype.translateTriangleFace=function(e,t){switch(e){case h.default.BACK:return t=="leftHanded"?this._gl.FRONT:this._gl.BACK;case h.default.FRONT:return t=="leftHanded"?this._gl.BACK:this._gl.FRONT;case h.default.FRONT_AND_BACK:return this._gl.FRONT_AND_BACK;default:throw"Unknown ContextGLTriangleFace type."}};e.MAX_SAMPLERS=8;e._float4=new Float32Array(4);e.modulo=0;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=j;var S=function(){function e(e,t,a){this.size=e;this.type=t;this.normalized=a}return e}()},{"awayjs-core/lib/geom/Matrix3DUtils":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-stagegl/lib/base/ContextGLBlendFactor":"awayjs-stagegl/lib/base/ContextGLBlendFactor","awayjs-stagegl/lib/base/ContextGLClearMask":"awayjs-stagegl/lib/base/ContextGLClearMask","awayjs-stagegl/lib/base/ContextGLCompareMode":"awayjs-stagegl/lib/base/ContextGLCompareMode","awayjs-stagegl/lib/base/ContextGLDrawMode":"awayjs-stagegl/lib/base/ContextGLDrawMode","awayjs-stagegl/lib/base/ContextGLMipFilter":"awayjs-stagegl/lib/base/ContextGLMipFilter","awayjs-stagegl/lib/base/ContextGLProgramType":"awayjs-stagegl/lib/base/ContextGLProgramType","awayjs-stagegl/lib/base/ContextGLStencilAction":"awayjs-stagegl/lib/base/ContextGLStencilAction","awayjs-stagegl/lib/base/ContextGLTextureFilter":"awayjs-stagegl/lib/base/ContextGLTextureFilter","awayjs-stagegl/lib/base/ContextGLTriangleFace":"awayjs-stagegl/lib/base/ContextGLTriangleFace","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat","awayjs-stagegl/lib/base/ContextGLWrapMode":"awayjs-stagegl/lib/base/ContextGLWrapMode","awayjs-stagegl/lib/base/CubeTextureWebGL":"awayjs-stagegl/lib/base/CubeTextureWebGL","awayjs-stagegl/lib/base/IndexBufferWebGL":"awayjs-stagegl/lib/base/IndexBufferWebGL","awayjs-stagegl/lib/base/ProgramWebGL":"awayjs-stagegl/lib/base/ProgramWebGL","awayjs-stagegl/lib/base/SamplerState":"awayjs-stagegl/lib/base/SamplerState","awayjs-stagegl/lib/base/TextureWebGL":"awayjs-stagegl/lib/base/TextureWebGL","awayjs-stagegl/lib/base/VertexBufferWebGL":"awayjs-stagegl/lib/base/VertexBufferWebGL"}],"awayjs-stagegl/lib/base/CubeTextureFlash":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/utils/ByteArrayBase");var i=e("awayjs-stagegl/lib/base/OpCodes");var l=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var n=function(e){r(t,e);function t(t,a,r,s,l){if(l===void 0){l=false}e.call(this);this._context=t;this._size=a;this._context.addStream(String.fromCharCode(i.default.initCubeTexture,s?i.default.trueValue:i.default.falseValue)+a+","+l+","+r+"$");this._pId=this._context.execute();this._context._iAddResource(this)}Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:true,configurable:true});t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(i.default.disposeCubeTexture)+this._pId.toString()+",");this._context.execute();this._context._iRemoveResource(this);this._context=null};t.prototype.uploadFromData=function(e,t,a){if(a===void 0){a=0}if(e instanceof HTMLImageElement){var r=document.createElement("canvas");var l=e.width;var n=e.height;r.width=l;r.height=n;var o=r.getContext("2d");o.drawImage(e,0,0);e=o.getImageData(0,0,l,n).data}var u=0;var f=s.default.internalGetBase64String(e.length,function(){return e[u++]},null);this._context.addStream(String.fromCharCode(i.default.uploadBytesCubeTexture)+this._pId+","+a+","+t+","+(this.size>>a)+","+f+"%");this._context.execute()};t.prototype.uploadCompressedTextureFromByteArray=function(e,t,a){if(a===void 0){a=false}};return t}(l.default);Object.defineProperty(a,"__esModule",{value:true});a.default=n},{"awayjs-core/lib/utils/ByteArrayBase":undefined,"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/CubeTextureWebGL":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/base/TextureBaseWebGL");var i=function(e){r(t,e);function t(t,a){e.call(this,t);this._textureSelectorDictionary=new Array(6);this.textureType="textureCube";this._size=a;this._texture=this._gl.createTexture();this._textureSelectorDictionary[0]=t.TEXTURE_CUBE_MAP_POSITIVE_X;this._textureSelectorDictionary[1]=t.TEXTURE_CUBE_MAP_NEGATIVE_X;this._textureSelectorDictionary[2]=t.TEXTURE_CUBE_MAP_POSITIVE_Y;this._textureSelectorDictionary[3]=t.TEXTURE_CUBE_MAP_NEGATIVE_Y;this._textureSelectorDictionary[4]=t.TEXTURE_CUBE_MAP_POSITIVE_Z;this._textureSelectorDictionary[5]=t.TEXTURE_CUBE_MAP_NEGATIVE_Z}t.prototype.dispose=function(){this._gl.deleteTexture(this._texture)};t.prototype.uploadFromData=function(e,t,a){if(a===void 0){a=0}this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._texture);this._gl.texImage2D(this._textureSelectorDictionary[t],a,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e);this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null)};t.prototype.uploadCompressedTextureFromByteArray=function(e,t,a){if(a===void 0){a=false}};Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._texture},enumerable:true,configurable:true});return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/base/TextureBaseWebGL":"awayjs-stagegl/lib/base/TextureBaseWebGL"}],"awayjs-stagegl/lib/base/IContextGL":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/base/ICubeTexture":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/base/IIndexBuffer":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/base/IProgram":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/base/ITextureBase":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/base/ITexture":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/base/IVertexBuffer":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/base/IndexBufferFlash":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/base/OpCodes");var i=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var l=function(e){r(t,e);function t(t,a){e.call(this);this._context=t;this._numIndices=a;this._context.addStream(String.fromCharCode(s.default.initIndexBuffer,a+s.default.intMask));this._pId=this._context.execute();this._context._iAddResource(this)}t.prototype.uploadFromArray=function(e,t,a){this._context.addStream(String.fromCharCode(s.default.uploadArrayIndexBuffer,this._pId+s.default.intMask)+e.join()+"#"+t+","+a+",");this._context.execute()};t.prototype.uploadFromByteArray=function(e,t,a){};t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(s.default.disposeIndexBuffer,this._pId+s.default.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};Object.defineProperty(t.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/IndexBufferSoftware":[function(e,t,a){"use strict";var r=function(){function e(e){this._numIndices=e}e.prototype.uploadFromArray=function(e,t,a){this._startOffset=t*2;this._data=new Uint16Array(e)};e.prototype.uploadFromByteArray=function(e,t,a){this._startOffset=t*2;this._data=new Uint16Array(e)};e.prototype.dispose=function(){this._data=null};Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"startOffset",{get:function(){return this._startOffset},enumerable:true,configurable:true});return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/IndexBufferWebGL":[function(e,t,a){"use strict";var r=function(){function e(e,t){this._gl=e;this._buffer=this._gl.createBuffer();this._numIndices=t}e.prototype.uploadFromArray=function(e,t,a){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER,t*2,new Uint16Array(e));else this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),this._gl.STATIC_DRAW)};e.prototype.uploadFromByteArray=function(e,t,a){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER,t*2,e);else this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,e,this._gl.STATIC_DRAW)};e.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)};Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:true,configurable:true});return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/OpCodes":[function(e,t,a){"use strict";var r=function(){function e(){}e.trueValue=32;e.falseValue=33;e.intMask=63;e.drawTriangles=41;e.setProgramConstant=42;e.setProgram=43;e.present=44;e.clear=45;e.initProgram=46;e.initVertexBuffer=47;e.initIndexBuffer=48;e.configureBackBuffer=49;e.uploadArrayIndexBuffer=50;e.uploadArrayVertexBuffer=51;e.uploadAGALBytesProgram=52;e.setVertexBufferAt=53;e.uploadBytesIndexBuffer=54;e.uploadBytesVertexBuffer=55;e.setColorMask=56;e.setDepthTest=57;e.disposeProgram=58;e.disposeContext=59;e.disposeVertexBuffer=61;e.disposeIndexBuffer=63;e.initTexture=64;e.setTextureAt=65;e.uploadBytesTexture=66;e.disposeTexture=67;e.setCulling=68;e.setScissorRect=69;e.clearScissorRect=70;e.setBlendFactors=71;e.setRenderToTexture=72;e.clearTextureAt=73;e.clearVertexBufferAt=74;e.setStencilActions=75;e.setStencilReferenceValue=76;e.initCubeTexture=77;e.disposeCubeTexture=78;e.uploadBytesCubeTexture=79;e.clearRenderToTexture=80;e.enableErrorChecking=81;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ProgramFlash":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/base/ContextStage3D");var i=e("awayjs-stagegl/lib/base/OpCodes");var l=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var n=function(e){r(t,e);function t(t){e.call(this);this._context=t;this._context.addStream(String.fromCharCode(i.default.initProgram));this._pId=this._context.execute();this._context._iAddResource(this)}t.prototype.upload=function(e,t){this._context.addStream(String.fromCharCode(i.default.uploadAGALBytesProgram,this._pId+i.default.intMask)+e.readBase64String(e.length)+"%"+t.readBase64String(t.length)+"%");if(s.default.debug)this._context.execute()};t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(i.default.disposeProgram,this._pId+i.default.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};return t}(l.default);Object.defineProperty(a,"__esModule",{value:true});a.default=n},{"awayjs-stagegl/lib/base/ContextStage3D":"awayjs-stagegl/lib/base/ContextStage3D","awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/ProgramSoftware":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/AGALTokenizer");var s=e("awayjs-stagegl/lib/base/ProgramVOSoftware");var i=e("awayjs-core/lib/geom/Matrix3D");var l=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var o=e("awayjs-stagegl/lib/base/SoftwareSamplerState");var u=e("awayjs-stagegl/lib/base/ContextGLTextureFilter");var f=e("awayjs-stagegl/lib/base/ContextGLMipFilter");var g=e("awayjs-stagegl/lib/base/ContextGLWrapMode");var c=function(){function e(){}e.prototype.upload=function(t,a){this._vertexDescr=e._tokenizer.decribeAGALByteArray(t);this._fragmentDescr=e._tokenizer.decribeAGALByteArray(a)};e.prototype.dispose=function(){this._vertexDescr=null;this._fragmentDescr=null};e.prototype.vertex=function(t,a){var r=new s.default;var i;for(i=0;i<t._vertexBuffers.length;i++){var o=t._vertexBuffers[i];if(!o)continue;var u=new l.default(0,0,0,1);var f=t._vertexBufferOffsets[i]/4+a*o.attributesPerVertex;if(t._vertexBufferFormats[i]==n.default.UNSIGNED_BYTE_4){u.x=o.uintData[f*4];u.y=o.uintData[f*4+1];u.z=o.uintData[f*4+2];u.w=o.uintData[f*4+3]}if(t._vertexBufferFormats[i]==n.default.FLOAT_1){u.x=o.data[f]}if(t._vertexBufferFormats[i]==n.default.FLOAT_2){u.x=o.data[f];u.y=o.data[f+1]}if(t._vertexBufferFormats[i]==n.default.FLOAT_3){u.x=o.data[f];u.y=o.data[f+1];u.z=o.data[f+2]}if(t._vertexBufferFormats[i]==n.default.FLOAT_4){u.x=o.data[f];u.y=o.data[f+1];u.z=o.data[f+2];u.w=o.data[f+3]}r.attributes[i]=u}var g=this._vertexDescr.tokens.length;for(var i=0;i<g;i++){var c=this._vertexDescr.tokens[i];e._opCodeFunc[c.opcode](r,this._vertexDescr,c.dest,c.a,c.b,t)}return r};e.prototype.fragment=function(t,a,r,i,n,o,u,f){var g=new s.default;g.outputDepth=f;for(var c=0;c<n.varying.length;c++){var d=n.varying[c];var h=o.varying[c];var b=u.varying[c];if(!d||!h||!b)continue;var _=g.varying[c]=new l.default(0,0,0,1);_.x=a.x*d.x+a.y*h.x+a.z*b.x;_.y=a.x*d.y+a.y*h.y+a.z*b.y;_.z=a.x*d.z+a.y*h.z+a.z*b.z;_.w=a.x*d.w+a.y*h.w+a.z*b.w;var p=g.derivativeX[c]=new l.default;p.x=r.x*d.x+r.y*h.x+r.z*b.x;p.y=r.x*d.y+r.y*h.y+r.z*b.y;p.z=r.x*d.z+r.y*h.z+r.z*b.z;p.w=r.x*d.w+r.y*h.w+r.z*b.w;p.x-=_.x;p.y-=_.y;p.z-=_.z;p.w-=_.w;var y=g.derivativeY[c]=new l.default;y.x=i.x*d.x+i.y*h.x+i.z*b.x;y.y=i.x*d.y+i.y*h.y+i.z*b.y;y.z=i.x*d.z+i.y*h.z+i.z*b.z;y.w=i.x*d.w+i.y*h.w+i.z*b.w;y.x-=_.x;y.y-=_.y;y.z-=_.z;y.w-=_.w}var w=this._fragmentDescr.tokens.length;for(var c=0;c<w;c++){var m=this._fragmentDescr.tokens[c];e._opCodeFunc[m.opcode](g,this._fragmentDescr,m.dest,m.a,m.b,t)}return g};e.getDestTarget=function(e,t,a){var r;if(a.regtype==2){r=e.temp}else if(a.regtype==3){if(t.header.type=="vertex"){r=e.outputPosition}else{r=e.outputColor}}else if(a.regtype==4){r=e.varying}var s=a.regnum;var i=r[s];if(!i){i=r[s]=new l.default(0,0,0,1)}return i};e.getSourceTargetType=function(e,t,a,r){var s;if(a.regtype==0){s=e.attributes}else if(a.regtype==1){if(t.header.type=="vertex"){s=r._vertexConstants}else{s=r._fragmentConstants}}else if(a.regtype==2){s=e.temp}else if(a.regtype==4){s=e.varying}return s};e.getSourceTargetByIndex=function(e,t){var a=e[t];if(!a){a=e[t]=new l.default(0,0,0,1)}return a};e.getSourceTarget=function(t,a,r,s){var i=e.getSourceTargetType(t,a,r,s);return e.getSourceTargetByIndex(i,r.regnum)};e.mov=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=o[u[s.swizzle>>0&3]]}if(r.mask&2){n.y=o[u[s.swizzle>>2&3]]}if(r.mask&4){n.z=o[u[s.swizzle>>4&3]]}if(r.mask&8){n.w=o[u[s.swizzle>>6&3]]}};e.m44=function(t,a,r,s,l,n){var o=e.getDestTarget(t,a,r);var u=e.getSourceTarget(t,a,s,n);var f=e.getSourceTargetType(t,a,l,n);var g=e.getSourceTargetByIndex(f,l.regnum);var c=e.getSourceTargetByIndex(f,l.regnum+1);var d=e.getSourceTargetByIndex(f,l.regnum+2);var h=e.getSourceTargetByIndex(f,l.regnum+3);var b=new i.default(new Float32Array([g.x,c.x,d.x,h.x,g.y,c.y,d.y,h.y,g.z,c.z,d.z,h.z,g.w,c.w,d.w,h.w]));var _=b.transformVector(u);if(r.mask&1){o.x=_.x}if(r.mask&2){o.y=_.y}if(r.mask&4){o.z=_.z}if(r.mask&8){o.w=_.w}};e.sample=function(t,a,r,s,i,l,n,o,c){if(i>=a._textures.length||a._textures[i]==null){return[1,r,s,0]}var d=a._textures[i];var h=a._samplerStates[i];if(!h){h=this._defaultSamplerState}var b=h.wrap==g.default.REPEAT;var _=h.mipfilter==f.default.MIPLINEAR;if(_&&d.getMipLevelsCount()>1){l=Math.abs(l);n=Math.abs(n);o=Math.abs(o);c=Math.abs(c);var p=Math.log(Math.max(d.width*Math.sqrt(l*l+n*n),d.height*Math.sqrt(o*o+c*c)))/Math.LN2;if(p>0){var y=Math.floor(p);var w=Math.ceil(p);var m=Math.log(Math.min(d.width,d.height))/Math.LN2;if(w>m){w=m}if(y>m){y=m}var v=p-Math.floor(p);var x=[];var j=[];var S=d.getData(y);var T=d.width/Math.pow(2,y);var C=d.height/Math.pow(2,y);var A=d.getData(w);var E=d.width/Math.pow(2,w);var B=d.height/Math.pow(2,w);if(h.filter==u.default.LINEAR){x=e.sampleBilinear(r,s,S,T,C,b);j=e.sampleBilinear(r,s,A,E,B,b)}else{x=e.sampleNearest(r,s,S,T,C,b);j=e.sampleNearest(r,s,A,E,B,b)}return e.interpolateColor(x,j,v)}}var z;var M=d.getData(0);if(h.filter==u.default.LINEAR){z=e.sampleBilinear(r,s,M,d.width,d.height,b)}else{z=e.sampleNearest(r,s,M,d.width,d.height,b)}return z};e.sampleNearest=function(e,t,a,r,s,i){e*=r;t*=s;if(i){e=Math.abs(e%r);t=Math.abs(t%s)}else{if(e<0){e=0}else if(e>r-1){e=r-1}if(t<0){t=0}else if(t>s-1){t=s-1}}e=Math.floor(e);t=Math.floor(t);var l=(e+t*r)*4;var n=a[l]/255;var o=a[l+1]/255;var u=a[l+2]/255;var f=a[l+3]/255;return[f,n,o,u]};e.sampleBilinear=function(t,a,r,s,i,l){var n=1/s;var o=1/i;t-=n/2;a-=o/2;var u=e.sampleNearest(t,a,r,s,i,l);var f=e.sampleNearest(t+n,a,r,s,i,l);var g=e.sampleNearest(t,a+o,r,s,i,l);var c=e.sampleNearest(t+n,a+o,r,s,i,l);var d=t*s;d=d-Math.floor(d);var h=e.interpolateColor(u,f,d);var b=e.interpolateColor(g,c,d);var _=a*i;_=_-Math.floor(_);return e.interpolateColor(h,b,_)};e.interpolateColor=function(e,t,a){var r=[];r[0]=e[0]+(t[0]-e[0])*a;r[1]=e[1]+(t[1]-e[1])*a;r[2]=e[2]+(t[2]-e[2])*a;r[3]=e[3]+(t[3]-e[3])*a;return r};e.tex=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];var f=o[u[s.swizzle>>0&3]];var g=o[u[s.swizzle>>2&3]];var c=t.derivativeX[s.regnum][u[s.swizzle>>0&3]];var d=t.derivativeX[s.regnum][u[s.swizzle>>2&3]];var h=t.derivativeY[s.regnum][u[s.swizzle>>0&3]];var b=t.derivativeY[s.regnum][u[s.swizzle>>2&3]];var _=e.sample(t,l,f,g,i.regnum,c,d,h,b);if(r.mask&1){n.x=_[1]}if(r.mask&2){n.y=_[2]}if(r.mask&4){n.z=_[3]}if(r.mask&8){n.w=_[0]}};e.add=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=e.getSourceTarget(t,a,i,l);var f=["x","y","z","w"];if(r.mask&1){n.x=o[f[s.swizzle>>0&3]]+u[f[i.swizzle>>0&3]]}if(r.mask&2){n.y=o[f[s.swizzle>>2&3]]+u[f[i.swizzle>>2&3]]}if(r.mask&4){n.z=o[f[s.swizzle>>4&3]]+u[f[i.swizzle>>4&3]]}if(r.mask&8){n.w=o[f[s.swizzle>>6&3]]+u[f[i.swizzle>>6&3]]}};e.sub=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=e.getSourceTarget(t,a,i,l);var f=["x","y","z","w"];if(r.mask&1){n.x=o[f[s.swizzle>>0&3]]-u[f[i.swizzle>>0&3]]}if(r.mask&2){n.y=o[f[s.swizzle>>2&3]]-u[f[i.swizzle>>2&3]]}if(r.mask&4){n.z=o[f[s.swizzle>>4&3]]-u[f[i.swizzle>>4&3]]}if(r.mask&8){n.w=o[f[s.swizzle>>6&3]]-u[f[i.swizzle>>6&3]]}};e.mul=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=e.getSourceTarget(t,a,i,l);var f=["x","y","z","w"];if(r.mask&1){n.x=o[f[s.swizzle>>0&3]]*u[f[i.swizzle>>0&3]]}if(r.mask&2){n.y=o[f[s.swizzle>>2&3]]*u[f[i.swizzle>>2&3]]}if(r.mask&4){n.z=o[f[s.swizzle>>4&3]]*u[f[i.swizzle>>4&3]]}if(r.mask&8){n.w=o[f[s.swizzle>>6&3]]*u[f[i.swizzle>>6&3]]}};e.div=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=e.getSourceTarget(t,a,i,l);var f=["x","y","z","w"];if(r.mask&1){n.x=o[f[s.swizzle>>0&3]]/u[f[i.swizzle>>0&3]]}if(r.mask&2){n.y=o[f[s.swizzle>>2&3]]/u[f[i.swizzle>>2&3]]}if(r.mask&4){n.z=o[f[s.swizzle>>4&3]]/u[f[i.swizzle>>4&3]]}if(r.mask&8){n.w=o[f[s.swizzle>>6&3]]/u[f[i.swizzle>>6&3]]}};e.rcp=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=1/o[u[s.swizzle>>0&3]]}if(r.mask&2){n.y=1/o[u[s.swizzle>>2&3]]}if(r.mask&4){n.z=1/o[u[s.swizzle>>4&3]]}if(r.mask&8){n.w=1/o[u[s.swizzle>>6&3]]}};e.min=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=e.getSourceTarget(t,a,i,l);var f=["x","y","z","w"];if(r.mask&1){n.x=Math.min(o[f[s.swizzle>>0&3]],u[f[i.swizzle>>0&3]])}if(r.mask&2){
n.y=Math.min(o[f[s.swizzle>>2&3]],u[f[i.swizzle>>2&3]])}if(r.mask&4){n.z=Math.min(o[f[s.swizzle>>4&3]],u[f[i.swizzle>>4&3]])}if(r.mask&8){n.w=Math.min(o[f[s.swizzle>>6&3]],u[f[i.swizzle>>6&3]])}};e.max=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=e.getSourceTarget(t,a,i,l);var f=["x","y","z","w"];if(r.mask&1){n.x=Math.max(o[f[s.swizzle>>0&3]],u[f[i.swizzle>>0&3]])}if(r.mask&2){n.y=Math.max(o[f[s.swizzle>>2&3]],u[f[i.swizzle>>2&3]])}if(r.mask&4){n.z=Math.max(o[f[s.swizzle>>4&3]],u[f[i.swizzle>>4&3]])}if(r.mask&8){n.w=Math.max(o[f[s.swizzle>>6&3]],u[f[i.swizzle>>6&3]])}};e.frc=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=o[u[s.swizzle>>0&3]]-Math.floor(o[u[s.swizzle>>0&3]])}if(r.mask&2){n.y=o[u[s.swizzle>>2&3]]-Math.floor(o[u[s.swizzle>>2&3]])}if(r.mask&4){n.z=o[u[s.swizzle>>4&3]]-Math.floor(o[u[s.swizzle>>4&3]])}if(r.mask&8){n.w=o[u[s.swizzle>>6&3]]-Math.floor(o[u[s.swizzle>>6&3]])}};e.sqt=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=Math.sqrt(o[u[s.swizzle>>0&3]])}if(r.mask&2){n.y=Math.sqrt(o[u[s.swizzle>>2&3]])}if(r.mask&4){n.z=Math.sqrt(o[u[s.swizzle>>4&3]])}if(r.mask&8){n.w=Math.sqrt(o[u[s.swizzle>>6&3]])}};e.rsq=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=1/Math.sqrt(o[u[s.swizzle>>0&3]])}if(r.mask&2){n.y=1/Math.sqrt(o[u[s.swizzle>>2&3]])}if(r.mask&4){n.z=1/Math.sqrt(o[u[s.swizzle>>4&3]])}if(r.mask&8){n.w=1/Math.sqrt(o[u[s.swizzle>>6&3]])}};e.pow=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=e.getSourceTarget(t,a,i,l);var f=["x","y","z","w"];if(r.mask&1){n.x=Math.pow(o[f[s.swizzle>>0&3]],u[f[i.swizzle>>0&3]])}if(r.mask&2){n.y=Math.pow(o[f[s.swizzle>>2&3]],u[f[i.swizzle>>2&3]])}if(r.mask&4){n.z=Math.pow(o[f[s.swizzle>>4&3]],u[f[i.swizzle>>4&3]])}if(r.mask&8){n.w=Math.pow(o[f[s.swizzle>>6&3]],u[f[i.swizzle>>6&3]])}};e.log=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=Math.log(o[u[s.swizzle>>0&3]])/Math.LN2}if(r.mask&2){n.y=Math.log(o[u[s.swizzle>>2&3]])/Math.LN2}if(r.mask&4){n.z=Math.log(o[u[s.swizzle>>4&3]])/Math.LN2}if(r.mask&8){n.w=Math.log(o[u[s.swizzle>>6&3]])/Math.LN2}};e.exp=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=Math.exp(o[u[s.swizzle>>0&3]])}if(r.mask&2){n.y=Math.exp(o[u[s.swizzle>>2&3]])}if(r.mask&4){n.z=Math.exp(o[u[s.swizzle>>4&3]])}if(r.mask&8){n.w=Math.exp(o[u[s.swizzle>>6&3]])}};e.nrm=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];var f=o[u[s.swizzle>>0&3]];var g=o[u[s.swizzle>>2&3]];var c=o[u[s.swizzle>>4&3]];var d=Math.sqrt(f*f+g*g+c*c);f/=d;g/=d;c/=d;if(r.mask&1){n.x=f}if(r.mask&2){n.y=g}if(r.mask&4){n.z=c}};e.sin=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=Math.sin(o[u[s.swizzle>>0&3]])}if(r.mask&2){n.y=Math.sin(o[u[s.swizzle>>2&3]])}if(r.mask&4){n.z=Math.sin(o[u[s.swizzle>>4&3]])}if(r.mask&8){n.w=Math.sin(o[u[s.swizzle>>6&3]])}};e.cos=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=Math.cos(o[u[s.swizzle>>0&3]])}if(r.mask&2){n.y=Math.cos(o[u[s.swizzle>>2&3]])}if(r.mask&4){n.z=Math.cos(o[u[s.swizzle>>4&3]])}if(r.mask&8){n.w=Math.cos(o[u[s.swizzle>>6&3]])}};e.crs=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=e.getSourceTarget(t,a,i,l);var h=d[o[i.swizzle>>0&3]];var b=d[o[i.swizzle>>2&3]];var _=d[o[i.swizzle>>4&3]];if(r.mask&1){n.x=g*_-c*b}if(r.mask&2){n.y=c*h-f*_}if(r.mask&4){n.z=f*b-g*h}};e.dp3=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=e.getSourceTarget(t,a,i,l);var h=d[o[i.swizzle>>0&3]];var b=d[o[i.swizzle>>2&3]];var _=d[o[i.swizzle>>4&3]];if(r.mask&1){n.x=f*h+g*b+c*_}if(r.mask&2){n.y=f*h+g*b+c*_}if(r.mask&4){n.z=f*h+g*b+c*_}if(r.mask&8){n.w=f*h+g*b+c*_}};e.dp4=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=u[o[s.swizzle>>6&3]];var h=e.getSourceTarget(t,a,i,l);var b=h[o[i.swizzle>>0&3]];var _=h[o[i.swizzle>>2&3]];var p=h[o[i.swizzle>>4&3]];var y=h[o[i.swizzle>>6&3]];if(r.mask&1){n.x=f*b+g*_+c*p+d*y}if(r.mask&2){n.y=f*b+g*_+c*p+d*y}if(r.mask&4){n.z=f*b+g*_+c*p+d*y}if(r.mask&8){n.w=f*b+g*_+c*p+d*y}};e.abs=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=Math.abs(o[u[s.swizzle>>0&3]])}if(r.mask&2){n.y=Math.abs(o[u[s.swizzle>>2&3]])}if(r.mask&4){n.z=Math.abs(o[u[s.swizzle>>4&3]])}if(r.mask&8){n.w=Math.abs(o[u[s.swizzle>>6&3]])}};e.neg=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=-o[u[s.swizzle>>0&3]]}if(r.mask&2){n.y=-o[u[s.swizzle>>2&3]]}if(r.mask&4){n.z=-o[u[s.swizzle>>4&3]]}if(r.mask&8){n.w=-o[u[s.swizzle>>6&3]]}};e.sat=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=e.getSourceTarget(t,a,s,l);var u=["x","y","z","w"];if(r.mask&1){n.x=Math.max(0,Math.min(1,o[u[s.swizzle>>0&3]]))}if(r.mask&2){n.y=Math.max(0,Math.min(1,o[u[s.swizzle>>2&3]]))}if(r.mask&4){n.z=Math.max(0,Math.min(1,o[u[s.swizzle>>4&3]]))}if(r.mask&8){n.w=Math.max(0,Math.min(1,o[u[s.swizzle>>6&3]]))}};e.m33=function(t,a,r,s,l,n){var o=e.getDestTarget(t,a,r);var u=e.getSourceTarget(t,a,s,n);var f=e.getSourceTargetType(t,a,l,n);var g=e.getSourceTargetByIndex(f,l.regnum);var c=e.getSourceTargetByIndex(f,l.regnum+1);var d=e.getSourceTargetByIndex(f,l.regnum+2);var h=new i.default(new Float32Array([g.x,c.x,d.x,0,g.y,c.y,d.y,0,g.z,c.z,d.z,0,0,0,0,0]));var b=h.transformVector(u);if(r.mask&1){o.x=b.x}if(r.mask&2){o.y=b.y}if(r.mask&4){o.z=b.z}};e.m34=function(t,a,r,s,l,n){var o=e.getDestTarget(t,a,r);var u=e.getSourceTarget(t,a,s,n);var f=e.getSourceTargetType(t,a,l,n);var g=e.getSourceTargetByIndex(f,l.regnum);var c=e.getSourceTargetByIndex(f,l.regnum+1);var d=e.getSourceTargetByIndex(f,l.regnum+2);var h=new i.default(new Float32Array([g.x,c.x,d.x,0,g.y,c.y,d.y,0,g.z,c.z,d.z,0,g.w,c.w,d.w,1]));var b=h.transformVector(u);if(r.mask&1){o.x=b.x}if(r.mask&2){o.y=b.y}if(r.mask&4){o.z=b.z}if(r.mask&8){o.w=b.w}};e.ddx=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=t.derivativeX[s.regnum];var u=["x","y","z","w"];if(r.mask&1){n.x=o[u[s.swizzle>>0&3]]}if(r.mask&2){n.y=o[u[s.swizzle>>2&3]]}if(r.mask&4){n.z=o[u[s.swizzle>>4&3]]}if(r.mask&8){n.w=o[u[s.swizzle>>6&3]]}};e.ddy=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=t.derivativeY[s.regnum];var u=["x","y","z","w"];if(r.mask&1){n.x=o[u[s.swizzle>>0&3]]}if(r.mask&2){n.y=o[u[s.swizzle>>2&3]]}if(r.mask&4){n.z=o[u[s.swizzle>>4&3]]}if(r.mask&8){n.w=o[u[s.swizzle>>6&3]]}};e.sge=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=u[o[s.swizzle>>6&3]];var h=e.getSourceTarget(t,a,i,l);var b=h[o[i.swizzle>>0&3]];var _=h[o[i.swizzle>>2&3]];var p=h[o[i.swizzle>>4&3]];var y=h[o[i.swizzle>>6&3]];if(r.mask&1){n.x=f>=b?1:0}if(r.mask&2){n.y=g>=_?1:0}if(r.mask&4){n.z=c>=p?1:0}if(r.mask&8){n.w=d>=y?1:0}};e.slt=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=u[o[s.swizzle>>6&3]];var h=e.getSourceTarget(t,a,i,l);var b=h[o[i.swizzle>>0&3]];var _=h[o[i.swizzle>>2&3]];var p=h[o[i.swizzle>>4&3]];var y=h[o[i.swizzle>>6&3]];if(r.mask&1){n.x=f<b?1:0}if(r.mask&2){n.y=g<_?1:0}if(r.mask&4){n.z=c<p?1:0}if(r.mask&8){n.w=d<y?1:0}};e.seq=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=u[o[s.swizzle>>6&3]];var h=e.getSourceTarget(t,a,i,l);var b=h[o[i.swizzle>>0&3]];var _=h[o[i.swizzle>>2&3]];var p=h[o[i.swizzle>>4&3]];var y=h[o[i.swizzle>>6&3]];if(r.mask&1){n.x=f==b?1:0}if(r.mask&2){n.y=g==_?1:0}if(r.mask&4){n.z=c==p?1:0}if(r.mask&8){n.w=d==y?1:0}};e.sne=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=u[o[s.swizzle>>6&3]];var h=e.getSourceTarget(t,a,i,l);var b=h[o[i.swizzle>>0&3]];var _=h[o[i.swizzle>>2&3]];var p=h[o[i.swizzle>>4&3]];var y=h[o[i.swizzle>>6&3]];if(r.mask&1){n.x=f!=b?1:0}if(r.mask&2){n.y=g!=_?1:0}if(r.mask&4){n.z=c!=p?1:0}if(r.mask&8){n.w=d!=y?1:0}};e.sgn=function(t,a,r,s,i,l){var n=e.getDestTarget(t,a,r);var o=["x","y","z","w"];var u=e.getSourceTarget(t,a,s,l);var f=u[o[s.swizzle>>0&3]];var g=u[o[s.swizzle>>2&3]];var c=u[o[s.swizzle>>4&3]];var d=u[o[s.swizzle>>6&3]];if(r.mask&1){n.x=1;if(f<0){n.x=-1}else if(f==0){n.x=0}}if(r.mask&2){n.y=1;if(g<0){n.y=-1}else if(g==0){n.y=0}}if(r.mask&4){n.z=1;if(c<0){n.z=-1}else if(c==0){n.z=0}}if(r.mask&8){n.w=1;if(d<0){n.w=-1}else if(d==0){n.w=0}}};e.kil=function(t,a,r,s,i,l){var n=["x","y","z","w"];var o=e.getSourceTarget(t,a,s,l);var u=o[n[s.swizzle>>0&3]];if(u<0){t.discard=true}};e._defaultSamplerState=new o.default;e._tokenizer=new r.default;e._opCodeFunc=[e.mov,e.add,e.sub,e.mul,e.div,e.rcp,e.min,e.max,e.frc,e.sqt,e.rsq,e.pow,e.log,e.exp,e.nrm,e.sin,e.cos,e.crs,e.dp3,e.dp4,e.abs,e.neg,e.sat,e.m33,e.m44,e.m34,null,null,null,null,null,null,null,null,null,null,null,null,null,e.kil,e.tex,e.sge,e.slt,e.sgn,e.seq,e.sne];return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=c},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-stagegl/lib/aglsl/AGALTokenizer":"awayjs-stagegl/lib/aglsl/AGALTokenizer","awayjs-stagegl/lib/base/ContextGLMipFilter":"awayjs-stagegl/lib/base/ContextGLMipFilter","awayjs-stagegl/lib/base/ContextGLTextureFilter":"awayjs-stagegl/lib/base/ContextGLTextureFilter","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat","awayjs-stagegl/lib/base/ContextGLWrapMode":"awayjs-stagegl/lib/base/ContextGLWrapMode","awayjs-stagegl/lib/base/ProgramVOSoftware":"awayjs-stagegl/lib/base/ProgramVOSoftware","awayjs-stagegl/lib/base/SoftwareSamplerState":"awayjs-stagegl/lib/base/SoftwareSamplerState"}],"awayjs-stagegl/lib/base/ProgramVOSoftware":[function(e,t,a){"use strict";var r=function(){function e(){this.outputPosition=[];this.outputColor=[];this.varying=[];this.derivativeX=[];this.derivativeY=[];this.temp=[];this.attributes=[];this.discard=false}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/ProgramWebGL":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/aglsl/AGALTokenizer");var s=e("awayjs-stagegl/lib/aglsl/AGLSLParser");var i=function(){function e(e){this._uniforms=[[],[],[]];this._attribs=[];this._gl=e;this._program=this._gl.createProgram()}e.prototype.upload=function(t,a){var r=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(t));var s=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(a));this._vertexShader=this._gl.createShader(this._gl.VERTEX_SHADER);this._fragmentShader=this._gl.createShader(this._gl.FRAGMENT_SHADER);this._gl.shaderSource(this._vertexShader,r);this._gl.compileShader(this._vertexShader);if(!this._gl.getShaderParameter(this._vertexShader,this._gl.COMPILE_STATUS))throw new Error(this._gl.getShaderInfoLog(this._vertexShader));this._gl.shaderSource(this._fragmentShader,s);this._gl.compileShader(this._fragmentShader);if(!this._gl.getShaderParameter(this._fragmentShader,this._gl.COMPILE_STATUS))throw new Error(this._gl.getShaderInfoLog(this._fragmentShader));this._gl.attachShader(this._program,this._vertexShader);this._gl.attachShader(this._program,this._fragmentShader);this._gl.linkProgram(this._program);if(!this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS))throw new Error(this._gl.getProgramInfoLog(this._program));this._uniforms[0].length=0;this._uniforms[1].length=0;this._uniforms[2].length=0;this._attribs.length=0};e.prototype.getUniformLocation=function(t,a){if(this._uniforms[t][a]!=null)return this._uniforms[t][a];return this._uniforms[t][a]=this._gl.getUniformLocation(this._program,e._uniformLocationNameDictionary[t]+a)};e.prototype.getAttribLocation=function(e){if(this._attribs[e]!=null)return this._attribs[e];return this._attribs[e]=this._gl.getAttribLocation(this._program,"va"+e)};e.prototype.dispose=function(){this._gl.deleteProgram(this._program)};e.prototype.focusProgram=function(){this._gl.useProgram(this._program)};Object.defineProperty(e.prototype,"glProgram",{get:function(){return this._program},enumerable:true,configurable:true});e._tokenizer=new r.default;e._aglslParser=new s.default;e._uniformLocationNameDictionary=["fc","fs","vc"];return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/aglsl/AGALTokenizer":"awayjs-stagegl/lib/aglsl/AGALTokenizer","awayjs-stagegl/lib/aglsl/AGLSLParser":"awayjs-stagegl/lib/aglsl/AGLSLParser"}],"awayjs-stagegl/lib/base/ResourceBaseFlash":[function(e,t,a){"use strict";var r=function(){function e(){}Object.defineProperty(e.prototype,"id",{get:function(){return this._pId},enumerable:true,configurable:true});e.prototype.dispose=function(){};return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/SamplerState":[function(e,t,a){"use strict";var r=function(){function e(){}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/SoftwareSamplerState":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/base/ContextGLTextureFilter");var s=e("awayjs-stagegl/lib/base/ContextGLMipFilter");var i=e("awayjs-stagegl/lib/base/ContextGLWrapMode");var l=function(){function e(){this.wrap=i.default.REPEAT;this.filter=r.default.LINEAR;this.mipfilter=s.default.MIPLINEAR}return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-stagegl/lib/base/ContextGLMipFilter":"awayjs-stagegl/lib/base/ContextGLMipFilter","awayjs-stagegl/lib/base/ContextGLTextureFilter":"awayjs-stagegl/lib/base/ContextGLTextureFilter","awayjs-stagegl/lib/base/ContextGLWrapMode":"awayjs-stagegl/lib/base/ContextGLWrapMode"}],"awayjs-stagegl/lib/base/Stage":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/events/EventDispatcher");var i=e("awayjs-core/lib/geom/Rectangle");var l=e("awayjs-core/lib/utils/CSS");var n=e("awayjs-stagegl/lib/base/ContextMode");var o=e("awayjs-stagegl/lib/base/ContextGLMipFilter");var u=e("awayjs-stagegl/lib/base/ContextGLTextureFilter");var f=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");var g=e("awayjs-stagegl/lib/base/ContextGLWrapMode");var c=e("awayjs-stagegl/lib/base/ContextWebGL");var d=e("awayjs-stagegl/lib/base/ContextStage3D");var h=e("awayjs-stagegl/lib/base/ContextSoftware");var b=e("awayjs-stagegl/lib/events/StageEvent");var _=e("awayjs-stagegl/lib/image/ProgramDataPool");var p=function(e){r(t,e);function t(t,a,r,s,n){var o=this;if(s===void 0){s=false}if(n===void 0){n="baseline"}e.call(this);this._abstractionPool=new Object;this._programData=new Array;this._x=0;this._y=0;this._stageIndex=-1;this._antiAlias=0;this._renderTarget=null;this._renderSurfaceSelector=0;this._initialised=false;this._bufferFormatDictionary=new Array(5);this._programDataPool=new _.default(this);this._container=t;if(this._container){this._container.addEventListener("webglcontextlost",function(e){return o.onContextLost(e)});this._container.addEventListener("webglcontextrestored",function(e){return o.onContextRestored(e)})}this._stageIndex=a;this._stageManager=r;this._viewPort=new i.default;this._enableDepthAndStencil=true;l.default.setElementX(this._container,0);l.default.setElementY(this._container,0);this._bufferFormatDictionary[1]=new Array(5);this._bufferFormatDictionary[1][1]=f.default.BYTE_1;this._bufferFormatDictionary[1][2]=f.default.BYTE_2;this._bufferFormatDictionary[1][3]=f.default.BYTE_3;this._bufferFormatDictionary[1][4]=f.default.BYTE_4;this._bufferFormatDictionary[2]=new Array(5);this._bufferFormatDictionary[2][1]=f.default.SHORT_1;this._bufferFormatDictionary[2][2]=f.default.SHORT_2;this._bufferFormatDictionary[2][3]=f.default.SHORT_3;this._bufferFormatDictionary[2][4]=f.default.SHORT_4;this._bufferFormatDictionary[4]=new Array(5);this._bufferFormatDictionary[4][1]=f.default.FLOAT_1;this._bufferFormatDictionary[4][2]=f.default.FLOAT_2;this._bufferFormatDictionary[4][3]=f.default.FLOAT_3;this._bufferFormatDictionary[4][4]=f.default.FLOAT_4;this._bufferFormatDictionary[5]=new Array(5);this._bufferFormatDictionary[5][1]=f.default.UNSIGNED_BYTE_1;this._bufferFormatDictionary[5][2]=f.default.UNSIGNED_BYTE_2;this._bufferFormatDictionary[5][3]=f.default.UNSIGNED_BYTE_3;this._bufferFormatDictionary[5][4]=f.default.UNSIGNED_BYTE_4;this._bufferFormatDictionary[6]=new Array(5);this._bufferFormatDictionary[6][1]=f.default.UNSIGNED_SHORT_1;this._bufferFormatDictionary[6][2]=f.default.UNSIGNED_SHORT_2;this._bufferFormatDictionary[6][3]=f.default.UNSIGNED_SHORT_3;this._bufferFormatDictionary[6][4]=f.default.UNSIGNED_SHORT_4;this.visible=true}t.prototype.getProgramData=function(e,t){return this._programDataPool.getItem(e,t)};t.prototype.setRenderTarget=function(e,t,a){if(t===void 0){t=false}if(a===void 0){a=0}if(this._renderTarget===e&&a==this._renderSurfaceSelector&&this._enableDepthAndStencil==t)return;this._renderTarget=e;this._renderSurfaceSelector=a;this._enableDepthAndStencil=t;if(e){this._context.setRenderToTexture(this.getAbstraction(e).texture,t,this._antiAlias,a)}else{this._context.setRenderToBackBuffer();this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil)}};t.prototype.getAbstraction=function(e){return this._abstractionPool[e.id]||(this._abstractionPool[e.id]=new t._abstractionClassPool[e.assetType](e,this))};t.prototype.clearAbstraction=function(e){this._abstractionPool[e.id]=null};t.registerAbstraction=function(e,a){t._abstractionClassPool[a.assetType]=e};t.prototype.requestContext=function(e,t,a){var r=this;if(e===void 0){e=false}if(t===void 0){t="baseline"}if(a===void 0){a="auto"}if(this._usesSoftwareRendering!=null)this._usesSoftwareRendering=e;this._profile=t;try{if(a==n.default.FLASH)new d.default(this._container,function(e){return r._callback(e)});else if(a==n.default.SOFTWARE)this._context=new h.default(this._container);else this._context=new c.default(this._container)}catch(s){try{if(a==n.default.AUTO)new d.default(this._container,function(e){return r._callback(e)});else this.dispatchEvent(new b.default(b.default.STAGE_ERROR,this))}catch(s){this.dispatchEvent(new b.default(b.default.STAGE_ERROR,this))}}if(this._context)this._callback(this._context)};Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){if(this._width==e)return;l.default.setElementWidth(this._container,e);this._width=this._viewPort.width=e;this._backBufferDirty=true;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){if(this._height==e)return;l.default.setElementHeight(this._container,e);this._height=this._viewPort.height=e;this._backBufferDirty=true;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){if(this._x==e)return;l.default.setElementX(this._container,e);this._x=this._viewPort.x=e;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){if(this._y==e)return;l.default.setElementY(this._container,e);this._y=this._viewPort.y=e;this.notifyViewportUpdated()},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"visible",{get:function(){return l.default.getElementVisibility(this._container)},set:function(e){l.default.setElementVisibility(this._container,e)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:true,configurable:true});t.prototype.notifyViewportUpdated=function(){if(this._viewportDirty)return;this._viewportDirty=true;this.dispatchEvent(new b.default(b.default.VIEWPORT_UPDATED,this))};Object.defineProperty(t.prototype,"profile",{get:function(){return this._profile},enumerable:true,configurable:true});t.prototype.dispose=function(){for(var e in this._abstractionPool)this._abstractionPool[e].clear();this._abstractionPool=null;this._stageManager.iRemoveStage(this);this.freeContext();this._stageManager=null;this._stageIndex=-1};t.prototype.configureBackBuffer=function(e,t,a,r){this.width=e;this.height=t;this._antiAlias=a;this._enableDepthAndStencil=r;if(this._context)this._context.configureBackBuffer(e,t,a,r)};Object.defineProperty(t.prototype,"enableDepthAndStencil",{get:function(){return this._enableDepthAndStencil},set:function(e){this._enableDepthAndStencil=e;this._backBufferDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderTarget",{get:function(){return this._renderTarget},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"renderSurfaceSelector",{get:function(){return this._renderSurfaceSelector},enumerable:true,configurable:true});t.prototype.clear=function(){if(!this._context)return;if(this._backBufferDirty){this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil);this._backBufferDirty=false}this._context.clear((this._color&4278190080)>>>24,(this._color&16711680)>>>16,(this._color&65280)>>>8,this._color&255);this._bufferClear=true};Object.defineProperty(t.prototype,"scissorRect",{get:function(){return this._scissorRect},set:function(e){this._scissorRect=e;this._context.setScissorRectangle(this._scissorRect)},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"stageIndex",{get:function(){return this._stageIndex},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"usesSoftwareRendering",{get:function(){return this._usesSoftwareRendering},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"antiAlias",{get:function(){return this._antiAlias},set:function(e){this._antiAlias=e;this._backBufferDirty=true},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"viewPort",{get:function(){this._viewportDirty=false;return this._viewPort},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"bufferClear",{get:function(){return this._bufferClear},set:function(e){this._bufferClear=e},enumerable:true,configurable:true});t.prototype.registerProgram=function(e){var t=0;while(this._programData[t]!=null)t++;this._programData[t]=e;e.id=t};t.prototype.unRegisterProgram=function(e){this._programData[e.id]=null;e.id=-1};t.prototype.freeContext=function(){if(this._context){this._context.dispose();this.dispatchEvent(new b.default(b.default.CONTEXT_DISPOSED,this))}this._context=null;this._initialised=false};t.prototype.onContextLost=function(e){};t.prototype.onContextRestored=function(e){};t.prototype.recoverFromDisposal=function(){if(!this._context)return false;return true};t.prototype._callback=function(e){this._context=e;this._container=this._context.container;if(this._width&&this._height)this._context.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil);this.dispatchEvent(new b.default(this._initialised?b.default.CONTEXT_RECREATED:b.default.CONTEXT_CREATED,this));this._initialised=true};t.prototype.setVertexBuffer=function(e,t,a,r,s,i){if(i===void 0){i=false}this._context.setVertexBufferAt(e,t,s,this._bufferFormatDictionary[i?a+4:a][r])};t.prototype.setSamplerState=function(e,t,a,r){var s=t?g.default.REPEAT:g.default.CLAMP;var i=a?u.default.LINEAR:u.default.NEAREST;var l=r?o.default.MIPLINEAR:o.default.MIPNONE;this._context.setSamplerStateAt(e,s,i,l)};t._abstractionClassPool=new Object;return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=p},{"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-core/lib/geom/Rectangle":undefined,"awayjs-core/lib/utils/CSS":undefined,"awayjs-stagegl/lib/base/ContextGLMipFilter":"awayjs-stagegl/lib/base/ContextGLMipFilter","awayjs-stagegl/lib/base/ContextGLTextureFilter":"awayjs-stagegl/lib/base/ContextGLTextureFilter","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat","awayjs-stagegl/lib/base/ContextGLWrapMode":"awayjs-stagegl/lib/base/ContextGLWrapMode","awayjs-stagegl/lib/base/ContextMode":"awayjs-stagegl/lib/base/ContextMode","awayjs-stagegl/lib/base/ContextSoftware":"awayjs-stagegl/lib/base/ContextSoftware","awayjs-stagegl/lib/base/ContextStage3D":"awayjs-stagegl/lib/base/ContextStage3D","awayjs-stagegl/lib/base/ContextWebGL":"awayjs-stagegl/lib/base/ContextWebGL","awayjs-stagegl/lib/events/StageEvent":"awayjs-stagegl/lib/events/StageEvent","awayjs-stagegl/lib/image/ProgramDataPool":"awayjs-stagegl/lib/image/ProgramDataPool"}],"awayjs-stagegl/lib/base/TextureBaseWebGL":[function(e,t,a){"use strict";var r=e("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function e(e){this.textureType="";this._gl=e}e.prototype.dispose=function(){throw"Abstract method must be overridden."};Object.defineProperty(e.prototype,"glTexture",{get:function(){throw new r.default},enumerable:true,configurable:true});return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-stagegl/lib/base/TextureFlash":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/utils/ByteArrayBase");var i=e("awayjs-stagegl/lib/base/OpCodes");var l=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var n=function(e){r(t,e);function t(t,a,r,s,l,n){if(n===void 0){n=false}e.call(this);this._context=t;this._width=a;this._height=r;this._context.addStream(String.fromCharCode(i.default.initTexture,l?i.default.trueValue:i.default.falseValue)+a+","+r+","+n+","+s+"$");this._pId=this._context.execute();this._context._iAddResource(this)}Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(i.default.disposeTexture)+this._pId.toString()+",");this._context.execute();this._context._iRemoveResource(this);this._context=null};t.prototype.uploadFromData=function(e,t){if(t===void 0){t=0}if(e instanceof HTMLImageElement){var a=document.createElement("canvas");var r=e.width;var l=e.height;a.width=r;a.height=l;var n=a.getContext("2d");n.drawImage(e,0,0);e=n.getImageData(0,0,r,l).data}var o=0;var u=s.default.internalGetBase64String(e.length,function(){return e[o++]},null);this._context.addStream(String.fromCharCode(i.default.uploadBytesTexture)+this._pId+","+t+","+(this._width>>t)+","+(this._height>>t)+","+u+"%");this._context.execute()};return t}(l.default);Object.defineProperty(a,"__esModule",{value:true});a.default=n},{"awayjs-core/lib/utils/ByteArrayBase":undefined,"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/TextureSoftware":[function(e,t,a){"use strict";var r=function(){function e(e,t){this.textureType="texture2d";this._mipLevels=[];this._width=e;this._height=t}e.prototype.dispose=function(){this._mipLevels=null};Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});e.prototype.uploadFromData=function(e,t){if(t===void 0){t=0}console.log("uploadFromData: "+e+" miplevel: "+t);this._mipLevels[t]=e.data};e.prototype.getData=function(e){return this._mipLevels[e]};e.prototype.getMipLevelsCount=function(){return this._mipLevels.length};return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/TextureWebGL":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/base/TextureBaseWebGL");var i=function(e){r(t,e);function t(t,a,r){e.call(this,t);this.textureType="texture2d";this._width=a;this._height=r;this._glTexture=this._gl.createTexture()}t.prototype.dispose=function(){this._gl.deleteTexture(this._glTexture)};Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"frameBuffer",{get:function(){if(!this._frameBuffer){this._frameBuffer=this._gl.createFramebuffer();this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._frameBuffer);this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture);this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null);var e=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,e);this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_STENCIL,this._width,this._height);this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._glTexture,0);this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_STENCIL_ATTACHMENT,this._gl.RENDERBUFFER,e);this._gl.bindTexture(this._gl.TEXTURE_2D,null);this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null);this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return this._frameBuffer},enumerable:true,configurable:true});t.prototype.uploadFromData=function(e,t){if(t===void 0){t=0}this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture);this._gl.texImage2D(this._gl.TEXTURE_2D,t,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e);this._gl.bindTexture(this._gl.TEXTURE_2D,null)};t.prototype.uploadCompressedTextureFromByteArray=function(e,t,a){if(a===void 0){a=false}var r=this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc")};Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._glTexture},enumerable:true,configurable:true});t.prototype.generateMipmaps=function(){};return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/base/TextureBaseWebGL":"awayjs-stagegl/lib/base/TextureBaseWebGL"
}],"awayjs-stagegl/lib/base/VertexBufferFlash":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/base/OpCodes");var i=e("awayjs-stagegl/lib/base/ResourceBaseFlash");var l=function(e){r(t,e);function t(t,a,r){e.call(this);this._context=t;this._numVertices=a;this._dataPerVertex=r;this._context.addStream(String.fromCharCode(s.default.initVertexBuffer,r+s.default.intMask)+a.toString()+",");this._pId=this._context.execute();this._context._iAddResource(this)}t.prototype.uploadFromArray=function(e,t,a){this._context.addStream(String.fromCharCode(s.default.uploadArrayVertexBuffer,this._pId+s.default.intMask)+e.join()+"#"+[t,a].join()+",");this._context.execute()};t.prototype.uploadFromByteArray=function(e,t,a){};Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:true,configurable:true});t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(s.default.disposeVertexBuffer,this._pId+s.default.intMask));this._context.execute();this._context._iRemoveResource(this);this._context=null};return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash"}],"awayjs-stagegl/lib/base/VertexBufferSoftware":[function(e,t,a){"use strict";var r=function(){function e(e,t){this._numVertices=e;this._dataPerVertex=t}e.prototype.uploadFromArray=function(e,t,a){console.log("VertexBufferSoftware.uploadFromArray");this._floatData=new Float32Array(e)};e.prototype.uploadFromByteArray=function(e,t,a){console.log("VertexBufferSoftware.uploadFromByteArray");this._floatData=new Float32Array(e,t*this._dataPerVertex,a*this._dataPerVertex/4);this._uintData=new Uint8Array(e)};Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"attributesPerVertex",{get:function(){return this._dataPerVertex/4},enumerable:true,configurable:true});e.prototype.dispose=function(){this._floatData=null};Object.defineProperty(e.prototype,"data",{get:function(){return this._floatData},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"uintData",{get:function(){return this._uintData},enumerable:true,configurable:true});return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base/VertexBufferWebGL":[function(e,t,a){"use strict";var r=function(){function e(e,t,a){this._gl=e;this._buffer=this._gl.createBuffer();this._numVertices=t;this._dataPerVertex=a}e.prototype.uploadFromArray=function(e,t,a){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ARRAY_BUFFER,t*this._dataPerVertex,new Float32Array(e));else this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW)};e.prototype.uploadFromByteArray=function(e,t,a){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer);if(t)this._gl.bufferSubData(this._gl.ARRAY_BUFFER,t*this._dataPerVertex,e);else this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.STATIC_DRAW)};Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"dataPerVertex",{get:function(){return this._dataPerVertex},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:true,configurable:true});e.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)};return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/base":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/base/ContextGLBlendFactor");a.ContextGLBlendFactor=r.default;var s=e("awayjs-stagegl/lib/base/ContextGLClearMask");a.ContextGLClearMask=s.default;var i=e("awayjs-stagegl/lib/base/ContextGLCompareMode");a.ContextGLCompareMode=i.default;var l=e("awayjs-stagegl/lib/base/ContextGLDrawMode");a.ContextGLDrawMode=l.default;var n=e("awayjs-stagegl/lib/base/ContextGLMipFilter");a.ContextGLMipFilter=n.default;var o=e("awayjs-stagegl/lib/base/ContextGLProfile");a.ContextGLProfile=o.default;var u=e("awayjs-stagegl/lib/base/ContextGLProgramType");a.ContextGLProgramType=u.default;var f=e("awayjs-stagegl/lib/base/ContextGLStencilAction");a.ContextGLStencilAction=f.default;var g=e("awayjs-stagegl/lib/base/ContextGLTextureFilter");a.ContextGLTextureFilter=g.default;var c=e("awayjs-stagegl/lib/base/ContextGLTextureFormat");a.ContextGLTextureFormat=c.default;var d=e("awayjs-stagegl/lib/base/ContextGLTriangleFace");a.ContextGLTriangleFace=d.default;var h=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat");a.ContextGLVertexBufferFormat=h.default;var b=e("awayjs-stagegl/lib/base/ContextGLWrapMode");a.ContextGLWrapMode=b.default;var _=e("awayjs-stagegl/lib/base/ContextMode");a.ContextMode=_.default;var p=e("awayjs-stagegl/lib/base/ContextSoftware");a.ContextSoftware=p.default;var y=e("awayjs-stagegl/lib/base/ContextStage3D");a.ContextStage3D=y.default;var w=e("awayjs-stagegl/lib/base/ContextWebGL");a.ContextWebGL=w.default;var m=e("awayjs-stagegl/lib/base/CubeTextureFlash");a.CubeTextureFlash=m.default;var v=e("awayjs-stagegl/lib/base/CubeTextureWebGL");a.CubeTextureWebGL=v.default;var x=e("awayjs-stagegl/lib/base/IndexBufferFlash");a.IndexBufferFlash=x.default;var j=e("awayjs-stagegl/lib/base/IndexBufferSoftware");a.IndexBufferSoftware=j.default;var S=e("awayjs-stagegl/lib/base/IndexBufferWebGL");a.IndexBufferWebGL=S.default;var T=e("awayjs-stagegl/lib/base/OpCodes");a.OpCodes=T.default;var C=e("awayjs-stagegl/lib/base/ProgramFlash");a.ProgramFlash=C.default;var A=e("awayjs-stagegl/lib/base/ProgramSoftware");a.ProgramSoftware=A.default;var E=e("awayjs-stagegl/lib/base/ProgramVOSoftware");a.ProgramVOSoftware=E.default;var B=e("awayjs-stagegl/lib/base/ProgramWebGL");a.ProgramWebGL=B.default;var z=e("awayjs-stagegl/lib/base/ResourceBaseFlash");a.ResourceBaseFlash=z.default;var M=e("awayjs-stagegl/lib/base/SamplerState");a.SamplerState=M.default;var L=e("awayjs-stagegl/lib/base/SoftwareSamplerState");a.SoftwareSamplerState=L.default;var D=e("awayjs-stagegl/lib/base/Stage");a.Stage=D.default;var O=e("awayjs-stagegl/lib/base/TextureBaseWebGL");a.TextureBaseWebGL=O.default;var R=e("awayjs-stagegl/lib/base/TextureFlash");a.TextureFlash=R.default;var P=e("awayjs-stagegl/lib/base/TextureSoftware");a.TextureSoftware=P.default;var G=e("awayjs-stagegl/lib/base/TextureWebGL");a.TextureWebGL=G.default;var F=e("awayjs-stagegl/lib/base/VertexBufferFlash");a.VertexBufferFlash=F.default;var I=e("awayjs-stagegl/lib/base/VertexBufferSoftware");a.VertexBufferSoftware=I.default;var k=e("awayjs-stagegl/lib/base/VertexBufferWebGL");a.VertexBufferWebGL=k.default},{"awayjs-stagegl/lib/base/ContextGLBlendFactor":"awayjs-stagegl/lib/base/ContextGLBlendFactor","awayjs-stagegl/lib/base/ContextGLClearMask":"awayjs-stagegl/lib/base/ContextGLClearMask","awayjs-stagegl/lib/base/ContextGLCompareMode":"awayjs-stagegl/lib/base/ContextGLCompareMode","awayjs-stagegl/lib/base/ContextGLDrawMode":"awayjs-stagegl/lib/base/ContextGLDrawMode","awayjs-stagegl/lib/base/ContextGLMipFilter":"awayjs-stagegl/lib/base/ContextGLMipFilter","awayjs-stagegl/lib/base/ContextGLProfile":"awayjs-stagegl/lib/base/ContextGLProfile","awayjs-stagegl/lib/base/ContextGLProgramType":"awayjs-stagegl/lib/base/ContextGLProgramType","awayjs-stagegl/lib/base/ContextGLStencilAction":"awayjs-stagegl/lib/base/ContextGLStencilAction","awayjs-stagegl/lib/base/ContextGLTextureFilter":"awayjs-stagegl/lib/base/ContextGLTextureFilter","awayjs-stagegl/lib/base/ContextGLTextureFormat":"awayjs-stagegl/lib/base/ContextGLTextureFormat","awayjs-stagegl/lib/base/ContextGLTriangleFace":"awayjs-stagegl/lib/base/ContextGLTriangleFace","awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat","awayjs-stagegl/lib/base/ContextGLWrapMode":"awayjs-stagegl/lib/base/ContextGLWrapMode","awayjs-stagegl/lib/base/ContextMode":"awayjs-stagegl/lib/base/ContextMode","awayjs-stagegl/lib/base/ContextSoftware":"awayjs-stagegl/lib/base/ContextSoftware","awayjs-stagegl/lib/base/ContextStage3D":"awayjs-stagegl/lib/base/ContextStage3D","awayjs-stagegl/lib/base/ContextWebGL":"awayjs-stagegl/lib/base/ContextWebGL","awayjs-stagegl/lib/base/CubeTextureFlash":"awayjs-stagegl/lib/base/CubeTextureFlash","awayjs-stagegl/lib/base/CubeTextureWebGL":"awayjs-stagegl/lib/base/CubeTextureWebGL","awayjs-stagegl/lib/base/IndexBufferFlash":"awayjs-stagegl/lib/base/IndexBufferFlash","awayjs-stagegl/lib/base/IndexBufferSoftware":"awayjs-stagegl/lib/base/IndexBufferSoftware","awayjs-stagegl/lib/base/IndexBufferWebGL":"awayjs-stagegl/lib/base/IndexBufferWebGL","awayjs-stagegl/lib/base/OpCodes":"awayjs-stagegl/lib/base/OpCodes","awayjs-stagegl/lib/base/ProgramFlash":"awayjs-stagegl/lib/base/ProgramFlash","awayjs-stagegl/lib/base/ProgramSoftware":"awayjs-stagegl/lib/base/ProgramSoftware","awayjs-stagegl/lib/base/ProgramVOSoftware":"awayjs-stagegl/lib/base/ProgramVOSoftware","awayjs-stagegl/lib/base/ProgramWebGL":"awayjs-stagegl/lib/base/ProgramWebGL","awayjs-stagegl/lib/base/ResourceBaseFlash":"awayjs-stagegl/lib/base/ResourceBaseFlash","awayjs-stagegl/lib/base/SamplerState":"awayjs-stagegl/lib/base/SamplerState","awayjs-stagegl/lib/base/SoftwareSamplerState":"awayjs-stagegl/lib/base/SoftwareSamplerState","awayjs-stagegl/lib/base/Stage":"awayjs-stagegl/lib/base/Stage","awayjs-stagegl/lib/base/TextureBaseWebGL":"awayjs-stagegl/lib/base/TextureBaseWebGL","awayjs-stagegl/lib/base/TextureFlash":"awayjs-stagegl/lib/base/TextureFlash","awayjs-stagegl/lib/base/TextureSoftware":"awayjs-stagegl/lib/base/TextureSoftware","awayjs-stagegl/lib/base/TextureWebGL":"awayjs-stagegl/lib/base/TextureWebGL","awayjs-stagegl/lib/base/VertexBufferFlash":"awayjs-stagegl/lib/base/VertexBufferFlash","awayjs-stagegl/lib/base/VertexBufferSoftware":"awayjs-stagegl/lib/base/VertexBufferSoftware","awayjs-stagegl/lib/base/VertexBufferWebGL":"awayjs-stagegl/lib/base/VertexBufferWebGL"}],"awayjs-stagegl/lib/events/StageEvent":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/events/EventBase");var i=function(e){r(t,e);function t(t,a){e.call(this,t);this._stage=a}Object.defineProperty(t.prototype,"stage",{get:function(){return this._stage},enumerable:true,configurable:true});t.prototype.clone=function(){return new t(this.type,this._stage)};t.STAGE_ERROR="stageError";t.CONTEXT_CREATED="contextCreated";t.CONTEXT_DISPOSED="contextDisposed";t.CONTEXT_RECREATED="contextRecreated";t.VIEWPORT_UPDATED="viewportUpdated";return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-core/lib/events/EventBase":undefined}],"awayjs-stagegl/lib/events":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/events/StageEvent");a.StageEvent=r.default},{"awayjs-stagegl/lib/events/StageEvent":"awayjs-stagegl/lib/events/StageEvent"}],"awayjs-stagegl/lib/image/GL_BitmapImage2D":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/utils/MipmapGenerator");var i=e("awayjs-stagegl/lib/image/GL_Image2D");var l=function(e){r(t,e);function t(){e.apply(this,arguments)}t.prototype.activate=function(t,a){if(!this._texture){this._createTexture();this._invalid=true}if(!this._mipmap&&a){this._mipmap=true;this._invalid=true}if(this._invalid){this._invalid=false;if(a){var r=this._mipmapData||(this._mipmapData=new Array);s.default._generateMipMaps(this._asset.getCanvas(),r,true);var i=r.length;for(var l=0;l<i;l++)this._texture.uploadFromData(r[l].getImageData(),l)}else{this._texture.uploadFromData(this._asset.getImageData(),0)}}e.prototype.activate.call(this,t,a)};t.prototype.onClear=function(t){e.prototype.onClear.call(this,t);if(this._mipmapData){var a=this._mipmapData.length;for(var r=0;r<a;r++)s.default._freeMipMapHolder(this._mipmapData[r])}};return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-core/lib/utils/MipmapGenerator":undefined,"awayjs-stagegl/lib/image/GL_Image2D":"awayjs-stagegl/lib/image/GL_Image2D"}],"awayjs-stagegl/lib/image/GL_BitmapImageCube":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/utils/MipmapGenerator");var i=e("awayjs-stagegl/lib/image/GL_ImageCube");var l=function(e){r(t,e);function t(){e.apply(this,arguments);this._mipmapDataArray=new Array(6)}t.prototype.activate=function(t,a){if(!this._texture){this._createTexture();this._invalid=true}if(!this._mipmap&&a){this._mipmap=true;this._invalid=true}if(this._invalid){this._invalid=false;for(var r=0;r<6;++r){if(a){var i=this._mipmapDataArray[r]||(this._mipmapDataArray[r]=new Array);s.default._generateMipMaps(this._asset.getCanvas(r),i,true);var l=i.length;for(var n=0;n<l;n++)this._texture.uploadFromData(i[n].getImageData(),r,n)}else{this._texture.uploadFromData(this._asset.getImageData(r),r,0)}}}e.prototype.activate.call(this,t,a)};t.prototype.onClear=function(t){e.prototype.onClear.call(this,t);for(var a=0;a<6;a++){var r=this._mipmapDataArray[a];if(r){var i=r.length;for(var l=0;l<i;a++)s.default._freeMipMapHolder(r[l])}}};return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-core/lib/utils/MipmapGenerator":undefined,"awayjs-stagegl/lib/image/GL_ImageCube":"awayjs-stagegl/lib/image/GL_ImageCube"}],"awayjs-stagegl/lib/image/GL_Image2D":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/base/ContextGLTextureFormat");var i=e("awayjs-stagegl/lib/image/GL_ImageBase");var l=function(e){r(t,e);function t(){e.apply(this,arguments)}t.prototype._createTexture=function(){this._texture=this._stage.context.createTexture(this._asset.width,this._asset.height,s.default.BGRA,true)};return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-stagegl/lib/base/ContextGLTextureFormat":"awayjs-stagegl/lib/base/ContextGLTextureFormat","awayjs-stagegl/lib/image/GL_ImageBase":"awayjs-stagegl/lib/image/GL_ImageBase"}],"awayjs-stagegl/lib/image/GL_ImageBase":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/errors/AbstractMethodError");var i=e("awayjs-core/lib/library/AbstractionBase");var l=function(e){r(t,e);function t(t,a){e.call(this,t,a);this.usages=0;this._stage=a}Object.defineProperty(t.prototype,"texture",{get:function(){if(!this._texture){this._createTexture();this._invalid=true}return this._texture},enumerable:true,configurable:true});t.prototype.onClear=function(t){e.prototype.onClear.call(this,t);if(this._texture){this._texture.dispose();this._texture=null}};t.prototype.activate=function(e,t){this._stage.context.setTextureAt(e,this._texture)};t.prototype._createTexture=function(){throw new s.default};return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AbstractionBase":undefined}],"awayjs-stagegl/lib/image/GL_ImageCube":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/base/ContextGLTextureFormat");var i=e("awayjs-stagegl/lib/image/GL_ImageBase");var l=function(e){r(t,e);function t(){e.apply(this,arguments)}t.prototype._createTexture=function(){this._texture=this._stage.context.createCubeTexture(this._asset.size,s.default.BGRA,false)};return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-stagegl/lib/base/ContextGLTextureFormat":"awayjs-stagegl/lib/base/ContextGLTextureFormat","awayjs-stagegl/lib/image/GL_ImageBase":"awayjs-stagegl/lib/image/GL_ImageBase"}],"awayjs-stagegl/lib/image/GL_RenderImage2D":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/image/GL_Image2D");var i=function(e){r(t,e);function t(){e.apply(this,arguments)}t.prototype.activate=function(t,a){e.prototype.activate.call(this,t,false)};return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/image/GL_Image2D":"awayjs-stagegl/lib/image/GL_Image2D"}],"awayjs-stagegl/lib/image/GL_RenderImageCube":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/image/GL_ImageCube");var i=function(e){r(t,e);function t(){e.apply(this,arguments)}t.prototype.activate=function(t,a){e.prototype.activate.call(this,t,false)};return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/image/GL_ImageCube":"awayjs-stagegl/lib/image/GL_ImageCube"}],"awayjs-stagegl/lib/image/GL_Sampler2D":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/image/GL_SamplerBase");var i=function(e){r(t,e);function t(t,a){e.call(this,t,a);this._sampler=t}t.prototype.activate=function(e){this._stage.setSamplerState(e,this._sampler.repeat,this._sampler.smooth,this._sampler.mipmap)};return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/image/GL_SamplerBase":"awayjs-stagegl/lib/image/GL_SamplerBase"}],"awayjs-stagegl/lib/image/GL_SamplerBase":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/errors/AbstractMethodError");var i=e("awayjs-core/lib/library/AbstractionBase");var l=function(e){r(t,e);function t(t,a){e.call(this,t,a);this._stage=a}t.prototype.activate=function(e){throw new s.default};return t}(i.default);Object.defineProperty(a,"__esModule",{value:true});a.default=l},{"awayjs-core/lib/errors/AbstractMethodError":undefined,"awayjs-core/lib/library/AbstractionBase":undefined}],"awayjs-stagegl/lib/image/GL_SamplerCube":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-stagegl/lib/image/GL_SamplerBase");var i=function(e){r(t,e);function t(t,a){e.call(this,t,a);this._sampler=t}t.prototype.activate=function(e){this._stage.setSamplerState(e,false,this._sampler.smooth,this._sampler.mipmap)};return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=i},{"awayjs-stagegl/lib/image/GL_SamplerBase":"awayjs-stagegl/lib/image/GL_SamplerBase"}],"awayjs-stagegl/lib/image/ProgramDataPool":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/image/ProgramData");var s=function(){function e(e){this._pool=new Object;this._stage=e}e.prototype.getItem=function(e,t){var a=e+t;return this._pool[a]||(this._pool[a]=new r.default(this,this._stage,e,t))};e.prototype.disposeItem=function(e){this._pool[e]=null};return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=s},{"awayjs-stagegl/lib/image/ProgramData":"awayjs-stagegl/lib/image/ProgramData"}],"awayjs-stagegl/lib/image/ProgramData":[function(e,t,a){"use strict";var r=function(){function e(e,t,a,r){this.usages=0;this._pool=e;this.stage=t;this.vertexString=a;this.fragmentString=r;this.stage.registerProgram(this)}e.prototype.dispose=function(){this.usages--;if(!this.usages){this._pool.disposeItem(this.vertexString+this.fragmentString);this.stage.unRegisterProgram(this);if(this.program){this.program.dispose();this.program=null}}};e.PROGRAMDATA_ID_COUNT=0;return e}();Object.defineProperty(a,"__esModule",{value:true});a.default=r},{}],"awayjs-stagegl/lib/image":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/image/GL_BitmapImage2D");a.GL_BitmapImage2D=r.default;var s=e("awayjs-stagegl/lib/image/GL_BitmapImageCube");a.GL_BitmapImageCube=s.default;var i=e("awayjs-stagegl/lib/image/GL_Image2D");a.GL_Image2D=i.default;var l=e("awayjs-stagegl/lib/image/GL_ImageBase");a.GL_ImageBase=l.default;var n=e("awayjs-stagegl/lib/image/GL_ImageCube");a.GL_ImageCube=n.default;var o=e("awayjs-stagegl/lib/image/GL_RenderImage2D");a.GL_RenderImage2D=o.default;var u=e("awayjs-stagegl/lib/image/GL_RenderImageCube");a.GL_RenderImageCube=u.default;var f=e("awayjs-stagegl/lib/image/GL_Sampler2D");a.GL_Sampler2D=f.default;var g=e("awayjs-stagegl/lib/image/GL_SamplerBase");a.GL_SamplerBase=g.default;var c=e("awayjs-stagegl/lib/image/GL_SamplerCube");a.GL_SamplerCube=c.default;var d=e("awayjs-stagegl/lib/image/ProgramData");a.ProgramData=d.default;var h=e("awayjs-stagegl/lib/image/ProgramDataPool");a.ProgramDataPool=h.default},{"awayjs-stagegl/lib/image/GL_BitmapImage2D":"awayjs-stagegl/lib/image/GL_BitmapImage2D","awayjs-stagegl/lib/image/GL_BitmapImageCube":"awayjs-stagegl/lib/image/GL_BitmapImageCube","awayjs-stagegl/lib/image/GL_Image2D":"awayjs-stagegl/lib/image/GL_Image2D","awayjs-stagegl/lib/image/GL_ImageBase":"awayjs-stagegl/lib/image/GL_ImageBase","awayjs-stagegl/lib/image/GL_ImageCube":"awayjs-stagegl/lib/image/GL_ImageCube","awayjs-stagegl/lib/image/GL_RenderImage2D":"awayjs-stagegl/lib/image/GL_RenderImage2D","awayjs-stagegl/lib/image/GL_RenderImageCube":"awayjs-stagegl/lib/image/GL_RenderImageCube","awayjs-stagegl/lib/image/GL_Sampler2D":"awayjs-stagegl/lib/image/GL_Sampler2D","awayjs-stagegl/lib/image/GL_SamplerBase":"awayjs-stagegl/lib/image/GL_SamplerBase","awayjs-stagegl/lib/image/GL_SamplerCube":"awayjs-stagegl/lib/image/GL_SamplerCube","awayjs-stagegl/lib/image/ProgramData":"awayjs-stagegl/lib/image/ProgramData","awayjs-stagegl/lib/image/ProgramDataPool":"awayjs-stagegl/lib/image/ProgramDataPool"}],"awayjs-stagegl/lib/library/GL_IAssetClass":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/library":[function(e,t,a){"use strict"},{}],"awayjs-stagegl/lib/managers/StageManager":[function(e,t,a){"use strict";var r=this&&this.__extends||function(e,t){for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)};var s=e("awayjs-core/lib/events/EventDispatcher");var i=e("awayjs-core/lib/errors/ArgumentError");var l=e("awayjs-stagegl/lib/base/Stage");var n=e("awayjs-stagegl/lib/events/StageEvent");var o=function(e){r(t,e);function t(){var a=this;e.call(this);this._stages=new Array(t.STAGE_MAX_QUANTITY);this._onContextCreatedDelegate=function(e){return a.onContextCreated(e)}}t.getInstance=function(){if(this._instance==null)this._instance=new t;return this._instance};t.prototype.getStageAt=function(e,a,r,s){if(a===void 0){a=false}if(r===void 0){r="baseline"}if(s===void 0){s="auto"}if(e<0||e>=t.STAGE_MAX_QUANTITY)throw new i.default("Index is out of bounds [0.."+t.STAGE_MAX_QUANTITY+"]");if(!this._stages[e]){t._numStages++;if(document){var o=document.createElement("canvas");o.id="stage"+e;document.body.appendChild(o)}var u=this._stages[e]=new l.default(o,e,this,a,r);u.addEventListener(n.default.CONTEXT_CREATED,this._onContextCreatedDelegate);u.requestContext(a,r,s)}return u};t.prototype.iRemoveStage=function(e){t._numStages--;e.removeEventListener(n.default.CONTEXT_CREATED,this._onContextCreatedDelegate);this._stages[e.stageIndex]=null};t.prototype.getFreeStage=function(e,t,a){if(e===void 0){e=false}if(t===void 0){t="baseline"}if(a===void 0){a="auto"}var r=0;var s=this._stages.length;while(r<s){if(!this._stages[r])return this.getStageAt(r,e,t,a);++r}return null};Object.defineProperty(t.prototype,"hasFreeStage",{get:function(){return t._numStages<t.STAGE_MAX_QUANTITY?true:false},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numSlotsFree",{get:function(){return t.STAGE_MAX_QUANTITY-t._numStages},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numSlotsUsed",{get:function(){return t._numStages},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"numSlotsTotal",{get:function(){return this._stages.length},enumerable:true,configurable:true});t.prototype.onContextCreated=function(e){};t.STAGE_MAX_QUANTITY=8;t._numStages=0;return t}(s.default);Object.defineProperty(a,"__esModule",{value:true});a.default=o},{"awayjs-core/lib/errors/ArgumentError":undefined,"awayjs-core/lib/events/EventDispatcher":undefined,"awayjs-stagegl/lib/base/Stage":"awayjs-stagegl/lib/base/Stage","awayjs-stagegl/lib/events/StageEvent":"awayjs-stagegl/lib/events/StageEvent"}],"awayjs-stagegl/lib/managers":[function(e,t,a){"use strict";var r=e("awayjs-stagegl/lib/managers/StageManager");a.StageManager=r.default},{"awayjs-stagegl/lib/managers/StageManager":"awayjs-stagegl/lib/managers/StageManager"}]},{},[1]);
//# sourceMappingURL=awayjs-stagegl.min.js.map
