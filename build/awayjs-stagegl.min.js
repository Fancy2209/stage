require=function e(t,i,r){function n(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[s]={exports:{}};t[s][0].call(c.exports,function(e){var i=t[s][1][e];return n(i?i:e)},c,c.exports,e,t,i,r)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({"awayjs-stagegl/lib/aglsl/AGALTokenizer":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/Description"),r=e("awayjs-stagegl/lib/aglsl/Header"),n=e("awayjs-stagegl/lib/aglsl/Mapping"),a=e("awayjs-stagegl/lib/aglsl/Token"),s=function(){function e(){}return e.prototype.decribeAGALByteArray=function(e){var t=new r;if(160!=e.readUnsignedByte())throw"Bad AGAL: Missing 0xa0 magic byte.";if(t.version=e.readUnsignedInt(),t.version>=16&&(e.readUnsignedByte(),t.version>>=1),161!=e.readUnsignedByte())throw"Bad AGAL: Missing 0xa1 magic byte.";switch(t.progid=e.readUnsignedByte(),t.progid){case 1:t.type="fragment";break;case 0:t.type="vertex";break;case 2:t.type="cpu";break;default:t.type=""}for(var s=new i,o=[];e.position<e.length;){var l=new a;l.opcode=e.readUnsignedInt();var u=n.agal2glsllut[l.opcode];if(!u)throw"Opcode not valid or not implemented yet: "+l.opcode;u.matrixheight&&(s.hasmatrix=!0),u.dest?(l.dest.regnum=e.readUnsignedShort(),l.dest.mask=e.readUnsignedByte(),l.dest.regtype=e.readUnsignedByte(),s.regwrite[l.dest.regtype][l.dest.regnum]|=l.dest.mask):(l.dest=null,e.readUnsignedInt()),u.a?this.readReg(l.a,1,s,e):(l.a=null,e.readUnsignedInt(),e.readUnsignedInt()),u.b?this.readReg(l.b,0|u.matrixheight,s,e):(l.b=null,e.readUnsignedInt(),e.readUnsignedInt()),o.push(l)}return s.header=t,s.tokens=o,s},e.prototype.readReg=function(e,t,i,r){if(e.regnum=r.readUnsignedShort(),e.indexoffset=r.readByte(),e.swizzle=r.readUnsignedByte(),e.regtype=r.readUnsignedByte(),i.regread[e.regtype][e.regnum]=15,5==e.regtype?(e.lodbiad=e.indexoffset,e.indexoffset=void 0,e.swizzle=void 0,e.readmode=r.readUnsignedByte(),e.dim=e.readmode>>4,e.readmode&=15,e.special=r.readUnsignedByte(),e.wrap=e.special>>4,e.special&=15,e.mipmap=r.readUnsignedByte(),e.filter=e.mipmap>>4,e.mipmap&=15,i.samplers[e.regnum]=e):(e.indexregtype=r.readUnsignedByte(),e.indexselect=r.readUnsignedByte(),e.indirectflag=r.readUnsignedByte()),e.indirectflag&&(i.hasindirect=!0),!e.indirectflag&&t)for(var n=0;t>n;n++)i.regread[e.regtype][e.regnum+n]=i.regread[e.regtype][e.regnum]},e}();t.exports=s},{"awayjs-stagegl/lib/aglsl/Description":void 0,"awayjs-stagegl/lib/aglsl/Header":void 0,"awayjs-stagegl/lib/aglsl/Mapping":void 0,"awayjs-stagegl/lib/aglsl/Token":void 0}],"awayjs-stagegl/lib/aglsl/AGLSLParser":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/Mapping"),r=e("awayjs-stagegl/lib/base/ContextStage3D"),n=function(){function e(){}return e.prototype.parse=function(e){var t="",n="";t+="precision highp float;\n";var a=e.header.type[0];if("vertex"==e.header.type&&(t+="uniform float yflip;\n"),e.hasindirect)t+="uniform vec4 "+a+"carrr["+r.maxvertexconstants+"];\n";else for(var s=0;s<e.regread[1].length;s++)e.regread[1][s]&&(t+="uniform vec4 "+a+"c"+s+";\n");for(var s=0;s<e.regread[2].length||s<e.regwrite[2].length;s++)(e.regread[2][s]||e.regwrite[2][s])&&(t+="vec4 "+a+"t"+s+";\n");for(var s=0;s<e.regread[0].length;s++)e.regread[0][s]&&(t+="attribute vec4 va"+s+";\n");for(var s=0;s<e.regread[4].length||s<e.regwrite[4].length;s++)(e.regread[4][s]||e.regwrite[4][s])&&(t+="varying vec4 vi"+s+";\n");for(var o=["2D","Cube","3D",""],s=0;s<e.samplers.length;s++)e.samplers[s]&&(t+="uniform sampler"+o[3&e.samplers[s].dim]+" fs"+s+";\n");"vertex"==e.header.type&&(t+="vec4 outpos;\n"),e.writedepth&&(t+="vec4 tmp_FragDepth;\n"),n+="void main() {\n";for(var s=0;s<e.tokens.length;s++){var l=i.agal2glsllut[e.tokens[s].opcode];if(!l)throw"Opcode not valid or not implemented yet: ";for(var u=l.matrixheight||1,c=0;u>c;c++){var h="  "+l.s;if(e.tokens[s].dest){if(l.matrixheight){if(1!=(e.tokens[s].dest.mask>>c&1))continue;var g=this.regtostring(e.tokens[s].dest.regtype,e.tokens[s].dest.regnum,e,a),d="float",p=["x","y","z","w"][c];g+="."+p}else{var d,p,g=this.regtostring(e.tokens[s].dest.regtype,e.tokens[s].dest.regnum,e,a);if(15!=e.tokens[s].dest.mask){var f=0;switch(p="",1&e.tokens[s].dest.mask&&(f++,p+="x"),2&e.tokens[s].dest.mask&&(f++,p+="y"),4&e.tokens[s].dest.mask&&(f++,p+="z"),8&e.tokens[s].dest.mask&&(f++,p+="w"),g+="."+p,f){case 1:d="float";break;case 2:d="vec2";break;case 3:d="vec3";break;default:throw"Unexpected destination mask"}}else d="vec4",p="xyzw"}h=h.replace("%dest",g),h=h.replace("%cast",d),h=h.replace("%dm",p)}var _=15;if(!l.ndwm&&l.dest&&e.tokens[s].dest&&(_=e.tokens[s].dest.mask),e.tokens[s].a&&(h=h.replace("%a",this.sourcetostring(e.tokens[s].a,0,_,l.scalar,e,a))),e.tokens[s].b&&(h=h.replace("%b",this.sourcetostring(e.tokens[s].b,c,_,l.scalar,e,a)),5==e.tokens[s].b.regtype)){var y=["2D","Cube","3D"][e.tokens[s].b.dim],b=["vec2","vec3","vec3"][e.tokens[s].b.dim];h=h.replace("%texdim",y),h=h.replace("%texsize",b);var m="";h=h.replace("%lod",m)}n+=h}}return"vertex"==e.header.type&&(n+="  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\n"),e.writedepth&&(n+="  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\n"),n+="}\n",t+n},e.prototype.regtostring=function(e,t,i,r){switch(e){case 0:return"va"+t;case 1:return i.hasindirect&&"vertex"==i.header.type?"vcarrr["+t+"]":r+"c"+t;case 2:return r+"t"+t;case 3:return"vertex"==i.header.type?"outpos":"gl_FragColor";case 4:return"vi"+t;case 5:return"fs"+t;case 6:return"tmp_FragDepth";default:throw"Unknown register type"}},e.prototype.sourcetostring=function(e,t,i,r,n,a){var s,o=["x","y","z","w"];if(e.indirectflag){s="vcarrr[int("+this.regtostring(e.indexregtype,e.regnum,n,a)+"."+o[e.indexselect]+")";var l=t+e.indexoffset;0>l&&(s+=l.toString()),l>0&&(s+="+"+l.toString()),s+="]"}else s=this.regtostring(e.regtype,e.regnum+t,n,a);return 5==e.regtype?s:r?s+"."+o[e.swizzle>>0&3]:228==e.swizzle&&15==i?s:(s+=".",1&i&&(s+=o[e.swizzle>>0&3]),2&i&&(s+=o[e.swizzle>>2&3]),4&i&&(s+=o[e.swizzle>>4&3]),8&i&&(s+=o[e.swizzle>>6&3]),s)},e}();t.exports=n},{"awayjs-stagegl/lib/aglsl/Mapping":void 0,"awayjs-stagegl/lib/base/ContextStage3D":void 0}],"awayjs-stagegl/lib/aglsl/Description":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/Header"),r=function(){function e(){this.regread=[[],[],[],[],[],[],[]],this.regwrite=[[],[],[],[],[],[],[]],this.hasindirect=!1,this.writedepth=!1,this.hasmatrix=!1,this.samplers=[],this.tokens=[],this.header=new i}return e}();t.exports=r},{"awayjs-stagegl/lib/aglsl/Header":void 0}],"awayjs-stagegl/lib/aglsl/Destination":[function(e,t){var i=function(){function e(){this.mask=0,this.regnum=0,this.regtype=0,this.dim=0}return e}();t.exports=i},{}],"awayjs-stagegl/lib/aglsl/Header":[function(e,t){var i=function(){function e(){this.progid=0,this.version=0,this.type=""}return e}();t.exports=i},{}],"awayjs-stagegl/lib/aglsl/Mapping":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/OpLUT"),r=function(){function e(){}return e.agal2glsllut=[new i("%dest = %cast(%a);\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(%a + %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new i("%dest = %cast(%a - %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new i("%dest = %cast(%a * %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new i("%dest = %cast(%a / %b);\n",0,!0,!0,!0,null,null,null,null,null,null),new i("%dest = %cast(1.0) / %a;\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(min(%a,%b));\n",0,!0,!0,!0,null,null,null,null,null,null),new i("%dest = %cast(max(%a,%b));\n",0,!0,!0,!0,null,null,null,null,null,null),new i("%dest = %cast(fract(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(sqrt(abs(%a)));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(inversesqrt(abs(%a)));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(pow(abs(%a),%b));\n",0,!0,!0,!0,null,null,null,null,null,null),new i("%dest = %cast(log2(abs(%a)));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(exp2(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(normalize(vec3( %a ) ));\n",0,!0,!0,!1,null,null,!0,null,null,null),new i("%dest = %cast(sin(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(cos(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(cross(vec3(%a),vec3(%b)));\n",0,!0,!0,!0,null,null,!0,null,null,null),new i("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",0,!0,!0,!0,null,null,!0,null,null,null),new i("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",0,!0,!0,!0,null,null,!0,null,null,null),new i("%dest = %cast(abs(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(%a * -1.0);\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(clamp(%a,0.0,1.0));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(dot(vec3(%a),vec3(%b)));\n",null,!0,!0,!0,3,3,!0,null,null,null),new i("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,!0,!0,!0,4,4,!0,null,null,null),new i("%dest = %cast(dot(vec4(%a),vec4(%b)));\n",null,!0,!0,!0,4,3,!0,null,null,null),new i("%dest = %cast(dFdx(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(dFdx(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("if (float(%a)==float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new i("if (float(%a)!=float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new i("if (float(%a)>=float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new i("if (float(%a)<float(%b)) {;\n",0,!1,!0,!0,null,null,null,!0,null,null),new i("} else {;\n",0,!1,!1,!1,null,null,null,null,null,null),new i("};\n",0,!1,!1,!1,null,null,null,null,null,null),new i(null,null,null,null,!1,null,null,null,null,null,null),new i(null,null,null,null,!1,null,null,null,null,null,null),new i(null,null,null,null,!1,null,null,null,null,null,null),new i(null,null,null,null,!1,null,null,null,null,null,null),new i("%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\n",null,!0,!0,!0,null,null,null,null,!0,null),new i("if ( float(%a)<0.0 ) discard;\n",null,!1,!0,!1,null,null,null,!0,null,null),new i("%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\n",null,!0,!0,!0,null,null,!0,null,!0,!0),new i("%dest = %cast(greaterThanEqual(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null),new i("%dest = %cast(lessThan(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null),new i("%dest = %cast(sign(%a));\n",0,!0,!0,!1,null,null,null,null,null,null),new i("%dest = %cast(equal(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null),new i("%dest = %cast(notEqual(%a,%b).%dm);\n",0,!0,!0,!0,null,null,!0,null,!0,null)],e}();t.exports=r},{"awayjs-stagegl/lib/aglsl/OpLUT":void 0}],"awayjs-stagegl/lib/aglsl/OpLUT":[function(e,t){var i=function(){function e(e,t,i,r,n,a,s,o,l,u,c){this.s=e,this.flags=t,this.dest=i,this.a=r,this.b=n,this.matrixwidth=a,this.matrixheight=s,this.ndwm=o,this.scalar=l,this.dm=u,this.lod=c}return e}();t.exports=i},{}],"awayjs-stagegl/lib/aglsl/Sampler":[function(e,t){var i=function(){function e(){this.lodbias=0,this.dim=0,this.readmode=0,this.special=0,this.wrap=0,this.mipmap=0,this.filter=0}return e}();t.exports=i},{}],"awayjs-stagegl/lib/aglsl/Token":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/Destination"),r=function(){function e(){this.dest=new i,this.opcode=0,this.a=new i,this.b=new i}return e}();t.exports=r},{"awayjs-stagegl/lib/aglsl/Destination":void 0}],"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/assembler/OpcodeMap"),r=e("awayjs-stagegl/lib/aglsl/assembler/Part"),n=e("awayjs-stagegl/lib/aglsl/assembler/RegMap"),a=e("awayjs-stagegl/lib/aglsl/assembler/SamplerMap"),s=function(){function e(){this.r={},this.cur=new r}return e.prototype.assemble=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i=null),i||(i=1),t&&this.addHeader(t,i);var r=e.replace(/[\f\n\r\v]+/g,"\n").split("\n");for(var n in r)this.processLine(r[n],n);return this.r},e.prototype.processLine=function(e,t){var r=e.search("//");if(-1!=r&&(e=e.slice(0,r)),e=e.replace(/^\s+|\s+$/g,""),e.length>0){var n=e.search(/<.*>/g),a=null;-1!=n&&(a=e.slice(n).match(/([\w\.\-\+]+)/gi),e=e.slice(0,n));var s=e.match(/([\w\.\+\[\]]+)/gi);if(!s||s.length<1)return void(e.length>=3&&console.log("Warning: bad line "+t+": "+e));switch(s[0]){case"part":this.addHeader(s[1],Number(s[2]));break;case"endpart":if(!this.cur)throw"Unexpected endpart";return this.cur.data.position=0,void(this.cur=null);default:if(!this.cur)return void console.log("Warning: bad line "+t+": "+e+" (Outside of any part definition)");if("comment"==this.cur.name)return;var o=i.map[s[0]];if(!o)throw"Bad opcode "+s[0]+" "+t+": "+e;this.emitOpcode(this.cur,o.opcode);var l=1;if(o.dest&&"none"!=o.dest){if(!this.emitDest(this.cur,s[l++],o.dest))throw"Bad destination register "+s[l-1]+" "+t+": "+e}else this.emitZeroDword(this.cur);if(o.a&&"none"!=o.a.format){if(!this.emitSource(this.cur,s[l++],o.a))throw"Bad source register "+s[l-1]+" "+t+": "+e}else this.emitZeroQword(this.cur);if(o.b&&"none"!=o.b.format){if("sampler"==o.b.format){if(!this.emitSampler(this.cur,s[l++],o.b,a))throw"Bad sampler register "+s[l-1]+" "+t+": "+e}else if(!this.emitSource(this.cur,s[l++],o.b))throw"Bad source register "+s[l-1]+" "+t+": "+e}else this.emitZeroQword(this.cur)}}},e.prototype.emitHeader=function(e){switch(e.data.writeUnsignedByte(160),e.data.writeUnsignedInt(e.version),e.version>=16&&e.data.writeUnsignedByte(0),e.data.writeUnsignedByte(161),e.name){case"fragment":e.data.writeUnsignedByte(1);break;case"vertex":e.data.writeUnsignedByte(0);break;case"cpu":e.data.writeUnsignedByte(2);break;default:e.data.writeUnsignedByte(255)}},e.prototype.emitOpcode=function(e,t){e.data.writeUnsignedInt(t)},e.prototype.emitZeroDword=function(e){e.data.writeUnsignedInt(0)},e.prototype.emitZeroQword=function(e){e.data.writeUnsignedInt(0),e.data.writeUnsignedInt(0)},e.prototype.emitDest=function(e,t){var i=t.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i);if(!n.map[i[1]])return!1;var r={num:i[2]?i[2]:0,code:n.map[i[1]].code,mask:this.stringToMask(i[3])};return e.data.writeUnsignedShort(r.num),e.data.writeUnsignedByte(r.mask),e.data.writeUnsignedByte(r.code),!0},e.prototype.stringToMask=function(e){if(!e)return 15;var t=0;return-1!=e.indexOf("x")&&(t|=1),-1!=e.indexOf("y")&&(t|=2),-1!=e.indexOf("z")&&(t|=4),-1!=e.indexOf("w")&&(t|=8),t},e.prototype.stringToSwizzle=function(e){if(!e)return 228;var t={x:0,y:1,z:2,w:3},i=0;if("."!=e.charAt(0))throw"Missing . for swizzle";return e.length>1&&(i|=t[e.charAt(1)]),i|=e.length>2?t[e.charAt(2)]<<2:(3&i)<<2,i|=e.length>3?t[e.charAt(3)]<<4:(12&i)<<2,i|=e.length>4?t[e.charAt(4)]<<6:(48&i)<<2},e.prototype.emitSampler=function(e,t,i,r){var n=t.match(/fs(\d*)/i);if(!n||!n[1])return!1;e.data.writeUnsignedShort(parseInt(n[1])),e.data.writeUnsignedByte(0),e.data.writeUnsignedByte(0);for(var s=5,o=0,l=0;l<r.length;l++){var u=a.map[r[l].toLowerCase()];u?(0!=(o>>u.shift&u.mask)&&console.log("Warning, duplicate sampler option"),o|=u.mask<<u.shift,s&=~(u.mask<<u.shift),s|=u.value<<u.shift):console.log("Warning, unknown sampler option: ",r[l])}return e.data.writeUnsignedInt(s),!0},e.prototype.emitSource=function(e,t){var i,r=t.match(/vc\[(v[tcai])(\d+)\.([xyzw])([\+\-]\d+)?\](\.[xyzw]{1,4})?/i);if(r){if(!n.map[r[1]])return!1;var a={x:0,y:1,z:2,w:3},s={num:0|r[2],code:n.map[r[1]].code,swizzle:this.stringToSwizzle(r[5]),select:a[r[3]],offset:0|r[4]};e.data.writeUnsignedShort(s.num),e.data.writeByte(s.offset),e.data.writeUnsignedByte(s.swizzle),e.data.writeUnsignedByte(1),e.data.writeUnsignedByte(s.code),e.data.writeUnsignedByte(s.select),e.data.writeUnsignedByte(128)}else{if(i=t.match(/([fov]?[tpocidavs])(\d*)(\.[xyzw]{1,4})?/i),!n.map[i[1]])return!1;var s={num:0|i[2],code:n.map[i[1]].code,swizzle:this.stringToSwizzle(i[3])};e.data.writeUnsignedShort(s.num),e.data.writeUnsignedByte(0),e.data.writeUnsignedByte(s.swizzle),e.data.writeUnsignedByte(s.code),e.data.writeUnsignedByte(0),e.data.writeUnsignedByte(0),e.data.writeUnsignedByte(0)}return!0},e.prototype.addHeader=function(e,t){if(t||(t=1),void 0==this.r[e])this.r[e]=new r(e,t),this.emitHeader(this.r[e]);else if(this.r[e].version!=t)throw"Multiple versions for part "+e;this.cur=this.r[e]},e}();t.exports=s},{"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":void 0,"awayjs-stagegl/lib/aglsl/assembler/Part":void 0,"awayjs-stagegl/lib/aglsl/assembler/RegMap":void 0,"awayjs-stagegl/lib/aglsl/assembler/SamplerMap":void 0}],"awayjs-stagegl/lib/aglsl/assembler/FS":[function(e,t){var i=function(){function e(){}return e}();t.exports=i},{}],"awayjs-stagegl/lib/aglsl/assembler/Flags":[function(e,t){var i=function(){function e(){}return e}();t.exports=i},{}],"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/assembler/Opcode"),r=function(){function e(){}return Object.defineProperty(e,"map",{get:function(){return e._map||(e._map=new Array,e._map.mov=new i("vector","vector",4,"none",0,0,!0,null,null,null),e._map.add=new i("vector","vector",4,"vector",4,1,!0,null,null,null),e._map.sub=new i("vector","vector",4,"vector",4,2,!0,null,null,null),e._map.mul=new i("vector","vector",4,"vector",4,3,!0,null,null,null),e._map.div=new i("vector","vector",4,"vector",4,4,!0,null,null,null),e._map.rcp=new i("vector","vector",4,"none",0,5,!0,null,null,null),e._map.min=new i("vector","vector",4,"vector",4,6,!0,null,null,null),e._map.max=new i("vector","vector",4,"vector",4,7,!0,null,null,null),e._map.frc=new i("vector","vector",4,"none",0,8,!0,null,null,null),e._map.sqt=new i("vector","vector",4,"none",0,9,!0,null,null,null),e._map.rsq=new i("vector","vector",4,"none",0,10,!0,null,null,null),e._map.pow=new i("vector","vector",4,"vector",4,11,!0,null,null,null),e._map.log=new i("vector","vector",4,"none",0,12,!0,null,null,null),e._map.exp=new i("vector","vector",4,"none",0,13,!0,null,null,null),e._map.nrm=new i("vector","vector",4,"none",0,14,!0,null,null,null),e._map.sin=new i("vector","vector",4,"none",0,15,!0,null,null,null),e._map.cos=new i("vector","vector",4,"none",0,16,!0,null,null,null),e._map.crs=new i("vector","vector",4,"vector",4,17,!0,!0,null,null),e._map.dp3=new i("vector","vector",4,"vector",4,18,!0,!0,null,null),e._map.dp4=new i("vector","vector",4,"vector",4,19,!0,!0,null,null),e._map.abs=new i("vector","vector",4,"none",0,20,!0,null,null,null),e._map.neg=new i("vector","vector",4,"none",0,21,!0,null,null,null),e._map.sat=new i("vector","vector",4,"none",0,22,!0,null,null,null),e._map.ted=new i("vector","vector",4,"sampler",1,38,!0,null,!0,null),e._map.kil=new i("none","scalar",1,"none",0,39,!0,null,!0,null),e._map.tex=new i("vector","vector",4,"sampler",1,40,!0,null,!0,null),e._map.m33=new i("vector","matrix",3,"vector",3,23,!0,null,null,!0),e._map.m44=new i("vector","matrix",4,"vector",4,24,!0,null,null,!0),e._map.m43=new i("vector","matrix",3,"vector",4,25,!0,null,null,!0),e._map.sge=new i("vector","vector",4,"vector",4,41,!0,null,null,null),e._map.slt=new i("vector","vector",4,"vector",4,42,!0,null,null,null),e._map.sgn=new i("vector","vector",4,"vector",4,43,!0,null,null,null),e._map.seq=new i("vector","vector",4,"vector",4,44,!0,null,null,null),e._map.sne=new i("vector","vector",4,"vector",4,45,!0,null,null,null)),e._map},enumerable:!0,configurable:!0}),e}();t.exports=r},{"awayjs-stagegl/lib/aglsl/assembler/Opcode":void 0}],"awayjs-stagegl/lib/aglsl/assembler/Opcode":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/assembler/Flags"),r=e("awayjs-stagegl/lib/aglsl/assembler/FS"),n=function(){function e(e,t,n,a,s,o,l,u,c,h){this.a=new r,this.b=new r,this.flags=new i,this.dest=e,this.a.format=t,this.a.size=n,this.b.format=a,this.b.size=s,this.opcode=o,this.flags.simple=l,this.flags.horizontal=u,this.flags.fragonly=c,this.flags.matrix=h}return e}();t.exports=n},{"awayjs-stagegl/lib/aglsl/assembler/FS":void 0,"awayjs-stagegl/lib/aglsl/assembler/Flags":void 0}],"awayjs-stagegl/lib/aglsl/assembler/Part":[function(e,t){var i=e("awayjs-core/lib/utils/ByteArray"),r=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.name="",this.version=0,this.name=e,this.version=t,this.data=new i}return e}();t.exports=r},{"awayjs-core/lib/utils/ByteArray":void 0}],"awayjs-stagegl/lib/aglsl/assembler/RegMap":[function(e,t){var i=function(){function e(e,t){this.code=e,this.desc=t}return e}(),r=function(){function e(){}return Object.defineProperty(e,"map",{get:function(){return e._map||(e._map=new Array,e._map.va=new i(0,"vertex attribute"),e._map.fc=new i(1,"fragment constant"),e._map.vc=new i(1,"vertex constant"),e._map.ft=new i(2,"fragment temporary"),e._map.vt=new i(2,"vertex temporary"),e._map.vo=new i(3,"vertex output"),e._map.op=new i(3,"vertex output"),e._map.fd=new i(3,"fragment depth output"),e._map.fo=new i(3,"fragment output"),e._map.oc=new i(3,"fragment output"),e._map.v=new i(4,"varying"),e._map.vi=new i(4,"varying output"),e._map.fi=new i(4,"varying input"),e._map.fs=new i(5,"sampler")),e._map},enumerable:!0,configurable:!0}),e}();t.exports=r},{}],"awayjs-stagegl/lib/aglsl/assembler/SamplerMap":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/assembler/Sampler"),r=function(){function e(){}return Object.defineProperty(e,"map",{get:function(){return e._map||(e._map=new Array,e._map.rgba=new i(8,15,0),e._map.rg=new i(8,15,5),e._map.r=new i(8,15,4),e._map.compressed=new i(8,15,1),e._map.compressed_alpha=new i(8,15,2),e._map.dxt1=new i(8,15,1),e._map.dxt5=new i(8,15,2),e._map["2d"]=new i(12,15,0),e._map.cube=new i(12,15,1),e._map["3d"]=new i(12,15,2),e._map.centroid=new i(16,1,1),e._map.ignoresampler=new i(16,4,4),e._map.clamp=new i(20,15,0),e._map.repeat=new i(20,15,1),e._map.wrap=new i(20,15,1),e._map.nomip=new i(24,15,0),e._map.mipnone=new i(24,15,0),e._map.mipnearest=new i(24,15,1),e._map.miplinear=new i(24,15,2),e._map.nearest=new i(28,15,0),e._map.linear=new i(28,15,1)),e._map},enumerable:!0,configurable:!0}),e}();t.exports=r},{"awayjs-stagegl/lib/aglsl/assembler/Sampler":void 0}],"awayjs-stagegl/lib/aglsl/assembler/Sampler":[function(e,t){var i=function(){function e(e,t,i){this.shift=e,this.mask=t,this.value=i}return e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLBlendFactor":[function(e,t){var i=function(){function e(){}return e.DESTINATION_ALPHA="destinationAlpha",e.DESTINATION_COLOR="destinationColor",e.ONE="one",e.ONE_MINUS_DESTINATION_ALPHA="oneMinusDestinationAlpha",e.ONE_MINUS_DESTINATION_COLOR="oneMinusDestinationColor",e.ONE_MINUS_SOURCE_ALPHA="oneMinusSourceAlpha",e.ONE_MINUS_SOURCE_COLOR="oneMinusSourceColor",e.SOURCE_ALPHA="sourceAlpha",e.SOURCE_COLOR="sourceColor",e.ZERO="zero",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLClearMask":[function(e,t){var i=function(){function e(){}return e.COLOR=1,e.DEPTH=2,e.STENCIL=4,e.ALL=e.COLOR|e.DEPTH|e.STENCIL,e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLCompareMode":[function(e,t){var i=function(){function e(){}return e.ALWAYS="always",e.EQUAL="equal",e.GREATER="greater",e.GREATER_EQUAL="greaterEqual",e.LESS="less",e.LESS_EQUAL="lessEqual",e.NEVER="never",e.NOT_EQUAL="notEqual",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLMipFilter":[function(e,t){var i=function(){function e(){}return e.MIPLINEAR="miplinear",e.MIPNEAREST="mipnearest",e.MIPNONE="mipnone",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLProfile":[function(e,t){var i=function(){function e(){}return e.BASELINE="baseline",e.BASELINE_CONSTRAINED="baselineConstrained",e.BASELINE_EXTENDED="baselineExtended",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLProgramType":[function(e,t){var i=function(){function e(){}return e.FRAGMENT="fragment",e.VERTEX="vertex",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLStencilAction":[function(e,t){var i=function(){function e(){}return e.DECREMENT_SATURATE="decrementSaturate",e.DECREMENT_WRAP="decrementWrap",e.INCREMENT_SATURATE="incrementSaturate",e.INCREMENT_WRAP="incrementWrap",e.INVERT="invert",e.KEEP="keep",e.SET="set",e.ZERO="zero",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLTextureFilter":[function(e,t){var i=function(){function e(){}return e.LINEAR="linear",e.NEAREST="nearest",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLTextureFormat":[function(e,t){var i=function(){function e(){}return e.BGRA="bgra",e.BGRA_PACKED="bgraPacked4444",e.BGR_PACKED="bgrPacked565",e.COMPRESSED="compressed",e.COMPRESSED_ALPHA="compressedAlpha",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLTriangleFace":[function(e,t){var i=function(){function e(){}return e.BACK="back",e.FRONT="front",e.FRONT_AND_BACK="frontAndBack",e.NONE="none",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":[function(e,t){var i=function(){function e(){}return e.BYTES_4="bytes4",e.FLOAT_1="float1",e.FLOAT_2="float2",e.FLOAT_3="float3",e.FLOAT_4="float4",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextGLWrapMode":[function(e,t){var i=function(){function e(){}return e.CLAMP="clamp",e.REPEAT="repeat",e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ContextStage3D":[function(e,t){var i=e("awayjs-stagegl/lib/swfobject"),r=e("awayjs-stagegl/lib/aglsl/Sampler"),n=e("awayjs-stagegl/lib/base/ContextGLClearMask"),a=e("awayjs-stagegl/lib/base/ContextGLProgramType"),s=e("awayjs-stagegl/lib/base/CubeTextureFlash"),o=e("awayjs-stagegl/lib/base/IndexBufferFlash"),l=e("awayjs-stagegl/lib/base/OpCodes"),u=e("awayjs-stagegl/lib/base/ProgramFlash"),c=e("awayjs-stagegl/lib/base/TextureFlash"),h=e("awayjs-stagegl/lib/base/VertexBufferFlash"),g=function(){function e(t,r){function n(e){e.success&&(u._container=e.ref,u._iCallback=r)}this._cmdStream="",this._resources=new Array;var a="11.0.0",s={id:t.id},o={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"sameDomain",allowfullscreen:"true",wmode:"direct"};this._errorCheckingEnabled=!1,this._iDriverInfo="Unknown";var l={salign:"tl",id:t.id,name:t.name};this._oldCanvas=t.cloneNode(),this._oldParent=t.parentNode;var u=this;e.contexts[t.id]=this,i.embedSWF("libs/molehill_js_flashbridge.swf",t.id,String(t.width),String(t.height),a,"",s,o,l,n)}return Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"driverInfo",{get:function(){return this._iDriverInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorCheckingEnabled",{get:function(){return this._errorCheckingEnabled},set:function(e){this._errorCheckingEnabled!=e&&(this._errorCheckingEnabled=e,this.addStream(String.fromCharCode(l.enableErrorChecking,e?l.trueValue:l.falseValue)),this.execute())},enumerable:!0,configurable:!0}),e.prototype._iAddResource=function(e){this._resources.push(e)},e.prototype._iRemoveResource=function(e){this._resources.splice(this._resources.indexOf(e))},e.prototype.createTexture=function(e,t,i,r,n){return void 0===n&&(n=0),new c(this,e,t,i,r)},e.prototype.createCubeTexture=function(e,t,i,r){return void 0===r&&(r=0),new s(this,e,t,i)},e.prototype.setTextureAt=function(t,i){this.addStream(i?String.fromCharCode(l.setTextureAt)+t+","+i.id+",":String.fromCharCode(l.clearTextureAt)+t.toString()+","),e.debug&&this.execute()},e.prototype.setSamplerStateAt=function(){},e.prototype.setStencilActions=function(t,i,r,n,a){void 0===t&&(t="frontAndBack"),void 0===i&&(i="always"),void 0===r&&(r="keep"),void 0===n&&(n="keep"),void 0===a&&(a="keep"),this.addStream(String.fromCharCode(l.setStencilActions)+t+"$"+i+"$"+r+"$"+n+"$"+a+"$"),e.debug&&this.execute()},e.prototype.setStencilReferenceValue=function(t,i,r){void 0===i&&(i=255),void 0===r&&(r=255),this.addStream(String.fromCharCode(l.setStencilReferenceValue,t+l.intMask,i+l.intMask,r+l.intMask)),e.debug&&this.execute()},e.prototype.setCulling=function(t,i){void 0===i&&(i="leftHanded"),this.addStream(String.fromCharCode(l.setCulling)+t+"$"),e.debug&&this.execute()},e.prototype.drawTriangles=function(t,i,r){void 0===i&&(i=0),void 0===r&&(r=-1),i=i||0,(!r||0>r)&&(r=t.numIndices/3),this.addStream(String.fromCharCode(l.drawTriangles,t.id+l.intMask)+i+","+r+","),e.debug&&this.execute()},e.prototype.setProgramConstantsFromMatrix=function(e,t,i,r){void 0===r&&(r=!1);var n=i.rawData;r?(this.setProgramConstantsFromArray(e,t,[n[0],n[4],n[8],n[12]],1),this.setProgramConstantsFromArray(e,t+1,[n[1],n[5],n[9],n[13]],1),this.setProgramConstantsFromArray(e,t+2,[n[2],n[6],n[10],n[14]],1),this.setProgramConstantsFromArray(e,t+3,[n[3],n[7],n[11],n[15]],1)):(this.setProgramConstantsFromArray(e,t,[n[0],n[1],n[2],n[3]],1),this.setProgramConstantsFromArray(e,t+1,[n[4],n[5],n[6],n[7]],1),this.setProgramConstantsFromArray(e,t+2,[n[8],n[9],n[10],n[11]],1),this.setProgramConstantsFromArray(e,t+3,[n[12],n[13],n[14],n[15]],1))},e.prototype.setProgramConstantsFromArray=function(t,i,r,n){void 0===n&&(n=-1);for(var s,o=t==a.VERTEX?l.trueValue:l.falseValue,u=0;n>u;u++)s=4*u,this.addStream(String.fromCharCode(l.setProgramConstant,o,i+u+l.intMask)+r[s]+","+r[s+1]+","+r[s+2]+","+r[s+3]+","),e.debug&&this.execute()},e.prototype.setProgram=function(t){this.addStream(String.fromCharCode(l.setProgram,t.id+l.intMask)),e.debug&&this.execute()},e.prototype.present=function(){this.addStream(String.fromCharCode(l.present)),this.execute()},e.prototype.clear=function(t,i,r,a,s,o,u){void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===a&&(a=1),void 0===s&&(s=1),void 0===o&&(o=0),void 0===u&&(u=n.ALL),this.addStream(String.fromCharCode(l.clear)+t+","+i+","+r+","+a+","+s+","+o+","+u+","),e.debug&&this.execute()},e.prototype.createProgram=function(){return new u(this)},e.prototype.createVertexBuffer=function(e,t){return new h(this,e,t)},e.prototype.createIndexBuffer=function(e){return new o(this,e)},e.prototype.configureBackBuffer=function(e,t,i,r){void 0===r&&(r=!0),this._width=e,this._height=t,this.addStream(String.fromCharCode(l.configureBackBuffer)+e+","+t+",")},e.prototype.drawToBitmapData=function(){},e.prototype.setVertexBufferAt=function(t,i,r,n){void 0===r&&(r=0),void 0===n&&(n=null),this.addStream(i?String.fromCharCode(l.setVertexBufferAt,t+l.intMask)+i.id+","+r+","+n+"$":String.fromCharCode(l.clearVertexBufferAt,t+l.intMask)),e.debug&&this.execute()},e.prototype.setColorMask=function(t,i,r,n){this.addStream(String.fromCharCode(l.setColorMask,t?l.trueValue:l.falseValue,i?l.trueValue:l.falseValue,r?l.trueValue:l.falseValue,n?l.trueValue:l.falseValue)),e.debug&&this.execute()},e.prototype.setBlendFactors=function(t,i){this.addStream(String.fromCharCode(l.setBlendFactors)+t+"$"+i+"$"),e.debug&&this.execute()},e.prototype.setRenderToTexture=function(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=0),void 0===n&&(n=0),this.addStream(null===t||void 0===t?String.fromCharCode(l.clearRenderToTexture):String.fromCharCode(l.setRenderToTexture,i?l.trueValue:l.falseValue)+t.id+","+(r||0)+","),e.debug&&this.execute()},e.prototype.setRenderToBackBuffer=function(){this.addStream(String.fromCharCode(l.clearRenderToTexture)),e.debug&&this.execute()},e.prototype.setScissorRectangle=function(t){this.addStream(t?String.fromCharCode(l.setScissorRect)+t.x+","+t.y+","+t.width+","+t.height+",":String.fromCharCode(l.clearScissorRect)),e.debug&&this.execute()},e.prototype.setDepthTest=function(t,i){this.addStream(String.fromCharCode(l.setDepthTest,t?l.trueValue:l.falseValue)+i+"$"),e.debug&&this.execute()},e.prototype.dispose=function(){if(null!=this._container){for(console.log("Context3D dispose, releasing "+this._resources.length+" resources.");this._resources.length;)this._resources[0].dispose();this._container&&(this.addStream(String.fromCharCode(l.disposeContext)),this.execute(),i.removeSWF(this._oldCanvas.id),this._oldCanvas&&this._oldParent&&(this._oldParent.appendChild(this._oldCanvas),this._oldParent=null),this._container=null),this._oldCanvas=null}},e.prototype.addStream=function(e){this._cmdStream+=e},e.prototype.execute=function(){e.logStream&&console.log(this._cmdStream);
var t=this._container.CallFunction('<invoke name="execStage3dOpStream" returntype="javascript"><arguments><string>'+this._cmdStream+"</string></arguments></invoke>");if(Number(t)<=-3)throw"Exec stream failed";return this._cmdStream="",Number(t)},e.contexts=new Object,e.maxvertexconstants=128,e.maxfragconstants=28,e.maxtemp=8,e.maxstreams=8,e.maxtextures=8,e.defaultsampler=new r,e.debug=!1,e.logStream=!1,e}();t.exports=g},{"awayjs-stagegl/lib/aglsl/Sampler":void 0,"awayjs-stagegl/lib/base/ContextGLClearMask":void 0,"awayjs-stagegl/lib/base/ContextGLProgramType":void 0,"awayjs-stagegl/lib/base/CubeTextureFlash":void 0,"awayjs-stagegl/lib/base/IndexBufferFlash":void 0,"awayjs-stagegl/lib/base/OpCodes":void 0,"awayjs-stagegl/lib/base/ProgramFlash":void 0,"awayjs-stagegl/lib/base/TextureFlash":void 0,"awayjs-stagegl/lib/base/VertexBufferFlash":void 0,"awayjs-stagegl/lib/swfobject":void 0}],"awayjs-stagegl/lib/base/ContextWebGL":[function(e,t){var i=e("awayjs-core/lib/geom/Rectangle"),r=e("awayjs-core/lib/utils/ByteArray"),n=e("awayjs-stagegl/lib/base/ContextGLBlendFactor"),a=e("awayjs-stagegl/lib/base/ContextGLClearMask"),s=e("awayjs-stagegl/lib/base/ContextGLCompareMode"),o=e("awayjs-stagegl/lib/base/ContextGLMipFilter"),l=e("awayjs-stagegl/lib/base/ContextGLProgramType"),u=e("awayjs-stagegl/lib/base/ContextGLTextureFilter"),c=e("awayjs-stagegl/lib/base/ContextGLTriangleFace"),h=e("awayjs-stagegl/lib/base/ContextGLVertexBufferFormat"),g=e("awayjs-stagegl/lib/base/ContextGLWrapMode"),d=e("awayjs-stagegl/lib/base/CubeTextureWebGL"),p=e("awayjs-stagegl/lib/base/IndexBufferWebGL"),f=e("awayjs-stagegl/lib/base/ProgramWebGL"),_=e("awayjs-stagegl/lib/base/TextureWebGL"),y=e("awayjs-stagegl/lib/base/SamplerState"),b=e("awayjs-stagegl/lib/base/VertexBufferWebGL"),m=function(){function e(t){this._blendFactorDictionary=new Object,this._depthTestDictionary=new Object,this._textureIndexDictionary=new Array(8),this._textureTypeDictionary=new Object,this._wrapDictionary=new Object,this._filterDictionary=new Object,this._mipmapFilterDictionary=new Object,this._uniformLocationNameDictionary=new Object,this._vertexBufferDimensionDictionary=new Object,this._indexBufferList=new Array,this._vertexBufferList=new Array,this._textureList=new Array,this._programList=new Array,this._samplerStates=new Array(8),this._container=t;try{this._gl=t.getContext("experimental-webgl",{premultipliedAlpha:!1,alpha:!1}),this._gl||(this._gl=t.getContext("webgl",{premultipliedAlpha:!1,alpha:!1}))}catch(i){}this._gl?(this._blendFactorDictionary[n.ONE]=this._gl.ONE,this._blendFactorDictionary[n.DESTINATION_ALPHA]=this._gl.DST_ALPHA,this._blendFactorDictionary[n.DESTINATION_COLOR]=this._gl.DST_COLOR,this._blendFactorDictionary[n.ONE]=this._gl.ONE,this._blendFactorDictionary[n.ONE_MINUS_DESTINATION_ALPHA]=this._gl.ONE_MINUS_DST_ALPHA,this._blendFactorDictionary[n.ONE_MINUS_DESTINATION_COLOR]=this._gl.ONE_MINUS_DST_COLOR,this._blendFactorDictionary[n.ONE_MINUS_SOURCE_ALPHA]=this._gl.ONE_MINUS_SRC_ALPHA,this._blendFactorDictionary[n.ONE_MINUS_SOURCE_COLOR]=this._gl.ONE_MINUS_SRC_COLOR,this._blendFactorDictionary[n.SOURCE_ALPHA]=this._gl.SRC_ALPHA,this._blendFactorDictionary[n.SOURCE_COLOR]=this._gl.SRC_COLOR,this._blendFactorDictionary[n.ZERO]=this._gl.ZERO,this._depthTestDictionary[s.ALWAYS]=this._gl.ALWAYS,this._depthTestDictionary[s.EQUAL]=this._gl.EQUAL,this._depthTestDictionary[s.GREATER]=this._gl.GREATER,this._depthTestDictionary[s.GREATER_EQUAL]=this._gl.GEQUAL,this._depthTestDictionary[s.LESS]=this._gl.LESS,this._depthTestDictionary[s.LESS_EQUAL]=this._gl.LEQUAL,this._depthTestDictionary[s.NEVER]=this._gl.NEVER,this._depthTestDictionary[s.NOT_EQUAL]=this._gl.NOTEQUAL,this._textureIndexDictionary[0]=this._gl.TEXTURE0,this._textureIndexDictionary[1]=this._gl.TEXTURE1,this._textureIndexDictionary[2]=this._gl.TEXTURE2,this._textureIndexDictionary[3]=this._gl.TEXTURE3,this._textureIndexDictionary[4]=this._gl.TEXTURE4,this._textureIndexDictionary[5]=this._gl.TEXTURE5,this._textureIndexDictionary[6]=this._gl.TEXTURE6,this._textureIndexDictionary[7]=this._gl.TEXTURE7,this._textureTypeDictionary.texture2d=this._gl.TEXTURE_2D,this._textureTypeDictionary.textureCube=this._gl.TEXTURE_CUBE_MAP,this._wrapDictionary[g.REPEAT]=this._gl.REPEAT,this._wrapDictionary[g.CLAMP]=this._gl.CLAMP_TO_EDGE,this._filterDictionary[u.LINEAR]=this._gl.LINEAR,this._filterDictionary[u.NEAREST]=this._gl.NEAREST,this._mipmapFilterDictionary[u.LINEAR]=new Object,this._mipmapFilterDictionary[u.LINEAR][o.MIPNEAREST]=this._gl.LINEAR_MIPMAP_NEAREST,this._mipmapFilterDictionary[u.LINEAR][o.MIPLINEAR]=this._gl.LINEAR_MIPMAP_LINEAR,this._mipmapFilterDictionary[u.LINEAR][o.MIPNONE]=this._gl.LINEAR,this._mipmapFilterDictionary[u.NEAREST]=new Object,this._mipmapFilterDictionary[u.NEAREST][o.MIPNEAREST]=this._gl.NEAREST_MIPMAP_NEAREST,this._mipmapFilterDictionary[u.NEAREST][o.MIPLINEAR]=this._gl.NEAREST_MIPMAP_LINEAR,this._mipmapFilterDictionary[u.NEAREST][o.MIPNONE]=this._gl.NEAREST,this._uniformLocationNameDictionary[l.VERTEX]="vc",this._uniformLocationNameDictionary[l.FRAGMENT]="fc",this._vertexBufferDimensionDictionary[h.FLOAT_1]=1,this._vertexBufferDimensionDictionary[h.FLOAT_2]=2,this._vertexBufferDimensionDictionary[h.FLOAT_3]=3,this._vertexBufferDimensionDictionary[h.FLOAT_4]=4,this._vertexBufferDimensionDictionary[h.BYTES_4]=4):alert("WebGL is not available.");for(var r=0;r<e.MAX_SAMPLERS;++r)this._samplerStates[r]=new y,this._samplerStates[r].wrap=this._gl.REPEAT,this._samplerStates[r].filter=this._gl.LINEAR,this._samplerStates[r].mipfilter=this._gl.LINEAR}return Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),e.prototype.gl=function(){return this._gl},e.prototype.clear=function(e,t,i,r,n,s,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=1),void 0===s&&(s=0),void 0===o&&(o=a.ALL),this._drawing||(this.updateBlendStatus(),this._drawing=!0);var l=0;o&a.COLOR&&(l|=this._gl.COLOR_BUFFER_BIT),o&a.STENCIL&&(l|=this._gl.STENCIL_BUFFER_BIT),o&a.DEPTH&&(l|=this._gl.DEPTH_BUFFER_BIT),this._gl.clearColor(e,t,i,r),this._gl.clearDepth(n),this._gl.clearStencil(s),this._gl.clear(l)},e.prototype.configureBackBuffer=function(e,t,i,r){void 0===r&&(r=!0),this._width=e,this._height=t,r&&(this._gl.enable(this._gl.STENCIL_TEST),this._gl.enable(this._gl.DEPTH_TEST)),this._gl.viewport.width=e,this._gl.viewport.height=t,this._gl.viewport(0,0,e,t)},e.prototype.createCubeTexture=function(e,t,i,r){void 0===r&&(r=0);var n=new d(this._gl,e);return this._textureList.push(n),n},e.prototype.createIndexBuffer=function(e){var t=new p(this._gl,e);return this._indexBufferList.push(t),t},e.prototype.createProgram=function(){var e=new f(this._gl);return this._programList.push(e),e},e.prototype.createTexture=function(e,t,i,r,n){void 0===n&&(n=0);var a=new _(this._gl,e,t);return this._textureList.push(a),a},e.prototype.createVertexBuffer=function(e,t){var i=new b(this._gl,e,t);return this._vertexBufferList.push(i),i},e.prototype.dispose=function(){var e;for(e=0;e<this._indexBufferList.length;++e)this._indexBufferList[e].dispose();for(this._indexBufferList=null,e=0;e<this._vertexBufferList.length;++e)this._vertexBufferList[e].dispose();for(this._vertexBufferList=null,e=0;e<this._textureList.length;++e)this._textureList[e].dispose();for(this._textureList=null,e=0;e<this._programList.length;++e)this._programList[e].dispose();for(e=0;e<this._samplerStates.length;++e)this._samplerStates[e]=null;this._programList=null},e.prototype.drawToBitmapData=function(e){var t=new ArrayBuffer(e.width*e.height*4);this._gl.readPixels(0,0,e.width,e.height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,new Uint8Array(t));var n=new r;n.setArrayBuffer(t),e.setPixels(new i(0,0,e.width,e.height),n)},e.prototype.drawTriangles=function(e,t,i){if(void 0===t&&(t=0),void 0===i&&(i=-1),!this._drawing)throw"Need to clear before drawing if the buffer has not been cleared since the last present() call.";this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,e.glBuffer),this._gl.drawElements(this._gl.TRIANGLES,-1==i?e.numIndices:3*i,this._gl.UNSIGNED_SHORT,t)},e.prototype.present=function(){this._drawing=!1},e.prototype.setBlendFactors=function(e,t){this._blendEnabled=!0,this._blendSourceFactor=this._blendFactorDictionary[e],this._blendDestinationFactor=this._blendFactorDictionary[t],this.updateBlendStatus()},e.prototype.setColorMask=function(e,t,i,r){this._gl.colorMask(e,t,i,r)},e.prototype.setCulling=function(e,t){if(void 0===t&&(t="leftHanded"),e==c.NONE)this._gl.disable(this._gl.CULL_FACE);else switch(this._gl.enable(this._gl.CULL_FACE),e){case c.BACK:this._gl.cullFace("leftHanded"==t?this._gl.FRONT:this._gl.BACK);break;case c.FRONT:this._gl.cullFace("leftHanded"==t?this._gl.BACK:this._gl.FRONT);break;case c.FRONT_AND_BACK:this._gl.cullFace(this._gl.FRONT_AND_BACK);break;default:throw"Unknown ContextGLTriangleFace type."}},e.prototype.setDepthTest=function(e,t){this._gl.depthFunc(this._depthTestDictionary[t]),this._gl.depthMask(e)},e.prototype.setProgram=function(e){this._currentProgram=e,e.focusProgram()},e.prototype.setProgramConstantsFromMatrix=function(e,t,i,r){void 0===r&&(r=!1);var n=i.rawData;r?(this.setProgramConstantsFromArray(e,t,[n[0],n[4],n[8],n[12]],1),this.setProgramConstantsFromArray(e,t+1,[n[1],n[5],n[9],n[13]],1),this.setProgramConstantsFromArray(e,t+2,[n[2],n[6],n[10],n[14]],1),this.setProgramConstantsFromArray(e,t+3,[n[3],n[7],n[11],n[15]],1)):(this.setProgramConstantsFromArray(e,t,[n[0],n[1],n[2],n[3]],1),this.setProgramConstantsFromArray(e,t+1,[n[4],n[5],n[6],n[7]],1),this.setProgramConstantsFromArray(e,t+2,[n[8],n[9],n[10],n[11]],1),this.setProgramConstantsFromArray(e,t+3,[n[12],n[13],n[14],n[15]],1))},e.prototype.setProgramConstantsFromArray=function(e,t,i,r){void 0===r&&(r=-1);for(var n,a=this._uniformLocationNameDictionary[e],s=0;r>s;s++)n=4*s,this._gl.uniform4f(this._gl.getUniformLocation(this._currentProgram.glProgram,a+(t+s)),i[n],i[n+1],i[n+2],i[n+3])},e.prototype.setScissorRectangle=function(e){return e?(this._gl.enable(this._gl.SCISSOR_TEST),void this._gl.scissor(e.x,e.y,e.width,e.height)):void this._gl.disable(this._gl.SCISSOR_TEST)},e.prototype.setTextureAt=function(e,t){var i=this._samplerStates[e];if(this._activeTexture!=e&&(t||i.type)&&(this._activeTexture=e,this._gl.activeTexture(this._textureIndexDictionary[e])),!t)return void(i.type&&(this._gl.bindTexture(i.type,null),i.type=null));var r=this._textureTypeDictionary[t.textureType];i.type=r,this._gl.bindTexture(r,t.glTexture),this._gl.uniform1i(this._gl.getUniformLocation(this._currentProgram.glProgram,"fs"+e),e),this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_S,i.wrap),this._gl.texParameteri(r,this._gl.TEXTURE_WRAP_T,i.wrap),this._gl.texParameteri(r,this._gl.TEXTURE_MAG_FILTER,i.filter),this._gl.texParameteri(r,this._gl.TEXTURE_MIN_FILTER,i.mipfilter)},e.prototype.setSamplerStateAt=function(t,i,r,n){if(!(t>=0&&t<e.MAX_SAMPLERS))throw"Sampler is out of bounds.";this._samplerStates[t].wrap=this._wrapDictionary[i],this._samplerStates[t].filter=this._filterDictionary[r],this._samplerStates[t].mipfilter=this._mipmapFilterDictionary[r][n]},e.prototype.setVertexBufferAt=function(e,t,i,r){void 0===i&&(i=0),void 0===r&&(r=null);var n=this._currentProgram?this._gl.getAttribLocation(this._currentProgram.glProgram,"va"+e):-1;return t?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,t.glBuffer),this._gl.enableVertexAttribArray(n),void this._gl.vertexAttribPointer(n,this._vertexBufferDimensionDictionary[r],this._gl.FLOAT,!1,4*t.data32PerVertex,4*i)):void(n>-1&&this._gl.disableVertexAttribArray(n))},e.prototype.setRenderToTexture=function(e,t,i,r){void 0===t&&(t=!1),void 0===i&&(i=0),void 0===r&&(r=0);var n=e,a=n.frameBuffer;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,a),t&&(this._gl.enable(this._gl.STENCIL_TEST),this._gl.enable(this._gl.DEPTH_TEST)),this._gl.viewport(0,0,n.width,n.height)},e.prototype.setRenderToBackBuffer=function(){this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)},e.prototype.updateBlendStatus=function(){this._blendEnabled?(this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._blendSourceFactor,this._blendDestinationFactor)):this._gl.disable(this._gl.BLEND)},e.MAX_SAMPLERS=8,e.modulo=0,e}();t.exports=m},{"awayjs-core/lib/geom/Rectangle":void 0,"awayjs-core/lib/utils/ByteArray":void 0,"awayjs-stagegl/lib/base/ContextGLBlendFactor":void 0,"awayjs-stagegl/lib/base/ContextGLClearMask":void 0,"awayjs-stagegl/lib/base/ContextGLCompareMode":void 0,"awayjs-stagegl/lib/base/ContextGLMipFilter":void 0,"awayjs-stagegl/lib/base/ContextGLProgramType":void 0,"awayjs-stagegl/lib/base/ContextGLTextureFilter":void 0,"awayjs-stagegl/lib/base/ContextGLTriangleFace":void 0,"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat":void 0,"awayjs-stagegl/lib/base/ContextGLWrapMode":void 0,"awayjs-stagegl/lib/base/CubeTextureWebGL":void 0,"awayjs-stagegl/lib/base/IndexBufferWebGL":void 0,"awayjs-stagegl/lib/base/ProgramWebGL":void 0,"awayjs-stagegl/lib/base/SamplerState":void 0,"awayjs-stagegl/lib/base/TextureWebGL":void 0,"awayjs-stagegl/lib/base/VertexBufferWebGL":void 0}],"awayjs-stagegl/lib/base/CubeTextureFlash":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-core/lib/base/BitmapData"),n=e("awayjs-core/lib/utils/ByteArrayBase"),a=e("awayjs-stagegl/lib/base/OpCodes"),s=e("awayjs-stagegl/lib/base/ResourceBaseFlash"),o=function(e){function t(t,i,r,n,s){void 0===s&&(s=!1),e.call(this),this._context=t,this._size=i,this._context.addStream(String.fromCharCode(a.initCubeTexture,n?a.trueValue:a.falseValue)+i+","+s+","+r+"$"),this._pId=this._context.execute(),this._context._iAddResource(this)}return i(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(a.disposeCubeTexture)+this._pId.toString()+","),this._context.execute(),this._context._iRemoveResource(this),this._context=null},t.prototype.uploadFromData=function(e,t,i){if(void 0===i&&(i=0),e instanceof r)e=e.imageData.data;else if(e instanceof HTMLImageElement){var s=document.createElement("canvas"),o=e.width,l=e.height;s.width=o,s.height=l;var u=s.getContext("2d");u.drawImage(e,0,0),e=u.getImageData(0,0,o,l).data}var c=0,h=n.internalGetBase64String(e.length,function(){return e[c++]},null);this._context.addStream(String.fromCharCode(a.uploadBytesCubeTexture)+this._pId+","+i+","+t+","+(this.size>>i)+","+h+"%"),this._context.execute()},t.prototype.uploadCompressedTextureFromByteArray=function(e,t,i){void 0===i&&(i=!1)},t}(s);t.exports=o},{"awayjs-core/lib/base/BitmapData":void 0,"awayjs-core/lib/utils/ByteArrayBase":void 0,"awayjs-stagegl/lib/base/OpCodes":void 0,"awayjs-stagegl/lib/base/ResourceBaseFlash":void 0}],"awayjs-stagegl/lib/base/CubeTextureWebGL":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-core/lib/base/BitmapData"),n=e("awayjs-stagegl/lib/base/TextureBaseWebGL"),a=function(e){function t(t,i){e.call(this,t),this._textureSelectorDictionary=new Array(6),this.textureType="textureCube",this._size=i,this._texture=this._gl.createTexture(),this._textureSelectorDictionary[0]=t.TEXTURE_CUBE_MAP_POSITIVE_X,this._textureSelectorDictionary[1]=t.TEXTURE_CUBE_MAP_NEGATIVE_X,this._textureSelectorDictionary[2]=t.TEXTURE_CUBE_MAP_POSITIVE_Y,this._textureSelectorDictionary[3]=t.TEXTURE_CUBE_MAP_NEGATIVE_Y,this._textureSelectorDictionary[4]=t.TEXTURE_CUBE_MAP_POSITIVE_Z,this._textureSelectorDictionary[5]=t.TEXTURE_CUBE_MAP_NEGATIVE_Z}return i(t,e),t.prototype.dispose=function(){this._gl.deleteTexture(this._texture)},t.prototype.uploadFromData=function(e,t,i){void 0===i&&(i=0),e instanceof r&&(e=e.imageData),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,this._texture),this._gl.texImage2D(this._textureSelectorDictionary[t],i,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e),this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP,null)},t.prototype.uploadCompressedTextureFromByteArray=function(e,t,i){void 0===i&&(i=!1)},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),t}(n);t.exports=a},{"awayjs-core/lib/base/BitmapData":void 0,"awayjs-stagegl/lib/base/TextureBaseWebGL":void 0}],"awayjs-stagegl/lib/base/IContextGL":[function(){},{}],"awayjs-stagegl/lib/base/ICubeTexture":[function(){},{}],"awayjs-stagegl/lib/base/IIndexBuffer":[function(){},{}],"awayjs-stagegl/lib/base/IProgram":[function(){},{}],"awayjs-stagegl/lib/base/ITextureBase":[function(){},{}],"awayjs-stagegl/lib/base/ITexture":[function(){},{}],"awayjs-stagegl/lib/base/IVertexBuffer":[function(){},{}],"awayjs-stagegl/lib/base/IndexBufferFlash":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-stagegl/lib/base/OpCodes"),n=e("awayjs-stagegl/lib/base/ResourceBaseFlash"),a=function(e){function t(t,i){e.call(this),this._context=t,this._numIndices=i,this._context.addStream(String.fromCharCode(r.initIndexBuffer,i+r.intMask)),this._pId=this._context.execute(),this._context._iAddResource(this)}return i(t,e),t.prototype.uploadFromArray=function(e,t,i){this._context.addStream(String.fromCharCode(r.uploadArrayIndexBuffer,this._pId+r.intMask)+e.join()+"#"+t+","+i+","),this._context.execute()},t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(r.disposeIndexBuffer,this._pId+r.intMask)),this._context.execute(),this._context._iRemoveResource(this),this._context=null},Object.defineProperty(t.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:!0,configurable:!0}),t}(n);t.exports=a},{"awayjs-stagegl/lib/base/OpCodes":void 0,"awayjs-stagegl/lib/base/ResourceBaseFlash":void 0}],"awayjs-stagegl/lib/base/IndexBufferWebGL":[function(e,t){var i=function(){function e(e,t){this._gl=e,this._buffer=this._gl.createBuffer(),this._numIndices=t}return e.prototype.uploadFromArray=function(e){this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,this._buffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),this._gl.STATIC_DRAW)},e.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)},Object.defineProperty(e.prototype,"numIndices",{get:function(){return this._numIndices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),e}();t.exports=i},{}],"awayjs-stagegl/lib/base/OpCodes":[function(e,t){var i=function(){function e(){}return e.trueValue=32,e.falseValue=33,e.intMask=63,e.drawTriangles=41,e.setProgramConstant=42,e.setProgram=43,e.present=44,e.clear=45,e.initProgram=46,e.initVertexBuffer=47,e.initIndexBuffer=48,e.configureBackBuffer=49,e.uploadArrayIndexBuffer=50,e.uploadArrayVertexBuffer=51,e.uploadAGALBytesProgram=52,e.setVertexBufferAt=53,e.uploadBytesIndexBuffer=54,e.uploadBytesVertexBuffer=55,e.setColorMask=56,e.setDepthTest=57,e.disposeProgram=58,e.disposeContext=59,e.disposeVertexBuffer=61,e.disposeIndexBuffer=63,e.initTexture=64,e.setTextureAt=65,e.uploadBytesTexture=66,e.disposeTexture=67,e.setCulling=68,e.setScissorRect=69,e.clearScissorRect=70,e.setBlendFactors=71,e.setRenderToTexture=72,e.clearTextureAt=73,e.clearVertexBufferAt=74,e.setStencilActions=75,e.setStencilReferenceValue=76,e.initCubeTexture=77,e.disposeCubeTexture=78,e.uploadBytesCubeTexture=79,e.clearRenderToTexture=80,e.enableErrorChecking=81,e}();t.exports=i},{}],"awayjs-stagegl/lib/base/ProgramFlash":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-stagegl/lib/base/ContextStage3D"),n=e("awayjs-stagegl/lib/base/OpCodes"),a=e("awayjs-stagegl/lib/base/ResourceBaseFlash"),s=function(e){function t(t){e.call(this),this._context=t,this._context.addStream(String.fromCharCode(n.initProgram)),this._pId=this._context.execute(),this._context._iAddResource(this)}return i(t,e),t.prototype.upload=function(e,t){this._context.addStream(String.fromCharCode(n.uploadAGALBytesProgram,this._pId+n.intMask)+e.readBase64String(e.length)+"%"+t.readBase64String(t.length)+"%"),r.debug&&this._context.execute()},t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(n.disposeProgram,this._pId+n.intMask)),this._context.execute(),this._context._iRemoveResource(this),this._context=null},t}(a);t.exports=s},{"awayjs-stagegl/lib/base/ContextStage3D":void 0,"awayjs-stagegl/lib/base/OpCodes":void 0,"awayjs-stagegl/lib/base/ResourceBaseFlash":void 0}],"awayjs-stagegl/lib/base/ProgramWebGL":[function(e,t){var i=e("awayjs-stagegl/lib/aglsl/AGALTokenizer"),r=e("awayjs-stagegl/lib/aglsl/AGLSLParser"),n=function(){function e(e){this._gl=e,this._program=this._gl.createProgram()}return e.prototype.upload=function(t,i){var r=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(t)),n=e._aglslParser.parse(e._tokenizer.decribeAGALByteArray(i));if(this._vertexShader=this._gl.createShader(this._gl.VERTEX_SHADER),this._fragmentShader=this._gl.createShader(this._gl.FRAGMENT_SHADER),this._gl.shaderSource(this._vertexShader,r),this._gl.compileShader(this._vertexShader),!this._gl.getShaderParameter(this._vertexShader,this._gl.COMPILE_STATUS))throw new Error(this._gl.getShaderInfoLog(this._vertexShader));if(this._gl.shaderSource(this._fragmentShader,n),this._gl.compileShader(this._fragmentShader),!this._gl.getShaderParameter(this._fragmentShader,this._gl.COMPILE_STATUS))throw new Error(this._gl.getShaderInfoLog(this._fragmentShader));if(this._gl.attachShader(this._program,this._vertexShader),this._gl.attachShader(this._program,this._fragmentShader),this._gl.linkProgram(this._program),!this._gl.getProgramParameter(this._program,this._gl.LINK_STATUS))throw new Error(this._gl.getProgramInfoLog(this._program))},e.prototype.dispose=function(){this._gl.deleteProgram(this._program)},e.prototype.focusProgram=function(){this._gl.useProgram(this._program)},Object.defineProperty(e.prototype,"glProgram",{get:function(){return this._program},enumerable:!0,configurable:!0}),e._tokenizer=new i,e._aglslParser=new r,e}();t.exports=n},{"awayjs-stagegl/lib/aglsl/AGALTokenizer":void 0,"awayjs-stagegl/lib/aglsl/AGLSLParser":void 0}],"awayjs-stagegl/lib/base/ResourceBaseFlash":[function(e,t){var i=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this._pId},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},e}();t.exports=i},{}],"awayjs-stagegl/lib/base/SamplerState":[function(e,t){var i=function(){function e(){}return e}();t.exports=i},{}],"awayjs-stagegl/lib/base/Stage":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-core/lib/geom/Rectangle"),n=e("awayjs-core/lib/events/Event"),a=e("awayjs-core/lib/events/EventDispatcher"),s=e("awayjs-core/lib/textures/RenderTexture"),o=e("awayjs-core/lib/utils/CSS"),l=e("awayjs-display/lib/display/ContextMode"),u=e("awayjs-display/lib/events/StageEvent"),c=e("awayjs-stagegl/lib/base/ContextGLTextureFormat"),h=e("awayjs-stagegl/lib/base/ContextGLMipFilter"),g=e("awayjs-stagegl/lib/base/ContextGLTextureFilter"),d=e("awayjs-stagegl/lib/base/ContextGLWrapMode"),p=e("awayjs-stagegl/lib/base/ContextStage3D"),f=e("awayjs-stagegl/lib/base/ContextWebGL"),_=e("awayjs-stagegl/lib/pool/TextureDataPool"),y=e("awayjs-stagegl/lib/pool/ProgramDataPool"),b=function(e){function t(t,i,n,a,s){void 0===a&&(a=!1),void 0===s&&(s="baseline"),e.call(this),this._programData=new Array,this._x=0,this._y=0,this._stageIndex=-1,this._antiAlias=0,this._renderTarget=null,this._renderSurfaceSelector=0,this._initialised=!1,this._texturePool=new _,this._programDataPool=new y(this),this._container=t,this._stageIndex=i,this._stageManager=n,this._viewPort=new r,this._enableDepthAndStencil=!0,o.setElementX(this._container,0),o.setElementY(this._container,0),this.visible=!0}return i(t,e),t.prototype.getProgramData=function(e,t){return this._programDataPool.getItem(e,t)},t.prototype.setRenderTarget=function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=0),(this._renderTarget!==e||i!=this._renderSurfaceSelector||this._enableDepthAndStencil!=t)&&(this._renderTarget=e,this._renderSurfaceSelector=i,this._enableDepthAndStencil=t,e instanceof s?this._context.setRenderToTexture(this.getRenderTexture(e),t,this._antiAlias,i):(this._context.setRenderToBackBuffer(),this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil)))},t.prototype.getRenderTexture=function(e){var t=this._texturePool.getItem(e);return t.texture||(t.texture=this._context.createTexture(e.width,e.height,c.BGRA,!0)),t.texture},t.prototype.activateBuffer=function(e,t,i,r){t.contexts[this._stageIndex]||(t.contexts[this._stageIndex]=this._context),t.buffers[this._stageIndex]||(t.buffers[this._stageIndex]=this._context.createVertexBuffer(t.data.length/t.dataPerVertex,t.dataPerVertex),t.invalid[this._stageIndex]=!0),t.invalid[this._stageIndex]&&(t.buffers[this._stageIndex].uploadFromArray(t.data,0,t.data.length/t.dataPerVertex),t.invalid[this._stageIndex]=!1),this._context.setVertexBufferAt(e,t.buffers[this._stageIndex],i,r)},t.prototype.disposeVertexData=function(e){e.buffers[this._stageIndex].dispose(),e.buffers[this._stageIndex]=null},t.prototype.activateRenderTexture=function(e,t){this._setSamplerState(e,!1,!1,!1),this._context.setTextureAt(e,this.getRenderTexture(t))},t.prototype.activateTexture=function(e,t,i,r,n){this._setSamplerState(e,i,r,n);var a=this._texturePool.getItem(t);if(a.texture||(a.texture=this._context.createTexture(t.width,t.height,c.BGRA,!0),a.invalid=!0),a.invalid)if(a.invalid=!1,n)for(var s=t._iGetMipmapData(),o=s.length,l=0;o>l;l++)a.texture.uploadFromData(s[l],l);else a.texture.uploadFromData(t._iGetTextureData(),0);this._context.setTextureAt(e,a.texture)},t.prototype.activateCubeTexture=function(e,t,i,r){this._setSamplerState(e,!1,i,r);var n=this._texturePool.getItem(t);if(n.texture||(n.texture=this._context.createCubeTexture(t.size,c.BGRA,!1),n.invalid=!0),n.invalid){n.invalid=!1;for(var a=0;6>a;++a)if(r)for(var s=t._iGetMipmapData(a),o=s.length,l=0;o>l;l++)n.texture.uploadFromData(s[l],a,l);else n.texture.uploadFromData(t._iGetTextureData(a),a,0)}this._context.setTextureAt(e,n.texture)},t.prototype.getIndexBuffer=function(e){return e.contexts[this._stageIndex]||(e.contexts[this._stageIndex]=this._context),e.buffers[this._stageIndex]||(e.buffers[this._stageIndex]=this._context.createIndexBuffer(e.data.length),e.invalid[this._stageIndex]=!0),e.invalid[this._stageIndex]&&(e.buffers[this._stageIndex].uploadFromArray(e.data,0,e.data.length),e.invalid[this._stageIndex]=!1),e.buffers[this._stageIndex]},t.prototype.disposeIndexData=function(e){e.buffers[this._stageIndex].dispose(),e.buffers[this._stageIndex]=null},t.prototype.requestContext=function(e,t,i){var r=this;void 0===e&&(e=!1),void 0===t&&(t="baseline"),void 0===i&&(i="auto"),null!=this._usesSoftwareRendering&&(this._usesSoftwareRendering=e),this._profile=t;try{i==l.FLASH?new p(this._container,function(e){return r._callback(e)}):this._context=new f(this._container)}catch(a){try{i==l.AUTO?new p(this._container,function(e){return r._callback(e)}):this.dispatchEvent(new n(n.ERROR))}catch(a){this.dispatchEvent(new n(n.ERROR))}}this._context&&this._callback(this._context)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width!=e&&(o.setElementWidth(this._container,e),this._width=this._viewPort.width=e,this._backBufferDirty=!0,this.notifyViewportUpdated())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height!=e&&(o.setElementHeight(this._container,e),this._height=this._viewPort.height=e,this._backBufferDirty=!0,this.notifyViewportUpdated())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){this._x!=e&&(o.setElementX(this._container,e),this._x=this._viewPort.x=e,this.notifyViewportUpdated())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){this._y!=e&&(o.setElementY(this._container,e),this._y=this._viewPort.y=e,this.notifyViewportUpdated())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return o.getElementVisibility(this._container)},set:function(e){o.setElementVisibility(this._container,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),t.prototype.notifyViewportUpdated=function(){this._viewportDirty||(this._viewportDirty=!0,this._viewportUpdated=new u(u.VIEWPORT_UPDATED),this.dispatchEvent(this._viewportUpdated))},t.prototype.notifyEnterFrame=function(){this._enterFrame||(this._enterFrame=new n(n.ENTER_FRAME)),this.dispatchEvent(this._enterFrame)},t.prototype.notifyExitFrame=function(){this._exitFrame||(this._exitFrame=new n(n.EXIT_FRAME)),this.dispatchEvent(this._exitFrame)},Object.defineProperty(t.prototype,"profile",{get:function(){return this._profile},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._stageManager.iRemoveStage(this),this.freeContext(),this._stageManager=null,this._stageIndex=-1},t.prototype.configureBackBuffer=function(e,t,i,r){this.width=e,this.height=t,this._antiAlias=i,this._enableDepthAndStencil=r,this._context&&this._context.configureBackBuffer(e,t,i,r)},Object.defineProperty(t.prototype,"enableDepthAndStencil",{get:function(){return this._enableDepthAndStencil},set:function(e){this._enableDepthAndStencil=e,this._backBufferDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderTarget",{get:function(){return this._renderTarget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderSurfaceSelector",{get:function(){return this._renderSurfaceSelector},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._context&&(this._backBufferDirty&&(this.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil),this._backBufferDirty=!1),this._context.clear((4278190080&this._color)>>>24,(16711680&this._color)>>>16,(65280&this._color)>>>8,255&this._color),this._bufferClear=!0)},t.prototype.addEventListener=function(t,i){e.prototype.addEventListener.call(this,t,i)},t.prototype.removeEventListener=function(t,i){e.prototype.removeEventListener.call(this,t,i)},Object.defineProperty(t.prototype,"scissorRect",{get:function(){return this._scissorRect},set:function(e){this._scissorRect=e,this._context.setScissorRectangle(this._scissorRect)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stageIndex",{get:function(){return this._stageIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usesSoftwareRendering",{get:function(){return this._usesSoftwareRendering},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"antiAlias",{get:function(){return this._antiAlias},set:function(e){this._antiAlias=e,this._backBufferDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewPort",{get:function(){return this._viewportDirty=!1,this._viewPort},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color
},set:function(e){this._color=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferClear",{get:function(){return this._bufferClear},set:function(e){this._bufferClear=e},enumerable:!0,configurable:!0}),t.prototype.registerProgram=function(e){for(var t=0;null!=this._programData[t];)t++;this._programData[t]=e,e.id=t},t.prototype.unRegisterProgram=function(e){this._programData[e.id]=null,e.id=-1},t.prototype.freeContext=function(){this._context&&(this._context.dispose(),this.dispatchEvent(new u(u.CONTEXT_DISPOSED))),this._context=null,this._initialised=!1},t.prototype.onEnterFrame=function(){this._context&&(this.clear(),this.notifyEnterFrame(),this._context||this._context.present(),this.notifyExitFrame())},t.prototype.recoverFromDisposal=function(){return this._context?!0:!1},t.prototype._callback=function(e){this._context=e,this._container=this._context.container,this._width&&this._height&&this._context.configureBackBuffer(this._width,this._height,this._antiAlias,this._enableDepthAndStencil),this.dispatchEvent(new u(this._initialised?u.CONTEXT_RECREATED:u.CONTEXT_CREATED)),this._initialised=!0},t.prototype._setSamplerState=function(e,t,i,r){var n=t?d.REPEAT:d.CLAMP,a=i?g.LINEAR:g.NEAREST,s=r?h.MIPLINEAR:h.MIPNONE;this._context.setSamplerStateAt(e,n,a,s)},t}(a);t.exports=b},{"awayjs-core/lib/events/Event":void 0,"awayjs-core/lib/events/EventDispatcher":void 0,"awayjs-core/lib/geom/Rectangle":void 0,"awayjs-core/lib/textures/RenderTexture":void 0,"awayjs-core/lib/utils/CSS":void 0,"awayjs-display/lib/display/ContextMode":void 0,"awayjs-display/lib/events/StageEvent":void 0,"awayjs-stagegl/lib/base/ContextGLMipFilter":void 0,"awayjs-stagegl/lib/base/ContextGLTextureFilter":void 0,"awayjs-stagegl/lib/base/ContextGLTextureFormat":void 0,"awayjs-stagegl/lib/base/ContextGLWrapMode":void 0,"awayjs-stagegl/lib/base/ContextStage3D":void 0,"awayjs-stagegl/lib/base/ContextWebGL":void 0,"awayjs-stagegl/lib/pool/ProgramDataPool":void 0,"awayjs-stagegl/lib/pool/TextureDataPool":void 0}],"awayjs-stagegl/lib/base/TextureBaseWebGL":[function(e,t){var i=e("awayjs-core/lib/errors/AbstractMethodError"),r=function(){function e(e){this.textureType="",this._gl=e}return e.prototype.dispose=function(){throw"Abstract method must be overridden."},Object.defineProperty(e.prototype,"glTexture",{get:function(){throw new i},enumerable:!0,configurable:!0}),e}();t.exports=r},{"awayjs-core/lib/errors/AbstractMethodError":void 0}],"awayjs-stagegl/lib/base/TextureFlash":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-core/lib/base/BitmapData"),n=e("awayjs-core/lib/utils/ByteArrayBase"),a=e("awayjs-stagegl/lib/base/OpCodes"),s=e("awayjs-stagegl/lib/base/ResourceBaseFlash"),o=function(e){function t(t,i,r,n,s,o){void 0===o&&(o=!1),e.call(this),this._context=t,this._width=i,this._height=r,this._context.addStream(String.fromCharCode(a.initTexture,s?a.trueValue:a.falseValue)+i+","+r+","+o+","+n+"$"),this._pId=this._context.execute(),this._context._iAddResource(this)}return i(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(a.disposeTexture)+this._pId.toString()+","),this._context.execute(),this._context._iRemoveResource(this),this._context=null},t.prototype.uploadFromData=function(e,t){if(void 0===t&&(t=0),e instanceof r)e=e.imageData.data;else if(e instanceof HTMLImageElement){var i=document.createElement("canvas"),s=e.width,o=e.height;i.width=s,i.height=o;var l=i.getContext("2d");l.drawImage(e,0,0),e=l.getImageData(0,0,s,o).data}var u=0,c=n.internalGetBase64String(e.length,function(){return e[u++]},null);this._context.addStream(String.fromCharCode(a.uploadBytesTexture)+this._pId+","+t+","+(this._width>>t)+","+(this._height>>t)+","+c+"%"),this._context.execute()},t}(s);t.exports=o},{"awayjs-core/lib/base/BitmapData":void 0,"awayjs-core/lib/utils/ByteArrayBase":void 0,"awayjs-stagegl/lib/base/OpCodes":void 0,"awayjs-stagegl/lib/base/ResourceBaseFlash":void 0}],"awayjs-stagegl/lib/base/TextureWebGL":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-core/lib/base/BitmapData"),n=e("awayjs-stagegl/lib/base/TextureBaseWebGL"),a=function(e){function t(t,i,r){e.call(this,t),this.textureType="texture2d",this._width=i,this._height=r,this._glTexture=this._gl.createTexture()}return i(t,e),t.prototype.dispose=function(){this._gl.deleteTexture(this._glTexture)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameBuffer",{get:function(){if(!this._frameBuffer){this._frameBuffer=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._frameBuffer),this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._width,this._height,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null);var e=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,e),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._width,this._height),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._glTexture,0),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,e),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return this._frameBuffer},enumerable:!0,configurable:!0}),t.prototype.uploadFromData=function(e,t){void 0===t&&(t=0),e instanceof r&&(e=e.imageData),this._gl.bindTexture(this._gl.TEXTURE_2D,this._glTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,t,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,e),this._gl.bindTexture(this._gl.TEXTURE_2D,null)},t.prototype.uploadCompressedTextureFromByteArray=function(e,t,i){void 0===i&&(i=!1);this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc")},Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._glTexture},enumerable:!0,configurable:!0}),t.prototype.generateMipmaps=function(){},t}(n);t.exports=a},{"awayjs-core/lib/base/BitmapData":void 0,"awayjs-stagegl/lib/base/TextureBaseWebGL":void 0}],"awayjs-stagegl/lib/base/VertexBufferFlash":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-stagegl/lib/base/OpCodes"),n=e("awayjs-stagegl/lib/base/ResourceBaseFlash"),a=function(e){function t(t,i,n){e.call(this),this._context=t,this._numVertices=i,this._data32PerVertex=n,this._context.addStream(String.fromCharCode(r.initVertexBuffer,n+r.intMask)+i.toString()+","),this._pId=this._context.execute(),this._context._iAddResource(this)}return i(t,e),t.prototype.uploadFromArray=function(e,t,i){this._context.addStream(String.fromCharCode(r.uploadArrayVertexBuffer,this._pId+r.intMask)+e.join()+"#"+[t,i].join()+","),this._context.execute()},Object.defineProperty(t.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data32PerVertex",{get:function(){return this._data32PerVertex},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this._context.addStream(String.fromCharCode(r.disposeVertexBuffer,this._pId+r.intMask)),this._context.execute(),this._context._iRemoveResource(this),this._context=null},t}(n);t.exports=a},{"awayjs-stagegl/lib/base/OpCodes":void 0,"awayjs-stagegl/lib/base/ResourceBaseFlash":void 0}],"awayjs-stagegl/lib/base/VertexBufferWebGL":[function(e,t){var i=function(){function e(e,t,i){this._gl=e,this._buffer=this._gl.createBuffer(),this._numVertices=t,this._data32PerVertex=i}return e.prototype.uploadFromArray=function(e){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._buffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW)},Object.defineProperty(e.prototype,"numVertices",{get:function(){return this._numVertices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data32PerVertex",{get:function(){return this._data32PerVertex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glBuffer",{get:function(){return this._buffer},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._gl.deleteBuffer(this._buffer)},e}();t.exports=i},{}],"awayjs-stagegl/lib/managers/StageManager":[function(e,t){var i=this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);i.prototype=t.prototype,e.prototype=new i},r=e("awayjs-core/lib/events/EventDispatcher"),n=e("awayjs-core/lib/errors/ArgumentError"),a=e("awayjs-display/lib/events/StageEvent"),s=e("awayjs-stagegl/lib/base/Stage"),o=function(e){function t(){var i=this;e.call(this),this._stages=new Array(t.STAGE_MAX_QUANTITY),this._onContextCreatedDelegate=function(e){return i.onContextCreated(e)}}return i(t,e),t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.getStageAt=function(e,i,r,o){if(void 0===i&&(i=!1),void 0===r&&(r="baseline"),void 0===o&&(o="auto"),0>e||e>=t.STAGE_MAX_QUANTITY)throw new n("Index is out of bounds [0.."+t.STAGE_MAX_QUANTITY+"]");if(!this._stages[e]){t._numStages++;var l=document.createElement("canvas");l.id="stage"+e,document.body.appendChild(l);var u=this._stages[e]=new s(l,e,this,i,r);u.addEventListener(a.CONTEXT_CREATED,this._onContextCreatedDelegate),u.requestContext(i,r,o)}return u},t.prototype.iRemoveStage=function(e){t._numStages--,e.removeEventListener(a.CONTEXT_CREATED,this._onContextCreatedDelegate),this._stages[e.stageIndex]=null},t.prototype.getFreeStage=function(e,t,i){void 0===e&&(e=!1),void 0===t&&(t="baseline"),void 0===i&&(i="auto");for(var r=0,n=this._stages.length;n>r;){if(!this._stages[r])return this.getStageAt(r,e,t,i);++r}return null},Object.defineProperty(t.prototype,"hasFreeStage",{get:function(){return t._numStages<t.STAGE_MAX_QUANTITY?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numSlotsFree",{get:function(){return t.STAGE_MAX_QUANTITY-t._numStages},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numSlotsUsed",{get:function(){return t._numStages},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numSlotsTotal",{get:function(){return this._stages.length},enumerable:!0,configurable:!0}),t.prototype.onContextCreated=function(){},t.STAGE_MAX_QUANTITY=8,t._numStages=0,t}(r);t.exports=o},{"awayjs-core/lib/errors/ArgumentError":void 0,"awayjs-core/lib/events/EventDispatcher":void 0,"awayjs-display/lib/events/StageEvent":void 0,"awayjs-stagegl/lib/base/Stage":void 0}],"awayjs-stagegl/lib/pool/IndexDataPool":[function(e,t){var i=e("awayjs-stagegl/lib/pool/IndexData"),r=function(){function e(){}return e.getItem=function(t,r,n){var a=e._pool[t.id]||(e._pool[t.id]=new Array),s=a[r]||(a[r]=new i(r));return s.updateData(n,t.indices,t.numVertices),s},e.disposeItem=function(e,t){var i=this._pool[e];i[t].dispose(),i[t]=null},e.prototype.disposeData=function(t){for(var i=e._pool[t],r=i.length,n=0;r>n;n++)i[n].dispose(),i[n]=null;e._pool[t]=null},e._pool=new Object,e}();t.exports=r},{"awayjs-stagegl/lib/pool/IndexData":void 0}],"awayjs-stagegl/lib/pool/IndexData":[function(e,t){var i=function(){function e(e){this._dataDirty=!0,this.invalid=new Array(8),this.contexts=new Array(8),this.buffers=new Array(8),this.level=e}return e.prototype.updateData=function(t,i,r){if(this._dataDirty)if(this._dataDirty=!1,i.length<e.LIMIT_INDICES&&r<e.LIMIT_VERTS)this.indexMappings=null,this.originalIndices=null,this.setData(i),this.offset=i.length;else{var n,a,s,o,l,u=new Array;for(this.indexMappings=new Array(i.length),this.originalIndices=new Array,n=this.indexMappings.length;n--;)this.indexMappings[n]=-1;var c,h;for(s=0,a=i.length,n=t,l=0;a>n&&s+3<e.LIMIT_INDICES&&l+3<e.LIMIT_VERTS;){for(o=0;3>o;o++)c=i[n+o],this.indexMappings[c]>=0?h=this.indexMappings[c]:(h=l++,this.indexMappings[c]=h,this.originalIndices.push(c)),u[s+o]=h;s+=3,n+=3}this.setData(u),this.offset=n}},e.prototype.invalidateData=function(){this._dataDirty=!0},e.prototype.dispose=function(){for(var e=0;8>e;++e)this.contexts[e]&&(this.buffers[e].dispose(),this.buffers[e]=null,this.contexts[e]=null)},e.prototype.disposeBuffers=function(){for(var e=0;8>e;++e)this.buffers[e]&&(this.buffers[e].dispose(),this.buffers[e]=null)},e.prototype.invalidateBuffers=function(){for(var e=0;8>e;++e)this.invalid[e]=!0},e.prototype.setData=function(e){this.data&&this.data.length!=e.length?this.disposeBuffers():this.invalidateBuffers(),this.data=e},e.LIMIT_VERTS=65535,e.LIMIT_INDICES=16777215,e}();t.exports=i},{}],"awayjs-stagegl/lib/pool/ProgramDataPool":[function(e,t){var i=e("awayjs-stagegl/lib/pool/ProgramData"),r=function(){function e(e){this._pool=new Object,this._stage=e}return e.prototype.getItem=function(e,t){var r=e+t;return this._pool[r]||(this._pool[r]=new i(this,this._stage,e,t))},e.prototype.disposeItem=function(e){this._pool[e]=null},e}();t.exports=r},{"awayjs-stagegl/lib/pool/ProgramData":void 0}],"awayjs-stagegl/lib/pool/ProgramData":[function(e,t){var i=function(){function e(e,t,i,r){this.usages=0,this._pool=e,this.stage=t,this.vertexString=i,this.fragmentString=r,this.stage.registerProgram(this)}return e.prototype.dispose=function(){this.usages--,this.usages||(this._pool.disposeItem(this.vertexString+this.fragmentString),this.stage.unRegisterProgram(this),this.program&&this.program.dispose()),this.program=null},e.PROGRAMDATA_ID_COUNT=0,e}();t.exports=i},{}],"awayjs-stagegl/lib/pool/TextureDataPool":[function(e,t){var i=e("awayjs-stagegl/lib/pool/TextureData"),r=function(){function e(){this._pool=new Object}return e.prototype.getItem=function(e){return this._pool[e.id]||(this._pool[e.id]=e._iAddTextureData(new i(this,e)))},e.prototype.disposeItem=function(e){e._iRemoveTextureData(this._pool[e.id]),this._pool[e.id]=null},e}();t.exports=r},{"awayjs-stagegl/lib/pool/TextureData":void 0}],"awayjs-stagegl/lib/pool/TextureData":[function(e,t){var i=function(){function e(e,t){this._pool=e,this.textureProxy=t}return e.prototype.dispose=function(){this._pool.disposeItem(this.textureProxy),this.texture.dispose(),this.texture=null},e.prototype.invalidate=function(){this.invalid=!0},e}();t.exports=i},{}],"awayjs-stagegl/lib/pool/VertexDataPool":[function(e,t){var i=e("awayjs-display/lib/base/SubGeometryBase"),r=e("awayjs-stagegl/lib/pool/VertexData"),n=function(){function e(){}return e.getItem=function(t,n,a){t.concatenateArrays&&(a=i.VERTEX_DATA);var s=e._pool[t.id]||(e._pool[t.id]=new Object),o=s[a]||(s[a]=new Array),l=o[n.level]||(o[n.level]=new r(t,a));return l.updateData(n.originalIndices,n.indexMappings),l},e.disposeItem=function(t,i,r){var n=e._pool[t.id],a=n[r];a[i].dispose(),a[i]=null},e.prototype.disposeData=function(t){var i=e._pool[t.id];for(var r in i)for(var n=i[r],a=n.length,s=0;a>s;s++)n[s].dispose(),n[s]=null;e._pool[t.id]=null},e._pool=new Object,e}();t.exports=n},{"awayjs-display/lib/base/SubGeometryBase":void 0,"awayjs-stagegl/lib/pool/VertexData":void 0}],"awayjs-stagegl/lib/pool/VertexData":[function(e,t){var i=e("awayjs-display/lib/base/SubGeometryBase"),r=e("awayjs-display/lib/events/SubGeometryEvent"),n=function(){function e(e,t){var i=this;this._dataDirty=!0,this.invalid=new Array(8),this.buffers=new Array(8),this.contexts=new Array(8),this._subGeometry=e,this._dataType=t,this._onVerticesUpdatedDelegate=function(e){return i._onVerticesUpdated(e)},this._subGeometry.addEventListener(r.VERTICES_UPDATED,this._onVerticesUpdatedDelegate)}return e.prototype.updateData=function(e,t){if(void 0===e&&(e=null),void 0===t&&(t=null),this._dataDirty){this._dataDirty=!1,this.dataPerVertex=this._subGeometry.getStride(this._dataType);var i=this._subGeometry[this._dataType];if(null==t)this.setData(i);else{for(var r,n,a=new Array(e.length*this.dataPerVertex),s=0,o=0;s<e.length;){for(r=e[s],n=t[r]*this.dataPerVertex,r*=this.dataPerVertex,o=0;o<this.dataPerVertex;o++)a[n+o]=i[r+o];s++}this.setData(a)}}},e.prototype.dispose=function(){for(var e=0;8>e;++e)this.contexts[e]&&(this.buffers[e].dispose(),this.buffers[e]=null,this.contexts[e]=null)},e.prototype.disposeBuffers=function(){for(var e=0;8>e;++e)this.buffers[e]&&(this.buffers[e].dispose(),this.buffers[e]=null)},e.prototype.invalidateBuffers=function(){for(var e=0;8>e;++e)this.invalid[e]=!0},e.prototype.setData=function(e){this.data&&this.data.length!=e.length?this.disposeBuffers():this.invalidateBuffers(),this.data=e},e.prototype._onVerticesUpdated=function(e){var t=this._subGeometry.concatenateArrays?i.VERTEX_DATA:e.dataType;t==this._dataType&&(this._dataDirty=!0)},e}();t.exports=n},{"awayjs-display/lib/base/SubGeometryBase":void 0,"awayjs-display/lib/events/SubGeometryEvent":void 0}],"awayjs-stagegl/lib/swfobject":[function(e,t){var i=function(){function e(){if(!X){try{var e=N.getElementsByTagName("body")[0].appendChild(y("span"));e.parentNode.removeChild(e)}catch(t){return}X=!0;for(var i=k.length,r=0;i>r;r++)k[r]()}}function t(e){X?e():k[k.length]=e}function r(e){if(typeof F.addEventListener!=R)F.addEventListener("load",e,!1);else if(typeof N.addEventListener!=R)N.addEventListener("load",e,!1);else if(typeof F.attachEvent!=R)b(F,"onload",e);else if("function"==typeof F.onload){var t=F.onload;F.onload=function(){t(),e()}}else F.onload=e}function n(){M?a():s()}function a(){var e=N.getElementsByTagName("body")[0],t=y(B);t.setAttribute("type",P);var i=e.appendChild(t);if(i){var r=0;!function(){if(typeof i.GetVariable!=R){var n=i.GetVariable("$version");n&&(n=n.split(" ")[1].split(","),$.pv=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)])}else if(10>r)return r++,void setTimeout(arguments.callee,10);e.removeChild(t),i=null,s()}()}else s()}function s(){var e=G.length;if(e>0)for(var t=0;e>t;t++){var i=G[t].id,r=G[t].callbackFn,n={success:!1,id:i};if($.pv[0]>0){var a=_(i);if(a)if(!m(G[t].swfVersion)||$.wk&&$.wk<312)if(G[t].expressInstall&&l()){var s={};s.data=G[t].expressInstall,s.width=a.getAttribute("width")||"0",s.height=a.getAttribute("height")||"0",a.getAttribute("class")&&(s.styleclass=a.getAttribute("class")),a.getAttribute("align")&&(s.align=a.getAttribute("align"));for(var h={},g=a.getElementsByTagName("param"),d=g.length,p=0;d>p;p++)"movie"!=g[p].getAttribute("name").toLowerCase()&&(h[g[p].getAttribute("name")]=g[p].getAttribute("value"));u(s,h,i,r)}else c(a),r&&r(n);else w(i,!0),r&&(n.success=!0,n.ref=o(i),r(n))}else if(w(i,!0),r){var f=o(i);f&&typeof f.SetVariable!=R&&(n.success=!0,n.ref=f),r(n)}}}function o(e){var t=null,i=_(e);if(i&&"OBJECT"==i.nodeName)if(typeof i.SetVariable!=R)t=i;else{var r=i.getElementsByTagName(B)[0];r&&(t=r)}return t}function l(){return!W&&m("6.0.65")&&($.win||$.mac)&&!($.wk&&$.wk<312)}function u(e,t,i,r){W=!0,S=r||null,A={success:!1,id:i};var n=_(i);if(n){"OBJECT"==n.nodeName?(E=h(n),T=null):(E=n,T=i),e.id=L,(typeof e.width==R||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==R||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),N.title=N.title.slice(0,47)+" - Flash Player Installation";var a=$.ie&&$.win?"ActiveX":"PlugIn",s="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+a+"&MMdoctitle="+N.title;if(typeof t.flashvars!=R?t.flashvars+="&"+s:t.flashvars=s,$.ie&&$.win&&4!=n.readyState){var o=y("div");i+="SWFObjectNew",o.setAttribute("id",i),n.parentNode.insertBefore(o,n),n.style.display="none",function(){4==n.readyState?n.parentNode.removeChild(n):setTimeout(arguments.callee,10)}()}g(e,t,i)}}function c(e){if($.ie&&$.win&&4!=e.readyState){var t=y("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(h(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(h(e),e)}function h(e){var t=y("div");if($.win&&$.ie)t.innerHTML=e.innerHTML;else{var i=e.getElementsByTagName(B)[0];if(i){var r=i.childNodes;if(r)for(var n=r.length,a=0;n>a;a++)1==r[a].nodeType&&"PARAM"==r[a].nodeName||8==r[a].nodeType||t.appendChild(r[a].cloneNode(!0))}}return t}function g(e,t,i){var r,n=_(i);if($.wk&&$.wk<312)return r;if(n)if(typeof e.id==R&&(e.id=i),$.ie&&$.win){var a="";for(var s in e)e[s]!=Object.prototype[s]&&("data"==s.toLowerCase()?t.movie=e[s]:"styleclass"==s.toLowerCase()?a+=' class="'+e[s]+'"':"classid"!=s.toLowerCase()&&(a+=" "+s+'="'+e[s]+'"'));var o="";for(var l in t)t[l]!=Object.prototype[l]&&(o+='<param name="'+l+'" value="'+t[l]+'" />');n.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+o+"</object>",V[V.length]=e.id,r=_(e.id)}else{var u=y(B);u.setAttribute("type",P);for(var c in e)e[c]!=Object.prototype[c]&&("styleclass"==c.toLowerCase()?u.setAttribute("class",e[c]):"classid"!=c.toLowerCase()&&u.setAttribute(c,e[c]));for(var h in t)t[h]!=Object.prototype[h]&&"movie"!=h.toLowerCase()&&d(u,h,t[h]);n.parentNode.replaceChild(u,n),r=u}return r}function d(e,t,i){var r=y("param");r.setAttribute("name",t),r.setAttribute("value",i),e.appendChild(r)}function p(e){var t=_(e);t&&"OBJECT"==t.nodeName&&($.ie&&$.win?(t.style.display="none",function(){4==t.readyState?f(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function f(e){var t=_(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}function _(e){var t=null;try{t=N.getElementById(e)}catch(i){}return t}function y(e){return N.createElement(e)}function b(e,t,i){e.attachEvent(t,i),z[z.length]=[e,t,i]}function m(e){var t=$.pv,i=e.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,t[0]>i[0]||t[0]==i[0]&&t[1]>i[1]||t[0]==i[0]&&t[1]==i[1]&&t[2]>=i[2]?!0:!1}function v(e,t,i,r){if(!$.ie||!$.mac){var n=N.getElementsByTagName("head")[0];if(n){var a=i&&"string"==typeof i?i:"screen";if(r&&(C=null,j=null),!C||j!=a){var s=y("style");s.setAttribute("type","text/css"),s.setAttribute("media",a),C=n.appendChild(s),$.ie&&$.win&&typeof N.styleSheets!=R&&N.styleSheets.length>0&&(C=N.styleSheets[N.styleSheets.length-1]),j=a}$.ie&&$.win?C&&typeof C.addRule==B&&C.addRule(e,t):C&&typeof N.createTextNode!=R&&C.appendChild(N.createTextNode(e+" {"+t+"}"))}}}function w(e,t){if(H){var i=t?"visible":"hidden";X&&_(e)?_(e).style.visibility=i:v("#"+e,"visibility:"+i)}}function x(e){var t=/[\\\"<>\.;]/,i=null!=t.exec(e);return i&&typeof encodeURIComponent!=R?encodeURIComponent(e):e}{var E,T,S,A,C,j,R="undefined",B="object",D="Shockwave Flash",I="ShockwaveFlash.ShockwaveFlash",P="application/x-shockwave-flash",L="SWFObjectExprInst",O="onreadystatechange",F=window,N=document,U=navigator,M=!1,k=[n],G=[],V=[],z=[],X=!1,W=!1,H=!0,$=function(){var e=typeof N.getElementById!=R&&typeof N.getElementsByTagName!=R&&typeof N.createElement!=R,t=U.userAgent.toLowerCase(),i=U.platform.toLowerCase(),r=/win/.test(i?i:t),n=/mac/.test(i?i:t),a=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,s=!1,o=[0,0,0],l=null;if(typeof U.plugins!=R&&typeof U.plugins[D]==B)l=U.plugins[D].description,!l||typeof U.mimeTypes!=R&&U.mimeTypes[P]&&!U.mimeTypes[P].enabledPlugin||(M=!0,s=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),o[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),o[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),o[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof F.ActiveXObject!=R)try{var u=new ActiveXObject(I);u&&(l=u.GetVariable("$version"),l&&(s=!0,l=l.split(" ")[1].split(","),o=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(c){}return{w3:e,pv:o,wk:a,ie:s,win:r,mac:n}}();!function(){$.w3&&((typeof N.readyState!=R&&"complete"==N.readyState||typeof N.readyState==R&&(N.getElementsByTagName("body")[0]||N.body))&&e(),X||(typeof N.addEventListener!=R&&N.addEventListener("DOMContentLoaded",e,!1),$.ie&&$.win&&(N.attachEvent(O,function(){"complete"==N.readyState&&(N.detachEvent(O,arguments.callee),e())}),F==top&&!function(){if(!X){try{N.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}e()}}()),$.wk&&!function(){return X?void 0:/loaded|complete/.test(N.readyState)?void e():void setTimeout(arguments.callee,0)}(),r(e)))}(),function(){$.ie&&$.win&&window.attachEvent("onunload",function(){for(var e=z.length,t=0;e>t;t++)z[t][0].detachEvent(z[t][1],z[t][2]);for(var r=V.length,n=0;r>n;n++)p(V[n]);for(var a in $)$[a]=null;$=null;for(var s in i)i[s]=null;i=null})}()}return{registerObject:function(e,t,i,r){if($.w3&&e&&t){var n={};n.id=e,n.swfVersion=t,n.expressInstall=i,n.callbackFn=r,G[G.length]=n,w(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){return $.w3?o(e):void 0},embedSWF:function(e,i,r,n,a,s,o,c,h,d){var p={success:!1,id:i};$.w3&&!($.wk&&$.wk<312)&&e&&i&&r&&n&&a?(w(i,!1),t(function(){r+="",n+="";var t={};if(h&&typeof h===B)for(var f in h)t[f]=h[f];t.data=e,t.width=r,t.height=n;var _={};if(c&&typeof c===B)for(var y in c)_[y]=c[y];if(o&&typeof o===B)for(var b in o)typeof _.flashvars!=R?_.flashvars+="&"+b+"="+o[b]:_.flashvars=b+"="+o[b];if(m(a)){var v=g(t,_,i);t.id==i&&w(i,!0),p.success=!0,p.ref=v}else{if(s&&l())return t.data=s,void u(t,_,i,d);w(i,!0)}d&&d(p)})):d&&d(p)},switchOffAutoHideShow:function(){H=!1},ua:$,getFlashPlayerVersion:function(){return{major:$.pv[0],minor:$.pv[1],release:$.pv[2]}},hasFlashPlayerVersion:m,createSWF:function(e,t,i){return $.w3?g(e,t,i):void 0},showExpressInstall:function(e,t,i,r){$.w3&&l()&&u(e,t,i,r)},removeSWF:function(e){$.w3&&p(e)},createCSS:function(e,t,i,r){$.w3&&v(e,t,i,r)},addDomLoadEvent:t,addLoadEvent:r,getQueryParamValue:function(e){var t=N.location.search||N.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return x(t);for(var i=t.split("&"),r=0;r<i.length;r++)if(i[r].substring(0,i[r].indexOf("="))==e)return x(i[r].substring(i[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(W){var e=_(L);e&&E&&(e.parentNode.replaceChild(E,e),T&&(w(T,!0),$.ie&&$.win&&(E.style.display="block")),S&&S(A)),W=!1}}}}();t.exports=i},{}]},{},[]);
//# sourceMappingURL=awayjs-stagegl.min.js.map