{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "awayjs-stagegl.js",
    "../index.ts",
    "lib/lib/aglsl/AGALTokenizer.ts",
    "lib/lib/aglsl/AGLSLParser.ts",
    "lib/lib/aglsl/Description.ts",
    "lib/lib/aglsl/Destination.ts",
    "lib/lib/aglsl/Header.ts",
    "lib/lib/aglsl/Mapping.ts",
    "lib/lib/aglsl/OpLUT.ts",
    "lib/lib/aglsl/Token.ts",
    "lib/aglsl/lib/aglsl/assembler/AGALMiniAssembler.ts",
    "lib/aglsl/lib/aglsl/assembler/FS.ts",
    "lib/aglsl/lib/aglsl/assembler/Flags.ts",
    "lib/aglsl/lib/aglsl/assembler/OpcodeMap.ts",
    "lib/aglsl/lib/aglsl/assembler/Opcode.ts",
    "lib/aglsl/lib/aglsl/assembler/Part.ts",
    "lib/aglsl/lib/aglsl/assembler/RegMap.ts",
    "lib/aglsl/lib/aglsl/assembler/SamplerMap.ts",
    "lib/aglsl/lib/aglsl/assembler/Sampler.ts",
    "lib/aglsl.ts",
    "lib/lib/attributes/GL_AttributesBuffer.ts",
    "lib/attributes.ts",
    "lib/lib/base/ContextGLBlendFactor.ts",
    "lib/lib/base/ContextGLClearMask.ts",
    "lib/lib/base/ContextGLCompareMode.ts",
    "lib/lib/base/ContextGLDrawMode.ts",
    "lib/lib/base/ContextGLMipFilter.ts",
    "lib/lib/base/ContextGLProfile.ts",
    "lib/lib/base/ContextGLProgramType.ts",
    "lib/lib/base/ContextGLStencilAction.ts",
    "lib/lib/base/ContextGLTextureFilter.ts",
    "lib/lib/base/ContextGLTextureFormat.ts",
    "lib/lib/base/ContextGLTriangleFace.ts",
    "lib/lib/base/ContextGLVertexBufferFormat.ts",
    "lib/lib/base/ContextGLWrapMode.ts",
    "lib/lib/base/ContextMode.ts",
    "lib/lib/base/ContextSoftware.ts",
    "lib/lib/base/ContextStage3D.ts",
    "lib/lib/base/ContextWebGL.ts",
    "lib/lib/base/CubeTextureFlash.ts",
    "lib/lib/base/CubeTextureWebGL.ts",
    "lib/lib/base/IndexBufferFlash.ts",
    "lib/lib/base/IndexBufferSoftware.ts",
    "lib/lib/base/IndexBufferWebGL.ts",
    "lib/lib/base/OpCodes.ts",
    "lib/lib/base/ProgramFlash.ts",
    "lib/lib/base/ProgramSoftware.ts",
    "lib/lib/base/ProgramVOSoftware.ts",
    "lib/lib/base/ProgramWebGL.ts",
    "lib/lib/base/ResourceBaseFlash.ts",
    "lib/lib/base/SamplerState.ts",
    "lib/lib/base/SoftwareSamplerState.ts",
    "lib/lib/base/Stage.ts",
    "lib/lib/base/TextureBaseWebGL.ts",
    "lib/lib/base/TextureFlash.ts",
    "lib/lib/base/TextureSoftware.ts",
    "lib/lib/base/TextureWebGL.ts",
    "lib/lib/base/VertexBufferFlash.ts",
    "lib/lib/base/VertexBufferSoftware.ts",
    "lib/lib/base/VertexBufferWebGL.ts",
    "lib/base.ts",
    "lib/lib/events/StageEvent.ts",
    "lib/events.ts",
    "lib/lib/image/GL_BitmapImage2D.ts",
    "lib/lib/image/GL_BitmapImageCube.ts",
    "lib/lib/image/GL_Image2D.ts",
    "lib/lib/image/GL_ImageBase.ts",
    "lib/lib/image/GL_ImageCube.ts",
    "lib/lib/image/GL_RenderImage2D.ts",
    "lib/lib/image/GL_RenderImageCube.ts",
    "lib/lib/image/GL_Sampler2D.ts",
    "lib/lib/image/GL_SamplerBase.ts",
    "lib/lib/image/GL_SamplerCube.ts",
    "lib/lib/image/ProgramDataPool.ts",
    "lib/lib/image/ProgramData.ts",
    "lib/image.ts",
    "lib/lib/managers/StageManager.ts",
    "lib/managers.ts"
  ],
  "names": [
    "require",
    "e",
    "t",
    "n",
    "r",
    "s",
    "o",
    "u",
    "a",
    "i",
    "f",
    "Error",
    "code",
    "l",
    "exports",
    "call",
    "length",
    1,
    "module",
    "aglsl",
    "attributes",
    "base",
    "events",
    "image",
    "library",
    "managers",
    "AttributesBuffer_1",
    "BitmapImage2D_1",
    "BitmapImageCube_1",
    "Image2D_1",
    "ImageCube_1",
    "SpecularImage2D_1",
    "Sampler2D_1",
    "SamplerCube_1",
    "Stage",
    "registerAbstraction",
    "GL_AttributesBuffer",
    "AttributesBuffer",
    "GL_RenderImage2D",
    "Image2D",
    "GL_RenderImageCube",
    "ImageCube",
    "GL_BitmapImage2D",
    "BitmapImage2D",
    "GL_BitmapImageCube",
    "BitmapImageCube",
    "SpecularImage2D",
    "GL_Sampler2D",
    "Sampler2D",
    "GL_SamplerCube",
    "SamplerCube",
    "./lib/aglsl",
    "./lib/attributes",
    "./lib/base",
    "./lib/events",
    "./lib/image",
    "./lib/library",
    "./lib/managers",
    "awayjs-core/lib/attributes/AttributesBuffer",
    "undefined",
    "awayjs-core/lib/image/BitmapImage2D",
    "awayjs-core/lib/image/BitmapImageCube",
    "awayjs-core/lib/image/Image2D",
    "awayjs-core/lib/image/ImageCube",
    "awayjs-core/lib/image/Sampler2D",
    "awayjs-core/lib/image/SamplerCube",
    "awayjs-core/lib/image/SpecularImage2D",
    "awayjs-stagegl/lib/aglsl/AGALTokenizer",
    "Description_1",
    "Header_1",
    "Mapping_1",
    "Token_1",
    "AGALTokenizer",
    "prototype",
    "decribeAGALByteArray",
    "bytes",
    "header",
    "Header",
    "readUnsignedByte",
    "version",
    "readUnsignedInt",
    "progid",
    "type",
    "desc",
    "Description",
    "tokens",
    "position",
    "token",
    "Token",
    "opcode",
    "lutentry",
    "Mapping",
    "agal2glsllut",
    "matrixheight",
    "hasmatrix",
    "dest",
    "regnum",
    "readUnsignedShort",
    "mask",
    "regtype",
    "regwrite",
    "this",
    "readReg",
    "b",
    "push",
    "mh",
    "indexoffset",
    "readByte",
    "swizzle",
    "regread",
    "lodbiad",
    "readmode",
    "dim",
    "special",
    "wrap",
    "mipmap",
    "filter",
    "samplers",
    "indexregtype",
    "indexselect",
    "indirectflag",
    "hasindirect",
    "mhi",
    "../aglsl/Description",
    "../aglsl/Header",
    "../aglsl/Mapping",
    "../aglsl/Token",
    "awayjs-stagegl/lib/aglsl/AGLSLParser",
    "AGLSLParser",
    "parse",
    "body",
    "tag",
    "constcount",
    "samptype",
    "writedepth",
    "derivatives",
    "indexOf",
    "sublines",
    "sl",
    "line",
    "destregstring",
    "regtostring",
    "destcaststring",
    "destmaskstring",
    "ndest",
    "replace",
    "dwm",
    "ndwm",
    "sourcetostring",
    "scalar",
    "texdim",
    "texsize",
    "texlod",
    "subline",
    "isscalar",
    "swiz",
    "realofs",
    "toString",
    "maxvertexconstants",
    "maxfragconstants",
    "maxtemp",
    "maxstreams",
    "maxtextures",
    "awayjs-stagegl/lib/aglsl/Description",
    "awayjs-stagegl/lib/aglsl/Destination",
    "Destination",
    "awayjs-stagegl/lib/aglsl/Header",
    "awayjs-stagegl/lib/aglsl/Mapping",
    "OpLUT_1",
    "include",
    "OpLUT",
    "../aglsl/OpLUT",
    "awayjs-stagegl/lib/aglsl/OpLUT",
    "flags",
    "matrixwidth",
    "scaler",
    "dm",
    "lod",
    "awayjs-stagegl/lib/aglsl/Token",
    "Destination_1",
    "../aglsl/Destination",
    "awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler",
    "OpcodeMap_1",
    "Part_1",
    "RegMap_1",
    "SamplerMap_1",
    "AGALMiniAssembler",
    "cur",
    "Part",
    "assemble",
    "source",
    "ext_part",
    "ext_version",
    "addHeader",
    "lines",
    "split",
    "processLine",
    "linenr",
    "startcomment",
    "search",
    "slice",
    "optsi",
    "opts",
    "match",
    "console",
    "log",
    "Number",
    "data",
    "name",
    "op",
    "OpcodeMap",
    "map",
    "emitOpcode",
    "ti",
    "emitDest",
    "emitZeroDword",
    "format",
    "emitSource",
    "emitZeroQword",
    "emitSampler",
    "emitHeader",
    "pr",
    "writeUnsignedByte",
    "writeUnsignedInt",
    "opdest",
    "reg",
    "RegMap",
    "em",
    "num",
    "stringToMask",
    "writeUnsignedShort",
    "stringToSwizzle",
    "chartoindex",
    "x",
    "y",
    "z",
    "w",
    "sw",
    "charAt",
    "opsrc",
    "parseInt",
    "samplerbits",
    "sampleroptset",
    "SamplerMap",
    "toLowerCase",
    "shift",
    "value",
    "indexed",
    "selindex",
    "select",
    "offset",
    "writeByte",
    "partname",
    "../../aglsl/assembler/OpcodeMap",
    "../../aglsl/assembler/Part",
    "../../aglsl/assembler/RegMap",
    "../../aglsl/assembler/SamplerMap",
    "awayjs-stagegl/lib/aglsl/assembler/FS",
    "FS",
    "awayjs-stagegl/lib/aglsl/assembler/Flags",
    "Flags",
    "awayjs-stagegl/lib/aglsl/assembler/OpcodeMap",
    "Opcode_1",
    "Object",
    "defineProperty",
    "get",
    "_map",
    "Array",
    "Opcode",
    "enumerable",
    "configurable",
    "../../aglsl/assembler/Opcode",
    "awayjs-stagegl/lib/aglsl/assembler/Opcode",
    "Flags_1",
    "FS_1",
    "aformat",
    "asize",
    "bformat",
    "bsize",
    "simple",
    "horizontal",
    "fragonly",
    "matrix",
    "size",
    "../../aglsl/assembler/FS",
    "../../aglsl/assembler/Flags",
    "awayjs-stagegl/lib/aglsl/assembler/Part",
    "ByteArray_1",
    "ByteArray",
    "awayjs-core/lib/utils/ByteArray",
    "awayjs-stagegl/lib/aglsl/assembler/RegMap",
    "Reg",
    "awayjs-stagegl/lib/aglsl/assembler/SamplerMap",
    "Sampler_1",
    "Sampler",
    "../../aglsl/assembler/Sampler",
    "awayjs-stagegl/lib/aglsl/assembler/Sampler",
    "awayjs-stagegl/lib/aglsl",
    "AGALMiniAssembler_1",
    "AGALTokenizer_1",
    "AGLSLParser_1",
    "./aglsl/AGALTokenizer",
    "./aglsl/AGLSLParser",
    "./aglsl/Description",
    "./aglsl/Destination",
    "./aglsl/Header",
    "./aglsl/Mapping",
    "./aglsl/OpLUT",
    "./aglsl/Token",
    "./aglsl/assembler/AGALMiniAssembler",
    "./aglsl/assembler/FS",
    "./aglsl/assembler/Flags",
    "./aglsl/assembler/Opcode",
    "./aglsl/assembler/OpcodeMap",
    "./aglsl/assembler/Part",
    "./aglsl/assembler/RegMap",
    "./aglsl/assembler/Sampler",
    "./aglsl/assembler/SamplerMap",
    "awayjs-stagegl/lib/attributes/GL_AttributesBuffer",
    "__extends",
    "d",
    "p",
    "hasOwnProperty",
    "__",
    "constructor",
    "create",
    "AbstractionBase_1",
    "_super",
    "attributesBuffer",
    "stage",
    "_stage",
    "_attributesBuffer",
    "onClear",
    "event",
    "_indexBuffer",
    "dispose",
    "_vertexBuffer",
    "activate",
    "index",
    "dimensions",
    "unsigned",
    "setVertexBuffer",
    "_getVertexBuffer",
    "draw",
    "mode",
    "firstIndex",
    "numIndices",
    "context",
    "drawIndices",
    "_getIndexBuffer",
    "_invalid",
    "createIndexBuffer",
    "count",
    "stride",
    "uploadFromByteArray",
    "buffer",
    "createVertexBuffer",
    "AbstractionBase",
    "awayjs-core/lib/library/AbstractionBase",
    "awayjs-stagegl/lib/attributes",
    "GL_AttributesBuffer_1",
    "./attributes/GL_AttributesBuffer",
    "awayjs-stagegl/lib/base/ContextGLBlendFactor",
    "ContextGLBlendFactor",
    "DESTINATION_ALPHA",
    "DESTINATION_COLOR",
    "ONE",
    "ONE_MINUS_DESTINATION_ALPHA",
    "ONE_MINUS_DESTINATION_COLOR",
    "ONE_MINUS_SOURCE_ALPHA",
    "ONE_MINUS_SOURCE_COLOR",
    "SOURCE_ALPHA",
    "SOURCE_COLOR",
    "ZERO",
    "awayjs-stagegl/lib/base/ContextGLClearMask",
    "ContextGLClearMask",
    "COLOR",
    "DEPTH",
    "STENCIL",
    "ALL",
    "awayjs-stagegl/lib/base/ContextGLCompareMode",
    "ContextGLCompareMode",
    "ALWAYS",
    "EQUAL",
    "GREATER",
    "GREATER_EQUAL",
    "LESS",
    "LESS_EQUAL",
    "NEVER",
    "NOT_EQUAL",
    "awayjs-stagegl/lib/base/ContextGLDrawMode",
    "ContextGLDrawMode",
    "TRIANGLES",
    "LINES",
    "awayjs-stagegl/lib/base/ContextGLMipFilter",
    "ContextGLMipFilter",
    "MIPLINEAR",
    "MIPNEAREST",
    "MIPNONE",
    "awayjs-stagegl/lib/base/ContextGLProfile",
    "ContextGLProfile",
    "BASELINE",
    "BASELINE_CONSTRAINED",
    "BASELINE_EXTENDED",
    "default",
    "awayjs-stagegl/lib/base/ContextGLProgramType",
    "ContextGLProgramType",
    "FRAGMENT",
    "SAMPLER",
    "VERTEX",
    "awayjs-stagegl/lib/base/ContextGLStencilAction",
    "ContextGLStencilAction",
    "DECREMENT_SATURATE",
    "DECREMENT_WRAP",
    "INCREMENT_SATURATE",
    "INCREMENT_WRAP",
    "INVERT",
    "KEEP",
    "SET",
    "awayjs-stagegl/lib/base/ContextGLTextureFilter",
    "ContextGLTextureFilter",
    "LINEAR",
    "NEAREST",
    "awayjs-stagegl/lib/base/ContextGLTextureFormat",
    "ContextGLTextureFormat",
    "BGRA",
    "BGRA_PACKED",
    "BGR_PACKED",
    "COMPRESSED",
    "COMPRESSED_ALPHA",
    "awayjs-stagegl/lib/base/ContextGLTriangleFace",
    "ContextGLTriangleFace",
    "BACK",
    "FRONT",
    "FRONT_AND_BACK",
    "NONE",
    "awayjs-stagegl/lib/base/ContextGLVertexBufferFormat",
    "ContextGLVertexBufferFormat",
    "FLOAT_1",
    "FLOAT_2",
    "FLOAT_3",
    "FLOAT_4",
    "BYTE_1",
    "BYTE_2",
    "BYTE_3",
    "BYTE_4",
    "UNSIGNED_BYTE_1",
    "UNSIGNED_BYTE_2",
    "UNSIGNED_BYTE_3",
    "UNSIGNED_BYTE_4",
    "SHORT_1",
    "SHORT_2",
    "SHORT_3",
    "SHORT_4",
    "UNSIGNED_SHORT_1",
    "UNSIGNED_SHORT_2",
    "UNSIGNED_SHORT_3",
    "UNSIGNED_SHORT_4",
    "awayjs-stagegl/lib/base/ContextGLWrapMode",
    "ContextGLWrapMode",
    "CLAMP",
    "REPEAT",
    "awayjs-stagegl/lib/base/ContextMode",
    "ContextMode",
    "AUTO",
    "WEBGL",
    "FLASH",
    "NATIVE",
    "SOFTWARE",
    "awayjs-stagegl/lib/base/ContextSoftware",
    "Matrix3D_1",
    "Matrix_1",
    "Point_1",
    "Vector3D_1",
    "Rectangle_1",
    "ColorUtils_1",
    "ContextGLBlendFactor_1",
    "ContextGLClearMask_1",
    "ContextGLCompareMode_1",
    "ContextGLProgramType_1",
    "ContextGLTriangleFace_1",
    "IndexBufferSoftware_1",
    "VertexBufferSoftware_1",
    "TextureSoftware_1",
    "ProgramSoftware_1",
    "SoftwareSamplerState_1",
    "ContextSoftware",
    "canvas",
    "_backBufferRect",
    "Rectangle",
    "_backBufferWidth",
    "_backBufferHeight",
    "_cullingMode",
    "_blendSource",
    "_blendDestination",
    "_colorMaskR",
    "_colorMaskG",
    "_colorMaskB",
    "_colorMaskA",
    "_writeDepth",
    "_depthCompareMode",
    "_screenMatrix",
    "Matrix3D",
    "_frontBufferMatrix",
    "Matrix",
    "_bboxMin",
    "Point",
    "_bboxMax",
    "_clamp",
    "_samplerStates",
    "_textures",
    "_vertexBuffers",
    "_vertexBufferOffsets",
    "_vertexBufferFormats",
    "_antialias",
    "_sx",
    "Vector3D",
    "_sy",
    "_u",
    "_canvas",
    "_backBufferColor",
    "_frontBuffer",
    "document",
    "appendChild",
    "getCanvas",
    "clear",
    "red",
    "green",
    "blue",
    "alpha",
    "depth",
    "stencil",
    "lock",
    "_colorClearUint32",
    "fill",
    "setPixels",
    "_colorClearUint8",
    "_zbuffer",
    "set",
    "_zbufferClear",
    "configureBackBuffer",
    "width",
    "height",
    "antiAlias",
    "enableDepthAndStencil",
    "Math",
    "floor",
    "_setSize",
    "len",
    "zbufferBytes",
    "ArrayBuffer",
    "Float32Array",
    "colorClearBuffer",
    "Uint8ClampedArray",
    "Uint32Array",
    "raw",
    "rawData",
    "transpose",
    "scale",
    "createCubeTexture",
    "optimizeForRenderToTexture",
    "streamingLevels",
    "IndexBufferSoftware",
    "createProgram",
    "ProgramSoftware",
    "createTexture",
    "TextureSoftware",
    "numVertices",
    "dataPerVertex",
    "VertexBufferSoftware",
    "setBlendFactors",
    "sourceFactor",
    "destinationFactor",
    "setColorMask",
    "setStencilActions",
    "triangleFace",
    "compareMode",
    "actionOnBothPass",
    "actionOnDepthFail",
    "actionOnDepthPassStencilFail",
    "coordinateSystem",
    "setStencilReferenceValue",
    "referenceValue",
    "readMask",
    "writeMask",
    "setCulling",
    "triangleFaceToCull",
    "setDepthTest",
    "depthMask",
    "passCompareMode",
    "setProgram",
    "program",
    "_program",
    "setProgramConstantsFromArray",
    "programType",
    "target",
    "_vertexConstants",
    "_fragmentConstants",
    "setTextureAt",
    "sampler",
    "texture",
    "setVertexBufferAt",
    "bufferOffset",
    "present",
    "unlock",
    "fillRect",
    "rect",
    "ColorUtils",
    "ARGBtoFloat32",
    "drawToBitmapImage2D",
    "destination",
    "indexBuffer",
    "position0",
    "position1",
    "position2",
    "varying0",
    "numVarying",
    "varying1",
    "varying2",
    "vertex",
    "startOffset",
    "_triangle",
    "drawVertices",
    "firstVertex",
    "setScissorRectangle",
    "rectangle",
    "setSamplerStateAt",
    "mipfilter",
    "state",
    "SoftwareSamplerState",
    "setRenderToTexture",
    "surfaceSelector",
    "setRenderToBackBuffer",
    "_putPixel",
    "argb",
    "BlendModeSoftware",
    "setPixelData",
    "clamp",
    "min",
    "max",
    "interpolate",
    "gradient",
    "p0",
    "isNaN",
    "error",
    "p1",
    "p2",
    "scaleBy",
    "project",
    "transformVector",
    "screen",
    "_barycentric",
    "screenRight",
    "screenBottom",
    "clip",
    "clipRight",
    "clipBottom",
    "fragDepth",
    "DepthCompareModeSoftware",
    "fragmentVO",
    "fragment",
    "discard",
    "outputColor",
    "getPixelData",
    "c",
    "crossProduct",
    "MAX_SAMPLERS",
    "destinationAlpha",
    "result",
    "destinationColor",
    "zero",
    "one",
    "oneMinusDestinationAlpha",
    "oneMinusDestinationColor",
    "oneMinusSourceAlpha",
    "oneMinusSourceColor",
    "sourceAlpha",
    "sourceColor",
    "always",
    "currentDepth",
    "equal",
    "greater",
    "greaterEqual",
    "less",
    "lessEqual",
    "never",
    "notEqual",
    "../base/ContextGLBlendFactor",
    "../base/ContextGLClearMask",
    "../base/ContextGLCompareMode",
    "../base/ContextGLProgramType",
    "../base/ContextGLTriangleFace",
    "../base/IndexBufferSoftware",
    "../base/ProgramSoftware",
    "../base/SoftwareSamplerState",
    "../base/TextureSoftware",
    "../base/VertexBufferSoftware",
    "awayjs-core/lib/geom/Matrix",
    "awayjs-core/lib/geom/Matrix3D",
    "awayjs-core/lib/geom/Point",
    "awayjs-core/lib/geom/Rectangle",
    "awayjs-core/lib/geom/Vector3D",
    "awayjs-core/lib/utils/ColorUtils",
    "awayjs-stagegl/lib/base/ContextStage3D",
    "CubeTextureFlash_1",
    "IndexBufferFlash_1",
    "OpCodes_1",
    "ProgramFlash_1",
    "TextureFlash_1",
    "VertexBufferFlash_1",
    "ContextStage3D",
    "container",
    "callback",
    "_cmdStream",
    "_resources",
    "swfVersionStr",
    "flashvars",
    "id",
    "params",
    "quality",
    "bgcolor",
    "allowscriptaccess",
    "allowfullscreen",
    "wmode",
    "_errorCheckingEnabled",
    "_iDriverInfo",
    "salign",
    "_oldCanvas",
    "cloneNode",
    "_oldParent",
    "parentNode",
    "context3dObj",
    "contexts",
    "callbackSWFObject",
    "callbackInfo",
    "success",
    "_container",
    "ref",
    "_iCallback",
    "addStream",
    "String",
    "fromCharCode",
    "OpCodes",
    "enableErrorChecking",
    "trueValue",
    "falseValue",
    "execute",
    "_iAddResource",
    "resource",
    "_iRemoveResource",
    "splice",
    "TextureFlash",
    "CubeTextureFlash",
    "clearTextureAt",
    "debug",
    "intMask",
    "drawTriangles",
    "startIndex",
    "numRegisters",
    "setProgramConstant",
    "ProgramFlash",
    "data32PerVertex",
    "VertexBufferFlash",
    "IndexBufferFlash",
    "_width",
    "_height",
    "clearVertexBufferAt",
    "clearRenderToTexture",
    "setScissorRect",
    "clearScissorRect",
    "disposeContext",
    "stream",
    "logStream",
    "mountain_js_context_available",
    "driverInfo",
    "ctx",
    "timeOutId",
    "window",
    "setTimeout",
    "clearTimeout",
    "../base/CubeTextureFlash",
    "../base/IndexBufferFlash",
    "../base/OpCodes",
    "../base/ProgramFlash",
    "../base/TextureFlash",
    "../base/VertexBufferFlash",
    "awayjs-stagegl/lib/base/ContextWebGL",
    "ContextGLDrawMode_1",
    "ContextGLMipFilter_1",
    "ContextGLStencilAction_1",
    "ContextGLTextureFilter_1",
    "ContextGLVertexBufferFormat_1",
    "ContextGLWrapMode_1",
    "CubeTextureWebGL_1",
    "IndexBufferWebGL_1",
    "ProgramWebGL_1",
    "TextureWebGL_1",
    "SamplerState_1",
    "VertexBufferWebGL_1",
    "ContextWebGL",
    "_blendFactorDictionary",
    "_drawModeDictionary",
    "_compareModeDictionary",
    "_stencilActionDictionary",
    "_textureIndexDictionary",
    "_textureTypeDictionary",
    "_wrapDictionary",
    "_filterDictionary",
    "_mipmapFilterDictionary",
    "_vertexBufferPropertiesDictionary",
    "_stencilReferenceValue",
    "_stencilReadMask",
    "_separateStencil",
    "_gl",
    "getContext",
    "premultipliedAlpha",
    "getExtension",
    "_standardDerivatives",
    "DST_ALPHA",
    "DST_COLOR",
    "ONE_MINUS_DST_ALPHA",
    "ONE_MINUS_DST_COLOR",
    "ONE_MINUS_SRC_ALPHA",
    "ONE_MINUS_SRC_COLOR",
    "SRC_ALPHA",
    "SRC_COLOR",
    "GEQUAL",
    "LEQUAL",
    "NOTEQUAL",
    "DECR",
    "DECR_WRAP",
    "INCR",
    "INCR_WRAP",
    "REPLACE",
    "TEXTURE0",
    "TEXTURE1",
    "TEXTURE2",
    "TEXTURE3",
    "TEXTURE4",
    "TEXTURE5",
    "TEXTURE6",
    "TEXTURE7",
    "TEXTURE_2D",
    "TEXTURE_CUBE_MAP",
    "CLAMP_TO_EDGE",
    "LINEAR_MIPMAP_NEAREST",
    "LINEAR_MIPMAP_LINEAR",
    "NEAREST_MIPMAP_NEAREST",
    "NEAREST_MIPMAP_LINEAR",
    "VertexBufferProperties",
    "FLOAT",
    "BYTE",
    "UNSIGNED_BYTE",
    "SHORT",
    "UNSIGNED_SHORT",
    "_stencilCompareMode",
    "_stencilCompareModeBack",
    "_stencilCompareModeFront",
    "alert",
    "SamplerState",
    "gl",
    "_drawing",
    "updateBlendStatus",
    "glmask",
    "COLOR_BUFFER_BIT",
    "STENCIL_BUFFER_BIT",
    "DEPTH_BUFFER_BIT",
    "clearColor",
    "clearDepth",
    "clearStencil",
    "enable",
    "STENCIL_TEST",
    "DEPTH_TEST",
    "viewport",
    "CubeTextureWebGL",
    "IndexBufferWebGL",
    "ProgramWebGL",
    "TextureWebGL",
    "VertexBufferWebGL",
    "pixels",
    "readPixels",
    "RGBA",
    "bindBuffer",
    "ELEMENT_ARRAY_BUFFER",
    "glBuffer",
    "drawElements",
    "drawArrays",
    "_blendEnabled",
    "_blendSourceFactor",
    "_blendDestinationFactor",
    "colorMask",
    "disable",
    "CULL_FACE",
    "cullFace",
    "translateTriangleFace",
    "depthFunc",
    "compareModeGL",
    "fail",
    "zFail",
    "pass",
    "stencilFunc",
    "stencilOp",
    "stencilFuncSeparate",
    "stencilOpSeparate",
    "stencilMask",
    "_currentProgram",
    "focusProgram",
    "uniform4fv",
    "getUniformLocation",
    "SCISSOR_TEST",
    "scissor",
    "samplerState",
    "_activeTexture",
    "activeTexture",
    "bindTexture",
    "textureType",
    "glTexture",
    "uniform1i",
    "texParameteri",
    "TEXTURE_WRAP_S",
    "TEXTURE_WRAP_T",
    "TEXTURE_MAG_FILTER",
    "TEXTURE_MIN_FILTER",
    "location",
    "getAttribLocation",
    "disableVertexAttribArray",
    "_currentArrayBuffer",
    "ARRAY_BUFFER",
    "properties",
    "enableVertexAttribArray",
    "vertexAttribPointer",
    "normalized",
    "frameBuffer",
    "bindFramebuffer",
    "FRAMEBUFFER",
    "BLEND",
    "blendEquation",
    "FUNC_ADD",
    "blendFunc",
    "modulo",
    "../base/ContextGLDrawMode",
    "../base/ContextGLMipFilter",
    "../base/ContextGLStencilAction",
    "../base/ContextGLTextureFilter",
    "../base/ContextGLVertexBufferFormat",
    "../base/ContextGLWrapMode",
    "../base/CubeTextureWebGL",
    "../base/IndexBufferWebGL",
    "../base/ProgramWebGL",
    "../base/SamplerState",
    "../base/TextureWebGL",
    "../base/VertexBufferWebGL",
    "awayjs-stagegl/lib/base/CubeTextureFlash",
    "ByteArrayBase_1",
    "ResourceBaseFlash_1",
    "forRTT",
    "streaming",
    "_context",
    "_size",
    "initCubeTexture",
    "_pId",
    "disposeCubeTexture",
    "uploadFromData",
    "side",
    "miplevel",
    "HTMLImageElement",
    "can",
    "createElement",
    "h",
    "drawImage",
    "getImageData",
    "pos",
    "ByteArrayBase",
    "internalGetBase64String",
    "uploadBytesCubeTexture",
    "uploadCompressedTextureFromByteArray",
    "byteArrayOffset",
    "async",
    "ResourceBaseFlash",
    "../base/ResourceBaseFlash",
    "awayjs-core/lib/utils/ByteArrayBase",
    "awayjs-stagegl/lib/base/CubeTextureWebGL",
    "TextureBaseWebGL_1",
    "_textureSelectorDictionary",
    "_texture",
    "TEXTURE_CUBE_MAP_POSITIVE_X",
    "TEXTURE_CUBE_MAP_NEGATIVE_X",
    "TEXTURE_CUBE_MAP_POSITIVE_Y",
    "TEXTURE_CUBE_MAP_NEGATIVE_Y",
    "TEXTURE_CUBE_MAP_POSITIVE_Z",
    "TEXTURE_CUBE_MAP_NEGATIVE_Z",
    "deleteTexture",
    "texImage2D",
    "TextureBaseWebGL",
    "../base/TextureBaseWebGL",
    "awayjs-stagegl/lib/base/IContextGL",
    "awayjs-stagegl/lib/base/ICubeTexture",
    "awayjs-stagegl/lib/base/IIndexBuffer",
    "awayjs-stagegl/lib/base/IProgram",
    "awayjs-stagegl/lib/base/ITextureBase",
    "awayjs-stagegl/lib/base/ITexture",
    "awayjs-stagegl/lib/base/IVertexBuffer",
    "awayjs-stagegl/lib/base/IndexBufferFlash",
    "_numIndices",
    "initIndexBuffer",
    "uploadFromArray",
    "uploadArrayIndexBuffer",
    "join",
    "disposeIndexBuffer",
    "awayjs-stagegl/lib/base/IndexBufferSoftware",
    "_startOffset",
    "_data",
    "Uint16Array",
    "awayjs-stagegl/lib/base/IndexBufferWebGL",
    "_buffer",
    "createBuffer",
    "bufferSubData",
    "bufferData",
    "STATIC_DRAW",
    "deleteBuffer",
    "awayjs-stagegl/lib/base/OpCodes",
    "initProgram",
    "initVertexBuffer",
    "uploadArrayVertexBuffer",
    "uploadAGALBytesProgram",
    "uploadBytesIndexBuffer",
    "uploadBytesVertexBuffer",
    "disposeProgram",
    "disposeVertexBuffer",
    "initTexture",
    "uploadBytesTexture",
    "disposeTexture",
    "awayjs-stagegl/lib/base/ProgramFlash",
    "ContextStage3D_1",
    "upload",
    "vertexProgram",
    "fragmentProgram",
    "readBase64String",
    "../base/ContextStage3D",
    "awayjs-stagegl/lib/base/ProgramSoftware",
    "ProgramVOSoftware_1",
    "_numVarying",
    "_vertexDescr",
    "_tokenizer",
    "_vertexVO",
    "ProgramVOSoftware",
    "temp",
    "_fragmentDescr",
    "_fragmentVO",
    "varying",
    "derivativeX",
    "derivativeY",
    "vertexIndex",
    "j",
    "numAttributes",
    "attributesPerVertex",
    "uintData",
    "numTemp",
    "outputPosition",
    "_opCodeFunc",
    "outputDepth",
    "varyingDerivatives",
    "getMipLevelsCount",
    "getDestTarget",
    "vo",
    "getSourceTarget",
    "mov",
    "source1",
    "source2",
    "targetReg",
    "source1Reg",
    "source1Target",
    "m44",
    "source2Reg",
    "source2Target",
    "sample",
    "textureIndex",
    "v",
    "_defaultSamplerState",
    "repeat",
    "dux",
    "abs",
    "dvx",
    "duy",
    "dvy",
    "lambda",
    "sqrt",
    "LN2",
    "miplevelLow",
    "miplevelHigh",
    "ceil",
    "maxmiplevel",
    "mipblend",
    "resultLow",
    "resultHigh",
    "dataLow",
    "getData",
    "dataLowWidth",
    "pow",
    "dataLowHeight",
    "dataHigh",
    "dataHighWidth",
    "dataHighHeight",
    "sampleBilinear",
    "sampleNearest",
    "interpolateColor",
    "textureData",
    "textureWidth",
    "textureHeight",
    "g",
    "texelSizeX",
    "texelSizeY",
    "color00",
    "color10",
    "color01",
    "color11",
    "interColor0",
    "interColor1",
    "tex",
    "color",
    "add",
    "source1Swizzle",
    "source2Swizzle",
    "sub",
    "mul",
    "div",
    "rcp",
    "frc",
    "sqt",
    "rsq",
    "exp",
    "nrm",
    "sin",
    "cos",
    "crs",
    "source1TargetX",
    "source1TargetY",
    "source1TargetZ",
    "source2TargetX",
    "source2TargetY",
    "source2TargetZ",
    "dp3",
    "dp4",
    "source1TargetW",
    "source2TargetW",
    "neg",
    "sat",
    "m33",
    "m34",
    "ddx",
    "ddy",
    "sge",
    "slt",
    "seq",
    "sne",
    "sgn",
    "kil",
    "../aglsl/AGALTokenizer",
    "../base/ProgramVOSoftware",
    "awayjs-stagegl/lib/base/ProgramVOSoftware",
    "awayjs-stagegl/lib/base/ProgramWebGL",
    "_uniforms",
    "_attribs",
    "vertexString",
    "_aglslParser",
    "fragmentString",
    "_vertexShader",
    "createShader",
    "VERTEX_SHADER",
    "_fragmentShader",
    "FRAGMENT_SHADER",
    "shaderSource",
    "compileShader",
    "getShaderParameter",
    "COMPILE_STATUS",
    "getShaderInfoLog",
    "attachShader",
    "linkProgram",
    "getProgramParameter",
    "LINK_STATUS",
    "getProgramInfoLog",
    "_uniformLocationNameDictionary",
    "deleteProgram",
    "useProgram",
    "../aglsl/AGLSLParser",
    "awayjs-stagegl/lib/base/ResourceBaseFlash",
    "awayjs-stagegl/lib/base/SamplerState",
    "awayjs-stagegl/lib/base/SoftwareSamplerState",
    "./ContextGLMipFilter",
    "./ContextGLTextureFilter",
    "./ContextGLWrapMode",
    "awayjs-stagegl/lib/base/Stage",
    "EventDispatcher_1",
    "CSS_1",
    "ContextMode_1",
    "ContextWebGL_1",
    "ContextSoftware_1",
    "StageEvent_1",
    "ProgramDataPool_1",
    "stageIndex",
    "stageManager",
    "forceSoftware",
    "profile",
    "_this",
    "_abstractionPool",
    "_programData",
    "_x",
    "_y",
    "_stageIndex",
    "_antiAlias",
    "_renderTarget",
    "_renderSurfaceSelector",
    "_initialised",
    "_bufferFormatDictionary",
    "globalDisableMipmap",
    "globalDisableSmooth",
    "_programDataPool",
    "ProgramDataPool",
    "addEventListener",
    "onContextLost",
    "onContextRestored",
    "_stageManager",
    "_viewPort",
    "_enableDepthAndStencil",
    "CSS",
    "setElementX",
    "setElementY",
    "visible",
    "getProgramData",
    "getItem",
    "setRenderTarget",
    "getAbstraction",
    "asset",
    "_abstractionClassPool",
    "assetType",
    "clearAbstraction",
    "gl_assetClass",
    "assetClass",
    "requestContext",
    "_usesSoftwareRendering",
    "_profile",
    "_callback",
    "dispatchEvent",
    "StageEvent",
    "STAGE_ERROR",
    "val",
    "setElementWidth",
    "_backBufferDirty",
    "notifyViewportUpdated",
    "setElementHeight",
    "getElementVisibility",
    "setElementVisibility",
    "_viewportDirty",
    "VIEWPORT_UPDATED",
    "iRemoveStage",
    "freeContext",
    "backBufferWidth",
    "backBufferHeight",
    "_color",
    "_bufferClear",
    "_scissorRect",
    "newBufferClear",
    "registerProgram",
    "programData",
    "unRegisterProgram",
    "CONTEXT_DISPOSED",
    "recoverFromDisposal",
    "CONTEXT_RECREATED",
    "CONTEXT_CREATED",
    "setSamplerState",
    "smooth",
    "EventDispatcher",
    "../base/ContextMode",
    "../base/ContextSoftware",
    "../base/ContextWebGL",
    "../events/StageEvent",
    "../image/ProgramDataPool",
    "awayjs-core/lib/events/EventDispatcher",
    "awayjs-core/lib/utils/CSS",
    "awayjs-stagegl/lib/base/TextureBaseWebGL",
    "AbstractMethodError_1",
    "AbstractMethodError",
    "awayjs-core/lib/errors/AbstractMethodError",
    "awayjs-stagegl/lib/base/TextureFlash",
    "awayjs-stagegl/lib/base/TextureSoftware",
    "_mipLevels",
    "awayjs-stagegl/lib/base/TextureWebGL",
    "_glTexture",
    "_frameBuffer",
    "createFramebuffer",
    "renderBuffer",
    "createRenderbuffer",
    "bindRenderbuffer",
    "RENDERBUFFER",
    "renderbufferStorage",
    "DEPTH_STENCIL",
    "framebufferTexture2D",
    "COLOR_ATTACHMENT0",
    "framebufferRenderbuffer",
    "DEPTH_STENCIL_ATTACHMENT",
    "ext",
    "generateMipmaps",
    "awayjs-stagegl/lib/base/VertexBufferFlash",
    "_numVertices",
    "_dataPerVertex",
    "startVertex",
    "awayjs-stagegl/lib/base/VertexBufferSoftware",
    "vertices",
    "_floatData",
    "_uintData",
    "Uint8Array",
    "awayjs-stagegl/lib/base/VertexBufferWebGL",
    "awayjs-stagegl/lib/base",
    "ContextGLProfile_1",
    "ContextGLTextureFormat_1",
    "Stage_1",
    "./base/ContextGLBlendFactor",
    "./base/ContextGLClearMask",
    "./base/ContextGLCompareMode",
    "./base/ContextGLDrawMode",
    "./base/ContextGLMipFilter",
    "./base/ContextGLProfile",
    "./base/ContextGLProgramType",
    "./base/ContextGLStencilAction",
    "./base/ContextGLTextureFilter",
    "./base/ContextGLTextureFormat",
    "./base/ContextGLTriangleFace",
    "./base/ContextGLVertexBufferFormat",
    "./base/ContextGLWrapMode",
    "./base/ContextMode",
    "./base/ContextSoftware",
    "./base/ContextStage3D",
    "./base/ContextWebGL",
    "./base/CubeTextureFlash",
    "./base/CubeTextureWebGL",
    "./base/IndexBufferFlash",
    "./base/IndexBufferSoftware",
    "./base/IndexBufferWebGL",
    "./base/OpCodes",
    "./base/ProgramFlash",
    "./base/ProgramSoftware",
    "./base/ProgramVOSoftware",
    "./base/ProgramWebGL",
    "./base/ResourceBaseFlash",
    "./base/SamplerState",
    "./base/SoftwareSamplerState",
    "./base/Stage",
    "./base/TextureBaseWebGL",
    "./base/TextureFlash",
    "./base/TextureSoftware",
    "./base/TextureWebGL",
    "./base/VertexBufferFlash",
    "./base/VertexBufferSoftware",
    "./base/VertexBufferWebGL",
    "awayjs-stagegl/lib/events/StageEvent",
    "EventBase_1",
    "clone",
    "EventBase",
    "awayjs-core/lib/events/EventBase",
    "awayjs-stagegl/lib/events",
    "./events/StageEvent",
    "awayjs-stagegl/lib/image/GL_BitmapImage2D",
    "MipmapGenerator_1",
    "GL_Image2D_1",
    "apply",
    "arguments",
    "_createTexture",
    "_mipmap",
    "mipmapData",
    "_mipmapData",
    "MipmapGenerator",
    "_generateMipMaps",
    "_asset",
    "_freeMipMapHolder",
    "GL_Image2D",
    "../image/GL_Image2D",
    "awayjs-core/lib/utils/MipmapGenerator",
    "awayjs-stagegl/lib/image/GL_BitmapImageCube",
    "GL_ImageCube_1",
    "_mipmapDataArray",
    "GL_ImageCube",
    "../image/GL_ImageCube",
    "awayjs-stagegl/lib/image/GL_Image2D",
    "GL_ImageBase_1",
    "GL_ImageBase",
    "../base/ContextGLTextureFormat",
    "../image/GL_ImageBase",
    "awayjs-stagegl/lib/image/GL_ImageBase",
    "usages",
    "awayjs-stagegl/lib/image/GL_ImageCube",
    "awayjs-stagegl/lib/image/GL_RenderImage2D",
    "awayjs-stagegl/lib/image/GL_RenderImageCube",
    "awayjs-stagegl/lib/image/GL_Sampler2D",
    "GL_SamplerBase_1",
    "_sampler",
    "GL_SamplerBase",
    "../image/GL_SamplerBase",
    "awayjs-stagegl/lib/image/GL_SamplerBase",
    "awayjs-stagegl/lib/image/GL_SamplerCube",
    "awayjs-stagegl/lib/image/ProgramDataPool",
    "ProgramData_1",
    "_pool",
    "key",
    "ProgramData",
    "disposeItem",
    "../image/ProgramData",
    "awayjs-stagegl/lib/image/ProgramData",
    "pool",
    "PROGRAMDATA_ID_COUNT",
    "awayjs-stagegl/lib/image",
    "GL_BitmapImage2D_1",
    "GL_BitmapImageCube_1",
    "GL_RenderImage2D_1",
    "GL_RenderImageCube_1",
    "GL_Sampler2D_1",
    "GL_SamplerCube_1",
    "./image/GL_BitmapImage2D",
    "./image/GL_BitmapImageCube",
    "./image/GL_Image2D",
    "./image/GL_ImageBase",
    "./image/GL_ImageCube",
    "./image/GL_RenderImage2D",
    "./image/GL_RenderImageCube",
    "./image/GL_Sampler2D",
    "./image/GL_SamplerBase",
    "./image/GL_SamplerCube",
    "./image/ProgramData",
    "./image/ProgramDataPool",
    "awayjs-stagegl/lib/library/GL_IAssetClass",
    "awayjs-stagegl/lib/library",
    "awayjs-stagegl/lib/managers/StageManager",
    "ArgumentError_1",
    "StageManager",
    "_stages",
    "STAGE_MAX_QUANTITY",
    "_onContextCreatedDelegate",
    "onContextCreated",
    "getInstance",
    "_instance",
    "getStageAt",
    "ArgumentError",
    "_numStages",
    "removeEventListener",
    "getFreeStage",
    "../base/Stage",
    "awayjs-core/lib/errors/ArgumentError",
    "awayjs-stagegl/lib/managers",
    "StageManager_1",
    "./managers/StageManager"
  ],
  "mappings": "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",
  "file": "awayjs-stagegl.min.js",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n\"use strict\";\nvar aglsl = require(\"./lib/aglsl\");\nexports.aglsl = aglsl;\nvar attributes = require(\"./lib/attributes\");\nexports.attributes = attributes;\nvar base = require(\"./lib/base\");\nexports.base = base;\nvar events = require(\"./lib/events\");\nexports.events = events;\nvar image = require(\"./lib/image\");\nexports.image = image;\nvar library = require(\"./lib/library\");\nexports.library = library;\nvar managers = require(\"./lib/managers\");\nexports.managers = managers;\nvar AttributesBuffer_1 = require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nvar BitmapImage2D_1 = require(\"awayjs-core/lib/image/BitmapImage2D\");\nvar BitmapImageCube_1 = require(\"awayjs-core/lib/image/BitmapImageCube\");\nvar Image2D_1 = require(\"awayjs-core/lib/image/Image2D\");\nvar ImageCube_1 = require(\"awayjs-core/lib/image/ImageCube\");\nvar SpecularImage2D_1 = require(\"awayjs-core/lib/image/SpecularImage2D\");\nvar Sampler2D_1 = require(\"awayjs-core/lib/image/Sampler2D\");\nvar SamplerCube_1 = require(\"awayjs-core/lib/image/SamplerCube\");\nbase.Stage.registerAbstraction(attributes.GL_AttributesBuffer, AttributesBuffer_1.AttributesBuffer);\nbase.Stage.registerAbstraction(image.GL_RenderImage2D, Image2D_1.Image2D);\nbase.Stage.registerAbstraction(image.GL_RenderImageCube, ImageCube_1.ImageCube);\nbase.Stage.registerAbstraction(image.GL_BitmapImage2D, BitmapImage2D_1.BitmapImage2D);\nbase.Stage.registerAbstraction(image.GL_BitmapImageCube, BitmapImageCube_1.BitmapImageCube);\nbase.Stage.registerAbstraction(image.GL_BitmapImage2D, SpecularImage2D_1.SpecularImage2D);\nbase.Stage.registerAbstraction(image.GL_Sampler2D, Sampler2D_1.Sampler2D);\nbase.Stage.registerAbstraction(image.GL_SamplerCube, SamplerCube_1.SamplerCube);\n\n},{\"./lib/aglsl\":\"awayjs-stagegl/lib/aglsl\",\"./lib/attributes\":\"awayjs-stagegl/lib/attributes\",\"./lib/base\":\"awayjs-stagegl/lib/base\",\"./lib/events\":\"awayjs-stagegl/lib/events\",\"./lib/image\":\"awayjs-stagegl/lib/image\",\"./lib/library\":\"awayjs-stagegl/lib/library\",\"./lib/managers\":\"awayjs-stagegl/lib/managers\",\"awayjs-core/lib/attributes/AttributesBuffer\":undefined,\"awayjs-core/lib/image/BitmapImage2D\":undefined,\"awayjs-core/lib/image/BitmapImageCube\":undefined,\"awayjs-core/lib/image/Image2D\":undefined,\"awayjs-core/lib/image/ImageCube\":undefined,\"awayjs-core/lib/image/Sampler2D\":undefined,\"awayjs-core/lib/image/SamplerCube\":undefined,\"awayjs-core/lib/image/SpecularImage2D\":undefined}],\"awayjs-stagegl/lib/aglsl/AGALTokenizer\":[function(require,module,exports){\n\"use strict\";\nvar Description_1 = require(\"../aglsl/Description\");\nvar Header_1 = require(\"../aglsl/Header\");\nvar Mapping_1 = require(\"../aglsl/Mapping\");\nvar Token_1 = require(\"../aglsl/Token\");\nvar AGALTokenizer = (function () {\n    function AGALTokenizer() {\n    }\n    AGALTokenizer.prototype.decribeAGALByteArray = function (bytes) {\n        var header = new Header_1.Header();\n        if (bytes.readUnsignedByte() != 0xa0) {\n            throw \"Bad AGAL: Missing 0xa0 magic byte.\";\n        }\n        header.version = bytes.readUnsignedInt();\n        if (header.version >= 0x10) {\n            bytes.readUnsignedByte();\n            header.version >>= 1;\n        }\n        if (bytes.readUnsignedByte() != 0xa1) {\n            throw \"Bad AGAL: Missing 0xa1 magic byte.\";\n        }\n        header.progid = bytes.readUnsignedByte();\n        switch (header.progid) {\n            case 1:\n                header.type = \"fragment\";\n                break;\n            case 0:\n                header.type = \"vertex\";\n                break;\n            case 2:\n                header.type = \"cpu\";\n                break;\n            default:\n                header.type = \"\";\n                break;\n        }\n        var desc = new Description_1.Description();\n        var tokens = [];\n        while (bytes.position < bytes.length) {\n            var token = new Token_1.Token();\n            token.opcode = bytes.readUnsignedInt();\n            var lutentry = Mapping_1.Mapping.agal2glsllut[token.opcode];\n            if (!lutentry) {\n                throw \"Opcode not valid or not implemented yet: \" + token.opcode;\n            }\n            if (lutentry.matrixheight) {\n                desc.hasmatrix = true;\n            }\n            if (lutentry.dest) {\n                token.dest.regnum = bytes.readUnsignedShort();\n                token.dest.mask = bytes.readUnsignedByte();\n                token.dest.regtype = bytes.readUnsignedByte();\n                desc.regwrite[token.dest.regtype][token.dest.regnum] |= token.dest.mask;\n            }\n            else {\n                token.dest = null;\n                bytes.readUnsignedInt();\n            }\n            if (lutentry.a) {\n                this.readReg(token.a, 1, desc, bytes);\n            }\n            else {\n                token.a = null;\n                bytes.readUnsignedInt();\n                bytes.readUnsignedInt();\n            }\n            if (lutentry.b) {\n                this.readReg(token.b, lutentry.matrixheight | 0, desc, bytes);\n            }\n            else {\n                token.b = null;\n                bytes.readUnsignedInt();\n                bytes.readUnsignedInt();\n            }\n            tokens.push(token);\n        }\n        desc.header = header;\n        desc.tokens = tokens;\n        return desc;\n    };\n    AGALTokenizer.prototype.readReg = function (s, mh, desc, bytes) {\n        s.regnum = bytes.readUnsignedShort();\n        s.indexoffset = bytes.readByte();\n        s.swizzle = bytes.readUnsignedByte();\n        s.regtype = bytes.readUnsignedByte();\n        desc.regread[s.regtype][s.regnum] = 0xf; // sould be swizzle to mask? should be |=                                                 \n        if (s.regtype == 0x5) {\n            // sampler\n            s.lodbiad = s.indexoffset;\n            s.indexoffset = undefined;\n            s.swizzle = undefined;\n            // sampler \n            s.readmode = bytes.readUnsignedByte();\n            s.dim = s.readmode >> 4;\n            s.readmode &= 0xf;\n            s.special = bytes.readUnsignedByte();\n            s.wrap = s.special >> 4;\n            s.special &= 0xf;\n            s.mipmap = bytes.readUnsignedByte();\n            s.filter = s.mipmap >> 4;\n            s.mipmap &= 0xf;\n            desc.samplers[s.regnum] = s;\n        }\n        else {\n            s.indexregtype = bytes.readUnsignedByte();\n            s.indexselect = bytes.readUnsignedByte();\n            s.indirectflag = bytes.readUnsignedByte();\n        }\n        if (s.indirectflag) {\n            desc.hasindirect = true;\n        }\n        if (!s.indirectflag && mh) {\n            for (var mhi = 0; mhi < mh; mhi++) {\n                desc.regread[s.regtype][s.regnum + mhi] = desc.regread[s.regtype][s.regnum];\n            }\n        }\n    };\n    return AGALTokenizer;\n}());\nexports.AGALTokenizer = AGALTokenizer;\n\n},{\"../aglsl/Description\":\"awayjs-stagegl/lib/aglsl/Description\",\"../aglsl/Header\":\"awayjs-stagegl/lib/aglsl/Header\",\"../aglsl/Mapping\":\"awayjs-stagegl/lib/aglsl/Mapping\",\"../aglsl/Token\":\"awayjs-stagegl/lib/aglsl/Token\"}],\"awayjs-stagegl/lib/aglsl/AGLSLParser\":[function(require,module,exports){\n\"use strict\";\nvar Mapping_1 = require(\"../aglsl/Mapping\");\nvar AGLSLParser = (function () {\n    function AGLSLParser() {\n    }\n    AGLSLParser.prototype.parse = function (desc) {\n        var header = \"\";\n        var body = \"\";\n        header += \"precision highp float;\\n\";\n        var tag = desc.header.type[0]; //TODO\n        // declare uniforms\n        if (desc.header.type == \"vertex\") {\n            header += \"uniform float yflip;\\n\";\n        }\n        // if (!desc.hasindirect) {\n        // \tfor (var i:number = 0; i < desc.regread[0x1].length; i++) {\n        // \t\tif (desc.regread[0x1][i]) {\n        // \t\t\theader += \"uniform vec4 \" + tag + \"c\" + i + \";\\n\";\n        // \t\t}\n        // \t}\n        // } else {\n        // \theader += \"uniform vec4 \" + tag + \"carrr[\" + AGLSLParser.maxvertexconstants + \"];\\n\";                // use max const count instead\n        // }\n        var constcount = desc.regread[0x1].length;\n        if (constcount > 0)\n            header += \"uniform vec4 \" + tag + \"c[\" + constcount + \"];\\n\";\n        // declare temps\n        for (var i = 0; i < desc.regread[0x2].length || i < desc.regwrite[0x2].length; i++) {\n            if (desc.regread[0x2][i] || desc.regwrite[0x2][i]) {\n                header += \"vec4 \" + tag + \"t\" + i + \";\\n\";\n            }\n        }\n        // declare streams\n        for (var i = 0; i < desc.regread[0x0].length; i++) {\n            if (desc.regread[0x0][i]) {\n                header += \"attribute vec4 va\" + i + \";\\n\";\n            }\n        }\n        // declare interpolated\n        for (var i = 0; i < desc.regread[0x4].length || i < desc.regwrite[0x4].length; i++) {\n            if (desc.regread[0x4][i] || desc.regwrite[0x4][i]) {\n                header += \"varying vec4 vi\" + i + \";\\n\";\n            }\n        }\n        // declare samplers\n        var samptype = [\"2D\", \"Cube\", \"3D\", \"\"];\n        for (var i = 0; i < desc.samplers.length; i++) {\n            if (desc.samplers[i]) {\n                header += \"uniform sampler\" + samptype[desc.samplers[i].dim & 3] + \" fs\" + i + \";\\n\";\n            }\n        }\n        // extra gl fluff: setup position and depth adjust temps\n        if (desc.header.type == \"vertex\") {\n            header += \"vec4 outpos;\\n\";\n        }\n        if (desc.writedepth) {\n            header += \"vec4 tmp_FragDepth;\\n\";\n        }\n        //if ( desc.hasmatrix ) \n        //    header += \"vec4 tmp_matrix;\\n\";\n        var derivatives = false;\n        // start body of code\n        body += \"void main() {\\n\";\n        for (var i = 0; i < desc.tokens.length; i++) {\n            var lutentry = Mapping_1.Mapping.agal2glsllut[desc.tokens[i].opcode];\n            if (lutentry.s.indexOf(\"dFdx\") != -1 || lutentry.s.indexOf(\"dFdy\") != -1)\n                derivatives = true;\n            if (!lutentry) {\n                throw \"Opcode not valid or not implemented yet: \";\n            }\n            var sublines = lutentry.matrixheight || 1;\n            for (var sl = 0; sl < sublines; sl++) {\n                var line = \"  \" + lutentry.s;\n                if (desc.tokens[i].dest) {\n                    if (lutentry.matrixheight) {\n                        if (((desc.tokens[i].dest.mask >> sl) & 1) != 1) {\n                            continue;\n                        }\n                        var destregstring = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);\n                        var destcaststring = \"float\";\n                        var destmaskstring = [\"x\", \"y\", \"z\", \"w\"][sl];\n                        destregstring += \".\" + destmaskstring;\n                    }\n                    else {\n                        var destregstring = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);\n                        var destcaststring;\n                        var destmaskstring;\n                        if (desc.tokens[i].dest.mask != 0xf) {\n                            var ndest = 0;\n                            destmaskstring = \"\";\n                            if (desc.tokens[i].dest.mask & 1) {\n                                ndest++;\n                                destmaskstring += \"x\";\n                            }\n                            if (desc.tokens[i].dest.mask & 2) {\n                                ndest++;\n                                destmaskstring += \"y\";\n                            }\n                            if (desc.tokens[i].dest.mask & 4) {\n                                ndest++;\n                                destmaskstring += \"z\";\n                            }\n                            if (desc.tokens[i].dest.mask & 8) {\n                                ndest++;\n                                destmaskstring += \"w\";\n                            }\n                            destregstring += \".\" + destmaskstring;\n                            switch (ndest) {\n                                case 1:\n                                    destcaststring = \"float\";\n                                    break;\n                                case 2:\n                                    destcaststring = \"vec2\";\n                                    break;\n                                case 3:\n                                    destcaststring = \"vec3\";\n                                    break;\n                                default:\n                                    throw \"Unexpected destination mask\";\n                            }\n                        }\n                        else {\n                            destcaststring = \"vec4\";\n                            destmaskstring = \"xyzw\";\n                        }\n                    }\n                    line = line.replace(\"%dest\", destregstring);\n                    line = line.replace(\"%cast\", destcaststring);\n                    line = line.replace(\"%dm\", destmaskstring);\n                }\n                var dwm = 0xf;\n                if (!lutentry.ndwm && lutentry.dest && desc.tokens[i].dest) {\n                    dwm = desc.tokens[i].dest.mask;\n                }\n                if (desc.tokens[i].a) {\n                    line = line.replace(\"%a\", this.sourcetostring(desc.tokens[i].a, 0, dwm, lutentry.scalar, desc, tag));\n                }\n                if (desc.tokens[i].b) {\n                    line = line.replace(\"%b\", this.sourcetostring(desc.tokens[i].b, sl, dwm, lutentry.scalar, desc, tag));\n                    if (desc.tokens[i].b.regtype == 0x5) {\n                        // sampler dim\n                        var texdim = [\"2D\", \"Cube\", \"3D\"][desc.tokens[i].b.dim];\n                        var texsize = [\"vec2\", \"vec3\", \"vec3\"][desc.tokens[i].b.dim];\n                        line = line.replace(\"%texdim\", texdim);\n                        line = line.replace(\"%texsize\", texsize);\n                        var texlod = \"\";\n                        line = line.replace(\"%lod\", texlod);\n                    }\n                }\n                body += line;\n            }\n        }\n        // adjust z from opengl range of -1..1 to 0..1 as in d3d, this also enforces a left handed coordinate system\n        if (desc.header.type == \"vertex\") {\n            body += \"  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\\n\";\n        }\n        //flag based switch\n        if (derivatives && desc.header.type == \"fragment\") {\n            header = \"#extension GL_OES_standard_derivatives : enable\\n\" + header;\n        }\n        // clamp fragment depth\n        if (desc.writedepth) {\n            body += \"  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\\n\";\n        }\n        // close main\n        body += \"}\\n\";\n        return header + body;\n    };\n    AGLSLParser.prototype.regtostring = function (regtype, regnum, desc, tag) {\n        switch (regtype) {\n            case 0x0:\n                return \"va\" + regnum;\n            case 0x1:\n                return desc.header.type[0] + \"c[\" + regnum + \"]\";\n            // case 0x1:\n            // \tif (desc.hasindirect && desc.header.type == \"vertex\") {\n            // \t\treturn \"vcarrr[\" + regnum + \"]\";\n            // \t} else {\n            // \t\treturn tag + \"c\" + regnum;\n            // \t}\n            case 0x2:\n                return tag + \"t\" + regnum;\n            case 0x3:\n                return desc.header.type == \"vertex\" ? \"outpos\" : \"gl_FragColor\";\n            case 0x4:\n                return \"vi\" + regnum;\n            case 0x5:\n                return \"fs\" + regnum;\n            case 0x6:\n                return \"tmp_FragDepth\";\n            default:\n                throw \"Unknown register type\";\n        }\n    };\n    AGLSLParser.prototype.sourcetostring = function (s, subline, dwm, isscalar, desc, tag) {\n        var swiz = [\"x\", \"y\", \"z\", \"w\"];\n        var r;\n        if (s.indirectflag) {\n            r = \"vcarrr[int(\" + this.regtostring(s.indexregtype, s.regnum, desc, tag) + \".\" + swiz[s.indexselect] + \")\";\n            var realofs = subline + s.indexoffset;\n            if (realofs < 0)\n                r += realofs.toString();\n            if (realofs > 0)\n                r += \"+\" + realofs.toString();\n            r += \"]\";\n        }\n        else {\n            r = this.regtostring(s.regtype, s.regnum + subline, desc, tag);\n        }\n        // samplers never add swizzle        \n        if (s.regtype == 0x5) {\n            return r;\n        }\n        // scalar, first component only\n        if (isscalar) {\n            return r + \".\" + swiz[(s.swizzle >> 0) & 3];\n        }\n        // identity\n        if (s.swizzle == 0xe4 && dwm == 0xf) {\n            return r;\n        }\n        // with destination write mask folded in\n        r += \".\";\n        if (dwm & 1)\n            r += swiz[(s.swizzle >> 0) & 3];\n        if (dwm & 2)\n            r += swiz[(s.swizzle >> 2) & 3];\n        if (dwm & 4)\n            r += swiz[(s.swizzle >> 4) & 3];\n        if (dwm & 8)\n            r += swiz[(s.swizzle >> 6) & 3];\n        return r;\n    };\n    AGLSLParser.maxvertexconstants = 128;\n    AGLSLParser.maxfragconstants = 28;\n    AGLSLParser.maxtemp = 8;\n    AGLSLParser.maxstreams = 8;\n    AGLSLParser.maxtextures = 8;\n    return AGLSLParser;\n}());\nexports.AGLSLParser = AGLSLParser;\n\n},{\"../aglsl/Mapping\":\"awayjs-stagegl/lib/aglsl/Mapping\"}],\"awayjs-stagegl/lib/aglsl/Description\":[function(require,module,exports){\n\"use strict\";\nvar Header_1 = require(\"../aglsl/Header\");\nvar Description = (function () {\n    function Description() {\n        this.regread = [\n            [],\n            [],\n            [],\n            [],\n            [],\n            [],\n            []\n        ];\n        this.regwrite = [\n            [],\n            [],\n            [],\n            [],\n            [],\n            [],\n            []\n        ];\n        this.hasindirect = false;\n        this.writedepth = false;\n        this.hasmatrix = false;\n        this.samplers = [];\n        // added due to dynamic assignment 3*0xFFFFFFuuuu\n        this.tokens = [];\n        this.header = new Header_1.Header();\n    }\n    return Description;\n}());\nexports.Description = Description;\n\n},{\"../aglsl/Header\":\"awayjs-stagegl/lib/aglsl/Header\"}],\"awayjs-stagegl/lib/aglsl/Destination\":[function(require,module,exports){\n\"use strict\";\nvar Destination = (function () {\n    function Destination() {\n        this.mask = 0;\n        this.regnum = 0;\n        this.regtype = 0;\n        this.dim = 0;\n        this.indexoffset = 0;\n        this.swizzle = 0;\n        this.lodbiad = 0;\n        this.readmode = 0;\n        this.special = 0;\n        this.wrap = 0;\n        this.filter = 0;\n        this.indexregtype = 0;\n        this.indexselect = 0;\n        this.indirectflag = 0;\n    }\n    return Destination;\n}());\nexports.Destination = Destination;\n\n},{}],\"awayjs-stagegl/lib/aglsl/Header\":[function(require,module,exports){\n\"use strict\";\nvar Header = (function () {\n    function Header() {\n        this.progid = 0;\n        this.version = 0;\n        this.type = \"\";\n    }\n    return Header;\n}());\nexports.Header = Header;\n\n},{}],\"awayjs-stagegl/lib/aglsl/Mapping\":[function(require,module,exports){\n\"use strict\";\nvar OpLUT_1 = require(\"../aglsl/OpLUT\");\nvar Mapping = (function () {\n    //TODO: get rid of hack that fixes including definition file\n    function Mapping(include) {\n    }\n    Mapping.agal2glsllut = [\n        //         s \t\t\t\t\t\t\t\t\t\t\t\tflags   dest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n        new OpLUT_1.OpLUT(\"%dest = %cast(%a);\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(%a + %b);\\n\", 0, true, true, true, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(%a - %b);\\n\", 0, true, true, true, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(%a * %b);\\n\", 0, true, true, true, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(%a / %b);\\n\", 0, true, true, true, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(1.0) / %a;\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(min(%a,%b));\\n\", 0, true, true, true, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(max(%a,%b));\\n\", 0, true, true, true, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(fract(%a));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(sqrt(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(inversesqrt(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(pow(abs(%a),%b));\\n\", 0, true, true, true, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(log2(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(exp2(%a));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        //         s \t\t\t\t\t\t\t\t\t\t\t\tflags  \tdest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n        new OpLUT_1.OpLUT(\"%dest = %cast(normalize(vec3( %a ) ));\\n\", 0, true, true, false, null, null, true, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(sin(%a));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(cos(%a));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(cross(vec3(%a),vec3(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(dot(vec3(%a),vec3(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(abs(%a));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(%a * -1.0);\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(clamp(%a,0.0,1.0));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(dot(vec3(%a),vec3(%b)));\\n\", null, true, true, true, 3, 3, true, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", null, true, true, true, 4, 4, true, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", null, true, true, true, 4, 3, true, null, null, null),\n        //s:string, flags:number, dest:boolean, a:boolean, b:boolean, matrixwidth:number, matrixheight:number, ndwm:boolean, scaler:boolean, dm:boolean, lod:boolean\n        new OpLUT_1.OpLUT(\"%dest = %cast(dFdx(%a));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"%dest = %cast(dFdy(%a));\\n\", 0, true, true, false, null, null, null, null, null, null),\n        new OpLUT_1.OpLUT(\"if (float(%a)==float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT_1.OpLUT(\"if (float(%a)!=float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT_1.OpLUT(\"if (float(%a)>=float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT_1.OpLUT(\"if (float(%a)<float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT_1.OpLUT(\"} else {;\\n\", 0, false, false, false, null, null, null, null, null, null), new OpLUT_1.OpLUT(\"};\\n\", 0, false, false, false, null, null, null, null, null, null), new OpLUT_1.OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT_1.OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT_1.OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT_1.OpLUT(null, null, null, null, false, null, null, null, null, null, null),\n        //         s \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tflags  \tdest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n        new OpLUT_1.OpLUT(\"%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\\n\", null, true, true, true, null, null, null, null, true, null), new OpLUT_1.OpLUT(\"if ( float(%a)<0.0 ) discard;\\n\", null, false, true, false, null, null, null, true, null, null), new OpLUT_1.OpLUT(\"%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\\n\", null, true, true, true, null, null, true, null, true, true), new OpLUT_1.OpLUT(\"%dest = %cast(greaterThanEqual(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT_1.OpLUT(\"%dest = %cast(lessThan(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT_1.OpLUT(\"%dest = %cast(sign(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), new OpLUT_1.OpLUT(\"%dest = %cast(equal(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT_1.OpLUT(\"%dest = %cast(notEqual(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null)\n    ];\n    return Mapping;\n}());\nexports.Mapping = Mapping;\n\n},{\"../aglsl/OpLUT\":\"awayjs-stagegl/lib/aglsl/OpLUT\"}],\"awayjs-stagegl/lib/aglsl/OpLUT\":[function(require,module,exports){\n\"use strict\";\nvar OpLUT = (function () {\n    function OpLUT(s, flags, dest, a, b, matrixwidth, matrixheight, ndwm, scaler, dm, lod) {\n        this.s = s;\n        this.flags = flags;\n        this.dest = dest;\n        this.a = a;\n        this.b = b;\n        this.matrixwidth = matrixwidth;\n        this.matrixheight = matrixheight;\n        this.ndwm = ndwm;\n        this.scalar = scaler;\n        this.dm = dm;\n        this.lod = lod;\n    }\n    return OpLUT;\n}());\nexports.OpLUT = OpLUT;\n\n},{}],\"awayjs-stagegl/lib/aglsl/Token\":[function(require,module,exports){\n\"use strict\";\nvar Destination_1 = require(\"../aglsl/Destination\");\nvar Token = (function () {\n    function Token() {\n        this.dest = new Destination_1.Destination();\n        this.opcode = 0;\n        this.a = new Destination_1.Destination();\n        this.b = new Destination_1.Destination();\n    }\n    return Token;\n}());\nexports.Token = Token;\n\n},{\"../aglsl/Destination\":\"awayjs-stagegl/lib/aglsl/Destination\"}],\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\":[function(require,module,exports){\n\"use strict\";\nvar OpcodeMap_1 = require(\"../../aglsl/assembler/OpcodeMap\");\nvar Part_1 = require(\"../../aglsl/assembler/Part\");\nvar RegMap_1 = require(\"../../aglsl/assembler/RegMap\");\nvar SamplerMap_1 = require(\"../../aglsl/assembler/SamplerMap\");\nvar AGALMiniAssembler = (function () {\n    function AGALMiniAssembler() {\n        this.r = {};\n        this.cur = new Part_1.Part();\n    }\n    AGALMiniAssembler.prototype.assemble = function (source, ext_part, ext_version) {\n        if (ext_part === void 0) { ext_part = null; }\n        if (ext_version === void 0) { ext_version = null; }\n        if (!ext_version) {\n            ext_version = 1;\n        }\n        if (ext_part) {\n            this.addHeader(ext_part, ext_version);\n        }\n        var lines = source.replace(/[\\f\\n\\r\\v]+/g, \"\\n\").split(\"\\n\"); // handle breaks, then split into lines\n        for (var i in lines) {\n            this.processLine(lines[i], i);\n        }\n        return this.r;\n    };\n    AGALMiniAssembler.prototype.processLine = function (line, linenr) {\n        var startcomment = line.search(\"//\"); // remove comments\n        if (startcomment != -1) {\n            line = line.slice(0, startcomment);\n        }\n        line = line.replace(/^\\s+|\\s+$/g, \"\"); // remove outer space\n        if (!(line.length > 0)) {\n            return;\n        }\n        var optsi = line.search(/<.*>/g); // split of options part <*> if there\n        var opts = null;\n        if (optsi != -1) {\n            opts = line.slice(optsi).match(/([\\w\\.\\-\\+]+)/gi);\n            line = line.slice(0, optsi);\n        }\n        // get opcode/command\t\t\t\t            \n        var tokens = line.match(/([\\w\\.\\+\\[\\]]+)/gi); // get tokens in line\n        if (!tokens || tokens.length < 1) {\n            if (line.length >= 3) {\n                console.log(\"Warning: bad line \" + linenr + \": \" + line);\n            }\n            return;\n        }\n        //console.log ( linenr, line, cur, tokens ); \n        switch (tokens[0]) {\n            case \"part\":\n                this.addHeader(tokens[1], Number(tokens[2]));\n                break;\n            case \"endpart\":\n                if (!this.cur) {\n                    throw \"Unexpected endpart\";\n                }\n                this.cur.data.position = 0;\n                this.cur = null;\n                return;\n            default:\n                if (!this.cur) {\n                    console.log(\"Warning: bad line \" + linenr + \": \" + line + \" (Outside of any part definition)\");\n                    return;\n                }\n                if (this.cur.name == \"comment\") {\n                    return;\n                }\n                var op = OpcodeMap_1.OpcodeMap.map[tokens[0]];\n                if (!op) {\n                    throw \"Bad opcode \" + tokens[0] + \" \" + linenr + \": \" + line;\n                }\n                // console.log( 'AGALMiniAssembler' , 'op' , op );\n                this.emitOpcode(this.cur, op.opcode);\n                var ti = 1;\n                if (op.dest && op.dest != \"none\") {\n                    if (!this.emitDest(this.cur, tokens[ti++], op.dest)) {\n                        throw \"Bad destination register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n                    }\n                }\n                else {\n                    this.emitZeroDword(this.cur);\n                }\n                if (op.a && op.a.format != \"none\") {\n                    if (!this.emitSource(this.cur, tokens[ti++], op.a))\n                        throw \"Bad source register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n                }\n                else {\n                    this.emitZeroQword(this.cur);\n                }\n                if (op.b && op.b.format != \"none\") {\n                    if (op.b.format == \"sampler\") {\n                        if (!this.emitSampler(this.cur, tokens[ti++], op.b, opts)) {\n                            throw \"Bad sampler register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n                        }\n                    }\n                    else {\n                        if (!this.emitSource(this.cur, tokens[ti++], op.b)) {\n                            throw \"Bad source register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n                        }\n                    }\n                }\n                else {\n                    this.emitZeroQword(this.cur);\n                }\n                break;\n        }\n    };\n    AGALMiniAssembler.prototype.emitHeader = function (pr) {\n        pr.data.writeUnsignedByte(0xa0); // tag version\n        pr.data.writeUnsignedInt(pr.version);\n        if (pr.version >= 0x10) {\n            pr.data.writeUnsignedByte(0); // align, for higher versions\n        }\n        pr.data.writeUnsignedByte(0xa1); // tag program id\n        switch (pr.name) {\n            case \"fragment\":\n                pr.data.writeUnsignedByte(1);\n                break;\n            case \"vertex\":\n                pr.data.writeUnsignedByte(0);\n                break;\n            case \"cpu\":\n                pr.data.writeUnsignedByte(2);\n                break;\n            default:\n                pr.data.writeUnsignedByte(0xff);\n                break; // unknown/comment\n        }\n    };\n    AGALMiniAssembler.prototype.emitOpcode = function (pr, opcode) {\n        pr.data.writeUnsignedInt(opcode);\n        //console.log ( \"Emit opcode: \", opcode ); \n    };\n    AGALMiniAssembler.prototype.emitZeroDword = function (pr) {\n        pr.data.writeUnsignedInt(0);\n    };\n    AGALMiniAssembler.prototype.emitZeroQword = function (pr) {\n        pr.data.writeUnsignedInt(0);\n        pr.data.writeUnsignedInt(0);\n    };\n    AGALMiniAssembler.prototype.emitDest = function (pr, token, opdest) {\n        //console.log( 'AGALMiniAssembler' , 'emitDest' , 'RegMap.map' , RegMap.map);\n        var reg = token.match(/([fov]?[tpocidavs])(\\d*)(\\.[xyzw]{1,4})?/i); // g1: regname, g2:regnum, g3:mask\n        // console.log( 'AGALMiniAssembler' , 'emitDest' , 'reg' , reg , reg[1] , RegMap.map[reg[1]] );\n        // console.log( 'AGALMiniAssembler' , 'emitDest' , 'RegMap.map[reg[1]]' , RegMap.map[reg[1]] , 'bool' , !RegMap.map[reg[1]] ) ;\n        if (!RegMap_1.RegMap.map[reg[1]])\n            return false;\n        var em = { num: reg[2] ? reg[2] : 0, code: RegMap_1.RegMap.map[reg[1]].code, mask: this.stringToMask(reg[3]) };\n        pr.data.writeUnsignedShort(em.num);\n        pr.data.writeUnsignedByte(em.mask);\n        pr.data.writeUnsignedByte(em.code);\n        //console.log ( \"  Emit dest: \", em );\n        return true;\n    };\n    AGALMiniAssembler.prototype.stringToMask = function (s) {\n        if (!s)\n            return 0xf;\n        var r = 0;\n        if (s.indexOf(\"x\") != -1)\n            r |= 1;\n        if (s.indexOf(\"y\") != -1)\n            r |= 2;\n        if (s.indexOf(\"z\") != -1)\n            r |= 4;\n        if (s.indexOf(\"w\") != -1)\n            r |= 8;\n        return r;\n    };\n    AGALMiniAssembler.prototype.stringToSwizzle = function (s) {\n        if (!s) {\n            return 0xe4;\n        }\n        var chartoindex = { x: 0, y: 1, z: 2, w: 3 };\n        var sw = 0;\n        if (s.charAt(0) != \".\") {\n            throw \"Missing . for swizzle\";\n        }\n        if (s.length > 1) {\n            sw |= chartoindex[s.charAt(1)];\n        }\n        if (s.length > 2) {\n            sw |= chartoindex[s.charAt(2)] << 2;\n        }\n        else {\n            sw |= (sw & 3) << 2;\n        }\n        if (s.length > 3) {\n            sw |= chartoindex[s.charAt(3)] << 4;\n        }\n        else {\n            sw |= (sw & (3 << 2)) << 2;\n        }\n        if (s.length > 4) {\n            sw |= chartoindex[s.charAt(4)] << 6;\n        }\n        else {\n            sw |= (sw & (3 << 4)) << 2;\n        }\n        return sw;\n    };\n    AGALMiniAssembler.prototype.emitSampler = function (pr, token, opsrc, opts) {\n        var reg = token.match(/fs(\\d*)/i); // g1:regnum\n        if (!reg || !reg[1]) {\n            return false;\n        }\n        pr.data.writeUnsignedShort(parseInt(reg[1]));\n        pr.data.writeUnsignedByte(0); // bias\n        pr.data.writeUnsignedByte(0);\n        /*\n         pr.data.writeUnsignedByte ( 0x5 );\n         pr.data.writeUnsignedByte ( 0 );   // readmode, dim\n         pr.data.writeUnsignedByte ( 0 );   // special, wrap\n         pr.data.writeUnsignedByte ( 0 );   // mip, filter\n         */\n        var samplerbits = 0x5;\n        var sampleroptset = 0;\n        for (var i = 0; i < opts.length; i++) {\n            var o = SamplerMap_1.SamplerMap.map[opts[i].toLowerCase()];\n            //console.log( 'AGALMiniAssembler' , 'emitSampler' , 'SampleMap opt:' , o , '<-------- WATCH FOR THIS');\n            if (o) {\n                if (((sampleroptset >> o.shift) & o.mask) != 0) {\n                    console.log(\"Warning, duplicate sampler option\");\n                }\n                sampleroptset |= o.mask << o.shift;\n                samplerbits &= ~(o.mask << o.shift);\n                samplerbits |= o.value << o.shift;\n            }\n            else {\n                console.log(\"Warning, unknown sampler option: \", opts[i]);\n            }\n        }\n        pr.data.writeUnsignedInt(samplerbits);\n        return true;\n    };\n    AGALMiniAssembler.prototype.emitSource = function (pr, token, opsrc) {\n        var indexed = token.match(/vc\\[(v[tcai])(\\d+)\\.([xyzw])([\\+\\-]\\d+)?\\](\\.[xyzw]{1,4})?/i); // g1: indexregname, g2:indexregnum, g3:select, [g4:offset], [g5:swizzle]\n        var reg;\n        if (indexed) {\n            if (!RegMap_1.RegMap.map[indexed[1]]) {\n                return false;\n            }\n            var selindex = { x: 0, y: 1, z: 2, w: 3 };\n            var em = { num: indexed[2] | 0, code: RegMap_1.RegMap.map[indexed[1]].code, swizzle: this.stringToSwizzle(indexed[5]), select: selindex[indexed[3]], offset: indexed[4] | 0 };\n            pr.data.writeUnsignedShort(em.num);\n            pr.data.writeByte(em.offset);\n            pr.data.writeUnsignedByte(em.swizzle);\n            pr.data.writeUnsignedByte(0x1); // constant reg\n            pr.data.writeUnsignedByte(em.code);\n            pr.data.writeUnsignedByte(em.select);\n            pr.data.writeUnsignedByte(1 << 7);\n        }\n        else {\n            reg = token.match(/([fov]?[tpocidavs])(\\d*)(\\.[xyzw]{1,4})?/i); // g1: regname, g2:regnum, g3:swizzle\n            if (!RegMap_1.RegMap.map[reg[1]]) {\n                return false;\n            }\n            var em = { num: reg[2] | 0, code: RegMap_1.RegMap.map[reg[1]].code, swizzle: this.stringToSwizzle(reg[3]) };\n            pr.data.writeUnsignedShort(em.num);\n            pr.data.writeUnsignedByte(0);\n            pr.data.writeUnsignedByte(em.swizzle);\n            pr.data.writeUnsignedByte(em.code);\n            pr.data.writeUnsignedByte(0);\n            pr.data.writeUnsignedByte(0);\n            pr.data.writeUnsignedByte(0);\n        }\n        return true;\n    };\n    AGALMiniAssembler.prototype.addHeader = function (partname, version) {\n        if (!version) {\n            version = 1;\n        }\n        if (this.r[partname] == undefined) {\n            this.r[partname] = new Part_1.Part(partname, version);\n            this.emitHeader(this.r[partname]);\n        }\n        else if (this.r[partname].version != version) {\n            throw \"Multiple versions for part \" + partname;\n        }\n        this.cur = this.r[partname];\n    };\n    return AGALMiniAssembler;\n}());\nexports.AGALMiniAssembler = AGALMiniAssembler;\n\n},{\"../../aglsl/assembler/OpcodeMap\":\"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap\",\"../../aglsl/assembler/Part\":\"awayjs-stagegl/lib/aglsl/assembler/Part\",\"../../aglsl/assembler/RegMap\":\"awayjs-stagegl/lib/aglsl/assembler/RegMap\",\"../../aglsl/assembler/SamplerMap\":\"awayjs-stagegl/lib/aglsl/assembler/SamplerMap\"}],\"awayjs-stagegl/lib/aglsl/assembler/FS\":[function(require,module,exports){\n\"use strict\";\nvar FS = (function () {\n    function FS() {\n    }\n    return FS;\n}());\nexports.FS = FS;\n\n},{}],\"awayjs-stagegl/lib/aglsl/assembler/Flags\":[function(require,module,exports){\n\"use strict\";\nvar Flags = (function () {\n    function Flags() {\n    }\n    return Flags;\n}());\nexports.Flags = Flags;\n\n},{}],\"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap\":[function(require,module,exports){\n\"use strict\";\nvar Opcode_1 = require(\"../../aglsl/assembler/Opcode\");\nvar OpcodeMap = (function () {\n    function OpcodeMap() {\n    }\n    Object.defineProperty(OpcodeMap, \"map\", {\n        get: function () {\n            if (!OpcodeMap._map) {\n                OpcodeMap._map = new Array();\n                OpcodeMap._map['mov'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x00, true, null, null, null); //0\n                OpcodeMap._map['add'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x01, true, null, null, null); //1\n                OpcodeMap._map['sub'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x02, true, null, null, null); //2\n                OpcodeMap._map['mul'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x03, true, null, null, null); //3\n                OpcodeMap._map['div'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x04, true, null, null, null); //4\n                OpcodeMap._map['rcp'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x05, true, null, null, null); //5\n                OpcodeMap._map['min'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x06, true, null, null, null); //6\n                OpcodeMap._map['max'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x07, true, null, null, null); //7\n                OpcodeMap._map['frc'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x08, true, null, null, null); //8\n                OpcodeMap._map['sqt'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x09, true, null, null, null); //9\n                OpcodeMap._map['rsq'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0a, true, null, null, null); //10\n                OpcodeMap._map['pow'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x0b, true, null, null, null); //11\n                OpcodeMap._map['log'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0c, true, null, null, null); //12\n                OpcodeMap._map['exp'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0d, true, null, null, null); //13\n                OpcodeMap._map['nrm'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0e, true, null, null, null); //14\n                OpcodeMap._map['sin'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0f, true, null, null, null); //15\n                OpcodeMap._map['cos'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x10, true, null, null, null); //16\n                OpcodeMap._map['crs'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x11, true, true, null, null); //17\n                OpcodeMap._map['dp3'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x12, true, true, null, null); //18\n                OpcodeMap._map['dp4'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x13, true, true, null, null); //19\n                OpcodeMap._map['abs'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x14, true, null, null, null); //20\n                OpcodeMap._map['neg'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x15, true, null, null, null); //21\n                OpcodeMap._map['sat'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x16, true, null, null, null); //22\n                OpcodeMap._map['ted'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"sampler\", 1, 0x26, true, null, true, null); //38\n                OpcodeMap._map['kil'] = new Opcode_1.Opcode(\"none\", \"scalar\", 1, \"none\", 0, 0x27, true, null, true, null); //39\n                OpcodeMap._map['tex'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"sampler\", 1, 0x28, true, null, true, null); //40\n                OpcodeMap._map['m33'] = new Opcode_1.Opcode(\"vector\", \"matrix\", 3, \"vector\", 3, 0x17, true, null, null, true); //23\n                OpcodeMap._map['m44'] = new Opcode_1.Opcode(\"vector\", \"matrix\", 4, \"vector\", 4, 0x18, true, null, null, true); //24\n                OpcodeMap._map['m43'] = new Opcode_1.Opcode(\"vector\", \"matrix\", 3, \"vector\", 4, 0x19, true, null, null, true); //25\n                OpcodeMap._map['ddx'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x1a, true, null, true, null); //26\n                OpcodeMap._map['ddy'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x1b, true, null, true, null); //27\n                OpcodeMap._map['sge'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x29, true, null, null, null); //41\n                OpcodeMap._map['slt'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2a, true, null, null, null); //42\n                OpcodeMap._map['sgn'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2b, true, null, null, null); //43\n                OpcodeMap._map['seq'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2c, true, null, null, null); //44\n                OpcodeMap._map['sne'] = new Opcode_1.Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2d, true, null, null, null); //45\n            }\n            return OpcodeMap._map;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return OpcodeMap;\n}());\nexports.OpcodeMap = OpcodeMap;\n\n},{\"../../aglsl/assembler/Opcode\":\"awayjs-stagegl/lib/aglsl/assembler/Opcode\"}],\"awayjs-stagegl/lib/aglsl/assembler/Opcode\":[function(require,module,exports){\n\"use strict\";\nvar Flags_1 = require(\"../../aglsl/assembler/Flags\");\nvar FS_1 = require(\"../../aglsl/assembler/FS\");\n/**\n *\n */\nvar Opcode = (function () {\n    function Opcode(dest, aformat, asize, bformat, bsize, opcode, simple, horizontal, fragonly, matrix) {\n        this.a = new FS_1.FS();\n        this.b = new FS_1.FS();\n        this.flags = new Flags_1.Flags();\n        this.dest = dest;\n        this.a.format = aformat;\n        this.a.size = asize;\n        this.b.format = bformat;\n        this.b.size = bsize;\n        this.opcode = opcode;\n        this.flags.simple = simple;\n        this.flags.horizontal = horizontal;\n        this.flags.fragonly = fragonly;\n        this.flags.matrix = matrix;\n    }\n    return Opcode;\n}());\nexports.Opcode = Opcode;\n\n},{\"../../aglsl/assembler/FS\":\"awayjs-stagegl/lib/aglsl/assembler/FS\",\"../../aglsl/assembler/Flags\":\"awayjs-stagegl/lib/aglsl/assembler/Flags\"}],\"awayjs-stagegl/lib/aglsl/assembler/Part\":[function(require,module,exports){\n\"use strict\";\nvar ByteArray_1 = require(\"awayjs-core/lib/utils/ByteArray\");\nvar Part = (function () {\n    function Part(name, version) {\n        if (name === void 0) { name = null; }\n        if (version === void 0) { version = null; }\n        this.name = \"\";\n        this.version = 0;\n        this.name = name;\n        this.version = version;\n        this.data = new ByteArray_1.ByteArray();\n    }\n    return Part;\n}());\nexports.Part = Part;\n\n},{\"awayjs-core/lib/utils/ByteArray\":undefined}],\"awayjs-stagegl/lib/aglsl/assembler/RegMap\":[function(require,module,exports){\n\"use strict\";\nvar Reg = (function () {\n    function Reg(code, desc) {\n        this.code = code;\n        this.desc = desc;\n    }\n    return Reg;\n}());\nvar RegMap = (function () {\n    /*\n     public static va:Reg = new Reg( 0x00, \"vertex attribute\" );\n     public static fc:Reg = new Reg( 0x01, \"fragment constant\" );\n     public static vc:Reg = new Reg( 0x01, \"vertex constant\" );\n     public static ft:Reg = new Reg( 0x02, \"fragment temporary\" );\n     public static vt:Reg = new Reg( 0x02, \"vertex temporary\" );\n     public static vo:Reg = new Reg( 0x03, \"vertex output\" );\n     public static op:Reg = new Reg( 0x03, \"vertex output\" );\n     public static fd:Reg = new Reg( 0x03, \"fragment depth output\" );\n     public static fo:Reg = new Reg( 0x03, \"fragment output\" );\n     public static oc:Reg = new Reg( 0x03, \"fragment output\" );\n     public static v: Reg = new Reg( 0x04, \"varying\" );\n     public static vi:Reg = new Reg( 0x04, \"varying output\" );\n     public static fi:Reg = new Reg( 0x04, \"varying input\" );\n     public static fs:Reg = new Reg( 0x05, \"sampler\" );\n     */\n    function RegMap() {\n    }\n    Object.defineProperty(RegMap, \"map\", {\n        get: function () {\n            if (!RegMap._map) {\n                RegMap._map = new Array();\n                RegMap._map['va'] = new Reg(0x00, \"vertex attribute\");\n                RegMap._map['fc'] = new Reg(0x01, \"fragment constant\");\n                RegMap._map['vc'] = new Reg(0x01, \"vertex constant\");\n                RegMap._map['ft'] = new Reg(0x02, \"fragment temporary\");\n                RegMap._map['vt'] = new Reg(0x02, \"vertex temporary\");\n                RegMap._map['vo'] = new Reg(0x03, \"vertex output\");\n                RegMap._map['op'] = new Reg(0x03, \"vertex output\");\n                RegMap._map['fd'] = new Reg(0x03, \"fragment depth output\");\n                RegMap._map['fo'] = new Reg(0x03, \"fragment output\");\n                RegMap._map['oc'] = new Reg(0x03, \"fragment output\");\n                RegMap._map['v'] = new Reg(0x04, \"varying\");\n                RegMap._map['vi'] = new Reg(0x04, \"varying output\");\n                RegMap._map['fi'] = new Reg(0x04, \"varying input\");\n                RegMap._map['fs'] = new Reg(0x05, \"sampler\");\n            }\n            return RegMap._map;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return RegMap;\n}());\nexports.RegMap = RegMap;\n\n},{}],\"awayjs-stagegl/lib/aglsl/assembler/SamplerMap\":[function(require,module,exports){\n\"use strict\";\nvar Sampler_1 = require(\"../../aglsl/assembler/Sampler\");\nvar SamplerMap = (function () {\n    /*\n     public static map =     [ new Sampler( 8, 0xf, 0 ),\n     new Sampler( 8, 0xf, 5 ),\n     new Sampler( 8, 0xf, 4 ),\n     new Sampler( 8, 0xf, 1 ),\n     new Sampler( 8, 0xf, 2 ),\n     new Sampler( 8, 0xf, 1 ),\n     new Sampler( 8, 0xf, 2 ),\n\n     // dimension\n     new Sampler( 12, 0xf, 0 ),\n     new Sampler( 12, 0xf, 1 ),\n     new Sampler( 12, 0xf, 2 ),\n\n     // special\n     new Sampler( 16, 1, 1 ),\n     new Sampler( 16, 4, 4 ),\n\n     // repeat\n     new Sampler( 20, 0xf, 0 ),\n     new Sampler( 20, 0xf, 1 ),\n     new Sampler( 20, 0xf, 1 ),\n\n     // mip\n     new Sampler( 24, 0xf, 0 ),\n     new Sampler( 24, 0xf, 0 ),\n     new Sampler( 24, 0xf, 1 ),\n     new Sampler( 24, 0xf, 2 ),\n\n     // filter\n     new Sampler( 28, 0xf, 0 ),\n     new Sampler( 28, 0xf, 1 ) ]\n     */\n    /*\n     public static rgba: Sampler = new Sampler( 8, 0xf, 0 );\n     public static rg: Sampler = new Sampler( 8, 0xf, 5 );\n     public static r: Sampler = new Sampler( 8, 0xf, 4 );\n     public static compressed: Sampler = new Sampler( 8, 0xf, 1 );\n     public static compressed_alpha: Sampler = new Sampler( 8, 0xf, 2 );\n     public static dxt1: Sampler = new Sampler( 8, 0xf, 1 );\n     public static dxt5: Sampler = new Sampler( 8, 0xf, 2 );\n\n     // dimension\n     public static sampler2d: Sampler = new Sampler( 12, 0xf, 0 );\n     public static cube: Sampler = new Sampler( 12, 0xf, 1 );\n     public static sampler3d: Sampler = new Sampler( 12, 0xf, 2 );\n\n     // special\n     public static centroid: Sampler = new Sampler( 16, 1, 1 );\n     public static ignoresampler: Sampler = new Sampler( 16, 4, 4 );\n\n     // repeat\n     public static clamp: Sampler = new Sampler( 20, 0xf, 0 );\n     public static repeat: Sampler = new Sampler( 20, 0xf, 1 );\n     public static wrap: Sampler = new Sampler( 20, 0xf, 1 );\n\n     // mip\n     public static nomip: Sampler = new Sampler( 24, 0xf, 0 );\n     public static mipnone: Sampler = new Sampler( 24, 0xf, 0 );\n     public static mipnearest: Sampler = new Sampler( 24, 0xf, 1 );\n     public static miplinear: Sampler = new Sampler( 24, 0xf, 2 );\n\n     // filter\n     public static nearest: Sampler = new Sampler( 28, 0xf, 0 );\n     public static linear: Sampler = new Sampler( 28, 0xf, 1 );\n     */\n    function SamplerMap() {\n    }\n    Object.defineProperty(SamplerMap, \"map\", {\n        get: function () {\n            if (!SamplerMap._map) {\n                SamplerMap._map = new Array();\n                SamplerMap._map['rgba'] = new Sampler_1.Sampler(8, 0xf, 0);\n                SamplerMap._map['rg'] = new Sampler_1.Sampler(8, 0xf, 5);\n                SamplerMap._map['r'] = new Sampler_1.Sampler(8, 0xf, 4);\n                SamplerMap._map['compressed'] = new Sampler_1.Sampler(8, 0xf, 1);\n                SamplerMap._map['compressed_alpha'] = new Sampler_1.Sampler(8, 0xf, 2);\n                SamplerMap._map['dxt1'] = new Sampler_1.Sampler(8, 0xf, 1);\n                SamplerMap._map['dxt5'] = new Sampler_1.Sampler(8, 0xf, 2);\n                // dimension\n                SamplerMap._map['2d'] = new Sampler_1.Sampler(12, 0xf, 0);\n                SamplerMap._map['cube'] = new Sampler_1.Sampler(12, 0xf, 1);\n                SamplerMap._map['3d'] = new Sampler_1.Sampler(12, 0xf, 2);\n                // special\n                SamplerMap._map['centroid'] = new Sampler_1.Sampler(16, 1, 1);\n                SamplerMap._map['ignoresampler'] = new Sampler_1.Sampler(16, 4, 4);\n                // repeat\n                SamplerMap._map['clamp'] = new Sampler_1.Sampler(20, 0xf, 0);\n                SamplerMap._map['repeat'] = new Sampler_1.Sampler(20, 0xf, 1);\n                SamplerMap._map['wrap'] = new Sampler_1.Sampler(20, 0xf, 1);\n                // mip\n                SamplerMap._map['nomip'] = new Sampler_1.Sampler(24, 0xf, 0);\n                SamplerMap._map['mipnone'] = new Sampler_1.Sampler(24, 0xf, 0);\n                SamplerMap._map['mipnearest'] = new Sampler_1.Sampler(24, 0xf, 1);\n                SamplerMap._map['miplinear'] = new Sampler_1.Sampler(24, 0xf, 2);\n                // filter\n                SamplerMap._map['nearest'] = new Sampler_1.Sampler(28, 0xf, 0);\n                SamplerMap._map['linear'] = new Sampler_1.Sampler(28, 0xf, 1);\n            }\n            return SamplerMap._map;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SamplerMap;\n}());\nexports.SamplerMap = SamplerMap;\n\n},{\"../../aglsl/assembler/Sampler\":\"awayjs-stagegl/lib/aglsl/assembler/Sampler\"}],\"awayjs-stagegl/lib/aglsl/assembler/Sampler\":[function(require,module,exports){\n\"use strict\";\nvar Sampler = (function () {\n    function Sampler(shift, mask, value) {\n        this.shift = shift;\n        this.mask = mask;\n        this.value = value;\n    }\n    return Sampler;\n}());\nexports.Sampler = Sampler;\n\n},{}],\"awayjs-stagegl/lib/aglsl\":[function(require,module,exports){\n\"use strict\";\nvar AGALMiniAssembler_1 = require(\"./aglsl/assembler/AGALMiniAssembler\");\nexports.AGALMiniAssembler = AGALMiniAssembler_1.AGALMiniAssembler;\nvar Flags_1 = require(\"./aglsl/assembler/Flags\");\nexports.Flags = Flags_1.Flags;\nvar FS_1 = require(\"./aglsl/assembler/FS\");\nexports.FS = FS_1.FS;\nvar Opcode_1 = require(\"./aglsl/assembler/Opcode\");\nexports.Opcode = Opcode_1.Opcode;\nvar OpcodeMap_1 = require(\"./aglsl/assembler/OpcodeMap\");\nexports.OpcodeMap = OpcodeMap_1.OpcodeMap;\nvar Part_1 = require(\"./aglsl/assembler/Part\");\nexports.Part = Part_1.Part;\nvar RegMap_1 = require(\"./aglsl/assembler/RegMap\");\nexports.RegMap = RegMap_1.RegMap;\nvar Sampler_1 = require(\"./aglsl/assembler/Sampler\");\nexports.Sampler = Sampler_1.Sampler;\nvar SamplerMap_1 = require(\"./aglsl/assembler/SamplerMap\");\nexports.SamplerMap = SamplerMap_1.SamplerMap;\nvar AGALTokenizer_1 = require(\"./aglsl/AGALTokenizer\");\nexports.AGALTokenizer = AGALTokenizer_1.AGALTokenizer;\nvar AGLSLParser_1 = require(\"./aglsl/AGLSLParser\");\nexports.AGLSLParser = AGLSLParser_1.AGLSLParser;\nvar Description_1 = require(\"./aglsl/Description\");\nexports.Description = Description_1.Description;\nvar Destination_1 = require(\"./aglsl/Destination\");\nexports.Destination = Destination_1.Destination;\nvar Header_1 = require(\"./aglsl/Header\");\nexports.Header = Header_1.Header;\nvar Mapping_1 = require(\"./aglsl/Mapping\");\nexports.Mapping = Mapping_1.Mapping;\nvar OpLUT_1 = require(\"./aglsl/OpLUT\");\nexports.OpLUT = OpLUT_1.OpLUT;\nvar Token_1 = require(\"./aglsl/Token\");\nexports.Token = Token_1.Token;\n\n},{\"./aglsl/AGALTokenizer\":\"awayjs-stagegl/lib/aglsl/AGALTokenizer\",\"./aglsl/AGLSLParser\":\"awayjs-stagegl/lib/aglsl/AGLSLParser\",\"./aglsl/Description\":\"awayjs-stagegl/lib/aglsl/Description\",\"./aglsl/Destination\":\"awayjs-stagegl/lib/aglsl/Destination\",\"./aglsl/Header\":\"awayjs-stagegl/lib/aglsl/Header\",\"./aglsl/Mapping\":\"awayjs-stagegl/lib/aglsl/Mapping\",\"./aglsl/OpLUT\":\"awayjs-stagegl/lib/aglsl/OpLUT\",\"./aglsl/Token\":\"awayjs-stagegl/lib/aglsl/Token\",\"./aglsl/assembler/AGALMiniAssembler\":\"awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler\",\"./aglsl/assembler/FS\":\"awayjs-stagegl/lib/aglsl/assembler/FS\",\"./aglsl/assembler/Flags\":\"awayjs-stagegl/lib/aglsl/assembler/Flags\",\"./aglsl/assembler/Opcode\":\"awayjs-stagegl/lib/aglsl/assembler/Opcode\",\"./aglsl/assembler/OpcodeMap\":\"awayjs-stagegl/lib/aglsl/assembler/OpcodeMap\",\"./aglsl/assembler/Part\":\"awayjs-stagegl/lib/aglsl/assembler/Part\",\"./aglsl/assembler/RegMap\":\"awayjs-stagegl/lib/aglsl/assembler/RegMap\",\"./aglsl/assembler/Sampler\":\"awayjs-stagegl/lib/aglsl/assembler/Sampler\",\"./aglsl/assembler/SamplerMap\":\"awayjs-stagegl/lib/aglsl/assembler/SamplerMap\"}],\"awayjs-stagegl/lib/attributes/GL_AttributesBuffer\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar AbstractionBase_1 = require(\"awayjs-core/lib/library/AbstractionBase\");\n/**\n *\n * @class away.pool.GL_AttributesBuffer\n */\nvar GL_AttributesBuffer = (function (_super) {\n    __extends(GL_AttributesBuffer, _super);\n    function GL_AttributesBuffer(attributesBuffer, stage) {\n        _super.call(this, attributesBuffer, stage);\n        this._stage = stage;\n        this._attributesBuffer = attributesBuffer;\n    }\n    /**\n     *\n     */\n    GL_AttributesBuffer.prototype.onClear = function (event) {\n        _super.prototype.onClear.call(this, event);\n        this._attributesBuffer = null;\n        if (this._indexBuffer) {\n            this._indexBuffer.dispose();\n            this._indexBuffer = null;\n        }\n        if (this._vertexBuffer) {\n            this._vertexBuffer.dispose();\n            this._vertexBuffer = null;\n        }\n    };\n    GL_AttributesBuffer.prototype.activate = function (index, size, dimensions, offset, unsigned) {\n        if (unsigned === void 0) { unsigned = false; }\n        this._stage.setVertexBuffer(index, this._getVertexBuffer(), size, dimensions, offset, unsigned);\n    };\n    GL_AttributesBuffer.prototype.draw = function (mode, firstIndex, numIndices) {\n        this._stage.context.drawIndices(mode, this._getIndexBuffer(), firstIndex, numIndices);\n    };\n    GL_AttributesBuffer.prototype._getIndexBuffer = function () {\n        if (!this._indexBuffer) {\n            this._invalid = true;\n            this._indexBuffer = this._stage.context.createIndexBuffer(this._attributesBuffer.count * this._attributesBuffer.stride / 2); //hardcoded assuming UintArray\n        }\n        if (this._invalid) {\n            this._invalid = false;\n            this._indexBuffer.uploadFromByteArray(this._attributesBuffer.buffer, 0, this._attributesBuffer.length);\n        }\n        return this._indexBuffer;\n    };\n    GL_AttributesBuffer.prototype._getVertexBuffer = function () {\n        if (!this._vertexBuffer) {\n            this._invalid = true;\n            this._vertexBuffer = this._stage.context.createVertexBuffer(this._attributesBuffer.count, this._attributesBuffer.stride);\n        }\n        if (this._invalid) {\n            this._invalid = false;\n            this._vertexBuffer.uploadFromByteArray(this._attributesBuffer.buffer, 0, this._attributesBuffer.count);\n        }\n        return this._vertexBuffer;\n    };\n    return GL_AttributesBuffer;\n}(AbstractionBase_1.AbstractionBase));\nexports.GL_AttributesBuffer = GL_AttributesBuffer;\n\n},{\"awayjs-core/lib/library/AbstractionBase\":undefined}],\"awayjs-stagegl/lib/attributes\":[function(require,module,exports){\n\"use strict\";\nvar GL_AttributesBuffer_1 = require(\"./attributes/GL_AttributesBuffer\");\nexports.GL_AttributesBuffer = GL_AttributesBuffer_1.GL_AttributesBuffer;\n\n},{\"./attributes/GL_AttributesBuffer\":\"awayjs-stagegl/lib/attributes/GL_AttributesBuffer\"}],\"awayjs-stagegl/lib/base/ContextGLBlendFactor\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLBlendFactor = (function () {\n    function ContextGLBlendFactor() {\n    }\n    ContextGLBlendFactor.DESTINATION_ALPHA = \"destinationAlpha\";\n    ContextGLBlendFactor.DESTINATION_COLOR = \"destinationColor\";\n    ContextGLBlendFactor.ONE = \"one\";\n    ContextGLBlendFactor.ONE_MINUS_DESTINATION_ALPHA = \"oneMinusDestinationAlpha\";\n    ContextGLBlendFactor.ONE_MINUS_DESTINATION_COLOR = \"oneMinusDestinationColor\";\n    ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA = \"oneMinusSourceAlpha\";\n    ContextGLBlendFactor.ONE_MINUS_SOURCE_COLOR = \"oneMinusSourceColor\";\n    ContextGLBlendFactor.SOURCE_ALPHA = \"sourceAlpha\";\n    ContextGLBlendFactor.SOURCE_COLOR = \"sourceColor\";\n    ContextGLBlendFactor.ZERO = \"zero\";\n    return ContextGLBlendFactor;\n}());\nexports.ContextGLBlendFactor = ContextGLBlendFactor;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLClearMask\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLClearMask = (function () {\n    function ContextGLClearMask() {\n    }\n    ContextGLClearMask.COLOR = 1;\n    ContextGLClearMask.DEPTH = 2;\n    ContextGLClearMask.STENCIL = 4;\n    ContextGLClearMask.ALL = ContextGLClearMask.COLOR | ContextGLClearMask.DEPTH | ContextGLClearMask.STENCIL;\n    return ContextGLClearMask;\n}());\nexports.ContextGLClearMask = ContextGLClearMask;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLCompareMode\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLCompareMode = (function () {\n    function ContextGLCompareMode() {\n    }\n    ContextGLCompareMode.ALWAYS = \"always\";\n    ContextGLCompareMode.EQUAL = \"equal\";\n    ContextGLCompareMode.GREATER = \"greater\";\n    ContextGLCompareMode.GREATER_EQUAL = \"greaterEqual\";\n    ContextGLCompareMode.LESS = \"less\";\n    ContextGLCompareMode.LESS_EQUAL = \"lessEqual\";\n    ContextGLCompareMode.NEVER = \"never\";\n    ContextGLCompareMode.NOT_EQUAL = \"notEqual\";\n    return ContextGLCompareMode;\n}());\nexports.ContextGLCompareMode = ContextGLCompareMode;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLDrawMode\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLDrawMode = (function () {\n    function ContextGLDrawMode() {\n    }\n    ContextGLDrawMode.TRIANGLES = \"triangles\";\n    ContextGLDrawMode.LINES = \"lines\";\n    return ContextGLDrawMode;\n}());\nexports.ContextGLDrawMode = ContextGLDrawMode;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLMipFilter\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLMipFilter = (function () {\n    function ContextGLMipFilter() {\n    }\n    ContextGLMipFilter.MIPLINEAR = \"miplinear\";\n    ContextGLMipFilter.MIPNEAREST = \"mipnearest\";\n    ContextGLMipFilter.MIPNONE = \"mipnone\";\n    return ContextGLMipFilter;\n}());\nexports.ContextGLMipFilter = ContextGLMipFilter;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLProfile\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLProfile = (function () {\n    function ContextGLProfile() {\n    }\n    ContextGLProfile.BASELINE = \"baseline\";\n    ContextGLProfile.BASELINE_CONSTRAINED = \"baselineConstrained\";\n    ContextGLProfile.BASELINE_EXTENDED = \"baselineExtended\";\n    return ContextGLProfile;\n}());\nexports.ContextGLProfile = ContextGLProfile;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = ContextGLProfile;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLProgramType\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLProgramType = (function () {\n    function ContextGLProgramType() {\n    }\n    ContextGLProgramType.FRAGMENT = 0;\n    ContextGLProgramType.SAMPLER = 1;\n    ContextGLProgramType.VERTEX = 2;\n    return ContextGLProgramType;\n}());\nexports.ContextGLProgramType = ContextGLProgramType;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLStencilAction\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLStencilAction = (function () {\n    function ContextGLStencilAction() {\n    }\n    ContextGLStencilAction.DECREMENT_SATURATE = \"decrementSaturate\";\n    ContextGLStencilAction.DECREMENT_WRAP = \"decrementWrap\";\n    ContextGLStencilAction.INCREMENT_SATURATE = \"incrementSaturate\";\n    ContextGLStencilAction.INCREMENT_WRAP = \"incrementWrap\";\n    ContextGLStencilAction.INVERT = \"invert\";\n    ContextGLStencilAction.KEEP = \"keep\";\n    ContextGLStencilAction.SET = \"set\";\n    ContextGLStencilAction.ZERO = \"zero\";\n    return ContextGLStencilAction;\n}());\nexports.ContextGLStencilAction = ContextGLStencilAction;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLTextureFilter\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLTextureFilter = (function () {\n    function ContextGLTextureFilter() {\n    }\n    ContextGLTextureFilter.LINEAR = \"linear\";\n    ContextGLTextureFilter.NEAREST = \"nearest\";\n    return ContextGLTextureFilter;\n}());\nexports.ContextGLTextureFilter = ContextGLTextureFilter;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLTextureFormat\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLTextureFormat = (function () {\n    function ContextGLTextureFormat() {\n    }\n    ContextGLTextureFormat.BGRA = \"bgra\";\n    ContextGLTextureFormat.BGRA_PACKED = \"bgraPacked4444\";\n    ContextGLTextureFormat.BGR_PACKED = \"bgrPacked565\";\n    ContextGLTextureFormat.COMPRESSED = \"compressed\";\n    ContextGLTextureFormat.COMPRESSED_ALPHA = \"compressedAlpha\";\n    return ContextGLTextureFormat;\n}());\nexports.ContextGLTextureFormat = ContextGLTextureFormat;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLTriangleFace\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLTriangleFace = (function () {\n    function ContextGLTriangleFace() {\n    }\n    ContextGLTriangleFace.BACK = \"back\";\n    ContextGLTriangleFace.FRONT = \"front\";\n    ContextGLTriangleFace.FRONT_AND_BACK = \"frontAndBack\";\n    ContextGLTriangleFace.NONE = \"none\";\n    return ContextGLTriangleFace;\n}());\nexports.ContextGLTriangleFace = ContextGLTriangleFace;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLVertexBufferFormat = (function () {\n    function ContextGLVertexBufferFormat() {\n    }\n    ContextGLVertexBufferFormat.FLOAT_1 = 0;\n    ContextGLVertexBufferFormat.FLOAT_2 = 1;\n    ContextGLVertexBufferFormat.FLOAT_3 = 2;\n    ContextGLVertexBufferFormat.FLOAT_4 = 3;\n    ContextGLVertexBufferFormat.BYTE_1 = 4;\n    ContextGLVertexBufferFormat.BYTE_2 = 5;\n    ContextGLVertexBufferFormat.BYTE_3 = 6;\n    ContextGLVertexBufferFormat.BYTE_4 = 7;\n    ContextGLVertexBufferFormat.UNSIGNED_BYTE_1 = 8;\n    ContextGLVertexBufferFormat.UNSIGNED_BYTE_2 = 9;\n    ContextGLVertexBufferFormat.UNSIGNED_BYTE_3 = 10;\n    ContextGLVertexBufferFormat.UNSIGNED_BYTE_4 = 11;\n    ContextGLVertexBufferFormat.SHORT_1 = 12;\n    ContextGLVertexBufferFormat.SHORT_2 = 13;\n    ContextGLVertexBufferFormat.SHORT_3 = 14;\n    ContextGLVertexBufferFormat.SHORT_4 = 15;\n    ContextGLVertexBufferFormat.UNSIGNED_SHORT_1 = 16;\n    ContextGLVertexBufferFormat.UNSIGNED_SHORT_2 = 17;\n    ContextGLVertexBufferFormat.UNSIGNED_SHORT_3 = 18;\n    ContextGLVertexBufferFormat.UNSIGNED_SHORT_4 = 19;\n    return ContextGLVertexBufferFormat;\n}());\nexports.ContextGLVertexBufferFormat = ContextGLVertexBufferFormat;\n\n},{}],\"awayjs-stagegl/lib/base/ContextGLWrapMode\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLWrapMode = (function () {\n    function ContextGLWrapMode() {\n    }\n    ContextGLWrapMode.CLAMP = \"clamp\";\n    ContextGLWrapMode.REPEAT = \"repeat\";\n    return ContextGLWrapMode;\n}());\nexports.ContextGLWrapMode = ContextGLWrapMode;\n\n},{}],\"awayjs-stagegl/lib/base/ContextMode\":[function(require,module,exports){\n\"use strict\";\nvar ContextMode = (function () {\n    function ContextMode() {\n    }\n    ContextMode.AUTO = \"auto\";\n    ContextMode.WEBGL = \"webgl\";\n    ContextMode.FLASH = \"flash\";\n    ContextMode.NATIVE = \"native\";\n    ContextMode.SOFTWARE = \"software\";\n    return ContextMode;\n}());\nexports.ContextMode = ContextMode;\n\n},{}],\"awayjs-stagegl/lib/base/ContextSoftware\":[function(require,module,exports){\n\"use strict\";\nvar BitmapImage2D_1 = require(\"awayjs-core/lib/image/BitmapImage2D\");\nvar Matrix3D_1 = require(\"awayjs-core/lib/geom/Matrix3D\");\nvar Matrix_1 = require(\"awayjs-core/lib/geom/Matrix\");\nvar Point_1 = require(\"awayjs-core/lib/geom/Point\");\nvar Vector3D_1 = require(\"awayjs-core/lib/geom/Vector3D\");\nvar Rectangle_1 = require(\"awayjs-core/lib/geom/Rectangle\");\nvar ColorUtils_1 = require(\"awayjs-core/lib/utils/ColorUtils\");\nvar ContextGLBlendFactor_1 = require(\"../base/ContextGLBlendFactor\");\nvar ContextGLClearMask_1 = require(\"../base/ContextGLClearMask\");\nvar ContextGLCompareMode_1 = require(\"../base/ContextGLCompareMode\");\nvar ContextGLProgramType_1 = require(\"../base/ContextGLProgramType\");\nvar ContextGLTriangleFace_1 = require(\"../base/ContextGLTriangleFace\");\nvar IndexBufferSoftware_1 = require(\"../base/IndexBufferSoftware\");\nvar VertexBufferSoftware_1 = require(\"../base/VertexBufferSoftware\");\nvar TextureSoftware_1 = require(\"../base/TextureSoftware\");\nvar ProgramSoftware_1 = require(\"../base/ProgramSoftware\");\nvar SoftwareSamplerState_1 = require(\"../base/SoftwareSamplerState\");\nvar ContextSoftware = (function () {\n    function ContextSoftware(canvas) {\n        this._backBufferRect = new Rectangle_1.Rectangle();\n        this._backBufferWidth = 100;\n        this._backBufferHeight = 100;\n        this._cullingMode = ContextGLTriangleFace_1.ContextGLTriangleFace.BACK;\n        this._blendSource = ContextGLBlendFactor_1.ContextGLBlendFactor.ONE;\n        this._blendDestination = ContextGLBlendFactor_1.ContextGLBlendFactor.ZERO;\n        this._colorMaskR = true;\n        this._colorMaskG = true;\n        this._colorMaskB = true;\n        this._colorMaskA = true;\n        this._writeDepth = true;\n        this._depthCompareMode = ContextGLCompareMode_1.ContextGLCompareMode.LESS;\n        this._screenMatrix = new Matrix3D_1.Matrix3D();\n        this._frontBufferMatrix = new Matrix_1.Matrix();\n        this._bboxMin = new Point_1.Point();\n        this._bboxMax = new Point_1.Point();\n        this._clamp = new Point_1.Point();\n        this._samplerStates = [];\n        this._textures = [];\n        this._vertexBuffers = [];\n        this._vertexBufferOffsets = [];\n        this._vertexBufferFormats = [];\n        //public static _drawCallback:Function = null;\n        this._antialias = 0;\n        this._sx = new Vector3D_1.Vector3D();\n        this._sy = new Vector3D_1.Vector3D();\n        this._u = new Vector3D_1.Vector3D();\n        this._canvas = canvas;\n        this._backBufferColor = new BitmapImage2D_1.BitmapImage2D(this._backBufferWidth, this._backBufferHeight, false, 0, false);\n        this._frontBuffer = new BitmapImage2D_1.BitmapImage2D(this._backBufferWidth, this._backBufferHeight, true, 0, false);\n        if (document && document.body)\n            document.body.appendChild(this._frontBuffer.getCanvas());\n    }\n    Object.defineProperty(ContextSoftware.prototype, \"frontBuffer\", {\n        get: function () {\n            return this._frontBuffer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ContextSoftware.prototype, \"container\", {\n        get: function () {\n            return this._canvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ContextSoftware.prototype.clear = function (red, green, blue, alpha, depth, stencil, mask) {\n        if (red === void 0) { red = 0; }\n        if (green === void 0) { green = 0; }\n        if (blue === void 0) { blue = 0; }\n        if (alpha === void 0) { alpha = 1; }\n        if (depth === void 0) { depth = 1; }\n        if (stencil === void 0) { stencil = 0; }\n        if (mask === void 0) { mask = ContextGLClearMask_1.ContextGLClearMask.ALL; }\n        this._backBufferColor.lock();\n        if (mask & ContextGLClearMask_1.ContextGLClearMask.COLOR) {\n            this._colorClearUint32.fill(((alpha * 0xFF << 24) | (red * 0xFF << 16) | (green * 0xFF << 8) | blue * 0xFF));\n            this._backBufferColor.setPixels(this._backBufferRect, this._colorClearUint8);\n        }\n        //TODO: mask & ContextGLClearMask.STENCIL\n        if (mask & ContextGLClearMask_1.ContextGLClearMask.DEPTH)\n            this._zbuffer.set(this._zbufferClear); //fast memcpy\n    };\n    ContextSoftware.prototype.configureBackBuffer = function (width, height, antiAlias, enableDepthAndStencil) {\n        this._antialias = antiAlias;\n        if (this._antialias % 2 != 0)\n            this._antialias = Math.floor(this._antialias - 0.5);\n        if (this._antialias == 0)\n            this._antialias = 1;\n        this._frontBuffer._setSize(width, height);\n        this._backBufferWidth = width * this._antialias;\n        this._backBufferHeight = height * this._antialias;\n        //double buffer for fast clearing\n        var len = this._backBufferWidth * this._backBufferHeight;\n        var zbufferBytes = new ArrayBuffer(len * 8);\n        this._zbuffer = new Float32Array(zbufferBytes, 0, len);\n        this._zbufferClear = new Float32Array(zbufferBytes, len * 4, len);\n        for (var i = 0; i < len; i++)\n            this._zbufferClear[i] = 10000000;\n        var colorClearBuffer = new ArrayBuffer(len * 4);\n        this._colorClearUint8 = new Uint8ClampedArray(colorClearBuffer);\n        this._colorClearUint32 = new Uint32Array(colorClearBuffer);\n        this._backBufferRect.width = this._backBufferWidth;\n        this._backBufferRect.height = this._backBufferHeight;\n        this._backBufferColor._setSize(this._backBufferWidth, this._backBufferHeight);\n        var raw = this._screenMatrix.rawData;\n        raw[0] = this._backBufferWidth / 2;\n        raw[1] = 0;\n        raw[2] = 0;\n        raw[3] = this._backBufferWidth / 2;\n        raw[4] = 0;\n        raw[5] = -this._backBufferHeight / 2;\n        raw[6] = 0;\n        raw[7] = this._backBufferHeight / 2;\n        raw[8] = 0;\n        raw[9] = 0;\n        raw[10] = 1;\n        raw[11] = 0;\n        raw[12] = 0;\n        raw[13] = 0;\n        raw[14] = 0;\n        raw[15] = 0;\n        this._screenMatrix.transpose();\n        this._frontBufferMatrix = new Matrix_1.Matrix();\n        this._frontBufferMatrix.scale(1 / this._antialias, 1 / this._antialias);\n    };\n    ContextSoftware.prototype.createCubeTexture = function (size, format, optimizeForRenderToTexture, streamingLevels) {\n        //TODO: impl\n        return undefined;\n    };\n    ContextSoftware.prototype.createIndexBuffer = function (numIndices) {\n        return new IndexBufferSoftware_1.IndexBufferSoftware(numIndices);\n    };\n    ContextSoftware.prototype.createProgram = function () {\n        return new ProgramSoftware_1.ProgramSoftware();\n    };\n    ContextSoftware.prototype.createTexture = function (width, height, format, optimizeForRenderToTexture, streamingLevels) {\n        return new TextureSoftware_1.TextureSoftware(width, height);\n    };\n    ContextSoftware.prototype.createVertexBuffer = function (numVertices, dataPerVertex) {\n        return new VertexBufferSoftware_1.VertexBufferSoftware(numVertices, dataPerVertex);\n    };\n    ContextSoftware.prototype.dispose = function () {\n    };\n    ContextSoftware.prototype.setBlendFactors = function (sourceFactor, destinationFactor) {\n        this._blendSource = sourceFactor;\n        this._blendDestination = destinationFactor;\n    };\n    ContextSoftware.prototype.setColorMask = function (red, green, blue, alpha) {\n        this._colorMaskR = red;\n        this._colorMaskG = green;\n        this._colorMaskB = blue;\n        this._colorMaskA = alpha;\n    };\n    ContextSoftware.prototype.setStencilActions = function (triangleFace, compareMode, actionOnBothPass, actionOnDepthFail, actionOnDepthPassStencilFail, coordinateSystem) {\n        //TODO:\n    };\n    ContextSoftware.prototype.setStencilReferenceValue = function (referenceValue, readMask, writeMask) {\n        //TODO:\n    };\n    ContextSoftware.prototype.setCulling = function (triangleFaceToCull, coordinateSystem) {\n        //TODO: CoordinateSystem.RIGHT_HAND\n        this._cullingMode = triangleFaceToCull;\n    };\n    ContextSoftware.prototype.setDepthTest = function (depthMask, passCompareMode) {\n        this._writeDepth = depthMask;\n        this._depthCompareMode = passCompareMode;\n    };\n    ContextSoftware.prototype.setProgram = function (program) {\n        this._program = program;\n    };\n    ContextSoftware.prototype.setProgramConstantsFromArray = function (programType, data) {\n        var target;\n        if (programType == ContextGLProgramType_1.ContextGLProgramType.VERTEX)\n            target = this._vertexConstants = new Float32Array(data.length);\n        else if (programType == ContextGLProgramType_1.ContextGLProgramType.FRAGMENT)\n            target = this._fragmentConstants = new Float32Array(data.length);\n        target.set(data);\n    };\n    ContextSoftware.prototype.setTextureAt = function (sampler, texture) {\n        this._textures[sampler] = texture;\n    };\n    ContextSoftware.prototype.setVertexBufferAt = function (index, buffer, bufferOffset, format) {\n        this._vertexBuffers[index] = buffer;\n        this._vertexBufferOffsets[index] = bufferOffset;\n        this._vertexBufferFormats[index] = format;\n    };\n    ContextSoftware.prototype.present = function () {\n        this._backBufferColor.unlock();\n        this._frontBuffer.fillRect(this._frontBuffer.rect, ColorUtils_1.ColorUtils.ARGBtoFloat32(0, 0, 0, 0));\n        this._frontBuffer.draw(this._backBufferColor, this._frontBufferMatrix);\n    };\n    ContextSoftware.prototype.drawToBitmapImage2D = function (destination) {\n    };\n    ContextSoftware.prototype.drawIndices = function (mode, indexBuffer, firstIndex, numIndices) {\n        if (!this._program)\n            return;\n        var position0 = new Float32Array(4);\n        var position1 = new Float32Array(4);\n        var position2 = new Float32Array(4);\n        var varying0 = new Float32Array(this._program.numVarying * 4);\n        var varying1 = new Float32Array(this._program.numVarying * 4);\n        var varying2 = new Float32Array(this._program.numVarying * 4);\n        if (this._cullingMode == ContextGLTriangleFace_1.ContextGLTriangleFace.BACK) {\n            for (var i = firstIndex; i < numIndices; i += 3) {\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position0, varying0);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position2, varying2);\n                this._triangle(position0, position1, position2, varying0, varying1, varying2);\n            }\n        }\n        else if (this._cullingMode == ContextGLTriangleFace_1.ContextGLTriangleFace.FRONT) {\n            for (var i = firstIndex; i < numIndices; i += 3) {\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position0, varying0);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position2, varying2);\n                this._triangle(position0, position1, position2, varying0, varying1, varying2);\n            }\n        }\n        else if (this._cullingMode == ContextGLTriangleFace_1.ContextGLTriangleFace.FRONT_AND_BACK || this._cullingMode == ContextGLTriangleFace_1.ContextGLTriangleFace.NONE) {\n            for (var i = firstIndex; i < numIndices; i += 3) {\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position0, varying0);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position2, varying2);\n                this._triangle(position0, position1, position2, varying0, varying1, varying2);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position0, varying0);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n                this._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position2, varying2);\n                this._triangle(position0, position1, position2, varying0, varying1, varying2);\n            }\n        }\n    };\n    ContextSoftware.prototype.drawVertices = function (mode, firstVertex, numVertices) {\n        //TODO:\n    };\n    ContextSoftware.prototype.setScissorRectangle = function (rectangle) {\n        //TODO:\n    };\n    ContextSoftware.prototype.setSamplerStateAt = function (sampler, wrap, filter, mipfilter) {\n        var state = this._samplerStates[sampler];\n        if (!state)\n            state = this._samplerStates[sampler] = new SoftwareSamplerState_1.SoftwareSamplerState();\n        state.wrap = wrap;\n        state.filter = filter;\n        state.mipfilter = mipfilter;\n    };\n    ContextSoftware.prototype.setRenderToTexture = function (target, enableDepthAndStencil, antiAlias, surfaceSelector) {\n        //TODO:\n    };\n    ContextSoftware.prototype.setRenderToBackBuffer = function () {\n        //TODO:\n    };\n    ContextSoftware.prototype._putPixel = function (x, y, source, dest) {\n        argb[0] = 0;\n        argb[1] = 0;\n        argb[2] = 0;\n        argb[3] = 0;\n        BlendModeSoftware[this._blendDestination](dest, dest, source);\n        BlendModeSoftware[this._blendSource](source, dest, source);\n        this._backBufferColor.setPixelData(x, y, argb);\n    };\n    ContextSoftware.prototype.clamp = function (value, min, max) {\n        if (min === void 0) { min = 0; }\n        if (max === void 0) { max = 1; }\n        return Math.max(min, Math.min(value, max));\n    };\n    ContextSoftware.prototype.interpolate = function (min, max, gradient) {\n        return min + (max - min) * this.clamp(gradient);\n    };\n    ContextSoftware.prototype._triangle = function (position0, position1, position2, varying0, varying1, varying2) {\n        var p0 = new Vector3D_1.Vector3D(position0[0], position0[1], position0[2], position0[3]);\n        if (!p0 || p0.w == 0 || isNaN(p0.w)) {\n            console.error(\"wrong position: \" + position0);\n            return;\n        }\n        var p1 = new Vector3D_1.Vector3D(position1[0], position1[1], position1[2], position1[3]);\n        var p2 = new Vector3D_1.Vector3D(position2[0], position2[1], position2[2], position2[3]);\n        p0.z = p0.z * 2 - p0.w;\n        p1.z = p1.z * 2 - p1.w;\n        p2.z = p2.z * 2 - p2.w;\n        p0.scaleBy(1 / p0.w);\n        p1.scaleBy(1 / p1.w);\n        p2.scaleBy(1 / p2.w);\n        var project = new Vector3D_1.Vector3D(p0.w, p1.w, p2.w);\n        p0 = this._screenMatrix.transformVector(p0);\n        p1 = this._screenMatrix.transformVector(p1);\n        p2 = this._screenMatrix.transformVector(p2);\n        var depth = new Vector3D_1.Vector3D(p0.z, p1.z, p2.z);\n        this._bboxMin.x = 1000000;\n        this._bboxMin.y = 1000000;\n        this._bboxMax.x = -1000000;\n        this._bboxMax.y = -1000000;\n        this._clamp.x = this._backBufferWidth - 1;\n        this._clamp.y = this._backBufferHeight - 1;\n        this._bboxMin.x = Math.max(0, Math.min(this._bboxMin.x, p0.x));\n        this._bboxMin.y = Math.max(0, Math.min(this._bboxMin.y, p0.y));\n        this._bboxMin.x = Math.max(0, Math.min(this._bboxMin.x, p1.x));\n        this._bboxMin.y = Math.max(0, Math.min(this._bboxMin.y, p1.y));\n        this._bboxMin.x = Math.max(0, Math.min(this._bboxMin.x, p2.x));\n        this._bboxMin.y = Math.max(0, Math.min(this._bboxMin.y, p2.y));\n        this._bboxMax.x = Math.min(this._clamp.x, Math.max(this._bboxMax.x, p0.x));\n        this._bboxMax.y = Math.min(this._clamp.y, Math.max(this._bboxMax.y, p0.y));\n        this._bboxMax.x = Math.min(this._clamp.x, Math.max(this._bboxMax.x, p1.x));\n        this._bboxMax.y = Math.min(this._clamp.y, Math.max(this._bboxMax.y, p1.y));\n        this._bboxMax.x = Math.min(this._clamp.x, Math.max(this._bboxMax.x, p2.x));\n        this._bboxMax.y = Math.min(this._clamp.y, Math.max(this._bboxMax.y, p2.y));\n        this._bboxMin.x = Math.floor(this._bboxMin.x);\n        this._bboxMin.y = Math.floor(this._bboxMin.y);\n        this._bboxMax.x = Math.floor(this._bboxMax.x);\n        this._bboxMax.y = Math.floor(this._bboxMax.y);\n        for (var x = this._bboxMin.x; x <= this._bboxMax.x; x++)\n            for (var y = this._bboxMin.y; y <= this._bboxMax.y; y++) {\n                var screen = this._barycentric(p0, p1, p2, x, y);\n                if (screen.x < 0 || screen.y < 0 || screen.z < 0)\n                    continue;\n                var screenRight = this._barycentric(p0, p1, p2, x + 1, y);\n                var screenBottom = this._barycentric(p0, p1, p2, x, y + 1);\n                var clip = new Vector3D_1.Vector3D(screen.x / project.x, screen.y / project.y, screen.z / project.z);\n                clip.scaleBy(1 / (clip.x + clip.y + clip.z));\n                var clipRight = new Vector3D_1.Vector3D(screenRight.x / project.x, screenRight.y / project.y, screenRight.z / project.z);\n                clipRight.scaleBy(1 / (clipRight.x + clipRight.y + clipRight.z));\n                var clipBottom = new Vector3D_1.Vector3D(screenBottom.x / project.x, screenBottom.y / project.y, screenBottom.z / project.z);\n                clipBottom.scaleBy(1 / (clipBottom.x + clipBottom.y + clipBottom.z));\n                var index = (x % this._backBufferWidth) + y * this._backBufferWidth;\n                var fragDepth = depth.x * screen.x + depth.y * screen.y + depth.z * screen.z;\n                if (!DepthCompareModeSoftware[this._depthCompareMode](fragDepth, this._zbuffer[index]))\n                    continue;\n                var fragmentVO = this._program.fragment(this, clip, clipRight, clipBottom, varying0, varying1, varying2, fragDepth);\n                if (fragmentVO.discard)\n                    continue;\n                if (this._writeDepth)\n                    this._zbuffer[index] = fragDepth; //todo: fragmentVO.outputDepth?\n                //set source\n                source[0] = fragmentVO.outputColor[0] * 255;\n                source[1] = fragmentVO.outputColor[1] * 255;\n                source[2] = fragmentVO.outputColor[2] * 255;\n                source[3] = fragmentVO.outputColor[3] * 255;\n                //set dest\n                this._backBufferColor.getPixelData(x, y, dest);\n                this._putPixel(x, y, source, dest);\n            }\n    };\n    ContextSoftware.prototype._barycentric = function (a, b, c, x, y) {\n        this._sx.x = c.x - a.x;\n        this._sx.y = b.x - a.x;\n        this._sx.z = a.x - x;\n        this._sy.x = c.y - a.y;\n        this._sy.y = b.y - a.y;\n        this._sy.z = a.y - y;\n        this._u = this._sx.crossProduct(this._sy, this._u);\n        if (this._u.z < 0.01)\n            return new Vector3D_1.Vector3D(1 - (this._u.x + this._u.y) / this._u.z, this._u.y / this._u.z, this._u.x / this._u.z);\n        return new Vector3D_1.Vector3D(-1, 1, 1);\n    };\n    ContextSoftware.MAX_SAMPLERS = 8;\n    return ContextSoftware;\n}());\nexports.ContextSoftware = ContextSoftware;\nvar BlendModeSoftware = (function () {\n    function BlendModeSoftware() {\n    }\n    BlendModeSoftware.destinationAlpha = function (result, dest, source) {\n        argb[0] += result[0] * dest[0] / 0xFF;\n        argb[1] += result[1] * dest[0] / 0xFF;\n        argb[2] += result[2] * dest[0] / 0xFF;\n        argb[3] += result[3] * dest[0] / 0xFF;\n    };\n    BlendModeSoftware.destinationColor = function (result, dest, source) {\n        argb[0] += result[0] * dest[0] / 0xFF;\n        argb[1] += result[1] * dest[1] / 0xFF;\n        argb[2] += result[2] * dest[2] / 0xFF;\n        argb[3] += result[3] * dest[3] / 0xFF;\n    };\n    BlendModeSoftware.zero = function (result, dest, source) {\n    };\n    BlendModeSoftware.one = function (result, dest, source) {\n        argb[0] += result[0];\n        argb[1] += result[1];\n        argb[2] += result[2];\n        argb[3] += result[3];\n    };\n    BlendModeSoftware.oneMinusDestinationAlpha = function (result, dest, source) {\n        argb[0] += result[0] * (1 - dest[0] / 0xFF);\n        argb[1] += result[1] * (1 - dest[0] / 0xFF);\n        argb[2] += result[2] * (1 - dest[0] / 0xFF);\n        argb[3] += result[3] * (1 - dest[0] / 0xFF);\n    };\n    BlendModeSoftware.oneMinusDestinationColor = function (result, dest, source) {\n        argb[0] += result[0] * (1 - dest[0] / 0xFF);\n        argb[1] += result[1] * (1 - dest[1] / 0xFF);\n        argb[2] += result[2] * (1 - dest[2] / 0xFF);\n        argb[3] += result[3] * (1 - dest[3] / 0xFF);\n    };\n    BlendModeSoftware.oneMinusSourceAlpha = function (result, dest, source) {\n        argb[0] += result[0] * (1 - source[0] / 0xFF);\n        argb[1] += result[1] * (1 - source[0] / 0xFF);\n        argb[2] += result[2] * (1 - source[0] / 0xFF);\n        argb[3] += result[3] * (1 - source[0] / 0xFF);\n    };\n    BlendModeSoftware.oneMinusSourceColor = function (result, dest, source) {\n        argb[0] += result[0] * (1 - source[0] / 0xFF);\n        argb[1] += result[1] * (1 - source[1] / 0xFF);\n        argb[2] += result[2] * (1 - source[2] / 0xFF);\n        argb[3] += result[3] * (1 - source[3] / 0xFF);\n    };\n    BlendModeSoftware.sourceAlpha = function (result, dest, source) {\n        argb[0] += result[0] * source[0] / 0xFF;\n        argb[1] += result[1] * source[0] / 0xFF;\n        argb[2] += result[2] * source[0] / 0xFF;\n        argb[3] += result[3] * source[0] / 0xFF;\n    };\n    BlendModeSoftware.sourceColor = function (result, dest, source) {\n        argb[0] += result[0] * source[0] / 0xFF;\n        argb[1] += result[1] * source[1] / 0xFF;\n        argb[2] += result[2] * source[2] / 0xFF;\n        argb[3] += result[3] * source[3] / 0xFF;\n    };\n    return BlendModeSoftware;\n}());\nexports.BlendModeSoftware = BlendModeSoftware;\nvar DepthCompareModeSoftware = (function () {\n    function DepthCompareModeSoftware() {\n    }\n    DepthCompareModeSoftware.always = function (fragDepth, currentDepth) {\n        return true;\n    };\n    DepthCompareModeSoftware.equal = function (fragDepth, currentDepth) {\n        return fragDepth == currentDepth;\n    };\n    DepthCompareModeSoftware.greater = function (fragDepth, currentDepth) {\n        return fragDepth > currentDepth;\n    };\n    DepthCompareModeSoftware.greaterEqual = function (fragDepth, currentDepth) {\n        return fragDepth >= currentDepth;\n    };\n    DepthCompareModeSoftware.less = function (fragDepth, currentDepth) {\n        return fragDepth < currentDepth;\n    };\n    DepthCompareModeSoftware.lessEqual = function (fragDepth, currentDepth) {\n        return fragDepth <= currentDepth;\n    };\n    DepthCompareModeSoftware.never = function (fragDepth, currentDepth) {\n        return false;\n    };\n    DepthCompareModeSoftware.notEqual = function (fragDepth, currentDepth) {\n        return fragDepth != currentDepth;\n    };\n    return DepthCompareModeSoftware;\n}());\nexports.DepthCompareModeSoftware = DepthCompareModeSoftware;\nvar argb = new Uint8ClampedArray(4);\nvar source = new Uint8ClampedArray(4);\nvar dest = new Uint8ClampedArray(4);\n\n},{\"../base/ContextGLBlendFactor\":\"awayjs-stagegl/lib/base/ContextGLBlendFactor\",\"../base/ContextGLClearMask\":\"awayjs-stagegl/lib/base/ContextGLClearMask\",\"../base/ContextGLCompareMode\":\"awayjs-stagegl/lib/base/ContextGLCompareMode\",\"../base/ContextGLProgramType\":\"awayjs-stagegl/lib/base/ContextGLProgramType\",\"../base/ContextGLTriangleFace\":\"awayjs-stagegl/lib/base/ContextGLTriangleFace\",\"../base/IndexBufferSoftware\":\"awayjs-stagegl/lib/base/IndexBufferSoftware\",\"../base/ProgramSoftware\":\"awayjs-stagegl/lib/base/ProgramSoftware\",\"../base/SoftwareSamplerState\":\"awayjs-stagegl/lib/base/SoftwareSamplerState\",\"../base/TextureSoftware\":\"awayjs-stagegl/lib/base/TextureSoftware\",\"../base/VertexBufferSoftware\":\"awayjs-stagegl/lib/base/VertexBufferSoftware\",\"awayjs-core/lib/geom/Matrix\":undefined,\"awayjs-core/lib/geom/Matrix3D\":undefined,\"awayjs-core/lib/geom/Point\":undefined,\"awayjs-core/lib/geom/Rectangle\":undefined,\"awayjs-core/lib/geom/Vector3D\":undefined,\"awayjs-core/lib/image/BitmapImage2D\":undefined,\"awayjs-core/lib/utils/ColorUtils\":undefined}],\"awayjs-stagegl/lib/base/ContextStage3D\":[function(require,module,exports){\n\"use strict\";\n//import {swfobject}\t\t\t\t\tfrom \"../swfobject\";\nvar ContextGLClearMask_1 = require(\"../base/ContextGLClearMask\");\nvar ContextGLProgramType_1 = require(\"../base/ContextGLProgramType\");\nvar CubeTextureFlash_1 = require(\"../base/CubeTextureFlash\");\nvar IndexBufferFlash_1 = require(\"../base/IndexBufferFlash\");\nvar OpCodes_1 = require(\"../base/OpCodes\");\nvar ProgramFlash_1 = require(\"../base/ProgramFlash\");\nvar TextureFlash_1 = require(\"../base/TextureFlash\");\nvar VertexBufferFlash_1 = require(\"../base/VertexBufferFlash\");\nvar ContextStage3D = (function () {\n    //TODO: get rid of hack that fixes including definition file\n    function ContextStage3D(container, callback) {\n        this._cmdStream = \"\";\n        this._resources = new Array();\n        var swfVersionStr = \"11.0.0\";\n        // To use express install, set to playerProductInstall.swf, otherwise the empty string.\n        var flashvars = {\n            id: container.id\n        };\n        var params = {\n            quality: \"high\",\n            bgcolor: \"#ffffff\",\n            allowscriptaccess: \"sameDomain\",\n            allowfullscreen: \"true\",\n            wmode: \"direct\"\n        };\n        this._errorCheckingEnabled = false;\n        this._iDriverInfo = \"Unknown\";\n        var attributes = {\n            salign: \"tl\",\n            id: container.id,\n            name: container[\"name\"] //TODO: needed?\n        };\n        this._oldCanvas = container.cloneNode(); // keep the old one to restore on dispose\n        this._oldParent = container.parentNode;\n        var context3dObj = this;\n        ContextStage3D.contexts[container.id] = this;\n        function callbackSWFObject(callbackInfo) {\n            if (!callbackInfo.success)\n                return;\n            context3dObj._container = callbackInfo.ref;\n            context3dObj._iCallback = callback;\n        }\n        //swfobject.embedSWF(\"libs/molehill_js_flashbridge.swf\", container.id, String(container.width), String(container.height), swfVersionStr, \"\", flashvars, params, attributes, callbackSWFObject);\n    }\n    Object.defineProperty(ContextStage3D.prototype, \"container\", {\n        get: function () {\n            return this._container;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ContextStage3D.prototype, \"driverInfo\", {\n        get: function () {\n            return this._iDriverInfo;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ContextStage3D.prototype, \"errorCheckingEnabled\", {\n        get: function () {\n            return this._errorCheckingEnabled;\n        },\n        set: function (value) {\n            if (this._errorCheckingEnabled == value)\n                return;\n            this._errorCheckingEnabled = value;\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.enableErrorChecking, value ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue));\n            this.execute();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ContextStage3D.prototype._iAddResource = function (resource) {\n        this._resources.push(resource);\n    };\n    ContextStage3D.prototype._iRemoveResource = function (resource) {\n        this._resources.splice(this._resources.indexOf(resource));\n    };\n    ContextStage3D.prototype.createTexture = function (width, height, format, optimizeForRenderToTexture, streamingLevels) {\n        if (streamingLevels === void 0) { streamingLevels = 0; }\n        //TODO:streaming\n        return new TextureFlash_1.TextureFlash(this, width, height, format, optimizeForRenderToTexture);\n    };\n    ContextStage3D.prototype.createCubeTexture = function (size, format, optimizeForRenderToTexture, streamingLevels) {\n        if (streamingLevels === void 0) { streamingLevels = 0; }\n        //TODO:streaming\n        return new CubeTextureFlash_1.CubeTextureFlash(this, size, format, optimizeForRenderToTexture);\n    };\n    ContextStage3D.prototype.setTextureAt = function (sampler, texture) {\n        if (texture) {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setTextureAt) + sampler + \",\" + texture.id + \",\");\n        }\n        else {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.clearTextureAt) + sampler.toString() + \",\");\n        }\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setSamplerStateAt = function (sampler, wrap, filter, mipfilter) {\n        //nothing to do here\n    };\n    ContextStage3D.prototype.setStencilActions = function (triangleFace, compareMode, actionOnBothPass, actionOnDepthFail, actionOnDepthPassStencilFail, coordinateSystem) {\n        if (triangleFace === void 0) { triangleFace = \"frontAndBack\"; }\n        if (compareMode === void 0) { compareMode = \"always\"; }\n        if (actionOnBothPass === void 0) { actionOnBothPass = \"keep\"; }\n        if (actionOnDepthFail === void 0) { actionOnDepthFail = \"keep\"; }\n        if (actionOnDepthPassStencilFail === void 0) { actionOnDepthPassStencilFail = \"keep\"; }\n        if (coordinateSystem === void 0) { coordinateSystem = \"leftHanded\"; }\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setStencilActions) + triangleFace + \"$\" + compareMode + \"$\" + actionOnBothPass + \"$\" + actionOnDepthFail + \"$\" + actionOnDepthPassStencilFail + \"$\");\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setStencilReferenceValue = function (referenceValue, readMask, writeMask) {\n        if (readMask === void 0) { readMask = 255; }\n        if (writeMask === void 0) { writeMask = 255; }\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setStencilReferenceValue, referenceValue + OpCodes_1.OpCodes.intMask, readMask + OpCodes_1.OpCodes.intMask, writeMask + OpCodes_1.OpCodes.intMask));\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setCulling = function (triangleFaceToCull, coordinateSystem) {\n        if (coordinateSystem === void 0) { coordinateSystem = \"leftHanded\"; }\n        //TODO implement coordinateSystem option\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setCulling) + triangleFaceToCull + \"$\");\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.drawIndices = function (mode, indexBuffer, firstIndex, numIndices) {\n        if (firstIndex === void 0) { firstIndex = 0; }\n        if (numIndices === void 0) { numIndices = -1; }\n        firstIndex = firstIndex || 0;\n        if (!numIndices || numIndices < 0)\n            numIndices = indexBuffer.numIndices;\n        //assume triangles\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.drawTriangles, indexBuffer.id + OpCodes_1.OpCodes.intMask) + firstIndex + \",\" + numIndices + \",\");\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.drawVertices = function (mode, firstVertex, numVertices) {\n        if (firstVertex === void 0) { firstVertex = 0; }\n        if (numVertices === void 0) { numVertices = -1; }\n        //can't be done in Stage3D\n    };\n    ContextStage3D.prototype.setProgramConstantsFromArray = function (programType, data) {\n        var startIndex;\n        var numRegisters = data.length / 4;\n        var target = (programType == ContextGLProgramType_1.ContextGLProgramType.VERTEX) ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue;\n        for (var i = 0; i < numRegisters; i++) {\n            startIndex = i * 4;\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setProgramConstant, target, i + OpCodes_1.OpCodes.intMask) + data[startIndex] + \",\" + data[startIndex + 1] + \",\" + data[startIndex + 2] + \",\" + data[startIndex + 3] + \",\");\n            if (ContextStage3D.debug)\n                this.execute();\n        }\n    };\n    ContextStage3D.prototype.setProgram = function (program) {\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setProgram, program.id + OpCodes_1.OpCodes.intMask));\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.present = function () {\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.present));\n        this.execute();\n    };\n    ContextStage3D.prototype.clear = function (red, green, blue, alpha, depth, stencil, mask) {\n        if (red === void 0) { red = 0; }\n        if (green === void 0) { green = 0; }\n        if (blue === void 0) { blue = 0; }\n        if (alpha === void 0) { alpha = 1; }\n        if (depth === void 0) { depth = 1; }\n        if (stencil === void 0) { stencil = 0; }\n        if (mask === void 0) { mask = ContextGLClearMask_1.ContextGLClearMask.ALL; }\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.clear) + red + \",\" + green + \",\" + blue + \",\" + alpha + \",\" + depth + \",\" + stencil + \",\" + mask + \",\");\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.createProgram = function () {\n        return new ProgramFlash_1.ProgramFlash(this);\n    };\n    ContextStage3D.prototype.createVertexBuffer = function (numVertices, data32PerVertex) {\n        return new VertexBufferFlash_1.VertexBufferFlash(this, numVertices, data32PerVertex);\n    };\n    ContextStage3D.prototype.createIndexBuffer = function (numIndices) {\n        return new IndexBufferFlash_1.IndexBufferFlash(this, numIndices);\n    };\n    ContextStage3D.prototype.configureBackBuffer = function (width, height, antiAlias, enableDepthAndStencil) {\n        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = true; }\n        this._width = width;\n        this._height = height;\n        //TODO: add Anitalias setting\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.configureBackBuffer) + width + \",\" + height + \",\");\n    };\n    ContextStage3D.prototype.drawToBitmapImage2D = function (destination) {\n        //TODO\n    };\n    ContextStage3D.prototype.setVertexBufferAt = function (index, buffer, bufferOffset, format) {\n        if (bufferOffset === void 0) { bufferOffset = 0; }\n        if (format === void 0) { format = null; }\n        if (buffer) {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setVertexBufferAt, index + OpCodes_1.OpCodes.intMask) + buffer.id + \",\" + bufferOffset + \",\" + format + \"$\");\n        }\n        else {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.clearVertexBufferAt, index + OpCodes_1.OpCodes.intMask));\n        }\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setColorMask = function (red, green, blue, alpha) {\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setColorMask, red ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue, green ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue, blue ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue, alpha ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue));\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setBlendFactors = function (sourceFactor, destinationFactor) {\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setBlendFactors) + sourceFactor + \"$\" + destinationFactor + \"$\");\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setRenderToTexture = function (target, enableDepthAndStencil, antiAlias, surfaceSelector) {\n        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = false; }\n        if (antiAlias === void 0) { antiAlias = 0; }\n        if (surfaceSelector === void 0) { surfaceSelector = 0; }\n        if (target === null || target === undefined) {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.clearRenderToTexture));\n        }\n        else {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setRenderToTexture, enableDepthAndStencil ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue) + target.id + \",\" + (antiAlias || 0) + \",\");\n        }\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setRenderToBackBuffer = function () {\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.clearRenderToTexture));\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setScissorRectangle = function (rectangle) {\n        if (rectangle) {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setScissorRect) + rectangle.x + \",\" + rectangle.y + \",\" + rectangle.width + \",\" + rectangle.height + \",\");\n        }\n        else {\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.clearScissorRect));\n        }\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.setDepthTest = function (depthMask, passCompareMode) {\n        this.addStream(String.fromCharCode(OpCodes_1.OpCodes.setDepthTest, depthMask ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue) + passCompareMode + \"$\");\n        if (ContextStage3D.debug)\n            this.execute();\n    };\n    ContextStage3D.prototype.dispose = function () {\n        if (this._container == null)\n            return;\n        console.log(\"Context3D dispose, releasing \" + this._resources.length + \" resources.\");\n        while (this._resources.length)\n            this._resources[0].dispose();\n        if (this._container) {\n            // encode command\n            this.addStream(String.fromCharCode(OpCodes_1.OpCodes.disposeContext));\n            this.execute();\n            //swfobject.removeSWF(this._oldCanvas.id);\n            if (this._oldCanvas && this._oldParent) {\n                this._oldParent.appendChild(this._oldCanvas);\n                this._oldParent = null;\n            }\n            this._container = null;\n        }\n        this._oldCanvas = null;\n    };\n    ContextStage3D.prototype.addStream = function (stream) {\n        this._cmdStream += stream;\n    };\n    ContextStage3D.prototype.execute = function () {\n        if (ContextStage3D.logStream)\n            console.log(this._cmdStream);\n        var result = this._container[\"CallFunction\"](\"<invoke name=\\\"execStage3dOpStream\\\" returntype=\\\"javascript\\\"><arguments><string>\" + this._cmdStream + \"</string></arguments></invoke>\");\n        if (Number(result) <= -3)\n            throw \"Exec stream failed\";\n        this._cmdStream = \"\";\n        return Number(result);\n    };\n    ContextStage3D.contexts = new Object();\n    ContextStage3D.debug = false;\n    ContextStage3D.logStream = false;\n    return ContextStage3D;\n}());\nexports.ContextStage3D = ContextStage3D;\n/**\n* global function for flash callback\n*/\nfunction mountain_js_context_available(id, driverInfo) {\n    var ctx = ContextStage3D.contexts[id];\n    if (ctx._iCallback) {\n        ctx._iDriverInfo = driverInfo;\n        // get out of the current JS stack frame and call back from flash player\n        var timeOutId = window.setTimeout(function () {\n            window.clearTimeout(timeOutId);\n            try {\n                ctx._iCallback(ctx);\n            }\n            catch (e) {\n                console.log(\"Callback failed during flash initialization with '\" + e.toString() + \"'\");\n            }\n        }, 1);\n    }\n}\n\n},{\"../base/ContextGLClearMask\":\"awayjs-stagegl/lib/base/ContextGLClearMask\",\"../base/ContextGLProgramType\":\"awayjs-stagegl/lib/base/ContextGLProgramType\",\"../base/CubeTextureFlash\":\"awayjs-stagegl/lib/base/CubeTextureFlash\",\"../base/IndexBufferFlash\":\"awayjs-stagegl/lib/base/IndexBufferFlash\",\"../base/OpCodes\":\"awayjs-stagegl/lib/base/OpCodes\",\"../base/ProgramFlash\":\"awayjs-stagegl/lib/base/ProgramFlash\",\"../base/TextureFlash\":\"awayjs-stagegl/lib/base/TextureFlash\",\"../base/VertexBufferFlash\":\"awayjs-stagegl/lib/base/VertexBufferFlash\"}],\"awayjs-stagegl/lib/base/ContextWebGL\":[function(require,module,exports){\n\"use strict\";\nvar Rectangle_1 = require(\"awayjs-core/lib/geom/Rectangle\");\nvar ContextGLBlendFactor_1 = require(\"../base/ContextGLBlendFactor\");\nvar ContextGLDrawMode_1 = require(\"../base/ContextGLDrawMode\");\nvar ContextGLClearMask_1 = require(\"../base/ContextGLClearMask\");\nvar ContextGLCompareMode_1 = require(\"../base/ContextGLCompareMode\");\nvar ContextGLMipFilter_1 = require(\"../base/ContextGLMipFilter\");\nvar ContextGLProgramType_1 = require(\"../base/ContextGLProgramType\");\nvar ContextGLStencilAction_1 = require(\"../base/ContextGLStencilAction\");\nvar ContextGLTextureFilter_1 = require(\"../base/ContextGLTextureFilter\");\nvar ContextGLTriangleFace_1 = require(\"../base/ContextGLTriangleFace\");\nvar ContextGLVertexBufferFormat_1 = require(\"../base/ContextGLVertexBufferFormat\");\nvar ContextGLWrapMode_1 = require(\"../base/ContextGLWrapMode\");\nvar CubeTextureWebGL_1 = require(\"../base/CubeTextureWebGL\");\nvar IndexBufferWebGL_1 = require(\"../base/IndexBufferWebGL\");\nvar ProgramWebGL_1 = require(\"../base/ProgramWebGL\");\nvar TextureWebGL_1 = require(\"../base/TextureWebGL\");\nvar SamplerState_1 = require(\"../base/SamplerState\");\nvar VertexBufferWebGL_1 = require(\"../base/VertexBufferWebGL\");\nvar ContextWebGL = (function () {\n    function ContextWebGL(canvas) {\n        this._blendFactorDictionary = new Object();\n        this._drawModeDictionary = new Object();\n        this._compareModeDictionary = new Object();\n        this._stencilActionDictionary = new Object();\n        this._textureIndexDictionary = new Array(8);\n        this._textureTypeDictionary = new Object();\n        this._wrapDictionary = new Object();\n        this._filterDictionary = new Object();\n        this._mipmapFilterDictionary = new Object();\n        this._vertexBufferPropertiesDictionary = [];\n        this._samplerStates = new Array(8);\n        this._stencilReferenceValue = 0;\n        this._stencilReadMask = 0xff;\n        this._separateStencil = false;\n        this._container = canvas;\n        try {\n            this._gl = canvas.getContext(\"experimental-webgl\", { premultipliedAlpha: false, alpha: false, stencil: true });\n            if (!this._gl)\n                this._gl = canvas.getContext(\"webgl\", { premultipliedAlpha: false, alpha: false, stencil: true });\n        }\n        catch (e) {\n        }\n        if (this._gl) {\n            //this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_SUCCESS ) );\n            if (this._gl.getExtension(\"OES_standard_derivatives\")) {\n                this._standardDerivatives = true;\n            }\n            else {\n                this._standardDerivatives = false;\n            }\n            //setup shortcut dictionaries\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.ONE] = this._gl.ONE;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.DESTINATION_ALPHA] = this._gl.DST_ALPHA;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.DESTINATION_COLOR] = this._gl.DST_COLOR;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.ONE] = this._gl.ONE;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.ONE_MINUS_DESTINATION_ALPHA] = this._gl.ONE_MINUS_DST_ALPHA;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.ONE_MINUS_DESTINATION_COLOR] = this._gl.ONE_MINUS_DST_COLOR;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA] = this._gl.ONE_MINUS_SRC_ALPHA;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.ONE_MINUS_SOURCE_COLOR] = this._gl.ONE_MINUS_SRC_COLOR;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.SOURCE_ALPHA] = this._gl.SRC_ALPHA;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.SOURCE_COLOR] = this._gl.SRC_COLOR;\n            this._blendFactorDictionary[ContextGLBlendFactor_1.ContextGLBlendFactor.ZERO] = this._gl.ZERO;\n            this._drawModeDictionary[ContextGLDrawMode_1.ContextGLDrawMode.LINES] = this._gl.LINES;\n            this._drawModeDictionary[ContextGLDrawMode_1.ContextGLDrawMode.TRIANGLES] = this._gl.TRIANGLES;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.ALWAYS] = this._gl.ALWAYS;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.EQUAL] = this._gl.EQUAL;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.GREATER] = this._gl.GREATER;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.GREATER_EQUAL] = this._gl.GEQUAL;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.LESS] = this._gl.LESS;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.LESS_EQUAL] = this._gl.LEQUAL;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.NEVER] = this._gl.NEVER;\n            this._compareModeDictionary[ContextGLCompareMode_1.ContextGLCompareMode.NOT_EQUAL] = this._gl.NOTEQUAL;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.DECREMENT_SATURATE] = this._gl.DECR;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.DECREMENT_WRAP] = this._gl.DECR_WRAP;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.INCREMENT_SATURATE] = this._gl.INCR;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.INCREMENT_WRAP] = this._gl.INCR_WRAP;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.INVERT] = this._gl.INVERT;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.KEEP] = this._gl.KEEP;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.SET] = this._gl.REPLACE;\n            this._stencilActionDictionary[ContextGLStencilAction_1.ContextGLStencilAction.ZERO] = this._gl.ZERO;\n            this._textureIndexDictionary[0] = this._gl.TEXTURE0;\n            this._textureIndexDictionary[1] = this._gl.TEXTURE1;\n            this._textureIndexDictionary[2] = this._gl.TEXTURE2;\n            this._textureIndexDictionary[3] = this._gl.TEXTURE3;\n            this._textureIndexDictionary[4] = this._gl.TEXTURE4;\n            this._textureIndexDictionary[5] = this._gl.TEXTURE5;\n            this._textureIndexDictionary[6] = this._gl.TEXTURE6;\n            this._textureIndexDictionary[7] = this._gl.TEXTURE7;\n            this._textureTypeDictionary[\"texture2d\"] = this._gl.TEXTURE_2D;\n            this._textureTypeDictionary[\"textureCube\"] = this._gl.TEXTURE_CUBE_MAP;\n            this._wrapDictionary[ContextGLWrapMode_1.ContextGLWrapMode.REPEAT] = this._gl.REPEAT;\n            this._wrapDictionary[ContextGLWrapMode_1.ContextGLWrapMode.CLAMP] = this._gl.CLAMP_TO_EDGE;\n            this._filterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR] = this._gl.LINEAR;\n            this._filterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.NEAREST] = this._gl.NEAREST;\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR] = new Object();\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR][ContextGLMipFilter_1.ContextGLMipFilter.MIPNEAREST] = this._gl.LINEAR_MIPMAP_NEAREST;\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR][ContextGLMipFilter_1.ContextGLMipFilter.MIPLINEAR] = this._gl.LINEAR_MIPMAP_LINEAR;\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR][ContextGLMipFilter_1.ContextGLMipFilter.MIPNONE] = this._gl.LINEAR;\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.NEAREST] = new Object();\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.NEAREST][ContextGLMipFilter_1.ContextGLMipFilter.MIPNEAREST] = this._gl.NEAREST_MIPMAP_NEAREST;\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.NEAREST][ContextGLMipFilter_1.ContextGLMipFilter.MIPLINEAR] = this._gl.NEAREST_MIPMAP_LINEAR;\n            this._mipmapFilterDictionary[ContextGLTextureFilter_1.ContextGLTextureFilter.NEAREST][ContextGLMipFilter_1.ContextGLMipFilter.MIPNONE] = this._gl.NEAREST;\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_1] = new VertexBufferProperties(1, this._gl.FLOAT, false);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_2] = new VertexBufferProperties(2, this._gl.FLOAT, false);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_3] = new VertexBufferProperties(3, this._gl.FLOAT, false);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_4] = new VertexBufferProperties(4, this._gl.FLOAT, false);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_1] = new VertexBufferProperties(1, this._gl.BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_2] = new VertexBufferProperties(2, this._gl.BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_3] = new VertexBufferProperties(3, this._gl.BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_4] = new VertexBufferProperties(4, this._gl.BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_1] = new VertexBufferProperties(1, this._gl.UNSIGNED_BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_2] = new VertexBufferProperties(2, this._gl.UNSIGNED_BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_3] = new VertexBufferProperties(3, this._gl.UNSIGNED_BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_4] = new VertexBufferProperties(4, this._gl.UNSIGNED_BYTE, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_1] = new VertexBufferProperties(1, this._gl.SHORT, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_2] = new VertexBufferProperties(2, this._gl.SHORT, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_3] = new VertexBufferProperties(3, this._gl.SHORT, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_4] = new VertexBufferProperties(4, this._gl.SHORT, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_1] = new VertexBufferProperties(1, this._gl.UNSIGNED_SHORT, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_2] = new VertexBufferProperties(2, this._gl.UNSIGNED_SHORT, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_3] = new VertexBufferProperties(3, this._gl.UNSIGNED_SHORT, true);\n            this._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_4] = new VertexBufferProperties(4, this._gl.UNSIGNED_SHORT, true);\n            this._stencilCompareMode = this._gl.ALWAYS;\n            this._stencilCompareModeBack = this._gl.ALWAYS;\n            this._stencilCompareModeFront = this._gl.ALWAYS;\n        }\n        else {\n            //this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_FAILED, e ) );\n            alert(\"WebGL is not available.\");\n        }\n        //defaults\n        for (var i = 0; i < ContextWebGL.MAX_SAMPLERS; ++i) {\n            this._samplerStates[i] = new SamplerState_1.SamplerState();\n            this._samplerStates[i].wrap = this._gl.REPEAT;\n            this._samplerStates[i].filter = this._gl.LINEAR;\n            this._samplerStates[i].mipfilter = this._gl.LINEAR;\n        }\n    }\n    Object.defineProperty(ContextWebGL.prototype, \"container\", {\n        get: function () {\n            return this._container;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ContextWebGL.prototype, \"standardDerivatives\", {\n        get: function () {\n            return this._standardDerivatives;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ContextWebGL.prototype.gl = function () {\n        return this._gl;\n    };\n    ContextWebGL.prototype.clear = function (red, green, blue, alpha, depth, stencil, mask) {\n        if (red === void 0) { red = 0; }\n        if (green === void 0) { green = 0; }\n        if (blue === void 0) { blue = 0; }\n        if (alpha === void 0) { alpha = 1; }\n        if (depth === void 0) { depth = 1; }\n        if (stencil === void 0) { stencil = 0; }\n        if (mask === void 0) { mask = ContextGLClearMask_1.ContextGLClearMask.ALL; }\n        if (!this._drawing) {\n            this.updateBlendStatus();\n            this._drawing = true;\n        }\n        var glmask = 0;\n        if (mask & ContextGLClearMask_1.ContextGLClearMask.COLOR)\n            glmask |= this._gl.COLOR_BUFFER_BIT;\n        if (mask & ContextGLClearMask_1.ContextGLClearMask.STENCIL)\n            glmask |= this._gl.STENCIL_BUFFER_BIT;\n        if (mask & ContextGLClearMask_1.ContextGLClearMask.DEPTH)\n            glmask |= this._gl.DEPTH_BUFFER_BIT;\n        this._gl.clearColor(red, green, blue, alpha);\n        this._gl.clearDepth(depth);\n        this._gl.clearStencil(stencil);\n        this._gl.clear(glmask);\n    };\n    ContextWebGL.prototype.configureBackBuffer = function (width, height, antiAlias, enableDepthAndStencil) {\n        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = true; }\n        this._width = width;\n        this._height = height;\n        if (enableDepthAndStencil) {\n            this._gl.enable(this._gl.STENCIL_TEST);\n            this._gl.enable(this._gl.DEPTH_TEST);\n        }\n        this._gl.viewport['width'] = width;\n        this._gl.viewport['height'] = height;\n        this._gl.viewport(0, 0, width, height);\n    };\n    ContextWebGL.prototype.createCubeTexture = function (size, format, optimizeForRenderToTexture, streamingLevels) {\n        if (streamingLevels === void 0) { streamingLevels = 0; }\n        return new CubeTextureWebGL_1.CubeTextureWebGL(this._gl, size);\n    };\n    ContextWebGL.prototype.createIndexBuffer = function (numIndices) {\n        return new IndexBufferWebGL_1.IndexBufferWebGL(this._gl, numIndices);\n    };\n    ContextWebGL.prototype.createProgram = function () {\n        return new ProgramWebGL_1.ProgramWebGL(this._gl);\n    };\n    ContextWebGL.prototype.createTexture = function (width, height, format, optimizeForRenderToTexture, streamingLevels) {\n        if (streamingLevels === void 0) { streamingLevels = 0; }\n        //TODO streaming\n        return new TextureWebGL_1.TextureWebGL(this._gl, width, height);\n    };\n    ContextWebGL.prototype.createVertexBuffer = function (numVertices, dataPerVertex) {\n        return new VertexBufferWebGL_1.VertexBufferWebGL(this._gl, numVertices, dataPerVertex);\n    };\n    ContextWebGL.prototype.dispose = function () {\n        for (var i = 0; i < this._samplerStates.length; ++i)\n            this._samplerStates[i] = null;\n    };\n    ContextWebGL.prototype.drawToBitmapImage2D = function (destination) {\n        var pixels = new Uint8ClampedArray(destination.width * destination.height * 4);\n        this._gl.readPixels(0, 0, destination.width, destination.height, this._gl.RGBA, this._gl.UNSIGNED_BYTE, pixels);\n        destination.setPixels(new Rectangle_1.Rectangle(0, 0, destination.width, destination.height), pixels);\n    };\n    ContextWebGL.prototype.drawIndices = function (mode, indexBuffer, firstIndex, numIndices) {\n        if (firstIndex === void 0) { firstIndex = 0; }\n        if (numIndices === void 0) { numIndices = -1; }\n        if (!this._drawing)\n            throw \"Need to clear before drawing if the buffer has not been cleared since the last present() call.\";\n        this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, indexBuffer.glBuffer);\n        this._gl.drawElements(this._drawModeDictionary[mode], (numIndices == -1) ? indexBuffer.numIndices : numIndices, this._gl.UNSIGNED_SHORT, firstIndex * 2);\n    };\n    ContextWebGL.prototype.drawVertices = function (mode, firstVertex, numVertices) {\n        if (firstVertex === void 0) { firstVertex = 0; }\n        if (numVertices === void 0) { numVertices = -1; }\n        if (!this._drawing)\n            throw \"Need to clear before drawing if the buffer has not been cleared since the last present() call.\";\n        this._gl.drawArrays(this._drawModeDictionary[mode], firstVertex, numVertices);\n    };\n    ContextWebGL.prototype.present = function () {\n        this._drawing = false;\n    };\n    ContextWebGL.prototype.setBlendFactors = function (sourceFactor, destinationFactor) {\n        this._blendEnabled = true;\n        this._blendSourceFactor = this._blendFactorDictionary[sourceFactor];\n        this._blendDestinationFactor = this._blendFactorDictionary[destinationFactor];\n        this.updateBlendStatus();\n    };\n    ContextWebGL.prototype.setColorMask = function (red, green, blue, alpha) {\n        this._gl.colorMask(red, green, blue, alpha);\n    };\n    ContextWebGL.prototype.setCulling = function (triangleFaceToCull, coordinateSystem) {\n        if (coordinateSystem === void 0) { coordinateSystem = \"leftHanded\"; }\n        if (triangleFaceToCull == ContextGLTriangleFace_1.ContextGLTriangleFace.NONE) {\n            this._gl.disable(this._gl.CULL_FACE);\n        }\n        else {\n            this._gl.enable(this._gl.CULL_FACE);\n            this._gl.cullFace(this.translateTriangleFace(triangleFaceToCull, coordinateSystem));\n        }\n    };\n    // TODO ContextGLCompareMode\n    ContextWebGL.prototype.setDepthTest = function (depthMask, passCompareMode) {\n        this._gl.depthFunc(this._compareModeDictionary[passCompareMode]);\n        this._gl.depthMask(depthMask);\n    };\n    ContextWebGL.prototype.setStencilActions = function (triangleFace, compareMode, actionOnBothPass, actionOnDepthFail, actionOnDepthPassStencilFail, coordinateSystem) {\n        if (triangleFace === void 0) { triangleFace = \"frontAndBack\"; }\n        if (compareMode === void 0) { compareMode = \"always\"; }\n        if (actionOnBothPass === void 0) { actionOnBothPass = \"keep\"; }\n        if (actionOnDepthFail === void 0) { actionOnDepthFail = \"keep\"; }\n        if (actionOnDepthPassStencilFail === void 0) { actionOnDepthPassStencilFail = \"keep\"; }\n        if (coordinateSystem === void 0) { coordinateSystem = \"leftHanded\"; }\n        this._separateStencil = triangleFace != \"frontAndBack\";\n        var compareModeGL = this._compareModeDictionary[compareMode];\n        var fail = this._stencilActionDictionary[actionOnDepthPassStencilFail];\n        var zFail = this._stencilActionDictionary[actionOnDepthFail];\n        var pass = this._stencilActionDictionary[actionOnBothPass];\n        if (!this._separateStencil) {\n            this._stencilCompareMode = compareModeGL;\n            this._gl.stencilFunc(compareModeGL, this._stencilReferenceValue, this._stencilReadMask);\n            this._gl.stencilOp(fail, zFail, pass);\n        }\n        else if (triangleFace == \"back\") {\n            this._stencilCompareModeBack = compareModeGL;\n            this._gl.stencilFuncSeparate(this._gl.BACK, compareModeGL, this._stencilReferenceValue, this._stencilReadMask);\n            this._gl.stencilOpSeparate(this._gl.BACK, fail, zFail, pass);\n        }\n        else if (triangleFace == \"front\") {\n            this._stencilCompareModeFront = compareModeGL;\n            this._gl.stencilFuncSeparate(this._gl.FRONT, compareModeGL, this._stencilReferenceValue, this._stencilReadMask);\n            this._gl.stencilOpSeparate(this._gl.FRONT, fail, zFail, pass);\n        }\n    };\n    ContextWebGL.prototype.setStencilReferenceValue = function (referenceValue, readMask, writeMask) {\n        this._stencilReferenceValue = referenceValue;\n        this._stencilReadMask = readMask;\n        if (this._separateStencil) {\n            this._gl.stencilFuncSeparate(this._gl.FRONT, this._stencilCompareModeFront, referenceValue, readMask);\n            this._gl.stencilFuncSeparate(this._gl.BACK, this._stencilCompareModeBack, referenceValue, readMask);\n        }\n        else {\n            this._gl.stencilFunc(this._stencilCompareMode, referenceValue, readMask);\n        }\n        this._gl.stencilMask(writeMask);\n    };\n    ContextWebGL.prototype.setProgram = function (program) {\n        //TODO decide on construction/reference resposibilities\n        this._currentProgram = program;\n        program.focusProgram();\n    };\n    ContextWebGL.prototype.setProgramConstantsFromArray = function (programType, data) {\n        if (data.length)\n            this._gl.uniform4fv(this._currentProgram.getUniformLocation(programType), data);\n    };\n    ContextWebGL.prototype.setScissorRectangle = function (rectangle) {\n        if (!rectangle) {\n            this._gl.disable(this._gl.SCISSOR_TEST);\n            return;\n        }\n        this._gl.enable(this._gl.SCISSOR_TEST);\n        this._gl.scissor(rectangle.x, rectangle.y, rectangle.width, rectangle.height);\n    };\n    ContextWebGL.prototype.setTextureAt = function (sampler, texture) {\n        var samplerState = this._samplerStates[sampler];\n        if (this._activeTexture != sampler && (texture || samplerState.type)) {\n            this._activeTexture = sampler;\n            this._gl.activeTexture(this._textureIndexDictionary[sampler]);\n        }\n        if (!texture) {\n            if (samplerState.type) {\n                this._gl.bindTexture(samplerState.type, null);\n                samplerState.type = null;\n            }\n            return;\n        }\n        var textureType = this._textureTypeDictionary[texture.textureType];\n        samplerState.type = textureType;\n        this._gl.bindTexture(textureType, texture.glTexture);\n        this._gl.uniform1i(this._currentProgram.getUniformLocation(ContextGLProgramType_1.ContextGLProgramType.SAMPLER, sampler), sampler);\n        this._gl.texParameteri(textureType, this._gl.TEXTURE_WRAP_S, samplerState.wrap);\n        this._gl.texParameteri(textureType, this._gl.TEXTURE_WRAP_T, samplerState.wrap);\n        this._gl.texParameteri(textureType, this._gl.TEXTURE_MAG_FILTER, samplerState.filter);\n        this._gl.texParameteri(textureType, this._gl.TEXTURE_MIN_FILTER, samplerState.mipfilter);\n    };\n    ContextWebGL.prototype.setSamplerStateAt = function (sampler, wrap, filter, mipfilter) {\n        if (0 <= sampler && sampler < ContextWebGL.MAX_SAMPLERS) {\n            this._samplerStates[sampler].wrap = this._wrapDictionary[wrap];\n            this._samplerStates[sampler].filter = this._filterDictionary[filter];\n            this._samplerStates[sampler].mipfilter = this._mipmapFilterDictionary[filter][mipfilter];\n        }\n        else {\n            throw \"Sampler is out of bounds.\";\n        }\n    };\n    ContextWebGL.prototype.setVertexBufferAt = function (index, buffer, bufferOffset, format) {\n        if (bufferOffset === void 0) { bufferOffset = 0; }\n        if (format === void 0) { format = 4; }\n        var location = this._currentProgram ? this._currentProgram.getAttribLocation(index) : -1;\n        if (!buffer) {\n            if (location > -1)\n                this._gl.disableVertexAttribArray(location);\n            return;\n        }\n        //buffer may not have changed if concatenated buffers are being used\n        if (this._currentArrayBuffer != buffer) {\n            this._currentArrayBuffer = buffer;\n            this._gl.bindBuffer(this._gl.ARRAY_BUFFER, buffer ? buffer.glBuffer : null);\n        }\n        var properties = this._vertexBufferPropertiesDictionary[format];\n        this._gl.enableVertexAttribArray(location);\n        this._gl.vertexAttribPointer(location, properties.size, properties.type, properties.normalized, buffer.dataPerVertex, bufferOffset);\n    };\n    ContextWebGL.prototype.setRenderToTexture = function (target, enableDepthAndStencil, antiAlias, surfaceSelector) {\n        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = false; }\n        if (antiAlias === void 0) { antiAlias = 0; }\n        if (surfaceSelector === void 0) { surfaceSelector = 0; }\n        var texture = target;\n        var frameBuffer = texture.frameBuffer;\n        this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, frameBuffer);\n        if (enableDepthAndStencil) {\n            this._gl.enable(this._gl.STENCIL_TEST);\n            this._gl.enable(this._gl.DEPTH_TEST);\n        }\n        this._gl.viewport(0, 0, texture.width, texture.height);\n    };\n    ContextWebGL.prototype.setRenderToBackBuffer = function () {\n        this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n    };\n    ContextWebGL.prototype.updateBlendStatus = function () {\n        if (this._blendEnabled) {\n            this._gl.enable(this._gl.BLEND);\n            this._gl.blendEquation(this._gl.FUNC_ADD);\n            this._gl.blendFunc(this._blendSourceFactor, this._blendDestinationFactor);\n        }\n        else {\n            this._gl.disable(this._gl.BLEND);\n        }\n    };\n    ContextWebGL.prototype.translateTriangleFace = function (triangleFace, coordinateSystem) {\n        switch (triangleFace) {\n            case ContextGLTriangleFace_1.ContextGLTriangleFace.BACK:\n                return (coordinateSystem == \"leftHanded\") ? this._gl.FRONT : this._gl.BACK;\n            case ContextGLTriangleFace_1.ContextGLTriangleFace.FRONT:\n                return (coordinateSystem == \"leftHanded\") ? this._gl.BACK : this._gl.FRONT;\n            case ContextGLTriangleFace_1.ContextGLTriangleFace.FRONT_AND_BACK:\n                return this._gl.FRONT_AND_BACK;\n            default:\n                throw \"Unknown ContextGLTriangleFace type.\"; // TODO error\n        }\n    };\n    ContextWebGL.MAX_SAMPLERS = 8;\n    ContextWebGL.modulo = 0;\n    return ContextWebGL;\n}());\nexports.ContextWebGL = ContextWebGL;\nvar VertexBufferProperties = (function () {\n    function VertexBufferProperties(size, type, normalized) {\n        this.size = size;\n        this.type = type;\n        this.normalized = normalized;\n    }\n    return VertexBufferProperties;\n}());\nexports.VertexBufferProperties = VertexBufferProperties;\n\n},{\"../base/ContextGLBlendFactor\":\"awayjs-stagegl/lib/base/ContextGLBlendFactor\",\"../base/ContextGLClearMask\":\"awayjs-stagegl/lib/base/ContextGLClearMask\",\"../base/ContextGLCompareMode\":\"awayjs-stagegl/lib/base/ContextGLCompareMode\",\"../base/ContextGLDrawMode\":\"awayjs-stagegl/lib/base/ContextGLDrawMode\",\"../base/ContextGLMipFilter\":\"awayjs-stagegl/lib/base/ContextGLMipFilter\",\"../base/ContextGLProgramType\":\"awayjs-stagegl/lib/base/ContextGLProgramType\",\"../base/ContextGLStencilAction\":\"awayjs-stagegl/lib/base/ContextGLStencilAction\",\"../base/ContextGLTextureFilter\":\"awayjs-stagegl/lib/base/ContextGLTextureFilter\",\"../base/ContextGLTriangleFace\":\"awayjs-stagegl/lib/base/ContextGLTriangleFace\",\"../base/ContextGLVertexBufferFormat\":\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\",\"../base/ContextGLWrapMode\":\"awayjs-stagegl/lib/base/ContextGLWrapMode\",\"../base/CubeTextureWebGL\":\"awayjs-stagegl/lib/base/CubeTextureWebGL\",\"../base/IndexBufferWebGL\":\"awayjs-stagegl/lib/base/IndexBufferWebGL\",\"../base/ProgramWebGL\":\"awayjs-stagegl/lib/base/ProgramWebGL\",\"../base/SamplerState\":\"awayjs-stagegl/lib/base/SamplerState\",\"../base/TextureWebGL\":\"awayjs-stagegl/lib/base/TextureWebGL\",\"../base/VertexBufferWebGL\":\"awayjs-stagegl/lib/base/VertexBufferWebGL\",\"awayjs-core/lib/geom/Rectangle\":undefined}],\"awayjs-stagegl/lib/base/CubeTextureFlash\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar ByteArrayBase_1 = require(\"awayjs-core/lib/utils/ByteArrayBase\");\nvar OpCodes_1 = require(\"../base/OpCodes\");\nvar ResourceBaseFlash_1 = require(\"../base/ResourceBaseFlash\");\nvar CubeTextureFlash = (function (_super) {\n    __extends(CubeTextureFlash, _super);\n    function CubeTextureFlash(context, size, format, forRTT, streaming) {\n        if (streaming === void 0) { streaming = false; }\n        _super.call(this);\n        this._context = context;\n        this._size = size;\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.initCubeTexture, (forRTT ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue)) + size + \",\" + streaming + \",\" + format + \"$\");\n        this._pId = this._context.execute();\n        this._context._iAddResource(this);\n    }\n    Object.defineProperty(CubeTextureFlash.prototype, \"size\", {\n        get: function () {\n            return this._size;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CubeTextureFlash.prototype.dispose = function () {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.disposeCubeTexture) + this._pId.toString() + \",\");\n        this._context.execute();\n        this._context._iRemoveResource(this);\n        this._context = null;\n    };\n    CubeTextureFlash.prototype.uploadFromData = function (data, side, miplevel) {\n        if (miplevel === void 0) { miplevel = 0; }\n        if (data instanceof HTMLImageElement) {\n            var can = document.createElement(\"canvas\");\n            var w = data.width;\n            var h = data.height;\n            can.width = w;\n            can.height = h;\n            var ctx = can.getContext(\"2d\");\n            ctx.drawImage(data, 0, 0);\n            data = ctx.getImageData(0, 0, w, h).data;\n        }\n        var pos = 0;\n        var bytes = ByteArrayBase_1.ByteArrayBase.internalGetBase64String(data.length, function () {\n            return data[pos++];\n        }, null);\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.uploadBytesCubeTexture) + this._pId + \",\" + miplevel + \",\" + side + \",\" + (this.size >> miplevel) + \",\" + bytes + \"%\");\n        this._context.execute();\n    };\n    CubeTextureFlash.prototype.uploadCompressedTextureFromByteArray = function (data, byteArrayOffset /*uint*/, async) {\n        if (async === void 0) { async = false; }\n    };\n    return CubeTextureFlash;\n}(ResourceBaseFlash_1.ResourceBaseFlash));\nexports.CubeTextureFlash = CubeTextureFlash;\n\n},{\"../base/OpCodes\":\"awayjs-stagegl/lib/base/OpCodes\",\"../base/ResourceBaseFlash\":\"awayjs-stagegl/lib/base/ResourceBaseFlash\",\"awayjs-core/lib/utils/ByteArrayBase\":undefined}],\"awayjs-stagegl/lib/base/CubeTextureWebGL\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar TextureBaseWebGL_1 = require(\"../base/TextureBaseWebGL\");\nvar CubeTextureWebGL = (function (_super) {\n    __extends(CubeTextureWebGL, _super);\n    function CubeTextureWebGL(gl, size) {\n        _super.call(this, gl);\n        this._textureSelectorDictionary = new Array(6);\n        this.textureType = \"textureCube\";\n        this._size = size;\n        this._texture = this._gl.createTexture();\n        this._textureSelectorDictionary[0] = gl.TEXTURE_CUBE_MAP_POSITIVE_X;\n        this._textureSelectorDictionary[1] = gl.TEXTURE_CUBE_MAP_NEGATIVE_X;\n        this._textureSelectorDictionary[2] = gl.TEXTURE_CUBE_MAP_POSITIVE_Y;\n        this._textureSelectorDictionary[3] = gl.TEXTURE_CUBE_MAP_NEGATIVE_Y;\n        this._textureSelectorDictionary[4] = gl.TEXTURE_CUBE_MAP_POSITIVE_Z;\n        this._textureSelectorDictionary[5] = gl.TEXTURE_CUBE_MAP_NEGATIVE_Z;\n    }\n    CubeTextureWebGL.prototype.dispose = function () {\n        this._gl.deleteTexture(this._texture);\n    };\n    CubeTextureWebGL.prototype.uploadFromData = function (data, side, miplevel) {\n        if (miplevel === void 0) { miplevel = 0; }\n        this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP, this._texture);\n        this._gl.texImage2D(this._textureSelectorDictionary[side], miplevel, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, data);\n        this._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP, null);\n    };\n    CubeTextureWebGL.prototype.uploadCompressedTextureFromByteArray = function (data, byteArrayOffset /*uint*/, async) {\n        if (async === void 0) { async = false; }\n    };\n    Object.defineProperty(CubeTextureWebGL.prototype, \"size\", {\n        get: function () {\n            return this._size;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CubeTextureWebGL.prototype, \"glTexture\", {\n        get: function () {\n            return this._texture;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return CubeTextureWebGL;\n}(TextureBaseWebGL_1.TextureBaseWebGL));\nexports.CubeTextureWebGL = CubeTextureWebGL;\n\n},{\"../base/TextureBaseWebGL\":\"awayjs-stagegl/lib/base/TextureBaseWebGL\"}],\"awayjs-stagegl/lib/base/IContextGL\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/base/ICubeTexture\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/base/IIndexBuffer\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/base/IProgram\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/base/ITextureBase\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/base/ITexture\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/base/IVertexBuffer\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/base/IndexBufferFlash\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar OpCodes_1 = require(\"../base/OpCodes\");\nvar ResourceBaseFlash_1 = require(\"../base/ResourceBaseFlash\");\nvar IndexBufferFlash = (function (_super) {\n    __extends(IndexBufferFlash, _super);\n    function IndexBufferFlash(context, numIndices) {\n        _super.call(this);\n        this._context = context;\n        this._numIndices = numIndices;\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.initIndexBuffer, numIndices + OpCodes_1.OpCodes.intMask));\n        this._pId = this._context.execute();\n        this._context._iAddResource(this);\n    }\n    IndexBufferFlash.prototype.uploadFromArray = function (data, startOffset, count) {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.uploadArrayIndexBuffer, this._pId + OpCodes_1.OpCodes.intMask) + data.join() + \"#\" + startOffset + \",\" + count + \",\");\n        this._context.execute();\n    };\n    IndexBufferFlash.prototype.uploadFromByteArray = function (data, startOffset, count) {\n    };\n    IndexBufferFlash.prototype.dispose = function () {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.disposeIndexBuffer, this._pId + OpCodes_1.OpCodes.intMask));\n        this._context.execute();\n        this._context._iRemoveResource(this);\n        this._context = null;\n    };\n    Object.defineProperty(IndexBufferFlash.prototype, \"numIndices\", {\n        get: function () {\n            return this._numIndices;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return IndexBufferFlash;\n}(ResourceBaseFlash_1.ResourceBaseFlash));\nexports.IndexBufferFlash = IndexBufferFlash;\n\n},{\"../base/OpCodes\":\"awayjs-stagegl/lib/base/OpCodes\",\"../base/ResourceBaseFlash\":\"awayjs-stagegl/lib/base/ResourceBaseFlash\"}],\"awayjs-stagegl/lib/base/IndexBufferSoftware\":[function(require,module,exports){\n\"use strict\";\nvar IndexBufferSoftware = (function () {\n    function IndexBufferSoftware(numIndices) {\n        this._numIndices = numIndices;\n    }\n    IndexBufferSoftware.prototype.uploadFromArray = function (data, startOffset, count) {\n        this._startOffset = startOffset * 2;\n        this._data = new Uint16Array(data);\n    };\n    IndexBufferSoftware.prototype.uploadFromByteArray = function (data, startOffset, count) {\n        this._startOffset = startOffset * 2;\n        this._data = new Uint16Array(data);\n    };\n    IndexBufferSoftware.prototype.dispose = function () {\n        this._data = null;\n    };\n    Object.defineProperty(IndexBufferSoftware.prototype, \"numIndices\", {\n        get: function () {\n            return this._numIndices;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(IndexBufferSoftware.prototype, \"data\", {\n        get: function () {\n            return this._data;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(IndexBufferSoftware.prototype, \"startOffset\", {\n        get: function () {\n            return this._startOffset;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return IndexBufferSoftware;\n}());\nexports.IndexBufferSoftware = IndexBufferSoftware;\n\n},{}],\"awayjs-stagegl/lib/base/IndexBufferWebGL\":[function(require,module,exports){\n\"use strict\";\nvar IndexBufferWebGL = (function () {\n    function IndexBufferWebGL(gl, numIndices) {\n        this._gl = gl;\n        this._buffer = this._gl.createBuffer();\n        this._numIndices = numIndices;\n    }\n    IndexBufferWebGL.prototype.uploadFromArray = function (data, startOffset, count) {\n        this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this._buffer);\n        if (startOffset)\n            this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER, startOffset * 2, new Uint16Array(data));\n        else\n            this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(data), this._gl.STATIC_DRAW);\n    };\n    IndexBufferWebGL.prototype.uploadFromByteArray = function (data, startOffset, count) {\n        this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this._buffer);\n        if (startOffset)\n            this._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER, startOffset * 2, data);\n        else\n            this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, data, this._gl.STATIC_DRAW);\n    };\n    IndexBufferWebGL.prototype.dispose = function () {\n        this._gl.deleteBuffer(this._buffer);\n    };\n    Object.defineProperty(IndexBufferWebGL.prototype, \"numIndices\", {\n        get: function () {\n            return this._numIndices;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(IndexBufferWebGL.prototype, \"glBuffer\", {\n        get: function () {\n            return this._buffer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return IndexBufferWebGL;\n}());\nexports.IndexBufferWebGL = IndexBufferWebGL;\n\n},{}],\"awayjs-stagegl/lib/base/OpCodes\":[function(require,module,exports){\n\"use strict\";\nvar OpCodes = (function () {\n    function OpCodes() {\n    }\n    OpCodes.trueValue = 32;\n    OpCodes.falseValue = 33;\n    OpCodes.intMask = 63;\n    OpCodes.drawTriangles = 41;\n    OpCodes.setProgramConstant = 42;\n    OpCodes.setProgram = 43;\n    OpCodes.present = 44;\n    OpCodes.clear = 45;\n    OpCodes.initProgram = 46;\n    OpCodes.initVertexBuffer = 47;\n    OpCodes.initIndexBuffer = 48;\n    OpCodes.configureBackBuffer = 49;\n    OpCodes.uploadArrayIndexBuffer = 50;\n    OpCodes.uploadArrayVertexBuffer = 51;\n    OpCodes.uploadAGALBytesProgram = 52;\n    OpCodes.setVertexBufferAt = 53;\n    OpCodes.uploadBytesIndexBuffer = 54;\n    OpCodes.uploadBytesVertexBuffer = 55;\n    OpCodes.setColorMask = 56;\n    OpCodes.setDepthTest = 57;\n    OpCodes.disposeProgram = 58;\n    OpCodes.disposeContext = 59;\n    // must skip 60 '<' as it will invalidate xml being passed over the bridge\n    OpCodes.disposeVertexBuffer = 61;\n    // must skip 62 '>' as it will invalidate xml being passed over the bridge\n    OpCodes.disposeIndexBuffer = 63;\n    OpCodes.initTexture = 64;\n    OpCodes.setTextureAt = 65;\n    OpCodes.uploadBytesTexture = 66;\n    OpCodes.disposeTexture = 67;\n    OpCodes.setCulling = 68;\n    OpCodes.setScissorRect = 69;\n    OpCodes.clearScissorRect = 70;\n    OpCodes.setBlendFactors = 71;\n    OpCodes.setRenderToTexture = 72;\n    OpCodes.clearTextureAt = 73;\n    OpCodes.clearVertexBufferAt = 74;\n    OpCodes.setStencilActions = 75;\n    OpCodes.setStencilReferenceValue = 76;\n    OpCodes.initCubeTexture = 77;\n    OpCodes.disposeCubeTexture = 78;\n    OpCodes.uploadBytesCubeTexture = 79;\n    OpCodes.clearRenderToTexture = 80;\n    OpCodes.enableErrorChecking = 81;\n    return OpCodes;\n}());\nexports.OpCodes = OpCodes;\n\n},{}],\"awayjs-stagegl/lib/base/ProgramFlash\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar ContextStage3D_1 = require(\"../base/ContextStage3D\");\nvar OpCodes_1 = require(\"../base/OpCodes\");\nvar ResourceBaseFlash_1 = require(\"../base/ResourceBaseFlash\");\nvar ProgramFlash = (function (_super) {\n    __extends(ProgramFlash, _super);\n    function ProgramFlash(context) {\n        _super.call(this);\n        this._context = context;\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.initProgram));\n        this._pId = this._context.execute();\n        this._context._iAddResource(this);\n    }\n    ProgramFlash.prototype.upload = function (vertexProgram, fragmentProgram) {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.uploadAGALBytesProgram, this._pId + OpCodes_1.OpCodes.intMask) + vertexProgram.readBase64String(vertexProgram.length) + \"%\" + fragmentProgram.readBase64String(fragmentProgram.length) + \"%\");\n        if (ContextStage3D_1.ContextStage3D.debug)\n            this._context.execute();\n    };\n    ProgramFlash.prototype.dispose = function () {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.disposeProgram, this._pId + OpCodes_1.OpCodes.intMask));\n        this._context.execute();\n        this._context._iRemoveResource(this);\n        this._context = null;\n    };\n    return ProgramFlash;\n}(ResourceBaseFlash_1.ResourceBaseFlash));\nexports.ProgramFlash = ProgramFlash;\n\n},{\"../base/ContextStage3D\":\"awayjs-stagegl/lib/base/ContextStage3D\",\"../base/OpCodes\":\"awayjs-stagegl/lib/base/OpCodes\",\"../base/ResourceBaseFlash\":\"awayjs-stagegl/lib/base/ResourceBaseFlash\"}],\"awayjs-stagegl/lib/base/ProgramSoftware\":[function(require,module,exports){\n\"use strict\";\nvar AGALTokenizer_1 = require(\"../aglsl/AGALTokenizer\");\nvar ProgramVOSoftware_1 = require(\"../base/ProgramVOSoftware\");\nvar ContextGLVertexBufferFormat_1 = require(\"../base/ContextGLVertexBufferFormat\");\nvar SoftwareSamplerState_1 = require(\"../base/SoftwareSamplerState\");\nvar ContextGLTextureFilter_1 = require(\"../base/ContextGLTextureFilter\");\nvar ContextGLMipFilter_1 = require(\"../base/ContextGLMipFilter\");\nvar ContextGLWrapMode_1 = require(\"../base/ContextGLWrapMode\");\nvar ProgramSoftware = (function () {\n    function ProgramSoftware() {\n        this._numVarying = 0;\n    }\n    Object.defineProperty(ProgramSoftware.prototype, \"numVarying\", {\n        get: function () {\n            return this._numVarying;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ProgramSoftware.prototype.upload = function (vertexProgram, fragmentProgram) {\n        this._vertexDescr = ProgramSoftware._tokenizer.decribeAGALByteArray(vertexProgram);\n        this._vertexVO = new ProgramVOSoftware_1.ProgramVOSoftware();\n        this._vertexVO.temp = new Float32Array(this._vertexDescr.regwrite[0x2].length * 4);\n        this._vertexVO.attributes = new Float32Array(this._vertexDescr.regread[0x0].length * 4);\n        this._numVarying = this._vertexDescr.regwrite[0x4].length;\n        this._fragmentDescr = ProgramSoftware._tokenizer.decribeAGALByteArray(fragmentProgram);\n        this._fragmentVO = new ProgramVOSoftware_1.ProgramVOSoftware();\n        this._fragmentVO.temp = new Float32Array(this._fragmentDescr.regwrite[0x2].length * 4);\n        this._fragmentVO.varying = new Float32Array(this._fragmentDescr.regread[0x4].length * 4);\n        this._fragmentVO.derivativeX = new Float32Array(this._fragmentVO.varying.length);\n        this._fragmentVO.derivativeY = new Float32Array(this._fragmentVO.varying.length);\n    };\n    ProgramSoftware.prototype.dispose = function () {\n        this._vertexDescr = null;\n        this._fragmentDescr = null;\n    };\n    ProgramSoftware.prototype.vertex = function (context, vertexIndex, position, varying) {\n        //set attributes\n        var i;\n        var j = 0;\n        var numAttributes = this._vertexDescr.regread[0x0].length;\n        var attributes = this._vertexVO.attributes;\n        for (i = 0; i < numAttributes; i++) {\n            var buffer = context._vertexBuffers[i];\n            if (!buffer)\n                continue;\n            var index = context._vertexBufferOffsets[i] / 4 + vertexIndex * buffer.attributesPerVertex;\n            if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_4) {\n                attributes[j++] = buffer.uintData[index * 4];\n                attributes[j++] = buffer.uintData[index * 4 + 1];\n                attributes[j++] = buffer.uintData[index * 4 + 2];\n                attributes[j++] = buffer.uintData[index * 4 + 3];\n            }\n            else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_4) {\n                attributes[j++] = buffer.data[index];\n                attributes[j++] = buffer.data[index + 1];\n                attributes[j++] = buffer.data[index + 2];\n                attributes[j++] = buffer.data[index + 3];\n            }\n            else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_3) {\n                attributes[j++] = buffer.data[index];\n                attributes[j++] = buffer.data[index + 1];\n                attributes[j++] = buffer.data[index + 2];\n                attributes[j++] = 1;\n            }\n            else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_2) {\n                attributes[j++] = buffer.data[index];\n                attributes[j++] = buffer.data[index + 1];\n                attributes[j++] = 0;\n                attributes[j++] = 1;\n            }\n            else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_1) {\n                attributes[j++] = buffer.data[index];\n                attributes[j++] = 0;\n                attributes[j++] = 0;\n                attributes[j++] = 1;\n            }\n        }\n        //clear temps\n        var temp = this._vertexVO.temp;\n        var numTemp = temp.length;\n        for (var i = 0; i < numTemp; i += 4) {\n            temp[i] = 0;\n            temp[i + 1] = 0;\n            temp[i + 2] = 0;\n            temp[i + 3] = 1;\n        }\n        this._vertexVO.outputPosition = position;\n        this._vertexVO.varying = varying;\n        var len = this._vertexDescr.tokens.length;\n        for (var i = 0; i < len; i++) {\n            var token = this._vertexDescr.tokens[i];\n            ProgramSoftware._opCodeFunc[token.opcode](this._vertexVO, this._vertexDescr, token.dest, token.a, token.b, context);\n        }\n    };\n    ProgramSoftware.prototype.fragment = function (context, clip, clipRight, clipBottom, varying0, varying1, varying2, fragDepth) {\n        this._fragmentVO.outputDepth = fragDepth;\n        //clear temps\n        var temp = this._fragmentVO.temp;\n        var numTemp = temp.length;\n        for (var i = 0; i < numTemp; i += 4) {\n            temp[i] = 0;\n            temp[i + 1] = 0;\n            temp[i + 2] = 0;\n            temp[i + 3] = 1;\n        }\n        //check for requirement of derivatives\n        var varyingDerivatives = [];\n        var len = this._fragmentDescr.tokens.length;\n        for (var i = 0; i < len; i++) {\n            var token = this._fragmentDescr.tokens[i];\n            if (token.opcode == 0x28 && context._samplerStates[token.b.regnum] && context._samplerStates[token.b.regnum].mipfilter == ContextGLMipFilter_1.ContextGLMipFilter.MIPLINEAR && context._textures[token.b.regnum].getMipLevelsCount() > 1)\n                varyingDerivatives.push(token.a.regnum);\n        }\n        var derivativeX = this._fragmentVO.derivativeX;\n        var derivativeY = this._fragmentVO.derivativeY;\n        var varying = this._fragmentVO.varying;\n        var numVarying = varying.length;\n        for (var i = 0; i < numVarying; i += 4) {\n            // if (!varying0 || !varying1 || !varying2) continue;\n            varying[i] = clip.x * varying0[i] + clip.y * varying1[i] + clip.z * varying2[i];\n            varying[i + 1] = clip.x * varying0[i + 1] + clip.y * varying1[i + 1] + clip.z * varying2[i + 1];\n            varying[i + 2] = clip.x * varying0[i + 2] + clip.y * varying1[i + 2] + clip.z * varying2[i + 2];\n            varying[i + 3] = clip.x * varying0[i + 3] + clip.y * varying1[i + 3] + clip.z * varying2[i + 3];\n            if (varyingDerivatives.indexOf(i) == -1)\n                continue;\n            derivativeX[i] = clipRight.x * varying0[i] + clipRight.y * varying1[i] + clipRight.z * varying2[i];\n            derivativeX[i + 1] = clipRight.x * varying0[i + 1] + clipRight.y * varying1[i + 1] + clipRight.z * varying2[i + 1];\n            derivativeX[i + 2] = clipRight.x * varying0[i + 2] + clipRight.y * varying1[i + 2] + clipRight.z * varying2[i + 2];\n            derivativeX[i + 3] = clipRight.x * varying0[i + 3] + clipRight.y * varying1[i + 3] + clipRight.z * varying2[i + 3];\n            derivativeX[i] -= varying[i];\n            derivativeX[i + 1] -= varying[i + 1];\n            derivativeX[i + 2] -= varying[i + 2];\n            derivativeX[i + 3] -= varying[i + 3];\n            derivativeY[i] = clipBottom.x * varying0[i] + clipBottom.y * varying1[i] + clipBottom.z * varying2[i];\n            derivativeY[i + 1] = clipBottom.x * varying0[i + 1] + clipBottom.y * varying1[i + 1] + clipBottom.z * varying2[i + 1];\n            derivativeY[i + 2] = clipBottom.x * varying0[i + 2] + clipBottom.y * varying1[i + 2] + clipBottom.z * varying2[i + 2];\n            derivativeY[i + 3] = clipBottom.x * varying0[i + 3] + clipBottom.y * varying1[i + 3] + clipBottom.z * varying2[i + 3];\n            derivativeY[i] -= varying[i];\n            derivativeY[i + 1] -= varying[i + 1];\n            derivativeY[i + 2] -= varying[i + 2];\n            derivativeY[i + 3] -= varying[i + 3];\n        }\n        for (var i = 0; i < len; i++) {\n            var token = this._fragmentDescr.tokens[i];\n            ProgramSoftware._opCodeFunc[token.opcode](this._fragmentVO, this._fragmentDescr, token.dest, token.a, token.b, context);\n        }\n        return this._fragmentVO;\n    };\n    ProgramSoftware.getDestTarget = function (vo, desc, dest) {\n        var target;\n        if (dest.regtype == 0x2) {\n            target = vo.temp;\n        }\n        else if (dest.regtype == 0x3) {\n            if (desc.header.type == \"vertex\") {\n                target = vo.outputPosition;\n            }\n            else {\n                target = vo.outputColor;\n            }\n        }\n        else if (dest.regtype == 0x4) {\n            target = vo.varying;\n        }\n        return target;\n    };\n    ProgramSoftware.getSourceTarget = function (vo, desc, dest, context) {\n        var target;\n        if (dest.regtype == 0x0) {\n            target = vo.attributes;\n        }\n        else if (dest.regtype == 0x1) {\n            if (desc.header.type == \"vertex\") {\n                target = context._vertexConstants;\n            }\n            else {\n                target = context._fragmentConstants;\n            }\n        }\n        else if (dest.regtype == 0x2) {\n            target = vo.temp;\n        }\n        else if (dest.regtype == 0x4) {\n            target = vo.varying;\n        }\n        return target;\n    };\n    ProgramSoftware.mov = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1.swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1.swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1.swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1.swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.m44 = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg] * source2Target[source2Reg] + source1Target[source1Reg + 1] * source2Target[source2Reg + 1] + source1Target[source1Reg + 2] * source2Target[source2Reg + 2] + source2Target[source2Reg + 3];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg] * source2Target[source2Reg + 4] + source1Target[source1Reg + 1] * source2Target[source2Reg + 5] + source1Target[source1Reg + 2] * source2Target[source2Reg + 6] + source2Target[source2Reg + 7];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg] * source2Target[source2Reg + 8] + source1Target[source1Reg + 1] * source2Target[source2Reg + 9] + source1Target[source1Reg + 2] * source2Target[source2Reg + 10] + source2Target[source2Reg + 11];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg] * source2Target[source2Reg + 12] + source1Target[source1Reg + 1] * source2Target[source2Reg + 13] + source1Target[source1Reg + 2] * source2Target[source2Reg + 14] + source2Target[source2Reg + 15];\n    };\n    ProgramSoftware.sample = function (vo, desc, context, source1, textureIndex) {\n        var source1Reg = 4 * source1.regnum;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var u = source1Target[((source1.swizzle >> 0) & 3)];\n        var v = source1Target[((source1.swizzle >> 2) & 3)];\n        if (textureIndex >= context._textures.length || context._textures[textureIndex] == null)\n            return new Float32Array([1, u, v, 0]);\n        var texture = context._textures[textureIndex];\n        var state = context._samplerStates[textureIndex] || this._defaultSamplerState;\n        var repeat = state.wrap == ContextGLWrapMode_1.ContextGLWrapMode.REPEAT;\n        var mipmap = state.mipfilter == ContextGLMipFilter_1.ContextGLMipFilter.MIPLINEAR;\n        if (mipmap && texture.getMipLevelsCount() > 1) {\n            var dux = Math.abs(vo.derivativeX[source1Reg + ((source1.swizzle >> 0) & 3)]);\n            var dvx = Math.abs(vo.derivativeX[source1Reg + ((source1.swizzle >> 2) & 3)]);\n            var duy = Math.abs(vo.derivativeY[source1Reg + ((source1.swizzle >> 0) & 3)]);\n            var dvy = Math.abs(vo.derivativeY[source1Reg + ((source1.swizzle >> 2) & 3)]);\n            var lambda = Math.log(Math.max(texture.width * Math.sqrt(dux * dux + dvx * dvx), texture.height * Math.sqrt(duy * duy + dvy * dvy))) / Math.LN2;\n            if (lambda > 0) {\n                var miplevelLow = Math.floor(lambda);\n                var miplevelHigh = Math.ceil(lambda);\n                var maxmiplevel = Math.log(Math.min(texture.width, texture.height)) / Math.LN2;\n                if (miplevelHigh > maxmiplevel)\n                    miplevelHigh = maxmiplevel;\n                if (miplevelLow > maxmiplevel)\n                    miplevelLow = maxmiplevel;\n                var mipblend = lambda - Math.floor(lambda);\n                var resultLow;\n                var resultHigh;\n                var dataLow = texture.getData(miplevelLow);\n                var dataLowWidth = texture.width / Math.pow(2, miplevelLow);\n                var dataLowHeight = texture.height / Math.pow(2, miplevelLow);\n                var dataHigh = texture.getData(miplevelHigh);\n                var dataHighWidth = texture.width / Math.pow(2, miplevelHigh);\n                var dataHighHeight = texture.height / Math.pow(2, miplevelHigh);\n                if (state.filter == ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR) {\n                    resultLow = ProgramSoftware.sampleBilinear(u, v, dataLow, dataLowWidth, dataLowHeight, repeat);\n                    resultHigh = ProgramSoftware.sampleBilinear(u, v, dataHigh, dataHighWidth, dataHighHeight, repeat);\n                }\n                else {\n                    resultLow = ProgramSoftware.sampleNearest(u, v, dataLow, dataLowWidth, dataLowHeight, repeat);\n                    resultHigh = ProgramSoftware.sampleNearest(u, v, dataHigh, dataHighWidth, dataHighHeight, repeat);\n                }\n                return ProgramSoftware.interpolateColor(resultLow, resultHigh, mipblend);\n            }\n        }\n        var result;\n        var data = texture.getData(0);\n        if (state.filter == ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR) {\n            result = ProgramSoftware.sampleBilinear(u, v, data, texture.width, texture.height, repeat);\n        }\n        else {\n            result = ProgramSoftware.sampleNearest(u, v, data, texture.width, texture.height, repeat);\n        }\n        return result;\n    };\n    ProgramSoftware.sampleNearest = function (u, v, textureData, textureWidth, textureHeight, repeat) {\n        u *= textureWidth;\n        v *= textureHeight;\n        if (repeat) {\n            u = Math.abs(u % textureWidth);\n            v = Math.abs(v % textureHeight);\n        }\n        else {\n            if (u < 0)\n                u = 0;\n            else if (u > textureWidth - 1)\n                u = textureWidth - 1;\n            if (v < 0)\n                v = 0;\n            else if (v > textureHeight - 1)\n                v = textureHeight - 1;\n        }\n        u = Math.floor(u);\n        v = Math.floor(v);\n        var pos = (u + v * textureWidth) * 4;\n        var r = textureData[pos] / 255;\n        var g = textureData[pos + 1] / 255;\n        var b = textureData[pos + 2] / 255;\n        var a = textureData[pos + 3] / 255;\n        return new Float32Array([a, r, g, b]);\n    };\n    ProgramSoftware.sampleBilinear = function (u, v, textureData, textureWidth, textureHeight, repeat) {\n        var texelSizeX = 1 / textureWidth;\n        var texelSizeY = 1 / textureHeight;\n        u -= texelSizeX / 2;\n        v -= texelSizeY / 2;\n        var color00 = ProgramSoftware.sampleNearest(u, v, textureData, textureWidth, textureHeight, repeat);\n        var color10 = ProgramSoftware.sampleNearest(u + texelSizeX, v, textureData, textureWidth, textureHeight, repeat);\n        var color01 = ProgramSoftware.sampleNearest(u, v + texelSizeY, textureData, textureWidth, textureHeight, repeat);\n        var color11 = ProgramSoftware.sampleNearest(u + texelSizeX, v + texelSizeY, textureData, textureWidth, textureHeight, repeat);\n        var a = u * textureWidth;\n        a = a - Math.floor(a);\n        var interColor0 = ProgramSoftware.interpolateColor(color00, color10, a);\n        var interColor1 = ProgramSoftware.interpolateColor(color01, color11, a);\n        var b = v * textureHeight;\n        b = b - Math.floor(b);\n        return ProgramSoftware.interpolateColor(interColor0, interColor1, b);\n    };\n    ProgramSoftware.interpolateColor = function (source, target, a) {\n        var result = new Float32Array(4);\n        result[0] = source[0] + (target[0] - source[0]) * a;\n        result[1] = source[1] + (target[1] - source[1]) * a;\n        result[2] = source[2] + (target[2] - source[2]) * a;\n        result[3] = source[3] + (target[3] - source[3]) * a;\n        return result;\n    };\n    ProgramSoftware.tex = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var color = ProgramSoftware.sample(vo, desc, context, source1, source2.regnum);\n        var mask = dest.mask;\n        if (mask & 1)\n            target[targetReg] = color[1];\n        if (mask & 2)\n            target[targetReg + 1] = color[2];\n        if (mask & 4)\n            target[targetReg + 2] = color[3];\n        if (mask & 8)\n            target[targetReg + 3] = color[0];\n    };\n    ProgramSoftware.add = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.sub = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.mul = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] * source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] * source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] * source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] * source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.div = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] / source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] / source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] / source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] / source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.rcp = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = 1 / source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = 1 / source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = 1 / source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = 1 / source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.min = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)], source2Target[source2Reg + ((source2Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)], source2Target[source2Reg + ((source2Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)], source2Target[source2Reg + ((source2Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)], source2Target[source2Reg + ((source2Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.max = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)], source2Target[source2Reg + ((source2Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)], source2Target[source2Reg + ((source2Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)], source2Target[source2Reg + ((source2Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)], source2Target[source2Reg + ((source2Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.frc = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.sqt = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.rsq = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = 1 / Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = 1 / Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = 1 / Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = 1 / Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.pow = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)], source2Target[source2Reg + ((source2Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)], source2Target[source2Reg + ((source2Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)], source2Target[source2Reg + ((source2Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)], source2Target[source2Reg + ((source2Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.log = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]) / Math.LN2;\n        if (mask & 2)\n            target[targetReg + 1] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]) / Math.LN2;\n        if (mask & 4)\n            target[targetReg + 2] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]) / Math.LN2;\n        if (mask & 8)\n            target[targetReg + 3] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]) / Math.LN2;\n    };\n    ProgramSoftware.exp = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.nrm = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var x = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var y = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var z = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var len = Math.sqrt(x * x + y * y + z * z);\n        x /= len;\n        y /= len;\n        z /= len;\n        if (mask & 1)\n            target[targetReg] = x;\n        if (mask & 2)\n            target[targetReg + 1] = y;\n        if (mask & 4)\n            target[targetReg + 2] = z;\n    };\n    ProgramSoftware.sin = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.cos = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.crs = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var source2TargetX = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        var source2TargetY = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        var source2TargetZ = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        if (mask & 1)\n            target[targetReg] = source1TargetY * source2TargetZ - source1TargetZ * source2TargetY;\n        if (mask & 2)\n            target[targetReg + 1] = source1TargetZ * source2TargetX - source1TargetX * source2TargetZ;\n        if (mask & 4)\n            target[targetReg + 2] = source1TargetX * source2TargetY - source1TargetY * source2TargetX;\n    };\n    ProgramSoftware.dp3 = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var source2TargetX = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        var source2TargetY = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        var source2TargetZ = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        if (mask & 1)\n            target[targetReg] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ;\n        if (mask & 2)\n            target[targetReg + 1] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ;\n        if (mask & 4)\n            target[targetReg + 2] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ;\n        if (mask & 8)\n            target[targetReg + 3] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ;\n    };\n    ProgramSoftware.dp4 = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source1TargetW = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var source2TargetX = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        var source2TargetY = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        var source2TargetZ = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        var source2TargetW = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n        if (mask & 1)\n            target[targetReg] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ + source1TargetW * source2TargetW;\n        if (mask & 2)\n            target[targetReg + 1] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ + source1TargetW * source2TargetW;\n        if (mask & 4)\n            target[targetReg + 2] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ + source1TargetW * source2TargetW;\n        if (mask & 8)\n            target[targetReg + 3] = source1TargetX * source2TargetX + source1TargetY * source2TargetY + source1TargetZ * source2TargetZ + source1TargetW * source2TargetW;\n    };\n    ProgramSoftware.abs = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n        if (mask & 2)\n            target[targetReg + 1] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n        if (mask & 4)\n            target[targetReg + 2] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n        if (mask & 8)\n            target[targetReg + 3] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n    };\n    ProgramSoftware.neg = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = -source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = -source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = -source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = -source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.sat = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]));\n        if (mask & 2)\n            target[targetReg + 1] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]));\n        if (mask & 4)\n            target[targetReg + 2] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]));\n        if (mask & 8)\n            target[targetReg + 3] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]));\n    };\n    ProgramSoftware.m33 = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg] * source2Target[source2Reg] + source1Target[source1Reg + 1] * source2Target[source2Reg + 1] + source1Target[source1Reg + 2] * source2Target[source2Reg + 2];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg] * source2Target[source2Reg + 4] + source1Target[source1Reg + 1] * source2Target[source2Reg + 5] + source1Target[source1Reg + 2] * source2Target[source2Reg + 6];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg] * source2Target[source2Reg + 8] + source1Target[source1Reg + 1] * source2Target[source2Reg + 9] + source1Target[source1Reg + 2] * source2Target[source2Reg + 10];\n    };\n    ProgramSoftware.m34 = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source2.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var mask = dest.mask;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg] * source2Target[source2Reg] + source1Target[source1Reg + 1] * source2Target[source2Reg + 1] + source1Target[source1Reg + 2] * source2Target[source2Reg + 2] + source2Target[source2Reg + 3];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg] * source2Target[source2Reg + 4] + source1Target[source1Reg + 1] * source2Target[source2Reg + 5] + source1Target[source1Reg + 2] * source2Target[source2Reg + 6] + source2Target[source2Reg + 7];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg] * source2Target[source2Reg + 8] + source1Target[source1Reg + 1] * source2Target[source2Reg + 9] + source1Target[source1Reg + 2] * source2Target[source2Reg + 10] + source2Target[source2Reg + 11];\n    };\n    ProgramSoftware.ddx = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = vo.derivativeX;\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.ddy = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var source1Target = vo.derivativeY;\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        if (mask & 1)\n            target[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        if (mask & 2)\n            target[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        if (mask & 4)\n            target[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        if (mask & 8)\n            target[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n    };\n    ProgramSoftware.sge = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source1TargetW = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var source2TargetX = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        var source2TargetY = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        var source2TargetZ = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        var source2TargetW = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n        if (mask & 1)\n            target[targetReg] = source1TargetX >= source2TargetX ? 1 : 0;\n        if (mask & 2)\n            target[targetReg + 1] = source1TargetY >= source2TargetY ? 1 : 0;\n        if (mask & 4)\n            target[targetReg + 2] = source1TargetZ >= source2TargetZ ? 1 : 0;\n        if (mask & 8)\n            target[targetReg + 3] = source1TargetW >= source2TargetW ? 1 : 0;\n    };\n    ProgramSoftware.slt = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source1TargetW = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var source2TargetX = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        var source2TargetY = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        var source2TargetZ = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        var source2TargetW = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n        if (mask & 1)\n            target[targetReg] = source1TargetX < source2TargetX ? 1 : 0;\n        if (mask & 2)\n            target[targetReg + 1] = source1TargetY < source2TargetY ? 1 : 0;\n        if (mask & 4)\n            target[targetReg + 2] = source1TargetZ < source2TargetZ ? 1 : 0;\n        if (mask & 8)\n            target[targetReg + 3] = source1TargetW < source2TargetW ? 1 : 0;\n    };\n    ProgramSoftware.seq = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source1TargetW = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var source2TargetX = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        var source2TargetY = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        var source2TargetZ = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        var source2TargetW = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n        if (mask & 1)\n            target[targetReg] = source1TargetX == source2TargetX ? 1 : 0;\n        if (mask & 2)\n            target[targetReg + 1] = source1TargetY == source2TargetY ? 1 : 0;\n        if (mask & 4)\n            target[targetReg + 2] = source1TargetZ == source2TargetZ ? 1 : 0;\n        if (mask & 8)\n            target[targetReg + 3] = source1TargetW == source2TargetW ? 1 : 0;\n    };\n    ProgramSoftware.sne = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var source2Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source2Swizzle = source2.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source1TargetW = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n        var source2Target = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n        var source2TargetX = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n        var source2TargetY = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n        var source2TargetZ = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n        var source2TargetW = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n        if (mask & 1)\n            target[targetReg] = source1TargetX != source2TargetX ? 1 : 0;\n        if (mask & 2)\n            target[targetReg + 1] = source1TargetY != source2TargetY ? 1 : 0;\n        if (mask & 4)\n            target[targetReg + 2] = source1TargetZ != source2TargetZ ? 1 : 0;\n        if (mask & 8)\n            target[targetReg + 3] = source1TargetW != source2TargetW ? 1 : 0;\n    };\n    ProgramSoftware.sgn = function (vo, desc, dest, source1, source2, context) {\n        var targetReg = 4 * dest.regnum;\n        var source1Reg = 4 * source1.regnum;\n        var target = ProgramSoftware.getDestTarget(vo, desc, dest);\n        var mask = dest.mask;\n        var source1Swizzle = source1.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        var source1TargetY = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n        var source1TargetZ = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n        var source1TargetW = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n        if (mask & 1)\n            target[targetReg] = (source1TargetX < 0) ? -1 : (source1TargetX > 0) ? 1 : 0;\n        if (mask & 2)\n            target[targetReg + 1] = (source1TargetY < 0) ? -1 : (source1TargetY > 0) ? 1 : 0;\n        if (mask & 4)\n            target[targetReg + 2] = (source1TargetZ < 0) ? -1 : (source1TargetZ > 0) ? 1 : 0;\n        if (mask & 8)\n            target[targetReg + 3] = (source1TargetW < 0) ? -1 : (source1TargetW > 0) ? 1 : 0;\n    };\n    ProgramSoftware.kil = function (vo, desc, dest, source1, source2, context) {\n        var source1Reg = 4 * source1.regnum;\n        var source1Swizzle = source1.swizzle;\n        var source1Target = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n        var source1TargetX = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n        if (source1TargetX < 0)\n            vo.discard = true;\n    };\n    ProgramSoftware._defaultSamplerState = new SoftwareSamplerState_1.SoftwareSamplerState();\n    ProgramSoftware._tokenizer = new AGALTokenizer_1.AGALTokenizer();\n    ProgramSoftware._opCodeFunc = [\n        ProgramSoftware.mov,\n        ProgramSoftware.add,\n        ProgramSoftware.sub,\n        ProgramSoftware.mul,\n        ProgramSoftware.div,\n        ProgramSoftware.rcp,\n        ProgramSoftware.min,\n        ProgramSoftware.max,\n        ProgramSoftware.frc,\n        ProgramSoftware.sqt,\n        ProgramSoftware.rsq,\n        ProgramSoftware.pow,\n        ProgramSoftware.log,\n        ProgramSoftware.exp,\n        ProgramSoftware.nrm,\n        ProgramSoftware.sin,\n        ProgramSoftware.cos,\n        ProgramSoftware.crs,\n        ProgramSoftware.dp3,\n        ProgramSoftware.dp4,\n        ProgramSoftware.abs,\n        ProgramSoftware.neg,\n        ProgramSoftware.sat,\n        ProgramSoftware.m33,\n        ProgramSoftware.m44,\n        ProgramSoftware.m34,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        null,\n        ProgramSoftware.kil,\n        ProgramSoftware.tex,\n        ProgramSoftware.sge,\n        ProgramSoftware.slt,\n        ProgramSoftware.sgn,\n        ProgramSoftware.seq,\n        ProgramSoftware.sne\n    ];\n    return ProgramSoftware;\n}());\nexports.ProgramSoftware = ProgramSoftware;\n\n},{\"../aglsl/AGALTokenizer\":\"awayjs-stagegl/lib/aglsl/AGALTokenizer\",\"../base/ContextGLMipFilter\":\"awayjs-stagegl/lib/base/ContextGLMipFilter\",\"../base/ContextGLTextureFilter\":\"awayjs-stagegl/lib/base/ContextGLTextureFilter\",\"../base/ContextGLVertexBufferFormat\":\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\",\"../base/ContextGLWrapMode\":\"awayjs-stagegl/lib/base/ContextGLWrapMode\",\"../base/ProgramVOSoftware\":\"awayjs-stagegl/lib/base/ProgramVOSoftware\",\"../base/SoftwareSamplerState\":\"awayjs-stagegl/lib/base/SoftwareSamplerState\"}],\"awayjs-stagegl/lib/base/ProgramVOSoftware\":[function(require,module,exports){\n\"use strict\";\nvar ProgramVOSoftware = (function () {\n    function ProgramVOSoftware() {\n        this.outputColor = new Float32Array([0, 0, 0, 1]);\n        this.discard = false;\n    }\n    return ProgramVOSoftware;\n}());\nexports.ProgramVOSoftware = ProgramVOSoftware;\n\n},{}],\"awayjs-stagegl/lib/base/ProgramWebGL\":[function(require,module,exports){\n\"use strict\";\nvar AGALTokenizer_1 = require(\"../aglsl/AGALTokenizer\");\nvar AGLSLParser_1 = require(\"../aglsl/AGLSLParser\");\nvar ProgramWebGL = (function () {\n    function ProgramWebGL(gl) {\n        this._uniforms = [[], [], []];\n        this._attribs = [];\n        this._gl = gl;\n        this._program = this._gl.createProgram();\n    }\n    ProgramWebGL.prototype.upload = function (vertexProgram, fragmentProgram) {\n        var vertexString = ProgramWebGL._aglslParser.parse(ProgramWebGL._tokenizer.decribeAGALByteArray(vertexProgram));\n        var fragmentString = ProgramWebGL._aglslParser.parse(ProgramWebGL._tokenizer.decribeAGALByteArray(fragmentProgram));\n        this._vertexShader = this._gl.createShader(this._gl.VERTEX_SHADER);\n        this._fragmentShader = this._gl.createShader(this._gl.FRAGMENT_SHADER);\n        this._gl.shaderSource(this._vertexShader, vertexString);\n        this._gl.compileShader(this._vertexShader);\n        if (!this._gl.getShaderParameter(this._vertexShader, this._gl.COMPILE_STATUS))\n            throw new Error(this._gl.getShaderInfoLog(this._vertexShader));\n        this._gl.shaderSource(this._fragmentShader, fragmentString);\n        this._gl.compileShader(this._fragmentShader);\n        if (!this._gl.getShaderParameter(this._fragmentShader, this._gl.COMPILE_STATUS))\n            throw new Error(this._gl.getShaderInfoLog(this._fragmentShader));\n        this._gl.attachShader(this._program, this._vertexShader);\n        this._gl.attachShader(this._program, this._fragmentShader);\n        this._gl.linkProgram(this._program);\n        if (!this._gl.getProgramParameter(this._program, this._gl.LINK_STATUS))\n            throw new Error(this._gl.getProgramInfoLog(this._program));\n        this._uniforms[0].length = 0;\n        this._uniforms[1].length = 0;\n        this._uniforms[2].length = 0;\n        this._attribs.length = 0;\n    };\n    ProgramWebGL.prototype.getUniformLocation = function (programType, index) {\n        if (index === void 0) { index = -1; }\n        if (this._uniforms[programType][index + 1] != null)\n            return this._uniforms[programType][index + 1];\n        var name = (index == -1) ? ProgramWebGL._uniformLocationNameDictionary[programType] : ProgramWebGL._uniformLocationNameDictionary[programType] + index;\n        return (this._uniforms[programType][index + 1] = this._gl.getUniformLocation(this._program, name));\n    };\n    //\n    // public getUniformLocation(programType:number, index:number):WebGLUniformLocation\n    // {\n    // \tif (this._uniforms[programType][index] != null)\n    // \t\treturn this._uniforms[programType][index];\n    //\n    // \treturn (this._uniforms[programType][index] = this._gl.getUniformLocation(this._program, ProgramWebGL._uniformLocationNameDictionary[programType] + index));\n    // }\n    ProgramWebGL.prototype.getAttribLocation = function (index) {\n        if (this._attribs[index] != null)\n            return this._attribs[index];\n        return (this._attribs[index] = this._gl.getAttribLocation(this._program, \"va\" + index));\n    };\n    ProgramWebGL.prototype.dispose = function () {\n        this._gl.deleteProgram(this._program);\n    };\n    ProgramWebGL.prototype.focusProgram = function () {\n        this._gl.useProgram(this._program);\n    };\n    Object.defineProperty(ProgramWebGL.prototype, \"glProgram\", {\n        get: function () {\n            return this._program;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ProgramWebGL._tokenizer = new AGALTokenizer_1.AGALTokenizer();\n    ProgramWebGL._aglslParser = new AGLSLParser_1.AGLSLParser();\n    ProgramWebGL._uniformLocationNameDictionary = [\"fc\", \"fs\", \"vc\"];\n    return ProgramWebGL;\n}());\nexports.ProgramWebGL = ProgramWebGL;\n\n},{\"../aglsl/AGALTokenizer\":\"awayjs-stagegl/lib/aglsl/AGALTokenizer\",\"../aglsl/AGLSLParser\":\"awayjs-stagegl/lib/aglsl/AGLSLParser\"}],\"awayjs-stagegl/lib/base/ResourceBaseFlash\":[function(require,module,exports){\n\"use strict\";\nvar ResourceBaseFlash = (function () {\n    function ResourceBaseFlash() {\n    }\n    Object.defineProperty(ResourceBaseFlash.prototype, \"id\", {\n        get: function () {\n            return this._pId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ResourceBaseFlash.prototype.dispose = function () {\n    };\n    return ResourceBaseFlash;\n}());\nexports.ResourceBaseFlash = ResourceBaseFlash;\n\n},{}],\"awayjs-stagegl/lib/base/SamplerState\":[function(require,module,exports){\n\"use strict\";\nvar SamplerState = (function () {\n    function SamplerState() {\n    }\n    return SamplerState;\n}());\nexports.SamplerState = SamplerState;\n\n},{}],\"awayjs-stagegl/lib/base/SoftwareSamplerState\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLTextureFilter_1 = require(\"./ContextGLTextureFilter\");\nvar ContextGLMipFilter_1 = require(\"./ContextGLMipFilter\");\nvar ContextGLWrapMode_1 = require(\"./ContextGLWrapMode\");\n/**\n * The same as SamplerState, but with strings\n * TODO: replace two similar classes with one\n */\nvar SoftwareSamplerState = (function () {\n    function SoftwareSamplerState() {\n        this.wrap = ContextGLWrapMode_1.ContextGLWrapMode.REPEAT;\n        this.filter = ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR;\n        this.mipfilter = ContextGLMipFilter_1.ContextGLMipFilter.MIPLINEAR;\n    }\n    return SoftwareSamplerState;\n}());\nexports.SoftwareSamplerState = SoftwareSamplerState;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = SoftwareSamplerState;\n\n},{\"./ContextGLMipFilter\":\"awayjs-stagegl/lib/base/ContextGLMipFilter\",\"./ContextGLTextureFilter\":\"awayjs-stagegl/lib/base/ContextGLTextureFilter\",\"./ContextGLWrapMode\":\"awayjs-stagegl/lib/base/ContextGLWrapMode\"}],\"awayjs-stagegl/lib/base/Stage\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar EventDispatcher_1 = require(\"awayjs-core/lib/events/EventDispatcher\");\nvar Rectangle_1 = require(\"awayjs-core/lib/geom/Rectangle\");\nvar CSS_1 = require(\"awayjs-core/lib/utils/CSS\");\nvar ContextMode_1 = require(\"../base/ContextMode\");\nvar ContextGLMipFilter_1 = require(\"../base/ContextGLMipFilter\");\nvar ContextGLTextureFilter_1 = require(\"../base/ContextGLTextureFilter\");\nvar ContextGLVertexBufferFormat_1 = require(\"../base/ContextGLVertexBufferFormat\");\nvar ContextGLWrapMode_1 = require(\"../base/ContextGLWrapMode\");\nvar ContextWebGL_1 = require(\"../base/ContextWebGL\");\nvar ContextStage3D_1 = require(\"../base/ContextStage3D\");\nvar ContextSoftware_1 = require(\"../base/ContextSoftware\");\nvar StageEvent_1 = require(\"../events/StageEvent\");\nvar ProgramDataPool_1 = require(\"../image/ProgramDataPool\");\n/**\n * Stage provides a proxy class to handle the creation and attachment of the Context\n * (and in turn the back buffer) it uses. Stage should never be created directly,\n * but requested through StageManager.\n *\n * @see away.managers.StageManager\n *\n */\nvar Stage = (function (_super) {\n    __extends(Stage, _super);\n    function Stage(container, stageIndex, stageManager, forceSoftware, profile) {\n        var _this = this;\n        if (forceSoftware === void 0) { forceSoftware = false; }\n        if (profile === void 0) { profile = \"baseline\"; }\n        _super.call(this);\n        this._abstractionPool = new Object();\n        this._programData = new Array();\n        this._x = 0;\n        this._y = 0;\n        //private static _frameEventDriver:Shape = new Shape(); // TODO: add frame driver/request animation frame\n        this._stageIndex = -1;\n        this._antiAlias = 0;\n        //private var _activeVertexBuffers : Vector.<VertexBuffer> = new Vector.<VertexBuffer>(8, true);\n        //private var _activeTextures : Vector.<TextureBase> = new Vector.<TextureBase>(8, true);\n        this._renderTarget = null;\n        this._renderSurfaceSelector = 0;\n        //private _mouse3DManager:away.managers.Mouse3DManager;\n        //private _touch3DManager:Touch3DManager; //TODO: imeplement dependency Touch3DManager\n        this._initialised = false;\n        this._bufferFormatDictionary = new Array(5);\n        this.globalDisableMipmap = false;\n        this.globalDisableSmooth = false;\n        this._programDataPool = new ProgramDataPool_1.ProgramDataPool(this);\n        this._container = container;\n        if (this._container) {\n            this._container.addEventListener(\"webglcontextlost\", function (event) { return _this.onContextLost(event); });\n            this._container.addEventListener(\"webglcontextrestored\", function (event) { return _this.onContextRestored(event); });\n        }\n        this._stageIndex = stageIndex;\n        this._stageManager = stageManager;\n        this._viewPort = new Rectangle_1.Rectangle();\n        this._enableDepthAndStencil = true;\n        CSS_1.CSS.setElementX(this._container, 0);\n        CSS_1.CSS.setElementY(this._container, 0);\n        this._bufferFormatDictionary[1] = new Array(5);\n        this._bufferFormatDictionary[1][1] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_1;\n        this._bufferFormatDictionary[1][2] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_2;\n        this._bufferFormatDictionary[1][3] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_3;\n        this._bufferFormatDictionary[1][4] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.BYTE_4;\n        this._bufferFormatDictionary[2] = new Array(5);\n        this._bufferFormatDictionary[2][1] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_1;\n        this._bufferFormatDictionary[2][2] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_2;\n        this._bufferFormatDictionary[2][3] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_3;\n        this._bufferFormatDictionary[2][4] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.SHORT_4;\n        this._bufferFormatDictionary[4] = new Array(5);\n        this._bufferFormatDictionary[4][1] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_1;\n        this._bufferFormatDictionary[4][2] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_2;\n        this._bufferFormatDictionary[4][3] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_3;\n        this._bufferFormatDictionary[4][4] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.FLOAT_4;\n        this._bufferFormatDictionary[5] = new Array(5);\n        this._bufferFormatDictionary[5][1] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_1;\n        this._bufferFormatDictionary[5][2] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_2;\n        this._bufferFormatDictionary[5][3] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_3;\n        this._bufferFormatDictionary[5][4] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_BYTE_4;\n        this._bufferFormatDictionary[6] = new Array(5);\n        this._bufferFormatDictionary[6][1] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_1;\n        this._bufferFormatDictionary[6][2] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_2;\n        this._bufferFormatDictionary[6][3] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_3;\n        this._bufferFormatDictionary[6][4] = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat.UNSIGNED_SHORT_4;\n        this.visible = true;\n    }\n    Stage.prototype.getProgramData = function (vertexString, fragmentString) {\n        return this._programDataPool.getItem(vertexString, fragmentString);\n    };\n    Stage.prototype.setRenderTarget = function (target, enableDepthAndStencil, surfaceSelector) {\n        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = false; }\n        if (surfaceSelector === void 0) { surfaceSelector = 0; }\n        if (this._renderTarget === target && surfaceSelector == this._renderSurfaceSelector && this._enableDepthAndStencil == enableDepthAndStencil)\n            return;\n        this._renderTarget = target;\n        this._renderSurfaceSelector = surfaceSelector;\n        this._enableDepthAndStencil = enableDepthAndStencil;\n        if (target) {\n            this._context.setRenderToTexture(this.getAbstraction(target).texture, enableDepthAndStencil, this._antiAlias, surfaceSelector);\n        }\n        else {\n            this._context.setRenderToBackBuffer();\n            this.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n        }\n    };\n    Stage.prototype.getAbstraction = function (asset) {\n        return (this._abstractionPool[asset.id] || (this._abstractionPool[asset.id] = new Stage._abstractionClassPool[asset.assetType](asset, this)));\n    };\n    /**\n     *\n     * @param image\n     */\n    Stage.prototype.clearAbstraction = function (asset) {\n        this._abstractionPool[asset.id] = null;\n    };\n    /**\n     *\n     * @param imageObjectClass\n     */\n    Stage.registerAbstraction = function (gl_assetClass, assetClass) {\n        Stage._abstractionClassPool[assetClass.assetType] = gl_assetClass;\n    };\n    /**\n     * Requests a Context object to attach to the managed gl canvas.\n     */\n    Stage.prototype.requestContext = function (forceSoftware, profile, mode) {\n        // If forcing software, we can be certain that the\n        // returned Context will be running software mode.\n        // If not, we can't be sure and should stick to the\n        // old value (will likely be same if re-requesting.)\n        var _this = this;\n        if (forceSoftware === void 0) { forceSoftware = false; }\n        if (profile === void 0) { profile = \"baseline\"; }\n        if (mode === void 0) { mode = \"auto\"; }\n        if (this._usesSoftwareRendering != null)\n            this._usesSoftwareRendering = forceSoftware;\n        this._profile = profile;\n        try {\n            if (mode == ContextMode_1.ContextMode.FLASH)\n                new ContextStage3D_1.ContextStage3D(this._container, function (context) { return _this._callback(context); });\n            else if (mode == ContextMode_1.ContextMode.SOFTWARE)\n                this._context = new ContextSoftware_1.ContextSoftware(this._container);\n            else\n                this._context = new ContextWebGL_1.ContextWebGL(this._container);\n        }\n        catch (e) {\n            try {\n                if (mode == ContextMode_1.ContextMode.AUTO)\n                    new ContextStage3D_1.ContextStage3D(this._container, function (context) { return _this._callback(context); });\n                else\n                    this.dispatchEvent(new StageEvent_1.StageEvent(StageEvent_1.StageEvent.STAGE_ERROR, this));\n            }\n            catch (e) {\n                this.dispatchEvent(new StageEvent_1.StageEvent(StageEvent_1.StageEvent.STAGE_ERROR, this));\n            }\n        }\n        if (this._context)\n            this._callback(this._context);\n    };\n    Object.defineProperty(Stage.prototype, \"width\", {\n        /**\n         * The width of the gl canvas\n         */\n        get: function () {\n            return this._width;\n        },\n        set: function (val) {\n            if (this._width == val)\n                return;\n            CSS_1.CSS.setElementWidth(this._container, val);\n            this._width = this._viewPort.width = val;\n            this._backBufferDirty = true;\n            this.notifyViewportUpdated();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"height\", {\n        /**\n         * The height of the gl canvas\n         */\n        get: function () {\n            return this._height;\n        },\n        set: function (val) {\n            if (this._height == val)\n                return;\n            CSS_1.CSS.setElementHeight(this._container, val);\n            this._height = this._viewPort.height = val;\n            this._backBufferDirty = true;\n            this.notifyViewportUpdated();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"x\", {\n        /**\n         * The x position of the gl canvas\n         */\n        get: function () {\n            return this._x;\n        },\n        set: function (val) {\n            if (this._x == val)\n                return;\n            CSS_1.CSS.setElementX(this._container, val);\n            this._x = this._viewPort.x = val;\n            this.notifyViewportUpdated();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"y\", {\n        /**\n         * The y position of the gl canvas\n         */\n        get: function () {\n            return this._y;\n        },\n        set: function (val) {\n            if (this._y == val)\n                return;\n            CSS_1.CSS.setElementY(this._container, val);\n            this._y = this._viewPort.y = val;\n            this.notifyViewportUpdated();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"visible\", {\n        get: function () {\n            return CSS_1.CSS.getElementVisibility(this._container);\n        },\n        set: function (val) {\n            CSS_1.CSS.setElementVisibility(this._container, val);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"container\", {\n        get: function () {\n            return this._container;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"context\", {\n        /**\n         * The Context object associated with the given stage object.\n         */\n        get: function () {\n            return this._context;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Stage.prototype.notifyViewportUpdated = function () {\n        if (this._viewportDirty)\n            return;\n        this._viewportDirty = true;\n        this.dispatchEvent(new StageEvent_1.StageEvent(StageEvent_1.StageEvent.VIEWPORT_UPDATED, this));\n    };\n    Object.defineProperty(Stage.prototype, \"profile\", {\n        get: function () {\n            return this._profile;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Disposes the Stage object, freeing the Context attached to the Stage.\n     */\n    Stage.prototype.dispose = function () {\n        for (var id in this._abstractionPool)\n            this._abstractionPool[id].clear();\n        this._abstractionPool = null;\n        this._stageManager.iRemoveStage(this);\n        this.freeContext();\n        this._stageManager = null;\n        this._stageIndex = -1;\n    };\n    /**\n     * Configures the back buffer associated with the Stage object.\n     * @param backBufferWidth The width of the backbuffer.\n     * @param backBufferHeight The height of the backbuffer.\n     * @param antiAlias The amount of anti-aliasing to use.\n     * @param enableDepthAndStencil Indicates whether the back buffer contains a depth and stencil buffer.\n     */\n    Stage.prototype.configureBackBuffer = function (backBufferWidth, backBufferHeight, antiAlias, enableDepthAndStencil) {\n        this.width = backBufferWidth;\n        this.height = backBufferHeight;\n        this._antiAlias = antiAlias;\n        this._enableDepthAndStencil = enableDepthAndStencil;\n        if (this._context)\n            this._context.configureBackBuffer(backBufferWidth, backBufferHeight, antiAlias, enableDepthAndStencil);\n    };\n    Object.defineProperty(Stage.prototype, \"enableDepthAndStencil\", {\n        /*\n         * Indicates whether the depth and stencil buffer is used\n         */\n        get: function () {\n            return this._enableDepthAndStencil;\n        },\n        set: function (enableDepthAndStencil) {\n            this._enableDepthAndStencil = enableDepthAndStencil;\n            this._backBufferDirty = true;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"renderTarget\", {\n        get: function () {\n            return this._renderTarget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"renderSurfaceSelector\", {\n        get: function () {\n            return this._renderSurfaceSelector;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /*\n     * Clear and reset the back buffer when using a shared context\n     */\n    Stage.prototype.clear = function () {\n        if (!this._context)\n            return;\n        if (this._backBufferDirty) {\n            this.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n            this._backBufferDirty = false;\n        }\n        this._context.clear((this._color & 0xff000000) >>> 24, // <--------- Zero-fill right shift\n        (this._color & 0xff0000) >>> 16, // <-------------|\n        (this._color & 0xff00) >>> 8, // <----------------|\n        this._color & 0xff);\n        this._bufferClear = true;\n    };\n    Object.defineProperty(Stage.prototype, \"scissorRect\", {\n        get: function () {\n            return this._scissorRect;\n        },\n        set: function (value) {\n            this._scissorRect = value;\n            this._context.setScissorRectangle(this._scissorRect);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"stageIndex\", {\n        /**\n         * The index of the Stage which is managed by this instance of StageProxy.\n         */\n        get: function () {\n            return this._stageIndex;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"usesSoftwareRendering\", {\n        /**\n         * Indicates whether the Stage managed by this proxy is running in software mode.\n         * Remember to wait for the CONTEXT_CREATED event before checking this property,\n         * as only then will it be guaranteed to be accurate.\n         */\n        get: function () {\n            return this._usesSoftwareRendering;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"antiAlias\", {\n        /**\n         * The antiAliasing of the Stage.\n         */\n        get: function () {\n            return this._antiAlias;\n        },\n        set: function (antiAlias) {\n            this._antiAlias = antiAlias;\n            this._backBufferDirty = true;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"viewPort\", {\n        /**\n         * A viewPort rectangle equivalent of the Stage size and position.\n         */\n        get: function () {\n            this._viewportDirty = false;\n            return this._viewPort;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"color\", {\n        /**\n         * The background color of the Stage.\n         */\n        get: function () {\n            return this._color;\n        },\n        set: function (color) {\n            this._color = color;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Stage.prototype, \"bufferClear\", {\n        /**\n         * The freshly cleared state of the backbuffer before any rendering\n         */\n        get: function () {\n            return this._bufferClear;\n        },\n        set: function (newBufferClear) {\n            this._bufferClear = newBufferClear;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Stage.prototype.registerProgram = function (programData) {\n        var i = 0;\n        while (this._programData[i] != null)\n            i++;\n        this._programData[i] = programData;\n        programData.id = i;\n    };\n    Stage.prototype.unRegisterProgram = function (programData) {\n        this._programData[programData.id] = null;\n        programData.id = -1;\n    };\n    /**\n     * Frees the Context associated with this StageProxy.\n     */\n    Stage.prototype.freeContext = function () {\n        if (this._context) {\n            this._context.dispose();\n            this.dispatchEvent(new StageEvent_1.StageEvent(StageEvent_1.StageEvent.CONTEXT_DISPOSED, this));\n        }\n        this._context = null;\n        this._initialised = false;\n    };\n    Stage.prototype.onContextLost = function (event) {\n    };\n    Stage.prototype.onContextRestored = function (event) {\n    };\n    Stage.prototype.recoverFromDisposal = function () {\n        if (!this._context)\n            return false;\n        //away.Debug.throwPIR( 'StageProxy' , 'recoverFromDisposal' , '' );\n        /*\n         if (this._iContext.driverInfo == \"Disposed\")\n         {\n         this._iContext = null;\n         this.dispatchEvent(new StageEvent(StageEvent.CONTEXT_DISPOSED));\n         return false;\n\n         }\n         */\n        return true;\n    };\n    Stage.prototype._callback = function (context) {\n        this._context = context;\n        this._container = this._context.container;\n        // Only configure back buffer if width and height have been set,\n        // which they may not have been if View.render() has yet to be\n        // invoked for the first time.\n        if (this._width && this._height)\n            this._context.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n        // Dispatch the appropriate event depending on whether context was\n        // created for the first time or recreated after a device loss.\n        this.dispatchEvent(new StageEvent_1.StageEvent(this._initialised ? StageEvent_1.StageEvent.CONTEXT_RECREATED : StageEvent_1.StageEvent.CONTEXT_CREATED, this));\n        this._initialised = true;\n    };\n    Stage.prototype.setVertexBuffer = function (index, buffer, size, dimensions, offset, unsigned) {\n        if (unsigned === void 0) { unsigned = false; }\n        this._context.setVertexBufferAt(index, buffer, offset, this._bufferFormatDictionary[unsigned ? size + 4 : size][dimensions]);\n    };\n    Stage.prototype.setSamplerState = function (index, repeat, smooth, mipmap) {\n        var wrap = repeat ? ContextGLWrapMode_1.ContextGLWrapMode.REPEAT : ContextGLWrapMode_1.ContextGLWrapMode.CLAMP;\n        var filter = (smooth && !this.globalDisableSmooth) ? ContextGLTextureFilter_1.ContextGLTextureFilter.LINEAR : ContextGLTextureFilter_1.ContextGLTextureFilter.NEAREST;\n        var mipfilter = (mipmap && !this.globalDisableMipmap) ? ContextGLMipFilter_1.ContextGLMipFilter.MIPLINEAR : ContextGLMipFilter_1.ContextGLMipFilter.MIPNONE;\n        this._context.setSamplerStateAt(index, wrap, filter, mipfilter);\n    };\n    Stage._abstractionClassPool = new Object();\n    return Stage;\n}(EventDispatcher_1.EventDispatcher));\nexports.Stage = Stage;\n\n},{\"../base/ContextGLMipFilter\":\"awayjs-stagegl/lib/base/ContextGLMipFilter\",\"../base/ContextGLTextureFilter\":\"awayjs-stagegl/lib/base/ContextGLTextureFilter\",\"../base/ContextGLVertexBufferFormat\":\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\",\"../base/ContextGLWrapMode\":\"awayjs-stagegl/lib/base/ContextGLWrapMode\",\"../base/ContextMode\":\"awayjs-stagegl/lib/base/ContextMode\",\"../base/ContextSoftware\":\"awayjs-stagegl/lib/base/ContextSoftware\",\"../base/ContextStage3D\":\"awayjs-stagegl/lib/base/ContextStage3D\",\"../base/ContextWebGL\":\"awayjs-stagegl/lib/base/ContextWebGL\",\"../events/StageEvent\":\"awayjs-stagegl/lib/events/StageEvent\",\"../image/ProgramDataPool\":\"awayjs-stagegl/lib/image/ProgramDataPool\",\"awayjs-core/lib/events/EventDispatcher\":undefined,\"awayjs-core/lib/geom/Rectangle\":undefined,\"awayjs-core/lib/utils/CSS\":undefined}],\"awayjs-stagegl/lib/base/TextureBaseWebGL\":[function(require,module,exports){\n\"use strict\";\nvar AbstractMethodError_1 = require(\"awayjs-core/lib/errors/AbstractMethodError\");\nvar TextureBaseWebGL = (function () {\n    function TextureBaseWebGL(gl) {\n        this.textureType = \"\";\n        this._gl = gl;\n    }\n    TextureBaseWebGL.prototype.dispose = function () {\n        throw \"Abstract method must be overridden.\";\n    };\n    Object.defineProperty(TextureBaseWebGL.prototype, \"glTexture\", {\n        get: function () {\n            throw new AbstractMethodError_1.AbstractMethodError();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return TextureBaseWebGL;\n}());\nexports.TextureBaseWebGL = TextureBaseWebGL;\n\n},{\"awayjs-core/lib/errors/AbstractMethodError\":undefined}],\"awayjs-stagegl/lib/base/TextureFlash\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar ByteArrayBase_1 = require(\"awayjs-core/lib/utils/ByteArrayBase\");\nvar OpCodes_1 = require(\"../base/OpCodes\");\nvar ResourceBaseFlash_1 = require(\"../base/ResourceBaseFlash\");\nvar TextureFlash = (function (_super) {\n    __extends(TextureFlash, _super);\n    function TextureFlash(context, width, height, format, forRTT, streaming) {\n        if (streaming === void 0) { streaming = false; }\n        _super.call(this);\n        this._context = context;\n        this._width = width;\n        this._height = height;\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.initTexture, (forRTT ? OpCodes_1.OpCodes.trueValue : OpCodes_1.OpCodes.falseValue)) + width + \",\" + height + \",\" + streaming + \",\" + format + \"$\");\n        this._pId = this._context.execute();\n        this._context._iAddResource(this);\n    }\n    Object.defineProperty(TextureFlash.prototype, \"width\", {\n        get: function () {\n            return this._width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextureFlash.prototype, \"height\", {\n        get: function () {\n            return this._height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextureFlash.prototype.dispose = function () {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.disposeTexture) + this._pId.toString() + \",\");\n        this._context.execute();\n        this._context._iRemoveResource(this);\n        this._context = null;\n    };\n    TextureFlash.prototype.uploadFromData = function (data, miplevel) {\n        if (miplevel === void 0) { miplevel = 0; }\n        if (data instanceof HTMLImageElement) {\n            var can = document.createElement(\"canvas\");\n            var w = data.width;\n            var h = data.height;\n            can.width = w;\n            can.height = h;\n            var ctx = can.getContext(\"2d\");\n            ctx.drawImage(data, 0, 0);\n            data = ctx.getImageData(0, 0, w, h).data;\n        }\n        var pos = 0;\n        var bytes = ByteArrayBase_1.ByteArrayBase.internalGetBase64String(data.length, function () {\n            return data[pos++];\n        }, null);\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.uploadBytesTexture) + this._pId + \",\" + miplevel + \",\" + (this._width >> miplevel) + \",\" + (this._height >> miplevel) + \",\" + bytes + \"%\");\n        this._context.execute();\n    };\n    return TextureFlash;\n}(ResourceBaseFlash_1.ResourceBaseFlash));\nexports.TextureFlash = TextureFlash;\n\n},{\"../base/OpCodes\":\"awayjs-stagegl/lib/base/OpCodes\",\"../base/ResourceBaseFlash\":\"awayjs-stagegl/lib/base/ResourceBaseFlash\",\"awayjs-core/lib/utils/ByteArrayBase\":undefined}],\"awayjs-stagegl/lib/base/TextureSoftware\":[function(require,module,exports){\n\"use strict\";\nvar TextureSoftware = (function () {\n    function TextureSoftware(width, height) {\n        this.textureType = \"texture2d\";\n        this._mipLevels = [];\n        this._width = width;\n        this._height = height;\n    }\n    TextureSoftware.prototype.dispose = function () {\n        this._mipLevels = null;\n    };\n    Object.defineProperty(TextureSoftware.prototype, \"width\", {\n        get: function () {\n            return this._width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextureSoftware.prototype, \"height\", {\n        get: function () {\n            return this._height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextureSoftware.prototype.uploadFromData = function (data, miplevel) {\n        if (miplevel === void 0) { miplevel = 0; }\n        this._mipLevels[miplevel] = data.data;\n    };\n    TextureSoftware.prototype.getData = function (miplevel) {\n        return this._mipLevels[miplevel];\n    };\n    TextureSoftware.prototype.getMipLevelsCount = function () {\n        return this._mipLevels.length;\n    };\n    return TextureSoftware;\n}());\nexports.TextureSoftware = TextureSoftware;\n\n},{}],\"awayjs-stagegl/lib/base/TextureWebGL\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar TextureBaseWebGL_1 = require(\"../base/TextureBaseWebGL\");\nvar TextureWebGL = (function (_super) {\n    __extends(TextureWebGL, _super);\n    function TextureWebGL(gl, width, height) {\n        _super.call(this, gl);\n        this.textureType = \"texture2d\";\n        this._width = width;\n        this._height = height;\n        this._glTexture = this._gl.createTexture();\n    }\n    TextureWebGL.prototype.dispose = function () {\n        this._gl.deleteTexture(this._glTexture);\n    };\n    Object.defineProperty(TextureWebGL.prototype, \"width\", {\n        get: function () {\n            return this._width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextureWebGL.prototype, \"height\", {\n        get: function () {\n            return this._height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextureWebGL.prototype, \"frameBuffer\", {\n        get: function () {\n            if (!this._frameBuffer) {\n                this._frameBuffer = this._gl.createFramebuffer();\n                this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._frameBuffer);\n                this._gl.bindTexture(this._gl.TEXTURE_2D, this._glTexture);\n                this._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._width, this._height, 0, this._gl.RGBA, this._gl.UNSIGNED_BYTE, null);\n                var renderBuffer = this._gl.createRenderbuffer();\n                this._gl.bindRenderbuffer(this._gl.RENDERBUFFER, renderBuffer);\n                this._gl.renderbufferStorage(this._gl.RENDERBUFFER, this._gl.DEPTH_STENCIL, this._width, this._height);\n                this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER, this._gl.COLOR_ATTACHMENT0, this._gl.TEXTURE_2D, this._glTexture, 0);\n                this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER, this._gl.DEPTH_STENCIL_ATTACHMENT, this._gl.RENDERBUFFER, renderBuffer);\n                this._gl.bindTexture(this._gl.TEXTURE_2D, null);\n                this._gl.bindRenderbuffer(this._gl.RENDERBUFFER, null);\n                this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n            }\n            return this._frameBuffer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextureWebGL.prototype.uploadFromData = function (data, miplevel) {\n        if (miplevel === void 0) { miplevel = 0; }\n        this._gl.bindTexture(this._gl.TEXTURE_2D, this._glTexture);\n        this._gl.texImage2D(this._gl.TEXTURE_2D, miplevel, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, data);\n        this._gl.bindTexture(this._gl.TEXTURE_2D, null);\n    };\n    TextureWebGL.prototype.uploadCompressedTextureFromByteArray = function (data, byteArrayOffset /*uint*/, async) {\n        if (async === void 0) { async = false; }\n        var ext = this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\");\n        //this._gl.compressedTexImage2D(this._gl.TEXTURE_2D, 0, this)\n    };\n    Object.defineProperty(TextureWebGL.prototype, \"glTexture\", {\n        get: function () {\n            return this._glTexture;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextureWebGL.prototype.generateMipmaps = function () {\n        //TODO: implement generating mipmaps\n        //this._gl.bindTexture( this._gl.TEXTURE_2D, this._glTexture );\n        //this._gl.generateMipmap(this._gl.TEXTURE_2D);\n        //this._gl.bindTexture( this._gl.TEXTURE_2D, null );\n    };\n    return TextureWebGL;\n}(TextureBaseWebGL_1.TextureBaseWebGL));\nexports.TextureWebGL = TextureWebGL;\n\n},{\"../base/TextureBaseWebGL\":\"awayjs-stagegl/lib/base/TextureBaseWebGL\"}],\"awayjs-stagegl/lib/base/VertexBufferFlash\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar OpCodes_1 = require(\"../base/OpCodes\");\nvar ResourceBaseFlash_1 = require(\"../base/ResourceBaseFlash\");\nvar VertexBufferFlash = (function (_super) {\n    __extends(VertexBufferFlash, _super);\n    function VertexBufferFlash(context, numVertices, dataPerVertex) {\n        _super.call(this);\n        this._context = context;\n        this._numVertices = numVertices;\n        this._dataPerVertex = dataPerVertex;\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.initVertexBuffer, dataPerVertex + OpCodes_1.OpCodes.intMask) + numVertices.toString() + \",\");\n        this._pId = this._context.execute();\n        this._context._iAddResource(this);\n    }\n    VertexBufferFlash.prototype.uploadFromArray = function (data, startVertex, numVertices) {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.uploadArrayVertexBuffer, this._pId + OpCodes_1.OpCodes.intMask) + data.join() + \"#\" + [startVertex, numVertices].join() + \",\");\n        this._context.execute();\n    };\n    VertexBufferFlash.prototype.uploadFromByteArray = function (data, startVertex, numVertices) {\n    };\n    Object.defineProperty(VertexBufferFlash.prototype, \"numVertices\", {\n        get: function () {\n            return this._numVertices;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(VertexBufferFlash.prototype, \"dataPerVertex\", {\n        get: function () {\n            return this._dataPerVertex;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    VertexBufferFlash.prototype.dispose = function () {\n        this._context.addStream(String.fromCharCode(OpCodes_1.OpCodes.disposeVertexBuffer, this._pId + OpCodes_1.OpCodes.intMask));\n        this._context.execute();\n        this._context._iRemoveResource(this);\n        this._context = null;\n    };\n    return VertexBufferFlash;\n}(ResourceBaseFlash_1.ResourceBaseFlash));\nexports.VertexBufferFlash = VertexBufferFlash;\n\n},{\"../base/OpCodes\":\"awayjs-stagegl/lib/base/OpCodes\",\"../base/ResourceBaseFlash\":\"awayjs-stagegl/lib/base/ResourceBaseFlash\"}],\"awayjs-stagegl/lib/base/VertexBufferSoftware\":[function(require,module,exports){\n\"use strict\";\nvar VertexBufferSoftware = (function () {\n    //private _dataOffset:number;\n    function VertexBufferSoftware(numVertices, dataPerVertex) {\n        this._numVertices = numVertices;\n        this._dataPerVertex = dataPerVertex;\n    }\n    VertexBufferSoftware.prototype.uploadFromArray = function (vertices, startVertex, numVertices) {\n        //this._dataOffset = startVertex * this._dataPerVertex;\n        this._floatData = new Float32Array(vertices);\n    };\n    VertexBufferSoftware.prototype.uploadFromByteArray = function (data, startVertex, numVertices) {\n        //this._dataOffset = startVertex * this._dataPerVertex;\n        this._floatData = new Float32Array(data, startVertex * this._dataPerVertex, numVertices * this._dataPerVertex / 4);\n        this._uintData = new Uint8Array(data);\n    };\n    Object.defineProperty(VertexBufferSoftware.prototype, \"numVertices\", {\n        get: function () {\n            return this._numVertices;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(VertexBufferSoftware.prototype, \"dataPerVertex\", {\n        get: function () {\n            return this._dataPerVertex;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(VertexBufferSoftware.prototype, \"attributesPerVertex\", {\n        get: function () {\n            return this._dataPerVertex / 4;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    VertexBufferSoftware.prototype.dispose = function () {\n        this._floatData = null;\n    };\n    Object.defineProperty(VertexBufferSoftware.prototype, \"data\", {\n        get: function () {\n            return this._floatData;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(VertexBufferSoftware.prototype, \"uintData\", {\n        get: function () {\n            return this._uintData;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return VertexBufferSoftware;\n}());\nexports.VertexBufferSoftware = VertexBufferSoftware;\n\n},{}],\"awayjs-stagegl/lib/base/VertexBufferWebGL\":[function(require,module,exports){\n\"use strict\";\nvar VertexBufferWebGL = (function () {\n    function VertexBufferWebGL(gl, numVertices, dataPerVertex) {\n        this._gl = gl;\n        this._buffer = this._gl.createBuffer();\n        this._numVertices = numVertices;\n        this._dataPerVertex = dataPerVertex;\n    }\n    VertexBufferWebGL.prototype.uploadFromArray = function (vertices, startVertex, numVertices) {\n        this._gl.bindBuffer(this._gl.ARRAY_BUFFER, this._buffer);\n        if (startVertex)\n            this._gl.bufferSubData(this._gl.ARRAY_BUFFER, startVertex * this._dataPerVertex, new Float32Array(vertices));\n        else\n            this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(vertices), this._gl.STATIC_DRAW);\n    };\n    VertexBufferWebGL.prototype.uploadFromByteArray = function (data, startVertex, numVertices) {\n        this._gl.bindBuffer(this._gl.ARRAY_BUFFER, this._buffer);\n        if (startVertex)\n            this._gl.bufferSubData(this._gl.ARRAY_BUFFER, startVertex * this._dataPerVertex, data);\n        else\n            this._gl.bufferData(this._gl.ARRAY_BUFFER, data, this._gl.STATIC_DRAW);\n    };\n    Object.defineProperty(VertexBufferWebGL.prototype, \"numVertices\", {\n        get: function () {\n            return this._numVertices;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(VertexBufferWebGL.prototype, \"dataPerVertex\", {\n        get: function () {\n            return this._dataPerVertex;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(VertexBufferWebGL.prototype, \"glBuffer\", {\n        get: function () {\n            return this._buffer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    VertexBufferWebGL.prototype.dispose = function () {\n        this._gl.deleteBuffer(this._buffer);\n    };\n    return VertexBufferWebGL;\n}());\nexports.VertexBufferWebGL = VertexBufferWebGL;\n\n},{}],\"awayjs-stagegl/lib/base\":[function(require,module,exports){\n\"use strict\";\nvar ContextGLBlendFactor_1 = require(\"./base/ContextGLBlendFactor\");\nexports.ContextGLBlendFactor = ContextGLBlendFactor_1.ContextGLBlendFactor;\nvar ContextGLClearMask_1 = require(\"./base/ContextGLClearMask\");\nexports.ContextGLClearMask = ContextGLClearMask_1.ContextGLClearMask;\nvar ContextGLCompareMode_1 = require(\"./base/ContextGLCompareMode\");\nexports.ContextGLCompareMode = ContextGLCompareMode_1.ContextGLCompareMode;\nvar ContextGLDrawMode_1 = require(\"./base/ContextGLDrawMode\");\nexports.ContextGLDrawMode = ContextGLDrawMode_1.ContextGLDrawMode;\nvar ContextGLMipFilter_1 = require(\"./base/ContextGLMipFilter\");\nexports.ContextGLMipFilter = ContextGLMipFilter_1.ContextGLMipFilter;\nvar ContextGLProfile_1 = require(\"./base/ContextGLProfile\");\nexports.ContextGLProfile = ContextGLProfile_1.ContextGLProfile;\nvar ContextGLProgramType_1 = require(\"./base/ContextGLProgramType\");\nexports.ContextGLProgramType = ContextGLProgramType_1.ContextGLProgramType;\nvar ContextGLStencilAction_1 = require(\"./base/ContextGLStencilAction\");\nexports.ContextGLStencilAction = ContextGLStencilAction_1.ContextGLStencilAction;\nvar ContextGLTextureFilter_1 = require(\"./base/ContextGLTextureFilter\");\nexports.ContextGLTextureFilter = ContextGLTextureFilter_1.ContextGLTextureFilter;\nvar ContextGLTextureFormat_1 = require(\"./base/ContextGLTextureFormat\");\nexports.ContextGLTextureFormat = ContextGLTextureFormat_1.ContextGLTextureFormat;\nvar ContextGLTriangleFace_1 = require(\"./base/ContextGLTriangleFace\");\nexports.ContextGLTriangleFace = ContextGLTriangleFace_1.ContextGLTriangleFace;\nvar ContextGLVertexBufferFormat_1 = require(\"./base/ContextGLVertexBufferFormat\");\nexports.ContextGLVertexBufferFormat = ContextGLVertexBufferFormat_1.ContextGLVertexBufferFormat;\nvar ContextGLWrapMode_1 = require(\"./base/ContextGLWrapMode\");\nexports.ContextGLWrapMode = ContextGLWrapMode_1.ContextGLWrapMode;\nvar ContextMode_1 = require(\"./base/ContextMode\");\nexports.ContextMode = ContextMode_1.ContextMode;\nvar ContextSoftware_1 = require(\"./base/ContextSoftware\");\nexports.ContextSoftware = ContextSoftware_1.ContextSoftware;\nvar ContextStage3D_1 = require(\"./base/ContextStage3D\");\nexports.ContextStage3D = ContextStage3D_1.ContextStage3D;\nvar ContextWebGL_1 = require(\"./base/ContextWebGL\");\nexports.ContextWebGL = ContextWebGL_1.ContextWebGL;\nvar CubeTextureFlash_1 = require(\"./base/CubeTextureFlash\");\nexports.CubeTextureFlash = CubeTextureFlash_1.CubeTextureFlash;\nvar CubeTextureWebGL_1 = require(\"./base/CubeTextureWebGL\");\nexports.CubeTextureWebGL = CubeTextureWebGL_1.CubeTextureWebGL;\nvar IndexBufferFlash_1 = require(\"./base/IndexBufferFlash\");\nexports.IndexBufferFlash = IndexBufferFlash_1.IndexBufferFlash;\nvar IndexBufferSoftware_1 = require(\"./base/IndexBufferSoftware\");\nexports.IndexBufferSoftware = IndexBufferSoftware_1.IndexBufferSoftware;\nvar IndexBufferWebGL_1 = require(\"./base/IndexBufferWebGL\");\nexports.IndexBufferWebGL = IndexBufferWebGL_1.IndexBufferWebGL;\nvar OpCodes_1 = require(\"./base/OpCodes\");\nexports.OpCodes = OpCodes_1.OpCodes;\nvar ProgramFlash_1 = require(\"./base/ProgramFlash\");\nexports.ProgramFlash = ProgramFlash_1.ProgramFlash;\nvar ProgramSoftware_1 = require(\"./base/ProgramSoftware\");\nexports.ProgramSoftware = ProgramSoftware_1.ProgramSoftware;\nvar ProgramVOSoftware_1 = require(\"./base/ProgramVOSoftware\");\nexports.ProgramVOSoftware = ProgramVOSoftware_1.ProgramVOSoftware;\nvar ProgramWebGL_1 = require(\"./base/ProgramWebGL\");\nexports.ProgramWebGL = ProgramWebGL_1.ProgramWebGL;\nvar ResourceBaseFlash_1 = require(\"./base/ResourceBaseFlash\");\nexports.ResourceBaseFlash = ResourceBaseFlash_1.ResourceBaseFlash;\nvar SamplerState_1 = require(\"./base/SamplerState\");\nexports.SamplerState = SamplerState_1.SamplerState;\nvar SoftwareSamplerState_1 = require(\"./base/SoftwareSamplerState\");\nexports.SoftwareSamplerState = SoftwareSamplerState_1.SoftwareSamplerState;\nvar Stage_1 = require(\"./base/Stage\");\nexports.Stage = Stage_1.Stage;\nvar TextureBaseWebGL_1 = require(\"./base/TextureBaseWebGL\");\nexports.TextureBaseWebGL = TextureBaseWebGL_1.TextureBaseWebGL;\nvar TextureFlash_1 = require(\"./base/TextureFlash\");\nexports.TextureFlash = TextureFlash_1.TextureFlash;\nvar TextureSoftware_1 = require(\"./base/TextureSoftware\");\nexports.TextureSoftware = TextureSoftware_1.TextureSoftware;\nvar TextureWebGL_1 = require(\"./base/TextureWebGL\");\nexports.TextureWebGL = TextureWebGL_1.TextureWebGL;\nvar VertexBufferFlash_1 = require(\"./base/VertexBufferFlash\");\nexports.VertexBufferFlash = VertexBufferFlash_1.VertexBufferFlash;\nvar VertexBufferSoftware_1 = require(\"./base/VertexBufferSoftware\");\nexports.VertexBufferSoftware = VertexBufferSoftware_1.VertexBufferSoftware;\nvar VertexBufferWebGL_1 = require(\"./base/VertexBufferWebGL\");\nexports.VertexBufferWebGL = VertexBufferWebGL_1.VertexBufferWebGL;\n\n},{\"./base/ContextGLBlendFactor\":\"awayjs-stagegl/lib/base/ContextGLBlendFactor\",\"./base/ContextGLClearMask\":\"awayjs-stagegl/lib/base/ContextGLClearMask\",\"./base/ContextGLCompareMode\":\"awayjs-stagegl/lib/base/ContextGLCompareMode\",\"./base/ContextGLDrawMode\":\"awayjs-stagegl/lib/base/ContextGLDrawMode\",\"./base/ContextGLMipFilter\":\"awayjs-stagegl/lib/base/ContextGLMipFilter\",\"./base/ContextGLProfile\":\"awayjs-stagegl/lib/base/ContextGLProfile\",\"./base/ContextGLProgramType\":\"awayjs-stagegl/lib/base/ContextGLProgramType\",\"./base/ContextGLStencilAction\":\"awayjs-stagegl/lib/base/ContextGLStencilAction\",\"./base/ContextGLTextureFilter\":\"awayjs-stagegl/lib/base/ContextGLTextureFilter\",\"./base/ContextGLTextureFormat\":\"awayjs-stagegl/lib/base/ContextGLTextureFormat\",\"./base/ContextGLTriangleFace\":\"awayjs-stagegl/lib/base/ContextGLTriangleFace\",\"./base/ContextGLVertexBufferFormat\":\"awayjs-stagegl/lib/base/ContextGLVertexBufferFormat\",\"./base/ContextGLWrapMode\":\"awayjs-stagegl/lib/base/ContextGLWrapMode\",\"./base/ContextMode\":\"awayjs-stagegl/lib/base/ContextMode\",\"./base/ContextSoftware\":\"awayjs-stagegl/lib/base/ContextSoftware\",\"./base/ContextStage3D\":\"awayjs-stagegl/lib/base/ContextStage3D\",\"./base/ContextWebGL\":\"awayjs-stagegl/lib/base/ContextWebGL\",\"./base/CubeTextureFlash\":\"awayjs-stagegl/lib/base/CubeTextureFlash\",\"./base/CubeTextureWebGL\":\"awayjs-stagegl/lib/base/CubeTextureWebGL\",\"./base/IndexBufferFlash\":\"awayjs-stagegl/lib/base/IndexBufferFlash\",\"./base/IndexBufferSoftware\":\"awayjs-stagegl/lib/base/IndexBufferSoftware\",\"./base/IndexBufferWebGL\":\"awayjs-stagegl/lib/base/IndexBufferWebGL\",\"./base/OpCodes\":\"awayjs-stagegl/lib/base/OpCodes\",\"./base/ProgramFlash\":\"awayjs-stagegl/lib/base/ProgramFlash\",\"./base/ProgramSoftware\":\"awayjs-stagegl/lib/base/ProgramSoftware\",\"./base/ProgramVOSoftware\":\"awayjs-stagegl/lib/base/ProgramVOSoftware\",\"./base/ProgramWebGL\":\"awayjs-stagegl/lib/base/ProgramWebGL\",\"./base/ResourceBaseFlash\":\"awayjs-stagegl/lib/base/ResourceBaseFlash\",\"./base/SamplerState\":\"awayjs-stagegl/lib/base/SamplerState\",\"./base/SoftwareSamplerState\":\"awayjs-stagegl/lib/base/SoftwareSamplerState\",\"./base/Stage\":\"awayjs-stagegl/lib/base/Stage\",\"./base/TextureBaseWebGL\":\"awayjs-stagegl/lib/base/TextureBaseWebGL\",\"./base/TextureFlash\":\"awayjs-stagegl/lib/base/TextureFlash\",\"./base/TextureSoftware\":\"awayjs-stagegl/lib/base/TextureSoftware\",\"./base/TextureWebGL\":\"awayjs-stagegl/lib/base/TextureWebGL\",\"./base/VertexBufferFlash\":\"awayjs-stagegl/lib/base/VertexBufferFlash\",\"./base/VertexBufferSoftware\":\"awayjs-stagegl/lib/base/VertexBufferSoftware\",\"./base/VertexBufferWebGL\":\"awayjs-stagegl/lib/base/VertexBufferWebGL\"}],\"awayjs-stagegl/lib/events/StageEvent\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar EventBase_1 = require(\"awayjs-core/lib/events/EventBase\");\nvar StageEvent = (function (_super) {\n    __extends(StageEvent, _super);\n    function StageEvent(type, stage) {\n        _super.call(this, type);\n        this._stage = stage;\n    }\n    Object.defineProperty(StageEvent.prototype, \"stage\", {\n        /**\n         *\n         */\n        get: function () {\n            return this._stage;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     *\n     */\n    StageEvent.prototype.clone = function () {\n        return new StageEvent(this.type, this._stage);\n    };\n    /**\n     *\n     */\n    StageEvent.STAGE_ERROR = \"stageError\";\n    /**\n     *\n     */\n    StageEvent.CONTEXT_CREATED = \"contextCreated\";\n    /**\n     *\n     */\n    StageEvent.CONTEXT_DISPOSED = \"contextDisposed\";\n    /**\n     *\n     */\n    StageEvent.CONTEXT_RECREATED = \"contextRecreated\";\n    /**\n     *\n     */\n    StageEvent.VIEWPORT_UPDATED = \"viewportUpdated\";\n    return StageEvent;\n}(EventBase_1.EventBase));\nexports.StageEvent = StageEvent;\n\n},{\"awayjs-core/lib/events/EventBase\":undefined}],\"awayjs-stagegl/lib/events\":[function(require,module,exports){\n\"use strict\";\nvar StageEvent_1 = require(\"./events/StageEvent\");\nexports.StageEvent = StageEvent_1.StageEvent;\n\n},{\"./events/StageEvent\":\"awayjs-stagegl/lib/events/StageEvent\"}],\"awayjs-stagegl/lib/image/GL_BitmapImage2D\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar MipmapGenerator_1 = require(\"awayjs-core/lib/utils/MipmapGenerator\");\nvar GL_Image2D_1 = require(\"../image/GL_Image2D\");\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nvar GL_BitmapImage2D = (function (_super) {\n    __extends(GL_BitmapImage2D, _super);\n    function GL_BitmapImage2D() {\n        _super.apply(this, arguments);\n    }\n    GL_BitmapImage2D.prototype.activate = function (index, mipmap) {\n        if (mipmap && this._stage.globalDisableMipmap)\n            mipmap = false;\n        if (!this._texture) {\n            this._createTexture();\n            this._invalid = true;\n        }\n        if (!this._mipmap && mipmap) {\n            this._mipmap = true;\n            this._invalid = true;\n        }\n        if (this._invalid) {\n            this._invalid = false;\n            if (mipmap) {\n                var mipmapData = this._mipmapData || (this._mipmapData = new Array());\n                MipmapGenerator_1.MipmapGenerator._generateMipMaps(this._asset.getCanvas(), mipmapData, true);\n                var len = mipmapData.length;\n                for (var i = 0; i < len; i++)\n                    this._texture.uploadFromData(mipmapData[i].getImageData(), i);\n            }\n            else {\n                this._texture.uploadFromData(this._asset.getImageData(), 0);\n            }\n        }\n        _super.prototype.activate.call(this, index, mipmap);\n    };\n    /**\n     *\n     */\n    GL_BitmapImage2D.prototype.onClear = function (event) {\n        _super.prototype.onClear.call(this, event);\n        if (this._mipmapData) {\n            var len = this._mipmapData.length;\n            for (var i = 0; i < len; i++)\n                MipmapGenerator_1.MipmapGenerator._freeMipMapHolder(this._mipmapData[i]);\n        }\n    };\n    return GL_BitmapImage2D;\n}(GL_Image2D_1.GL_Image2D));\nexports.GL_BitmapImage2D = GL_BitmapImage2D;\n\n},{\"../image/GL_Image2D\":\"awayjs-stagegl/lib/image/GL_Image2D\",\"awayjs-core/lib/utils/MipmapGenerator\":undefined}],\"awayjs-stagegl/lib/image/GL_BitmapImageCube\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar MipmapGenerator_1 = require(\"awayjs-core/lib/utils/MipmapGenerator\");\nvar GL_ImageCube_1 = require(\"../image/GL_ImageCube\");\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nvar GL_BitmapImageCube = (function (_super) {\n    __extends(GL_BitmapImageCube, _super);\n    function GL_BitmapImageCube() {\n        _super.apply(this, arguments);\n        this._mipmapDataArray = new Array(6);\n    }\n    GL_BitmapImageCube.prototype.activate = function (index, mipmap) {\n        if (mipmap && this._stage.globalDisableMipmap)\n            mipmap = false;\n        if (!this._texture) {\n            this._createTexture();\n            this._invalid = true;\n        }\n        if (!this._mipmap && mipmap) {\n            this._mipmap = true;\n            this._invalid = true;\n        }\n        if (this._invalid) {\n            this._invalid = false;\n            for (var i = 0; i < 6; ++i) {\n                if (mipmap) {\n                    var mipmapData = this._mipmapDataArray[i] || (this._mipmapDataArray[i] = new Array());\n                    MipmapGenerator_1.MipmapGenerator._generateMipMaps(this._asset.getCanvas(i), mipmapData, true);\n                    var len = mipmapData.length;\n                    for (var j = 0; j < len; j++)\n                        this._texture.uploadFromData(mipmapData[j].getImageData(), i, j);\n                }\n                else {\n                    this._texture.uploadFromData(this._asset.getImageData(i), i, 0);\n                }\n            }\n        }\n        _super.prototype.activate.call(this, index, mipmap);\n    };\n    /**\n     *\n     */\n    GL_BitmapImageCube.prototype.onClear = function (event) {\n        _super.prototype.onClear.call(this, event);\n        for (var i = 0; i < 6; i++) {\n            var mipmapData = this._mipmapDataArray[i];\n            if (mipmapData) {\n                var len = mipmapData.length;\n                for (var j = 0; j < len; i++)\n                    MipmapGenerator_1.MipmapGenerator._freeMipMapHolder(mipmapData[j]);\n            }\n        }\n    };\n    return GL_BitmapImageCube;\n}(GL_ImageCube_1.GL_ImageCube));\nexports.GL_BitmapImageCube = GL_BitmapImageCube;\n\n},{\"../image/GL_ImageCube\":\"awayjs-stagegl/lib/image/GL_ImageCube\",\"awayjs-core/lib/utils/MipmapGenerator\":undefined}],\"awayjs-stagegl/lib/image/GL_Image2D\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar ContextGLTextureFormat_1 = require(\"../base/ContextGLTextureFormat\");\nvar GL_ImageBase_1 = require(\"../image/GL_ImageBase\");\n/**\n *\n * @class away.pool.GL_ImageBase\n */\nvar GL_Image2D = (function (_super) {\n    __extends(GL_Image2D, _super);\n    function GL_Image2D() {\n        _super.apply(this, arguments);\n    }\n    /**\n     *\n     * @param context\n     * @returns {ITexture}\n     */\n    GL_Image2D.prototype._createTexture = function () {\n        this._texture = this._stage.context.createTexture(this._asset.width, this._asset.height, ContextGLTextureFormat_1.ContextGLTextureFormat.BGRA, true);\n    };\n    return GL_Image2D;\n}(GL_ImageBase_1.GL_ImageBase));\nexports.GL_Image2D = GL_Image2D;\n\n},{\"../base/ContextGLTextureFormat\":\"awayjs-stagegl/lib/base/ContextGLTextureFormat\",\"../image/GL_ImageBase\":\"awayjs-stagegl/lib/image/GL_ImageBase\"}],\"awayjs-stagegl/lib/image/GL_ImageBase\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar AbstractMethodError_1 = require(\"awayjs-core/lib/errors/AbstractMethodError\");\nvar AbstractionBase_1 = require(\"awayjs-core/lib/library/AbstractionBase\");\n/**\n *\n * @class away.pool.GL_ImageBase\n */\nvar GL_ImageBase = (function (_super) {\n    __extends(GL_ImageBase, _super);\n    function GL_ImageBase(asset, stage) {\n        _super.call(this, asset, stage);\n        this.usages = 0;\n        this._stage = stage;\n    }\n    Object.defineProperty(GL_ImageBase.prototype, \"texture\", {\n        get: function () {\n            if (!this._texture) {\n                this._createTexture();\n                this._invalid = true;\n            }\n            return this._texture;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     *\n     */\n    GL_ImageBase.prototype.onClear = function (event) {\n        _super.prototype.onClear.call(this, event);\n        if (this._texture) {\n            this._texture.dispose();\n            this._texture = null;\n        }\n    };\n    GL_ImageBase.prototype.activate = function (index, mipmap) {\n        this._stage.context.setTextureAt(index, this._texture);\n    };\n    GL_ImageBase.prototype._createTexture = function () {\n        throw new AbstractMethodError_1.AbstractMethodError();\n    };\n    return GL_ImageBase;\n}(AbstractionBase_1.AbstractionBase));\nexports.GL_ImageBase = GL_ImageBase;\n\n},{\"awayjs-core/lib/errors/AbstractMethodError\":undefined,\"awayjs-core/lib/library/AbstractionBase\":undefined}],\"awayjs-stagegl/lib/image/GL_ImageCube\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar ContextGLTextureFormat_1 = require(\"../base/ContextGLTextureFormat\");\nvar GL_ImageBase_1 = require(\"../image/GL_ImageBase\");\n/**\n *\n * @class away.pool.GL_ImageCubeBase\n */\nvar GL_ImageCube = (function (_super) {\n    __extends(GL_ImageCube, _super);\n    function GL_ImageCube() {\n        _super.apply(this, arguments);\n    }\n    /**\n     *\n     * @param context\n     * @returns {ITexture}\n     */\n    GL_ImageCube.prototype._createTexture = function () {\n        this._texture = this._stage.context.createCubeTexture(this._asset.size, ContextGLTextureFormat_1.ContextGLTextureFormat.BGRA, false);\n    };\n    return GL_ImageCube;\n}(GL_ImageBase_1.GL_ImageBase));\nexports.GL_ImageCube = GL_ImageCube;\n\n},{\"../base/ContextGLTextureFormat\":\"awayjs-stagegl/lib/base/ContextGLTextureFormat\",\"../image/GL_ImageBase\":\"awayjs-stagegl/lib/image/GL_ImageBase\"}],\"awayjs-stagegl/lib/image/GL_RenderImage2D\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar GL_Image2D_1 = require(\"../image/GL_Image2D\");\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nvar GL_RenderImage2D = (function (_super) {\n    __extends(GL_RenderImage2D, _super);\n    function GL_RenderImage2D() {\n        _super.apply(this, arguments);\n    }\n    GL_RenderImage2D.prototype.activate = function (index, mipmap) {\n        _super.prototype.activate.call(this, index, false);\n        //TODO: allow automatic mipmap generation\n    };\n    return GL_RenderImage2D;\n}(GL_Image2D_1.GL_Image2D));\nexports.GL_RenderImage2D = GL_RenderImage2D;\n\n},{\"../image/GL_Image2D\":\"awayjs-stagegl/lib/image/GL_Image2D\"}],\"awayjs-stagegl/lib/image/GL_RenderImageCube\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar GL_ImageCube_1 = require(\"../image/GL_ImageCube\");\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nvar GL_RenderImageCube = (function (_super) {\n    __extends(GL_RenderImageCube, _super);\n    function GL_RenderImageCube() {\n        _super.apply(this, arguments);\n    }\n    GL_RenderImageCube.prototype.activate = function (index, mipmap) {\n        _super.prototype.activate.call(this, index, false);\n        //TODO: allow automatic mipmap generation\n    };\n    return GL_RenderImageCube;\n}(GL_ImageCube_1.GL_ImageCube));\nexports.GL_RenderImageCube = GL_RenderImageCube;\n\n},{\"../image/GL_ImageCube\":\"awayjs-stagegl/lib/image/GL_ImageCube\"}],\"awayjs-stagegl/lib/image/GL_Sampler2D\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar GL_SamplerBase_1 = require(\"../image/GL_SamplerBase\");\n/**\n *\n * @class away.pool.GL_SamplerBase\n */\nvar GL_Sampler2D = (function (_super) {\n    __extends(GL_Sampler2D, _super);\n    function GL_Sampler2D(sampler, stage) {\n        _super.call(this, sampler, stage);\n        this._sampler = sampler;\n    }\n    GL_Sampler2D.prototype.activate = function (index) {\n        this._stage.setSamplerState(index, this._sampler.repeat, this._sampler.smooth, this._sampler.mipmap);\n    };\n    return GL_Sampler2D;\n}(GL_SamplerBase_1.GL_SamplerBase));\nexports.GL_Sampler2D = GL_Sampler2D;\n\n},{\"../image/GL_SamplerBase\":\"awayjs-stagegl/lib/image/GL_SamplerBase\"}],\"awayjs-stagegl/lib/image/GL_SamplerBase\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar AbstractMethodError_1 = require(\"awayjs-core/lib/errors/AbstractMethodError\");\nvar AbstractionBase_1 = require(\"awayjs-core/lib/library/AbstractionBase\");\n/**\n *\n * @class away.pool.GL_SamplerBase\n */\nvar GL_SamplerBase = (function (_super) {\n    __extends(GL_SamplerBase, _super);\n    function GL_SamplerBase(asset, stage) {\n        _super.call(this, asset, stage);\n        this._stage = stage;\n    }\n    GL_SamplerBase.prototype.activate = function (index) {\n        throw new AbstractMethodError_1.AbstractMethodError();\n    };\n    return GL_SamplerBase;\n}(AbstractionBase_1.AbstractionBase));\nexports.GL_SamplerBase = GL_SamplerBase;\n\n},{\"awayjs-core/lib/errors/AbstractMethodError\":undefined,\"awayjs-core/lib/library/AbstractionBase\":undefined}],\"awayjs-stagegl/lib/image/GL_SamplerCube\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar GL_SamplerBase_1 = require(\"../image/GL_SamplerBase\");\n/**\n *\n * @class away.pool.GL_SamplerBase\n */\nvar GL_SamplerCube = (function (_super) {\n    __extends(GL_SamplerCube, _super);\n    function GL_SamplerCube(sampler, stage) {\n        _super.call(this, sampler, stage);\n        this._sampler = sampler;\n    }\n    GL_SamplerCube.prototype.activate = function (index) {\n        this._stage.setSamplerState(index, false, this._sampler.smooth, this._sampler.mipmap);\n    };\n    return GL_SamplerCube;\n}(GL_SamplerBase_1.GL_SamplerBase));\nexports.GL_SamplerCube = GL_SamplerCube;\n\n},{\"../image/GL_SamplerBase\":\"awayjs-stagegl/lib/image/GL_SamplerBase\"}],\"awayjs-stagegl/lib/image/ProgramDataPool\":[function(require,module,exports){\n\"use strict\";\nvar ProgramData_1 = require(\"../image/ProgramData\");\n/**\n * @class away.pool.ProgramDataPool\n */\nvar ProgramDataPool = (function () {\n    /**\n     * //TODO\n     *\n     * @param textureDataClass\n     */\n    function ProgramDataPool(stage) {\n        this._pool = new Object();\n        this._stage = stage;\n    }\n    /**\n     * //TODO\n     *\n     * @param materialOwner\n     * @returns ITexture\n     */\n    ProgramDataPool.prototype.getItem = function (vertexString, fragmentString) {\n        var key = vertexString + fragmentString;\n        return this._pool[key] || (this._pool[key] = new ProgramData_1.ProgramData(this, this._stage, vertexString, fragmentString));\n    };\n    /**\n     * //TODO\n     *\n     * @param materialOwner\n     */\n    ProgramDataPool.prototype.disposeItem = function (key) {\n        this._pool[key] = null;\n    };\n    return ProgramDataPool;\n}());\nexports.ProgramDataPool = ProgramDataPool;\n\n},{\"../image/ProgramData\":\"awayjs-stagegl/lib/image/ProgramData\"}],\"awayjs-stagegl/lib/image/ProgramData\":[function(require,module,exports){\n\"use strict\";\n/**\n *\n * @class away.pool.ProgramDataBase\n */\nvar ProgramData = (function () {\n    function ProgramData(pool, context, vertexString, fragmentString) {\n        this.usages = 0;\n        this._pool = pool;\n        this.stage = context;\n        this.vertexString = vertexString;\n        this.fragmentString = fragmentString;\n        this.stage.registerProgram(this);\n    }\n    /**\n     *\n     */\n    ProgramData.prototype.dispose = function () {\n        this.usages--;\n        if (!this.usages) {\n            this._pool.disposeItem(this.vertexString + this.fragmentString);\n            this.stage.unRegisterProgram(this);\n            if (this.program) {\n                this.program.dispose();\n                this.program = null;\n            }\n        }\n    };\n    ProgramData.PROGRAMDATA_ID_COUNT = 0;\n    return ProgramData;\n}());\nexports.ProgramData = ProgramData;\n\n},{}],\"awayjs-stagegl/lib/image\":[function(require,module,exports){\n\"use strict\";\nvar GL_BitmapImage2D_1 = require(\"./image/GL_BitmapImage2D\");\nexports.GL_BitmapImage2D = GL_BitmapImage2D_1.GL_BitmapImage2D;\nvar GL_BitmapImageCube_1 = require(\"./image/GL_BitmapImageCube\");\nexports.GL_BitmapImageCube = GL_BitmapImageCube_1.GL_BitmapImageCube;\nvar GL_Image2D_1 = require(\"./image/GL_Image2D\");\nexports.GL_Image2D = GL_Image2D_1.GL_Image2D;\nvar GL_ImageBase_1 = require(\"./image/GL_ImageBase\");\nexports.GL_ImageBase = GL_ImageBase_1.GL_ImageBase;\nvar GL_ImageCube_1 = require(\"./image/GL_ImageCube\");\nexports.GL_ImageCube = GL_ImageCube_1.GL_ImageCube;\nvar GL_RenderImage2D_1 = require(\"./image/GL_RenderImage2D\");\nexports.GL_RenderImage2D = GL_RenderImage2D_1.GL_RenderImage2D;\nvar GL_RenderImageCube_1 = require(\"./image/GL_RenderImageCube\");\nexports.GL_RenderImageCube = GL_RenderImageCube_1.GL_RenderImageCube;\nvar GL_Sampler2D_1 = require(\"./image/GL_Sampler2D\");\nexports.GL_Sampler2D = GL_Sampler2D_1.GL_Sampler2D;\nvar GL_SamplerBase_1 = require(\"./image/GL_SamplerBase\");\nexports.GL_SamplerBase = GL_SamplerBase_1.GL_SamplerBase;\nvar GL_SamplerCube_1 = require(\"./image/GL_SamplerCube\");\nexports.GL_SamplerCube = GL_SamplerCube_1.GL_SamplerCube;\nvar ProgramData_1 = require(\"./image/ProgramData\");\nexports.ProgramData = ProgramData_1.ProgramData;\nvar ProgramDataPool_1 = require(\"./image/ProgramDataPool\");\nexports.ProgramDataPool = ProgramDataPool_1.ProgramDataPool;\n\n},{\"./image/GL_BitmapImage2D\":\"awayjs-stagegl/lib/image/GL_BitmapImage2D\",\"./image/GL_BitmapImageCube\":\"awayjs-stagegl/lib/image/GL_BitmapImageCube\",\"./image/GL_Image2D\":\"awayjs-stagegl/lib/image/GL_Image2D\",\"./image/GL_ImageBase\":\"awayjs-stagegl/lib/image/GL_ImageBase\",\"./image/GL_ImageCube\":\"awayjs-stagegl/lib/image/GL_ImageCube\",\"./image/GL_RenderImage2D\":\"awayjs-stagegl/lib/image/GL_RenderImage2D\",\"./image/GL_RenderImageCube\":\"awayjs-stagegl/lib/image/GL_RenderImageCube\",\"./image/GL_Sampler2D\":\"awayjs-stagegl/lib/image/GL_Sampler2D\",\"./image/GL_SamplerBase\":\"awayjs-stagegl/lib/image/GL_SamplerBase\",\"./image/GL_SamplerCube\":\"awayjs-stagegl/lib/image/GL_SamplerCube\",\"./image/ProgramData\":\"awayjs-stagegl/lib/image/ProgramData\",\"./image/ProgramDataPool\":\"awayjs-stagegl/lib/image/ProgramDataPool\"}],\"awayjs-stagegl/lib/library/GL_IAssetClass\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/library\":[function(require,module,exports){\n\"use strict\";\n\n},{}],\"awayjs-stagegl/lib/managers/StageManager\":[function(require,module,exports){\n\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar EventDispatcher_1 = require(\"awayjs-core/lib/events/EventDispatcher\");\nvar ArgumentError_1 = require(\"awayjs-core/lib/errors/ArgumentError\");\nvar Stage_1 = require(\"../base/Stage\");\nvar StageEvent_1 = require(\"../events/StageEvent\");\n/**\n * The StageManager class provides a multiton object that handles management for Stage objects.\n *\n * @see away.base.Stage\n */\nvar StageManager = (function (_super) {\n    __extends(StageManager, _super);\n    /**\n     * Creates a new StageManager class.\n     * @param stage The Stage object that contains the Stage objects to be managed.\n     * @private\n     */\n    function StageManager() {\n        var _this = this;\n        _super.call(this);\n        this._stages = new Array(StageManager.STAGE_MAX_QUANTITY);\n        this._onContextCreatedDelegate = function (event) { return _this.onContextCreated(event); };\n    }\n    /**\n     * Gets a StageManager instance for the given Stage object.\n     * @param stage The Stage object that contains the Stage objects to be managed.\n     * @return The StageManager instance for the given Stage object.\n     */\n    StageManager.getInstance = function () {\n        if (this._instance == null)\n            this._instance = new StageManager();\n        return this._instance;\n    };\n    /**\n     * Requests the Stage for the given index.\n     *\n     * @param index The index of the requested Stage.\n     * @param forceSoftware Whether to force software mode even if hardware acceleration is available.\n     * @param profile The compatibility profile, an enumeration of ContextProfile\n     * @return The Stage for the given index.\n     */\n    StageManager.prototype.getStageAt = function (index, forceSoftware, profile, mode) {\n        if (forceSoftware === void 0) { forceSoftware = false; }\n        if (profile === void 0) { profile = \"baseline\"; }\n        if (mode === void 0) { mode = \"auto\"; }\n        if (index < 0 || index >= StageManager.STAGE_MAX_QUANTITY)\n            throw new ArgumentError_1.ArgumentError(\"Index is out of bounds [0..\" + StageManager.STAGE_MAX_QUANTITY + \"]\");\n        if (!this._stages[index]) {\n            StageManager._numStages++;\n            if (document) {\n                var canvas = document.createElement(\"canvas\");\n                canvas.id = \"stage\" + index;\n                document.body.appendChild(canvas);\n            }\n            var stage = this._stages[index] = new Stage_1.Stage(canvas, index, this, forceSoftware, profile);\n            stage.addEventListener(StageEvent_1.StageEvent.CONTEXT_CREATED, this._onContextCreatedDelegate);\n            stage.requestContext(forceSoftware, profile, mode);\n        }\n        return stage;\n    };\n    /**\n     * Removes a Stage from the manager.\n     * @param stage\n     * @private\n     */\n    StageManager.prototype.iRemoveStage = function (stage) {\n        StageManager._numStages--;\n        stage.removeEventListener(StageEvent_1.StageEvent.CONTEXT_CREATED, this._onContextCreatedDelegate);\n        this._stages[stage.stageIndex] = null;\n    };\n    /**\n     * Get the next available stage. An error is thrown if there are no StageProxies available\n     * @param forceSoftware Whether to force software mode even if hardware acceleration is available.\n     * @param profile The compatibility profile, an enumeration of ContextProfile\n     * @return The allocated stage\n     */\n    StageManager.prototype.getFreeStage = function (forceSoftware, profile, mode) {\n        if (forceSoftware === void 0) { forceSoftware = false; }\n        if (profile === void 0) { profile = \"baseline\"; }\n        if (mode === void 0) { mode = \"auto\"; }\n        var i = 0;\n        var len = this._stages.length;\n        while (i < len) {\n            if (!this._stages[i])\n                return this.getStageAt(i, forceSoftware, profile, mode);\n            ++i;\n        }\n        return null;\n    };\n    Object.defineProperty(StageManager.prototype, \"hasFreeStage\", {\n        /**\n         * Checks if a new stage can be created and managed by the class.\n         * @return true if there is one slot free for a new stage\n         */\n        get: function () {\n            return StageManager._numStages < StageManager.STAGE_MAX_QUANTITY ? true : false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StageManager.prototype, \"numSlotsFree\", {\n        /**\n         * Returns the amount of stage objects that can be created and managed by the class\n         * @return the amount of free slots\n         */\n        get: function () {\n            return StageManager.STAGE_MAX_QUANTITY - StageManager._numStages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StageManager.prototype, \"numSlotsUsed\", {\n        /**\n         * Returns the amount of Stage objects currently managed by the class.\n         * @return the amount of slots used\n         */\n        get: function () {\n            return StageManager._numStages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(StageManager.prototype, \"numSlotsTotal\", {\n        /**\n         * The maximum amount of Stage objects that can be managed by the class\n         */\n        get: function () {\n            return this._stages.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    StageManager.prototype.onContextCreated = function (event) {\n        //var stage:Stage = <Stage> e.target;\n        //document.body.appendChild(stage.canvas)\n    };\n    StageManager.STAGE_MAX_QUANTITY = 8;\n    StageManager._numStages = 0;\n    return StageManager;\n}(EventDispatcher_1.EventDispatcher));\nexports.StageManager = StageManager;\n\n},{\"../base/Stage\":\"awayjs-stagegl/lib/base/Stage\",\"../events/StageEvent\":\"awayjs-stagegl/lib/events/StageEvent\",\"awayjs-core/lib/errors/ArgumentError\":undefined,\"awayjs-core/lib/events/EventDispatcher\":undefined}],\"awayjs-stagegl/lib/managers\":[function(require,module,exports){\n\"use strict\";\nvar StageManager_1 = require(\"./managers/StageManager\");\nexports.StageManager = StageManager_1.StageManager;\n\n},{\"./managers/StageManager\":\"awayjs-stagegl/lib/managers/StageManager\"}]},{},[1])\n\n",
    "import * as aglsl\t\t\t\t\tfrom \"./lib/aglsl\";\nimport * as attributes\t\t\t\tfrom \"./lib/attributes\";\nimport * as base\t\t\t\t\tfrom \"./lib/base\";\nimport * as events\t\t\t\t\tfrom \"./lib/events\";\nimport * as image\t\t\t\t\tfrom \"./lib/image\";\nimport * as library\t\t\t\t\tfrom \"./lib/library\";\nimport * as managers\t\t\t\tfrom \"./lib/managers\";\n\nimport {AttributesBuffer}\t\t\t\tfrom \"awayjs-core/lib/attributes/AttributesBuffer\";\nimport {BitmapImage2D}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImage2D\";\nimport {BitmapImageCube}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImageCube\";\nimport {Image2D}\t\t\t\t\t\tfrom \"awayjs-core/lib/image/Image2D\";\nimport {ImageCube}\t\t\t\t\tfrom \"awayjs-core/lib/image/ImageCube\";\nimport {SpecularImage2D}\t\t\t\tfrom \"awayjs-core/lib/image/SpecularImage2D\";\nimport {Sampler2D}\t\t\t\t\tfrom \"awayjs-core/lib/image/Sampler2D\";\nimport {SamplerCube}\t\t\t\t\tfrom \"awayjs-core/lib/image/SamplerCube\";\n\nbase.Stage.registerAbstraction(attributes.GL_AttributesBuffer, AttributesBuffer);\nbase.Stage.registerAbstraction(image.GL_RenderImage2D, Image2D);\nbase.Stage.registerAbstraction(image.GL_RenderImageCube, ImageCube);\nbase.Stage.registerAbstraction(image.GL_BitmapImage2D, BitmapImage2D);\nbase.Stage.registerAbstraction(image.GL_BitmapImageCube, BitmapImageCube);\nbase.Stage.registerAbstraction(image.GL_BitmapImage2D, SpecularImage2D);\nbase.Stage.registerAbstraction(image.GL_Sampler2D, Sampler2D);\nbase.Stage.registerAbstraction(image.GL_SamplerCube, SamplerCube);\n\nexport {\n\taglsl,\n\tattributes,\n\tbase,\n\tevents,\n\timage,\n\tlibrary,\n\tmanagers\n}",
    "import {ByteArray}\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nimport {Description}\t\t\t\tfrom \"../aglsl/Description\";\nimport {Header}\t\t\t\t\tfrom \"../aglsl/Header\";\nimport {Mapping}\t\t\t\t\tfrom \"../aglsl/Mapping\";\nimport {Token}\t\t\t\t\tfrom \"../aglsl/Token\";\n\nexport class AGALTokenizer\n{\n\tconstructor()\n\t{\n\t}\n\n\tpublic decribeAGALByteArray(bytes:ByteArray):Description\n\t{\n\t\tvar header:Header = new Header();\n\n\t\tif (bytes.readUnsignedByte() != 0xa0) {\n\t\t\tthrow \"Bad AGAL: Missing 0xa0 magic byte.\";\n\t\t}\n\n\t\theader.version = bytes.readUnsignedInt();\n\t\tif (header.version >= 0x10) {\n\t\t\tbytes.readUnsignedByte();\n\t\t\theader.version >>= 1;\n\t\t}\n\t\tif (bytes.readUnsignedByte() != 0xa1) {\n\t\t\tthrow \"Bad AGAL: Missing 0xa1 magic byte.\";\n\t\t}\n\n\t\theader.progid = bytes.readUnsignedByte();\n\t\tswitch (header.progid) {\n\t\t\tcase 1:\n\t\t\t\theader.type = \"fragment\";\n\t\t\t\tbreak;\n\t\t\tcase 0:\n\t\t\t\theader.type = \"vertex\";\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\theader.type = \"cpu\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\theader.type = \"\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tvar desc:Description = new Description();\n\t\tvar tokens:Token[] = [];\n\t\twhile (bytes.position < bytes.length) {\n\t\t\tvar token:Token = new Token();\n\n\t\t\ttoken.opcode = bytes.readUnsignedInt();\n\t\t\tvar lutentry = Mapping.agal2glsllut[token.opcode];\n\t\t\tif (!lutentry) {\n\t\t\t\tthrow \"Opcode not valid or not implemented yet: \" + token.opcode;\n\t\t\t}\n\t\t\tif (lutentry.matrixheight) {\n\t\t\t\tdesc.hasmatrix = true;\n\t\t\t}\n\t\t\tif (lutentry.dest) {\n\t\t\t\ttoken.dest.regnum = bytes.readUnsignedShort();\n\t\t\t\ttoken.dest.mask = bytes.readUnsignedByte();\n\t\t\t\ttoken.dest.regtype = bytes.readUnsignedByte();\n\t\t\t\tdesc.regwrite[token.dest.regtype][token.dest.regnum] |= token.dest.mask;\n\t\t\t} else {\n\t\t\t\ttoken.dest = null;\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t}\n\t\t\tif (lutentry.a) {\n\t\t\t\tthis.readReg(token.a, 1, desc, bytes);\n\t\t\t} else {\n\t\t\t\ttoken.a = null;\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t}\n\t\t\tif (lutentry.b) {\n\t\t\t\tthis.readReg(token.b, lutentry.matrixheight | 0, desc, bytes);\n\t\t\t} else {\n\t\t\t\ttoken.b = null;\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t\tbytes.readUnsignedInt();\n\t\t\t}\n\t\t\ttokens.push(token);\n\t\t}\n\t\tdesc.header = header;\n\t\tdesc.tokens = tokens;\n\n\t\treturn desc;\n\t}\n\n\tpublic readReg(s, mh, desc, bytes):void\n\t{\n\t\ts.regnum = bytes.readUnsignedShort();\n\t\ts.indexoffset = bytes.readByte();\n\t\ts.swizzle = bytes.readUnsignedByte();\n\t\ts.regtype = bytes.readUnsignedByte();\n\t\tdesc.regread[s.regtype][s.regnum] = 0xf; // sould be swizzle to mask? should be |=                                                 \n\t\tif (s.regtype == 0x5) {\n\t\t\t// sampler\n\t\t\ts.lodbiad = s.indexoffset;\n\t\t\ts.indexoffset = undefined;\n\t\t\ts.swizzle = undefined;\n\n\t\t\t// sampler \n\t\t\ts.readmode = bytes.readUnsignedByte();\n\t\t\ts.dim = s.readmode >> 4;\n\t\t\ts.readmode &= 0xf;\n\t\t\ts.special = bytes.readUnsignedByte();\n\t\t\ts.wrap = s.special >> 4;\n\t\t\ts.special &= 0xf;\n\t\t\ts.mipmap = bytes.readUnsignedByte();\n\t\t\ts.filter = s.mipmap >> 4;\n\t\t\ts.mipmap &= 0xf;\n\t\t\tdesc.samplers[s.regnum] = s;\n\t\t} else {\n\t\t\ts.indexregtype = bytes.readUnsignedByte();\n\t\t\ts.indexselect = bytes.readUnsignedByte();\n\t\t\ts.indirectflag = bytes.readUnsignedByte();\n\t\t}\n\t\tif (s.indirectflag) {\n\t\t\tdesc.hasindirect = true;\n\t\t}\n\t\tif (!s.indirectflag && mh) {\n\t\t\tfor (var mhi:number = 0; mhi < mh; mhi++) //TODO wrong, should be |=\n\t\t\t{\n\t\t\t\tdesc.regread[s.regtype][s.regnum + mhi] = desc.regread[s.regtype][s.regnum];\n\t\t\t}\n\t\t}\n\t}\n}",
    "import {Description}\t\t\t\tfrom \"../aglsl/Description\";\nimport {Mapping}\t\t\t\t\tfrom \"../aglsl/Mapping\";\n\nexport class AGLSLParser\n{\n\tpublic static maxvertexconstants:number = 128;\n\tpublic static maxfragconstants:number = 28;\n\tpublic static maxtemp:number = 8;\n\tpublic static maxstreams:number = 8;\n\tpublic static maxtextures:number = 8;\n\t\n\tpublic parse(desc:Description):string\n\t{\n\t\tvar header:string = \"\";\n\t\tvar body:string = \"\";\n\n\t\theader += \"precision highp float;\\n\";\n\t\tvar tag = desc.header.type[0]; //TODO\n\n\t\t// declare uniforms\n\t\tif (desc.header.type == \"vertex\") {\n\t\t\theader += \"uniform float yflip;\\n\";\n\t\t}\n\t\t// if (!desc.hasindirect) {\n\t\t// \tfor (var i:number = 0; i < desc.regread[0x1].length; i++) {\n\t\t// \t\tif (desc.regread[0x1][i]) {\n\t\t// \t\t\theader += \"uniform vec4 \" + tag + \"c\" + i + \";\\n\";\n\t\t// \t\t}\n\t\t// \t}\n\t\t// } else {\n\t\t// \theader += \"uniform vec4 \" + tag + \"carrr[\" + AGLSLParser.maxvertexconstants + \"];\\n\";                // use max const count instead\n\t\t// }\n\n\t\tvar constcount:number = desc.regread[0x1].length;\n\n\t\tif (constcount > 0)\n\t\t\theader += \"uniform vec4 \" + tag + \"c[\" + constcount + \"];\\n\";\n\n\t\t// declare temps\n\t\tfor (var i = 0; i < desc.regread[0x2].length || i < desc.regwrite[0x2].length; i++) {\n\t\t\tif (desc.regread[0x2][i] || desc.regwrite[0x2][i]) // duh, have to check write only also...\n\t\t\t{\n\t\t\t\theader += \"vec4 \" + tag + \"t\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// declare streams\n\t\tfor (var i:number = 0; i < desc.regread[0x0].length; i++) {\n\t\t\tif (desc.regread[0x0][i]) {\n\t\t\t\theader += \"attribute vec4 va\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// declare interpolated\n\t\tfor (var i:number = 0; i < desc.regread[0x4].length || i < desc.regwrite[0x4].length; i++) {\n\t\t\tif (desc.regread[0x4][i] || desc.regwrite[0x4][i]) {\n\t\t\t\theader += \"varying vec4 vi\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// declare samplers\n\t\tvar samptype:Array<string> = [\"2D\", \"Cube\", \"3D\", \"\"];\n\t\tfor (var i:number = 0; i < desc.samplers.length; i++) {\n\t\t\tif (desc.samplers[i]) {\n\t\t\t\theader += \"uniform sampler\" + samptype[ desc.samplers[i].dim & 3 ] + \" fs\" + i + \";\\n\";\n\t\t\t}\n\t\t}\n\n\t\t// extra gl fluff: setup position and depth adjust temps\n\t\tif (desc.header.type == \"vertex\") {\n\t\t\theader += \"vec4 outpos;\\n\";\n\t\t}\n\t\tif (desc.writedepth) {\n\t\t\theader += \"vec4 tmp_FragDepth;\\n\";\n\t\t}\n\t\t//if ( desc.hasmatrix ) \n\t\t//    header += \"vec4 tmp_matrix;\\n\";\n\n\t\tvar derivatives:boolean = false;\n\n\t\t// start body of code\n\t\tbody += \"void main() {\\n\";\n\n\t\tfor (var i:number = 0; i < desc.tokens.length; i++) {\n\n\t\t\tvar lutentry = Mapping.agal2glsllut[desc.tokens[i].opcode];\n\n\t\t\tif(lutentry.s.indexOf(\"dFdx\") != -1 || lutentry.s.indexOf(\"dFdy\") != -1) derivatives = true;\n\t\t\tif (!lutentry) {\n\t\t\t\tthrow \"Opcode not valid or not implemented yet: \"\n\t\t\t\t/*+token.opcode;*/\n\t\t\t}\n\t\t\tvar sublines = lutentry.matrixheight || 1;\n\n\t\t\tfor (var sl:number = 0; sl < sublines; sl++) {\n\t\t\t\tvar line:string = \"  \" + lutentry.s;\n\t\t\t\tif (desc.tokens[i].dest) {\n\t\t\t\t\tif (lutentry.matrixheight) {\n\t\t\t\t\t\tif (((desc.tokens[i].dest.mask >> sl) & 1) != 1) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar destregstring:string = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);\n\t\t\t\t\t\tvar destcaststring:string = \"float\";\n\t\t\t\t\t\tvar destmaskstring = [\"x\", \"y\", \"z\", \"w\"][sl];\n\t\t\t\t\t\tdestregstring += \".\" + destmaskstring;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar destregstring:string = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);\n\t\t\t\t\t\tvar destcaststring:string;\n\t\t\t\t\t\tvar destmaskstring:string;\n\t\t\t\t\t\tif (desc.tokens[i].dest.mask != 0xf) {\n\t\t\t\t\t\t\tvar ndest:number = 0;\n\t\t\t\t\t\t\tdestmaskstring = \"\";\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 1) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"x\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 2) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"y\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 4) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"z\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (desc.tokens[i].dest.mask & 8) {\n\t\t\t\t\t\t\t\tndest++;\n\t\t\t\t\t\t\t\tdestmaskstring += \"w\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdestregstring += \".\" + destmaskstring;\n\t\t\t\t\t\t\tswitch (ndest) {\n\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\tdestcaststring = \"float\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\t\t\tdestcaststring = \"vec2\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\t\t\tdestcaststring = \"vec3\";\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tthrow \"Unexpected destination mask\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdestcaststring = \"vec4\";\n\t\t\t\t\t\t\tdestmaskstring = \"xyzw\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tline = line.replace(\"%dest\", destregstring);\n\t\t\t\t\tline = line.replace(\"%cast\", destcaststring);\n\t\t\t\t\tline = line.replace(\"%dm\", destmaskstring);\n\t\t\t\t}\n\t\t\t\tvar dwm:number = 0xf;\n\t\t\t\tif (!lutentry.ndwm && lutentry.dest && desc.tokens[i].dest) {\n\t\t\t\t\tdwm = desc.tokens[i].dest.mask;\n\t\t\t\t}\n\t\t\t\tif (desc.tokens[i].a) {\n\t\t\t\t\tline = line.replace(\"%a\", this.sourcetostring(desc.tokens[i].a, 0, dwm, lutentry.scalar, desc, tag));\n\t\t\t\t}\n\t\t\t\tif (desc.tokens[i].b) {\n\t\t\t\t\tline = line.replace(\"%b\", this.sourcetostring(desc.tokens[i].b, sl, dwm, lutentry.scalar, desc, tag));\n\t\t\t\t\tif (desc.tokens[i].b.regtype == 0x5) {\n\t\t\t\t\t\t// sampler dim\n\t\t\t\t\t\tvar texdim = [\"2D\", \"Cube\", \"3D\"][desc.tokens[i].b.dim];\n\t\t\t\t\t\tvar texsize = [\"vec2\", \"vec3\", \"vec3\"][desc.tokens[i].b.dim];\n\t\t\t\t\t\tline = line.replace(\"%texdim\", texdim);\n\t\t\t\t\t\tline = line.replace(\"%texsize\", texsize);\n\t\t\t\t\t\tvar texlod:string = \"\";\n\t\t\t\t\t\tline = line.replace(\"%lod\", texlod);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbody += line;\n\t\t\t}\n\t\t}\n\n\t\t// adjust z from opengl range of -1..1 to 0..1 as in d3d, this also enforces a left handed coordinate system\n\t\tif (desc.header.type == \"vertex\") {\n\t\t\tbody += \"  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\\n\";\n\t\t}\n\n\t\t//flag based switch\n\t\tif (derivatives && desc.header.type == \"fragment\") {\n\t\t\theader = \"#extension GL_OES_standard_derivatives : enable\\n\" + header;\n\t\t}\n\n\t\t// clamp fragment depth\n\t\tif (desc.writedepth) {\n\t\t\tbody += \"  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\\n\";\n\t\t}\n\n\t\t// close main\n\t\tbody += \"}\\n\";\n\n\t\treturn header + body;\n\t}\n\n\tpublic regtostring(regtype:number, regnum:number, desc:Description, tag):string\n\t{\n\t\tswitch (regtype) {\n\t\t\tcase 0x0:\n\t\t\t\treturn \"va\" + regnum;\n\t\t\tcase 0x1:\n\t\t\t\treturn desc.header.type[0] + \"c[\" + regnum + \"]\";\n\t\t\t// case 0x1:\n\t\t\t// \tif (desc.hasindirect && desc.header.type == \"vertex\") {\n\t\t\t// \t\treturn \"vcarrr[\" + regnum + \"]\";\n\t\t\t// \t} else {\n\t\t\t// \t\treturn tag + \"c\" + regnum;\n\t\t\t// \t}\n\t\t\tcase 0x2:\n\t\t\t\treturn tag + \"t\" + regnum;\n\t\t\tcase 0x3:\n\t\t\t\treturn desc.header.type == \"vertex\"? \"outpos\" : \"gl_FragColor\";\n\t\t\tcase 0x4:\n\t\t\t\treturn \"vi\" + regnum;\n\t\t\tcase 0x5:\n\t\t\t\treturn \"fs\" + regnum;\n\t\t\tcase 0x6:\n\t\t\t\treturn \"tmp_FragDepth\";\n\t\t\tdefault:\n\t\t\t\tthrow \"Unknown register type\";\n\t\t}\n\t}\n\n\tpublic sourcetostring(s, subline, dwm, isscalar, desc, tag):string\n\t{\n\t\tvar swiz = [ \"x\", \"y\", \"z\", \"w\" ];\n\t\tvar r;\n\n\t\tif (s.indirectflag) {\n\t\t\tr = \"vcarrr[int(\" + this.regtostring(s.indexregtype, s.regnum, desc, tag) + \".\" + swiz[s.indexselect] + \")\";\n\t\t\tvar realofs = subline + s.indexoffset;\n\t\t\tif (realofs < 0) r += realofs.toString();\n\t\t\tif (realofs > 0) r += \"+\" + realofs.toString();\n\t\t\tr += \"]\";\n\t\t} else {\n\t\t\tr = this.regtostring(s.regtype, s.regnum + subline, desc, tag);\n\t\t}\n\n\t\t// samplers never add swizzle        \n\t\tif (s.regtype == 0x5) {\n\t\t\treturn r;\n\t\t}\n\n\t\t// scalar, first component only\n\t\tif (isscalar) {\n\t\t\treturn r + \".\" + swiz[(s.swizzle >> 0) & 3];\n\t\t}\n\n\t\t// identity\n\t\tif (s.swizzle == 0xe4 && dwm == 0xf) {\n\t\t\treturn r;\n\t\t}\n\n\t\t// with destination write mask folded in\n\t\tr += \".\";\n\t\tif (dwm & 1) r += swiz[(s.swizzle >> 0) & 3];\n\t\tif (dwm & 2) r += swiz[(s.swizzle >> 2) & 3];\n\t\tif (dwm & 4) r += swiz[(s.swizzle >> 4) & 3];\n\t\tif (dwm & 8) r += swiz[(s.swizzle >> 6) & 3];\n\t\treturn r;\n\t}\n}",
    "import {Header}\t\t\t\t\tfrom \"../aglsl/Header\";\nimport {Token}\t\t\t\t\tfrom \"../aglsl/Token\";\n\nexport class Description\n{\n\tpublic regread:any[] = [\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[]\n\t];\n\tpublic regwrite:any[] = [\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[],\n\t\t[]\n\t];\n\tpublic hasindirect:boolean = false;\n\tpublic writedepth:boolean = false;\n\tpublic hasmatrix:boolean = false;\n\tpublic samplers:any[] = [];\n\n\t// added due to dynamic assignment 3*0xFFFFFFuuuu\n\tpublic tokens:Token[] = [];\n\tpublic header:Header = new Header();\n\n\tconstructor()\n\t{\n\t}\n}",
    "export class Destination\n{\n\tpublic mask:number = 0;\n\tpublic regnum:number = 0;\n\tpublic regtype:number = 0;\n\tpublic dim:number = 0;\n\n\tpublic indexoffset:number = 0;\n\tpublic swizzle:number = 0;\n\tpublic lodbiad:number = 0;\n\tpublic readmode:number = 0;\n\tpublic special:number = 0;\n\tpublic wrap:number = 0;\n\tpublic filter:number = 0;\n\n\tpublic indexregtype:number = 0;\n\tpublic indexselect:number = 0;\n\tpublic indirectflag:number = 0;\n\n\tconstructor()\n\t{\n\t}\n}",
    "export class Header\n{\n\tpublic progid:number = 0;\n\tpublic version:number = 0;\n\tpublic type:string = \"\";\n\n\tconstructor()\n\t{\n\t}\n}",
    "import {OpLUT}\t\t\t\t\tfrom \"../aglsl/OpLUT\";\n\nexport class Mapping\n{\n\tstatic agal2glsllut:Array<OpLUT> = [\n\n\t\t//         s \t\t\t\t\t\t\t\t\t\t\t\tflags   dest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n\t\tnew OpLUT(\"%dest = %cast(%a);\\n\", 0, true, true, false, null, null, null, null, null, null), //mov                          //0\n\t\tnew OpLUT(\"%dest = %cast(%a + %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //add                      //1\n\t\tnew OpLUT(\"%dest = %cast(%a - %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //sub                      //2\n\t\tnew OpLUT(\"%dest = %cast(%a * %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //mul                      //3\n\t\tnew OpLUT(\"%dest = %cast(%a / %b);\\n\", 0, true, true, true, null, null, null, null, null, null), //div                      //4\n\t\tnew OpLUT(\"%dest = %cast(1.0) / %a;\\n\", 0, true, true, false, null, null, null, null, null, null), //rcp                    //5\n\t\tnew OpLUT(\"%dest = %cast(min(%a,%b));\\n\", 0, true, true, true, null, null, null, null, null, null), //min                   //6\n\t\tnew OpLUT(\"%dest = %cast(max(%a,%b));\\n\", 0, true, true, true, null, null, null, null, null, null), //max                   //7\n\t\tnew OpLUT(\"%dest = %cast(fract(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //frc                   //8\n\t\tnew OpLUT(\"%dest = %cast(sqrt(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null), //sqt               //9\n\t\tnew OpLUT(\"%dest = %cast(inversesqrt(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null), //rsq        //10\n\t\tnew OpLUT(\"%dest = %cast(pow(abs(%a),%b));\\n\", 0, true, true, true, null, null, null, null, null, null), //pow              //11\n\t\tnew OpLUT(\"%dest = %cast(log2(abs(%a)));\\n\", 0, true, true, false, null, null, null, null, null, null), //log               //12\n\t\tnew OpLUT(\"%dest = %cast(exp2(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //exp                    //13\n\n\t\t//         s \t\t\t\t\t\t\t\t\t\t\t\tflags  \tdest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n\t\tnew OpLUT(\"%dest = %cast(normalize(vec3( %a ) ));\\n\", 0, true, true, false, null, null, true, null, null, null), //nrm      //14\n\t\tnew OpLUT(\"%dest = %cast(sin(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //sin                     //15\n\t\tnew OpLUT(\"%dest = %cast(cos(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //cos                     //16\n\t\tnew OpLUT(\"%dest = %cast(cross(vec3(%a),vec3(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null), //crs     //17\n\t\tnew OpLUT(\"%dest = %cast(dot(vec3(%a),vec3(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null), //dp3       //18\n\t\tnew OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", 0, true, true, true, null, null, true, null, null, null), //dp4       //19\n\t\tnew OpLUT(\"%dest = %cast(abs(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //abs                     //20\n\t\tnew OpLUT(\"%dest = %cast(%a * -1.0);\\n\", 0, true, true, false, null, null, null, null, null, null), //neg                   //21\n\t\tnew OpLUT(\"%dest = %cast(clamp(%a,0.0,1.0));\\n\", 0, true, true, false, null, null, null, null, null, null), //sat           //22\n\t\tnew OpLUT(\"%dest = %cast(dot(vec3(%a),vec3(%b)));\\n\", null, true, true, true, 3, 3, true, null, null, null), //m33          //23\n\t\tnew OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", null, true, true, true, 4, 4, true, null, null, null), //m44          //24\n\t\tnew OpLUT(\"%dest = %cast(dot(vec4(%a),vec4(%b)));\\n\", null, true, true, true, 4, 3, true, null, null, null), //m43          //25\n\t\t//s:string, flags:number, dest:boolean, a:boolean, b:boolean, matrixwidth:number, matrixheight:number, ndwm:boolean, scaler:boolean, dm:boolean, lod:boolean\n\t\tnew OpLUT(\"%dest = %cast(dFdx(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //dFdx                   //26\n\t\tnew OpLUT(\"%dest = %cast(dFdy(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), //dFdy                   //27\n\t\tnew OpLUT(\"if (float(%a)==float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"if (float(%a)!=float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"if (float(%a)>=float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"if (float(%a)<float(%b)) {;\\n\", 0, false, true, true, null, null, null, true, null, null), new OpLUT(\"} else {;\\n\", 0, false, false, false, null, null, null, null, null, null), new OpLUT(\"};\\n\", 0, false, false, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null), new OpLUT(null, null, null, null, false, null, null, null, null, null, null),\n\n\t\t//         s \t\t\t\t\t\t\t\t\t\t\t\t\t\t\tflags  \tdest    a     b \t    mw \t  mh    ndwm  scale dm\t  lod\n\t\tnew OpLUT(\"%dest = %cast(texture%texdimLod(%b,%texsize(%a)).%dm);\\n\", null, true, true, true, null, null, null, null, true, null), new OpLUT(\"if ( float(%a)<0.0 ) discard;\\n\", null, false, true, false, null, null, null, true, null, null), new OpLUT(\"%dest = %cast(texture%texdim(%b,%texsize(%a)%lod).%dm);\\n\", null, true, true, true, null, null, true, null, true, true), new OpLUT(\"%dest = %cast(greaterThanEqual(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT(\"%dest = %cast(lessThan(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT(\"%dest = %cast(sign(%a));\\n\", 0, true, true, false, null, null, null, null, null, null), new OpLUT(\"%dest = %cast(equal(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null), new OpLUT(\"%dest = %cast(notEqual(%a,%b).%dm);\\n\", 0, true, true, true, null, null, true, null, true, null)\n\n\t];\n\n\t//TODO: get rid of hack that fixes including definition file\n\tconstructor(include?:OpLUT)\n\t{\n\n\t}\n}",
    "export class OpLUT\n{\n\n\tpublic s:string;\n\tpublic flags:number;\n\tpublic dest:boolean;\n\tpublic a:boolean;\n\tpublic b:boolean;\n\tpublic matrixwidth:number;\n\tpublic matrixheight:number;\n\tpublic ndwm:boolean;\n\tpublic scalar:boolean;\n\tpublic dm:boolean;\n\tpublic lod:boolean;\n\n\tconstructor(s:string, flags:number, dest:boolean, a:boolean, b:boolean, matrixwidth:number, matrixheight:number, ndwm:boolean, scaler:boolean, dm:boolean, lod:boolean)\n\t{\n\t\tthis.s = s;\n\t\tthis.flags = flags;\n\t\tthis.dest = dest;\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.matrixwidth = matrixwidth;\n\t\tthis.matrixheight = matrixheight;\n\t\tthis.ndwm = ndwm;\n\t\tthis.scalar = scaler;\n\t\tthis.dm = dm;\n\t\tthis.lod = lod;\n\t}\n}",
    "import {Destination}\t\t\t\tfrom \"../aglsl/Destination\";\n\nexport class Token\n{\n\tpublic dest:Destination = new Destination();\n\tpublic opcode:number = 0;\n\tpublic a:Destination = new Destination();\n\tpublic b:Destination = new Destination();\n\n\tconstructor()\n\t{\n\t}\n}",
    "import {Sampler}\t\t\t\t\tfrom \"../../aglsl/assembler/Sampler\";\nimport {Opcode}\t\t\t\t\tfrom \"../../aglsl/assembler/Opcode\";\nimport {OpcodeMap}\t\t\t\tfrom \"../../aglsl/assembler/OpcodeMap\";\nimport {Part}\t\t\t\t\t\tfrom \"../../aglsl/assembler/Part\";\nimport {RegMap}\t\t\t\t\tfrom \"../../aglsl/assembler/RegMap\";\nimport {SamplerMap}\t\t\t\tfrom \"../../aglsl/assembler/SamplerMap\";\n\n\nexport class AGALMiniAssembler\n{\n\tpublic r:Object;\n\tpublic cur:Part;\n\n\tconstructor()\n\t{\n\t\tthis.r = {};\n\t\tthis.cur = new Part();\n\t}\n\n\tpublic assemble(source:string, ext_part = null, ext_version = null):Object\n\t{\n\t\tif (!ext_version) {\n\t\t\text_version = 1;\n\t\t}\n\n\t\tif (ext_part) {\n\t\t\tthis.addHeader(ext_part, ext_version);\n\t\t}\n\n\t\tvar lines = source.replace(/[\\f\\n\\r\\v]+/g, \"\\n\").split(\"\\n\"); // handle breaks, then split into lines\n\n\t\tfor (var i in lines) {\n\t\t\tthis.processLine(lines[i], i);\n\t\t}\n\n\t\treturn this.r;\n\t}\n\n\tprivate processLine(line, linenr):void\n\t{\n\t\tvar startcomment:number = line.search(\"//\");  // remove comments\n\t\tif (startcomment != -1) {\n\t\t\tline = line.slice(0, startcomment);\n\t\t}\n\t\tline = line.replace(/^\\s+|\\s+$/g, \"\"); // remove outer space\n\t\tif (!(line.length > 0 )) {\n\t\t\treturn;\n\t\t}\n\t\tvar optsi:number = line.search(/<.*>/g); // split of options part <*> if there\n\t\tvar opts:string[] = null;\n\t\tif (optsi != -1) {\n\t\t\topts = line.slice(optsi).match(/([\\w\\.\\-\\+]+)/gi);\n\t\t\tline = line.slice(0, optsi);\n\t\t}\n\n\t\t// get opcode/command\t\t\t\t            \n\t\tvar tokens = line.match(/([\\w\\.\\+\\[\\]]+)/gi); // get tokens in line\n\t\tif (!tokens || tokens.length < 1) {\n\t\t\tif (line.length >= 3) {\n\t\t\t\tconsole.log(\"Warning: bad line \" + linenr + \": \" + line);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t//console.log ( linenr, line, cur, tokens ); \n\t\tswitch (tokens[0]) {\n\t\t\tcase \"part\":\n\t\t\t\tthis.addHeader(tokens[1], Number(tokens[2]));\n\t\t\t\tbreak;\n\t\t\tcase \"endpart\":\n\t\t\t\tif (!this.cur) {\n\t\t\t\t\tthrow \"Unexpected endpart\";\n\t\t\t\t}\n\t\t\t\tthis.cur.data.position = 0;\n\t\t\t\tthis.cur = null;\n\t\t\t\treturn;\n\t\t\tdefault:\n\t\t\t\tif (!this.cur) {\n\t\t\t\t\tconsole.log(\"Warning: bad line \" + linenr + \": \" + line + \" (Outside of any part definition)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this.cur.name == \"comment\") {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar op:Opcode = <Opcode> OpcodeMap.map[tokens[0]];\n\t\t\t\tif (!op) {\n\t\t\t\t\tthrow \"Bad opcode \" + tokens[0] + \" \" + linenr + \": \" + line;\n\t\t\t\t}\n\t\t\t\t// console.log( 'AGALMiniAssembler' , 'op' , op );\n\n\t\t\t\tthis.emitOpcode(this.cur, op.opcode);\n\t\t\t\tvar ti:number = 1;\n\t\t\t\tif (op.dest && op.dest != \"none\") {\n\t\t\t\t\tif (!this.emitDest(this.cur, tokens[ti++], op.dest)) {\n\t\t\t\t\t\tthrow \"Bad destination register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.emitZeroDword(this.cur);\n\t\t\t\t}\n\n\t\t\t\tif (op.a && op.a.format != \"none\") {\n\t\t\t\t\tif (!this.emitSource(this.cur, tokens[ti++], op.a)) throw \"Bad source register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t} else {\n\t\t\t\t\tthis.emitZeroQword(this.cur);\n\t\t\t\t}\n\n\t\t\t\tif (op.b && op.b.format != \"none\") {\n\t\t\t\t\tif (op.b.format == \"sampler\") {\n\t\t\t\t\t\tif (!this.emitSampler(this.cur, tokens[ti++], op.b, opts)) {\n\t\t\t\t\t\t\tthrow \"Bad sampler register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!this.emitSource(this.cur, tokens[ti++], op.b)) {\n\t\t\t\t\t\t\tthrow \"Bad source register \" + tokens[ti - 1] + \" \" + linenr + \": \" + line;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.emitZeroQword(this.cur);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpublic emitHeader(pr:Part):void\n\t{\n\t\tpr.data.writeUnsignedByte(0xa0); \t// tag version\n\t\tpr.data.writeUnsignedInt(pr.version);\n\t\tif (pr.version >= 0x10) {\n\t\t\tpr.data.writeUnsignedByte(0); // align, for higher versions\n\t\t}\n\t\tpr.data.writeUnsignedByte(0xa1);\t\t// tag program id\n\t\tswitch (pr.name) {\n\t\t\tcase \"fragment\" :\n\t\t\t\tpr.data.writeUnsignedByte(1);\n\t\t\t\tbreak;\n\t\t\tcase \"vertex\" :\n\t\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\t\tbreak;\n\t\t\tcase \"cpu\" :\n\t\t\t\tpr.data.writeUnsignedByte(2);\n\t\t\t\tbreak;\n\t\t\tdefault :\n\t\t\t\tpr.data.writeUnsignedByte(0xff);\n\t\t\t\tbreak; // unknown/comment\n\t\t}\n\t}\n\n\tpublic emitOpcode(pr:Part, opcode):void\n\t{\n\t\tpr.data.writeUnsignedInt(opcode);\n\t\t//console.log ( \"Emit opcode: \", opcode ); \n\t}\n\n\tpublic emitZeroDword(pr:Part):void\n\t{\n\t\tpr.data.writeUnsignedInt(0);\n\t}\n\n\tpublic emitZeroQword(pr):void\n\t{\n\t\tpr.data.writeUnsignedInt(0);\n\t\tpr.data.writeUnsignedInt(0);\n\t}\n\n\tpublic emitDest(pr, token, opdest):boolean\n\t{\n\n\t\t//console.log( 'AGALMiniAssembler' , 'emitDest' , 'RegMap.map' , RegMap.map);\n\t\tvar reg = token.match(/([fov]?[tpocidavs])(\\d*)(\\.[xyzw]{1,4})?/i); // g1: regname, g2:regnum, g3:mask\n\n\t\t// console.log( 'AGALMiniAssembler' , 'emitDest' , 'reg' , reg , reg[1] , RegMap.map[reg[1]] );\n\t\t// console.log( 'AGALMiniAssembler' , 'emitDest' , 'RegMap.map[reg[1]]' , RegMap.map[reg[1]] , 'bool' , !RegMap.map[reg[1]] ) ;\n\n\t\tif (!RegMap.map[reg[1]]) return false;\n\t\tvar em = { num:reg[2]? reg[2] : 0, code:RegMap.map[reg[1]].code, mask:this.stringToMask(reg[3]) };\n\t\tpr.data.writeUnsignedShort(em.num);\n\t\tpr.data.writeUnsignedByte(em.mask);\n\t\tpr.data.writeUnsignedByte(em.code);\n\t\t//console.log ( \"  Emit dest: \", em );\n\t\treturn true;\n\t}\n\n\tpublic stringToMask(s:string):number\n\t{\n\t\tif (!s) return 0xf;\n\t\tvar r:number = 0;\n\t\tif (s.indexOf(\"x\") != -1) r |= 1;\n\t\tif (s.indexOf(\"y\") != -1) r |= 2;\n\t\tif (s.indexOf(\"z\") != -1) r |= 4;\n\t\tif (s.indexOf(\"w\") != -1) r |= 8;\n\t\treturn r;\n\t}\n\n\tpublic stringToSwizzle(s):number\n\t{\n\t\tif (!s) {\n\t\t\treturn 0xe4;\n\t\t}\n\t\tvar chartoindex = { x:0, y:1, z:2, w:3 };\n\t\tvar sw:number = 0;\n\n\t\tif (s.charAt(0) != \".\") {\n\t\t\tthrow \"Missing . for swizzle\";\n\t\t}\n\n\t\tif (s.length > 1) {\n\t\t\tsw |= chartoindex[s.charAt(1)];\n\t\t}\n\n\t\tif (s.length > 2) {\n\t\t\tsw |= chartoindex[s.charAt(2)] << 2;\n\t\t} else {\n\t\t\tsw |= (sw & 3) << 2;\n\t\t}\n\n\t\tif (s.length > 3) {\n\t\t\tsw |= chartoindex[s.charAt(3)] << 4;\n\t\t} else {\n\t\t\tsw |= (sw & (3 << 2)) << 2;\n\t\t}\n\n\t\tif (s.length > 4) {\n\t\t\tsw |= chartoindex[s.charAt(4)] << 6;\n\t\t} else {\n\t\t\tsw |= (sw & (3 << 4)) << 2;\n\t\t}\n\n\t\treturn sw;\n\t}\n\n\tpublic emitSampler(pr:Part, token, opsrc, opts):boolean\n\t{\n\t\tvar reg:string[] = token.match(/fs(\\d*)/i); // g1:regnum\n\t\tif (!reg || !reg[1]) {\n\t\t\treturn false;\n\t\t}\n\t\tpr.data.writeUnsignedShort(parseInt(reg[1]));\n\t\tpr.data.writeUnsignedByte(0);   // bias\n\t\tpr.data.writeUnsignedByte(0);\n\t\t/*\n\t\t pr.data.writeUnsignedByte ( 0x5 );\n\t\t pr.data.writeUnsignedByte ( 0 );   // readmode, dim\n\t\t pr.data.writeUnsignedByte ( 0 );   // special, wrap\n\t\t pr.data.writeUnsignedByte ( 0 );   // mip, filter\n\t\t */\n\t\tvar samplerbits:number = 0x5;\n\t\tvar sampleroptset:number = 0;\n\t\tfor (var i:number = 0; i < opts.length; i++) {\n\t\t\tvar o:Sampler = <Sampler> SamplerMap.map[ opts[i].toLowerCase() ];\n\n\t\t\t//console.log( 'AGALMiniAssembler' , 'emitSampler' , 'SampleMap opt:' , o , '<-------- WATCH FOR THIS');\n\n\t\t\tif (o) {\n\t\t\t\tif (((sampleroptset >> o.shift) & o.mask) != 0) {\n\t\t\t\t\tconsole.log(\"Warning, duplicate sampler option\");\n\t\t\t\t}\n\t\t\t\tsampleroptset |= o.mask << o.shift;\n\t\t\t\tsamplerbits &= ~(o.mask << o.shift);\n\t\t\t\tsamplerbits |= o.value << o.shift;\n\t\t\t} else {\n\t\t\t\tconsole.log(\"Warning, unknown sampler option: \", opts[i]);\n\t\t\t\t// todo bias\n\t\t\t}\n\t\t}\n\t\tpr.data.writeUnsignedInt(samplerbits);\n\t\treturn true;\n\t}\n\n\tpublic emitSource(pr, token, opsrc):boolean\n\t{\n\t\tvar indexed = token.match(/vc\\[(v[tcai])(\\d+)\\.([xyzw])([\\+\\-]\\d+)?\\](\\.[xyzw]{1,4})?/i); // g1: indexregname, g2:indexregnum, g3:select, [g4:offset], [g5:swizzle]\n\t\tvar reg;\n\t\tif (indexed) {\n\t\t\tif (!RegMap.map[indexed[1]]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar selindex = { x:0, y:1, z:2, w:3 };\n\t\t\tvar em:any = { num:indexed[2] | 0, code:RegMap.map[indexed[1]].code, swizzle:this.stringToSwizzle(indexed[5]), select:selindex[indexed[3]], offset:indexed[4] | 0 };\n\t\t\tpr.data.writeUnsignedShort(em.num);\n\t\t\tpr.data.writeByte(em.offset);\n\t\t\tpr.data.writeUnsignedByte(em.swizzle);\n\t\t\tpr.data.writeUnsignedByte(0x1); // constant reg\n\t\t\tpr.data.writeUnsignedByte(em.code);\n\t\t\tpr.data.writeUnsignedByte(em.select);\n\t\t\tpr.data.writeUnsignedByte(1 << 7);\n\t\t} else {\n\t\t\treg = token.match(/([fov]?[tpocidavs])(\\d*)(\\.[xyzw]{1,4})?/i); // g1: regname, g2:regnum, g3:swizzle\n\t\t\tif (!RegMap.map[reg[1]]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar em:any = { num:reg[2] | 0, code:RegMap.map[reg[1]].code, swizzle:this.stringToSwizzle(reg[3]) };\n\t\t\tpr.data.writeUnsignedShort(em.num);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\tpr.data.writeUnsignedByte(em.swizzle);\n\t\t\tpr.data.writeUnsignedByte(em.code);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\tpr.data.writeUnsignedByte(0);\n\t\t\t//console.log ( \"  Emit source: \", em, pr.data.length );\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic addHeader(partname, version):void\n\t{\n\t\tif (!version) {\n\t\t\tversion = 1;\n\t\t}\n\t\tif (this.r[partname] == undefined) {\n\t\t\tthis.r[partname] = new Part(partname, version);\n\t\t\tthis.emitHeader(this.r[ partname ]);\n\t\t} else if (this.r[partname].version != version) {\n\t\t\tthrow \"Multiple versions for part \" + partname;\n\t\t}\n\t\tthis.cur = this.r[partname];\n\t}\n}",
    "export class FS\n{\n\tpublic format:string;\n\tpublic size:number;\n}\n",
    "export class Flags\n{\n\tpublic simple:boolean;\n\tpublic horizontal:boolean;\n\tpublic fragonly:boolean;\n\tpublic matrix:boolean;\n}\n",
    "import {Opcode}\t\t\t\t\tfrom \"../../aglsl/assembler/Opcode\";\n\nexport class OpcodeMap\n{\n\t// dest:\t\t\t\t\t  \t\t\t\t\t   string,  aformat, asize, bformat,   bsize, opcode, simple, horizontal, fragonly   matrix\n\t/*\n\t public static mov:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x00,   true,   null,       null,      null );\n\t public static add:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x01,   true,   null,       null,      null );\n\n\t public static sub:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x02,   true,   null,       null,      null );\n\t public static mul:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x03,   true,   null,       null,      null );\n\t public static div:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x04,   true,   null,       null,      null );\n\t public static rcp:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x05,   true,   null,       null,      null );\n\t public static min:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x06,   true,   null,       null,      null );\n\t public static max:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x07,   true,   null,       null,      null );\n\t public static frc:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x08,   true,   null,       null,      null );\n\t public static sqt:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x09,   true,   null,       null,      null );\n\t public static rsq:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0a,   true,   null,       null,      null );\n\t public static pow:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x0b,   true,   null,       null,      null );\n\t public static log:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0c,   true,   null,       null,      null );\n\t public static exp:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0d,   true,   null,       null,      null );\n\t public static nrm:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0e,   true,   null,       null,      null );\n\t public static sin:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x0f,   true,   null,       null,      null );\n\t public static cos:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x10,   true,   null,       null,      null );\n\t public static crs:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x11,   true,   true,       null,      null );\n\t public static dp3:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x12,   true,   true,       null,      null );\n\t public static dp4:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x13,   true,   true,       null,      null );\n\t public static abs:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x14,   true,   null,       null,      null );\n\t public static neg:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x15,   true,   null,       null,      null );\n\t public static sat:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"none\",    0,     0x16,   true,   null,       null,      null );\n\n\t public static ted:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"sampler\", 1,     0x26,   true,   null,       true,      null );\n\t public static kil:Opcode = new Opcode( \"none\",   \"scalar\", 1,    \"none\",    0,     0x27,   true,   null,       true,      null );\n\t public static tex:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"sampler\", 1,     0x28,   true,   null,       true,      null );\n\n\t public static m33:Opcode = new Opcode( \"vector\", \"matrix\", 3,    \"vector\",  3,     0x17,   true,   null,       null,      true );\n\t public static m44:Opcode = new Opcode( \"vector\", \"matrix\", 4,    \"vector\",  4,     0x18,   true,   null,       null,      true );\n\t public static m43:Opcode = new Opcode( \"vector\", \"matrix\", 3,    \"vector\",  4,     0x19,   true,   null,       null,      true );\n\n\t public static sge:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x29,   true,   null,       null,      null );\n\t public static slt:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2a,   true,   null,       null,      null );\n\t public static sgn:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2b,   true,   null,       null,      null );\n\t public static seq:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2c,   true,   null,       null,      null );\n\t public static sne:Opcode = new Opcode( \"vector\", \"vector\", 4,    \"vector\",  4,     0x2d,   true,   null,       null,      null );\n\t */\n\n\n\tprivate static _map:Object[];\n\n\tpublic static get map():Object[]\n\t{\n\n\t\tif (!OpcodeMap._map) {\n\n\t\t\tOpcodeMap._map = new Array<Object>();\n\t\t\tOpcodeMap._map['mov'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x00, true, null, null, null);     //0\n\t\t\tOpcodeMap._map['add'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x01, true, null, null, null);   //1\n\t\t\tOpcodeMap._map['sub'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x02, true, null, null, null);   //2\n\t\t\tOpcodeMap._map['mul'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x03, true, null, null, null);   //3\n\t\t\tOpcodeMap._map['div'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x04, true, null, null, null);   //4\n\t\t\tOpcodeMap._map['rcp'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x05, true, null, null, null);     //5\n\t\t\tOpcodeMap._map['min'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x06, true, null, null, null);   //6\n\t\t\tOpcodeMap._map['max'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x07, true, null, null, null);   //7\n\t\t\tOpcodeMap._map['frc'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x08, true, null, null, null);     //8\n\t\t\tOpcodeMap._map['sqt'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x09, true, null, null, null);     //9\n\t\t\tOpcodeMap._map['rsq'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0a, true, null, null, null);     //10\n\t\t\tOpcodeMap._map['pow'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x0b, true, null, null, null);   //11\n\t\t\tOpcodeMap._map['log'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0c, true, null, null, null);     //12\n\t\t\tOpcodeMap._map['exp'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0d, true, null, null, null);     //13\n\t\t\tOpcodeMap._map['nrm'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0e, true, null, null, null);     //14\n\t\t\tOpcodeMap._map['sin'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x0f, true, null, null, null);     //15\n\t\t\tOpcodeMap._map['cos'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x10, true, null, null, null);     //16\n\t\t\tOpcodeMap._map['crs'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x11, true, true, null, null);   //17\n\t\t\tOpcodeMap._map['dp3'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x12, true, true, null, null);   //18\n\t\t\tOpcodeMap._map['dp4'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x13, true, true, null, null);   //19\n\t\t\tOpcodeMap._map['abs'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x14, true, null, null, null);     //20\n\t\t\tOpcodeMap._map['neg'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x15, true, null, null, null);     //21\n\t\t\tOpcodeMap._map['sat'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x16, true, null, null, null);     //22\n\n\t\t\tOpcodeMap._map['ted'] = new Opcode(\"vector\", \"vector\", 4, \"sampler\", 1, 0x26, true, null, true, null);  //38\n\t\t\tOpcodeMap._map['kil'] = new Opcode(\"none\", \"scalar\", 1, \"none\", 0, 0x27, true, null, true, null);       //39\n\t\t\tOpcodeMap._map['tex'] = new Opcode(\"vector\", \"vector\", 4, \"sampler\", 1, 0x28, true, null, true, null);  //40\n\n\t\t\tOpcodeMap._map['m33'] = new Opcode(\"vector\", \"matrix\", 3, \"vector\", 3, 0x17, true, null, null, true);   //23\n\t\t\tOpcodeMap._map['m44'] = new Opcode(\"vector\", \"matrix\", 4, \"vector\", 4, 0x18, true, null, null, true);   //24\n\t\t\tOpcodeMap._map['m43'] = new Opcode(\"vector\", \"matrix\", 3, \"vector\", 4, 0x19, true, null, null, true);   //25\n\n            OpcodeMap._map['ddx'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x1a, true, null, true, null);   //26\n            OpcodeMap._map['ddy'] = new Opcode(\"vector\", \"vector\", 4, \"none\", 0, 0x1b, true, null, true, null);   //27\n\n\t\t\tOpcodeMap._map['sge'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x29, true, null, null, null);   //41\n\t\t\tOpcodeMap._map['slt'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2a, true, null, null, null);   //42\n\t\t\tOpcodeMap._map['sgn'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2b, true, null, null, null);   //43\n\t\t\tOpcodeMap._map['seq'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2c, true, null, null, null);   //44\n\t\t\tOpcodeMap._map['sne'] = new Opcode(\"vector\", \"vector\", 4, \"vector\", 4, 0x2d, true, null, null, null);   //45\n\n\n\t\t}\n\n\t\treturn OpcodeMap._map;\n\n\t}\n\n\n\tconstructor()\n\t{\n\t}\n}",
    "import {Flags}\t\t\t\tfrom \"../../aglsl/assembler/Flags\";\nimport {FS}\t\t\t\t\tfrom \"../../aglsl/assembler/FS\";\n\n/**\n *\n */\nexport class Opcode\n{\n\tpublic dest:string;\n\tpublic a:FS;\n\tpublic b:FS;\n\tpublic opcode:number;\n\tpublic flags:Flags;\n\n\tconstructor(dest:string, aformat:string, asize:number, bformat:string, bsize:number, opcode:number, simple:boolean, horizontal:boolean, fragonly:boolean, matrix:boolean)\n\t{\n\t\tthis.a = new FS();\n\t\tthis.b = new FS();\n\t\tthis.flags = new Flags();\n\n\t\tthis.dest = dest;\n\t\tthis.a.format = aformat;\n\t\tthis.a.size = asize;\n\t\tthis.b.format = bformat;\n\t\tthis.b.size = bsize;\n\t\tthis.opcode = opcode;\n\t\tthis.flags.simple = simple;\n\t\tthis.flags.horizontal = horizontal;\n\t\tthis.flags.fragonly = fragonly;\n\t\tthis.flags.matrix = matrix;\n\t}\n}\n",
    "import {ByteArray}\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nexport class Part\n{\n\tpublic name:string = \"\";\n\tpublic version:number = 0;\n\tpublic data:ByteArray;\n\n\tconstructor(name:string = null, version:number = null)\n\t{\n\t\tthis.name = name;\n\t\tthis.version = version;\n\t\tthis.data = new ByteArray();\n\t}\n}",
    "\nclass Reg\n{\n\n\tpublic code:number;\n\tpublic desc:string;\n\n\tconstructor(code:number, desc:string)\n\t{\n\t\tthis.code = code;\n\t\tthis.desc = desc;\n\t}\n}\n\nexport class RegMap\n{\n\n\t/*\n\t public static map = [ new Reg( 0x00, \"vertex attribute\" ),\n\t new Reg( 0x01, \"fragment constant\" ),\n\t new Reg( 0x01, \"vertex constant\" ),\n\t new Reg( 0x02, \"fragment temporary\" ),\n\t new Reg( 0x02, \"vertex temporary\" ),\n\t new Reg( 0x03, \"vertex output\" ),\n\t new Reg( 0x03, \"vertex output\" ),\n\t new Reg( 0x03, \"fragment depth output\" ),\n\t new Reg( 0x03, \"fragment output\" ),\n\t new Reg( 0x03, \"fragment output\" ),\n\t new Reg( 0x04, \"varying\" ),\n\t new Reg( 0x04, \"varying output\" ),\n\t new Reg( 0x04, \"varying input\" ),\n\t new Reg( 0x05, \"sampler\" ) ];\n\t */\n\n\tprivate static _map:any[];\n\tpublic static get map():any[]\n\t{\n\n\t\tif (!RegMap._map) {\n\n\t\t\tRegMap._map = new Array<Object>();\n\t\t\tRegMap._map['va'] = new Reg(0x00, \"vertex attribute\");\n\t\t\tRegMap._map['fc'] = new Reg(0x01, \"fragment constant\");\n\t\t\tRegMap._map['vc'] = new Reg(0x01, \"vertex constant\");\n\t\t\tRegMap._map['ft'] = new Reg(0x02, \"fragment temporary\");\n\t\t\tRegMap._map['vt'] = new Reg(0x02, \"vertex temporary\");\n\t\t\tRegMap._map['vo'] = new Reg(0x03, \"vertex output\");\n\t\t\tRegMap._map['op'] = new Reg(0x03, \"vertex output\");\n\t\t\tRegMap._map['fd'] = new Reg(0x03, \"fragment depth output\");\n\t\t\tRegMap._map['fo'] = new Reg(0x03, \"fragment output\");\n\t\t\tRegMap._map['oc'] = new Reg(0x03, \"fragment output\");\n\t\t\tRegMap._map['v'] = new Reg(0x04, \"varying\");\n\t\t\tRegMap._map['vi'] = new Reg(0x04, \"varying output\");\n\t\t\tRegMap._map['fi'] = new Reg(0x04, \"varying input\");\n\t\t\tRegMap._map['fs'] = new Reg(0x05, \"sampler\");\n\n\n\t\t}\n\n\t\treturn RegMap._map;\n\n\t}\n\n\t/*\n\t public static va:Reg = new Reg( 0x00, \"vertex attribute\" );\n\t public static fc:Reg = new Reg( 0x01, \"fragment constant\" );\n\t public static vc:Reg = new Reg( 0x01, \"vertex constant\" );\n\t public static ft:Reg = new Reg( 0x02, \"fragment temporary\" );\n\t public static vt:Reg = new Reg( 0x02, \"vertex temporary\" );\n\t public static vo:Reg = new Reg( 0x03, \"vertex output\" );\n\t public static op:Reg = new Reg( 0x03, \"vertex output\" );\n\t public static fd:Reg = new Reg( 0x03, \"fragment depth output\" );\n\t public static fo:Reg = new Reg( 0x03, \"fragment output\" );\n\t public static oc:Reg = new Reg( 0x03, \"fragment output\" );\n\t public static v: Reg = new Reg( 0x04, \"varying\" );\n\t public static vi:Reg = new Reg( 0x04, \"varying output\" );\n\t public static fi:Reg = new Reg( 0x04, \"varying input\" );\n\t public static fs:Reg = new Reg( 0x05, \"sampler\" );\n\t */\n\tconstructor()\n\t{\n\t}\n}",
    "import {Sampler}\t\t\t\tfrom \"../../aglsl/assembler/Sampler\";\n\nexport class SamplerMap\n{\n\n\tprivate static _map:Object[];\n\n\tpublic static get map():Object[]\n\t{\n\n\t\tif (!SamplerMap._map) {\n\n\t\t\tSamplerMap._map = new Array<Object>();\n\t\t\tSamplerMap._map['rgba'] = new Sampler(8, 0xf, 0);\n\t\t\tSamplerMap._map['rg'] = new Sampler(8, 0xf, 5);\n\t\t\tSamplerMap._map['r'] = new Sampler(8, 0xf, 4);\n\t\t\tSamplerMap._map['compressed'] = new Sampler(8, 0xf, 1);\n\t\t\tSamplerMap._map['compressed_alpha'] = new Sampler(8, 0xf, 2);\n\t\t\tSamplerMap._map['dxt1'] = new Sampler(8, 0xf, 1);\n\t\t\tSamplerMap._map['dxt5'] = new Sampler(8, 0xf, 2);\n\n\t\t\t// dimension\n\t\t\tSamplerMap._map['2d'] = new Sampler(12, 0xf, 0);\n\t\t\tSamplerMap._map['cube'] = new Sampler(12, 0xf, 1);\n\t\t\tSamplerMap._map['3d'] = new Sampler(12, 0xf, 2);\n\n\t\t\t// special\n\t\t\tSamplerMap._map['centroid'] = new Sampler(16, 1, 1);\n\t\t\tSamplerMap._map['ignoresampler'] = new Sampler(16, 4, 4);\n\n\t\t\t// repeat\n\t\t\tSamplerMap._map['clamp'] = new Sampler(20, 0xf, 0);\n\t\t\tSamplerMap._map['repeat'] = new Sampler(20, 0xf, 1);\n\t\t\tSamplerMap._map['wrap'] = new Sampler(20, 0xf, 1);\n\n\t\t\t// mip\n\t\t\tSamplerMap._map['nomip'] = new Sampler(24, 0xf, 0);\n\t\t\tSamplerMap._map['mipnone'] = new Sampler(24, 0xf, 0);\n\t\t\tSamplerMap._map['mipnearest'] = new Sampler(24, 0xf, 1);\n\t\t\tSamplerMap._map['miplinear'] = new Sampler(24, 0xf, 2);\n\n\t\t\t// filter\n\t\t\tSamplerMap._map['nearest'] = new Sampler(28, 0xf, 0);\n\t\t\tSamplerMap._map['linear'] = new Sampler(28, 0xf, 1);\n\n\t\t}\n\n\t\treturn SamplerMap._map;\n\n\t}\n\n\t/*\n\t public static map =     [ new Sampler( 8, 0xf, 0 ),\n\t new Sampler( 8, 0xf, 5 ),\n\t new Sampler( 8, 0xf, 4 ),\n\t new Sampler( 8, 0xf, 1 ),\n\t new Sampler( 8, 0xf, 2 ),\n\t new Sampler( 8, 0xf, 1 ),\n\t new Sampler( 8, 0xf, 2 ),\n\n\t // dimension\n\t new Sampler( 12, 0xf, 0 ),\n\t new Sampler( 12, 0xf, 1 ),\n\t new Sampler( 12, 0xf, 2 ),\n\n\t // special\n\t new Sampler( 16, 1, 1 ),\n\t new Sampler( 16, 4, 4 ),\n\n\t // repeat\n\t new Sampler( 20, 0xf, 0 ),\n\t new Sampler( 20, 0xf, 1 ),\n\t new Sampler( 20, 0xf, 1 ),\n\n\t // mip\n\t new Sampler( 24, 0xf, 0 ),\n\t new Sampler( 24, 0xf, 0 ),\n\t new Sampler( 24, 0xf, 1 ),\n\t new Sampler( 24, 0xf, 2 ),\n\n\t // filter\n\t new Sampler( 28, 0xf, 0 ),\n\t new Sampler( 28, 0xf, 1 ) ]\n\t */\n\t/*\n\t public static rgba: Sampler = new Sampler( 8, 0xf, 0 );\n\t public static rg: Sampler = new Sampler( 8, 0xf, 5 );\n\t public static r: Sampler = new Sampler( 8, 0xf, 4 );\n\t public static compressed: Sampler = new Sampler( 8, 0xf, 1 );\n\t public static compressed_alpha: Sampler = new Sampler( 8, 0xf, 2 );\n\t public static dxt1: Sampler = new Sampler( 8, 0xf, 1 );\n\t public static dxt5: Sampler = new Sampler( 8, 0xf, 2 );\n\n\t // dimension\n\t public static sampler2d: Sampler = new Sampler( 12, 0xf, 0 );\n\t public static cube: Sampler = new Sampler( 12, 0xf, 1 );\n\t public static sampler3d: Sampler = new Sampler( 12, 0xf, 2 );\n\n\t // special\n\t public static centroid: Sampler = new Sampler( 16, 1, 1 );\n\t public static ignoresampler: Sampler = new Sampler( 16, 4, 4 );\n\n\t // repeat\n\t public static clamp: Sampler = new Sampler( 20, 0xf, 0 );\n\t public static repeat: Sampler = new Sampler( 20, 0xf, 1 );\n\t public static wrap: Sampler = new Sampler( 20, 0xf, 1 );\n\n\t // mip\n\t public static nomip: Sampler = new Sampler( 24, 0xf, 0 );\n\t public static mipnone: Sampler = new Sampler( 24, 0xf, 0 );\n\t public static mipnearest: Sampler = new Sampler( 24, 0xf, 1 );\n\t public static miplinear: Sampler = new Sampler( 24, 0xf, 2 );\n\n\t // filter\n\t public static nearest: Sampler = new Sampler( 28, 0xf, 0 );\n\t public static linear: Sampler = new Sampler( 28, 0xf, 1 );\n\t */\n\tconstructor()\n\t{\n\t}\n}",
    "export class Sampler\n{\n\tpublic shift:number;\n\tpublic mask:number;\n\tpublic value:number;\n\n\tconstructor(shift:number, mask:number, value:number)\n\t{\n\t\tthis.shift = shift;\n\t\tthis.mask = mask;\n\t\tthis.value = value;\n\t}\n}",
    "export {AGALMiniAssembler}\t\t\t\tfrom \"./aglsl/assembler/AGALMiniAssembler\";\nexport {Flags}\t\t\t\t\t\t\tfrom \"./aglsl/assembler/Flags\";\nexport {FS}\t\t\t\t\t\t\t\tfrom \"./aglsl/assembler/FS\";\nexport {Opcode}\t\t\t\t\t\t\tfrom \"./aglsl/assembler/Opcode\";\nexport {OpcodeMap}\t\t\t\t\t\tfrom \"./aglsl/assembler/OpcodeMap\";\nexport {Part}\t\t\t\t\t\t\tfrom \"./aglsl/assembler/Part\";\nexport {RegMap}\t\t\t\t\t\t\tfrom \"./aglsl/assembler/RegMap\";\nexport {Sampler}\t\t\t\t\t\t\tfrom \"./aglsl/assembler/Sampler\";\nexport {SamplerMap}\t\t\t\t\t\tfrom \"./aglsl/assembler/SamplerMap\";\nexport {AGALTokenizer}\t\t\t\t\tfrom \"./aglsl/AGALTokenizer\";\nexport {AGLSLParser}\t\t\t\t\t\tfrom \"./aglsl/AGLSLParser\";\nexport {Description}\t\t\t\t\t\tfrom \"./aglsl/Description\";\nexport {Destination}\t\t\t\t\t\tfrom \"./aglsl/Destination\";\nexport {Header}\t\t\t\t\t\t\tfrom \"./aglsl/Header\";\nexport {Mapping}\t\t\t\t\t\t\tfrom \"./aglsl/Mapping\";\nexport {OpLUT}\t\t\t\t\t\t\tfrom \"./aglsl/OpLUT\";\nexport {Token}\t\t\t\t\t\t\tfrom \"./aglsl/Token\";",
    "import {AttributesBuffer}\t\t\t\tfrom \"awayjs-core/lib/attributes/AttributesBuffer\";\nimport {AssetEvent}\t\t\t\t\tfrom \"awayjs-core/lib/events/AssetEvent\";\nimport {AbstractionBase}\t\t\t\tfrom \"awayjs-core/lib/library/AbstractionBase\";\n\nimport {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\nimport {IIndexBuffer}\t\t\t\t\tfrom \"../base/IIndexBuffer\";\nimport {IVertexBuffer}\t\t\t\tfrom \"../base/IVertexBuffer\";\n\n/**\n *\n * @class away.pool.GL_AttributesBuffer\n */\nexport class GL_AttributesBuffer extends AbstractionBase\n{\n\tpublic _indexBuffer:IIndexBuffer;\n\n\tpublic _vertexBuffer:IVertexBuffer;\n\n\tpublic _stage:Stage;\n\n\tpublic _attributesBuffer:AttributesBuffer;\n\n\tpublic _mipmap:boolean;\n\n\tpublic _invalid:boolean;\n\n\tconstructor(attributesBuffer:AttributesBuffer, stage:Stage)\n\t{\n\t\tsuper(attributesBuffer, stage);\n\n\t\tthis._stage = stage;\n\n\t\tthis._attributesBuffer = attributesBuffer;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onClear(event:AssetEvent):void\n\t{\n\t\tsuper.onClear(event);\n\n\t\tthis._attributesBuffer = null;\n\n\t\tif (this._indexBuffer) {\n\t\t\tthis._indexBuffer.dispose();\n\t\t\tthis._indexBuffer = null;\n\t\t}\n\n\t\tif (this._vertexBuffer) {\n\t\t\tthis._vertexBuffer.dispose();\n\t\t\tthis._vertexBuffer = null;\n\t\t}\n\t}\n\n\tpublic activate(index:number, size:number, dimensions:number, offset:number, unsigned:boolean = false):void\n\t{\n\t\tthis._stage.setVertexBuffer(index, this._getVertexBuffer(), size, dimensions, offset, unsigned);\n\t}\n\n\tpublic draw(mode:string, firstIndex:number, numIndices:number):void\n\t{\n\t\tthis._stage.context.drawIndices(mode, this._getIndexBuffer(), firstIndex, numIndices);\n\t}\n\n\tpublic _getIndexBuffer():IIndexBuffer\n\t{\n\t\tif (!this._indexBuffer) {\n\t\t\tthis._invalid = true;\n\t\t\tthis._indexBuffer = this._stage.context.createIndexBuffer(this._attributesBuffer.count*this._attributesBuffer.stride/2); //hardcoded assuming UintArray\n\t\t}\n\n\t\tif (this._invalid) {\n\t\t\tthis._invalid = false;\n\t\t\tthis._indexBuffer.uploadFromByteArray(this._attributesBuffer.buffer, 0, this._attributesBuffer.length);\n\t\t}\n\n\t\treturn this._indexBuffer;\n\t}\n\n\tpublic _getVertexBuffer():IVertexBuffer\n\t{\n\t\tif (!this._vertexBuffer) {\n\t\t\tthis._invalid = true;\n\t\t\tthis._vertexBuffer = this._stage.context.createVertexBuffer(this._attributesBuffer.count, this._attributesBuffer.stride);\n\t\t}\n\n\t\tif (this._invalid) {\n\t\t\tthis._invalid = false;\n\t\t\tthis._vertexBuffer.uploadFromByteArray(this._attributesBuffer.buffer, 0, this._attributesBuffer.count);\n\t\t}\n\n\t\treturn this._vertexBuffer;\n\t}\n}",
    "export {GL_AttributesBuffer}\t\t\t\tfrom \"./attributes/GL_AttributesBuffer\";",
    "export class ContextGLBlendFactor\n{\n\tpublic static DESTINATION_ALPHA:string = \"destinationAlpha\";\n\tpublic static DESTINATION_COLOR:string = \"destinationColor\";\n\tpublic static ONE:string = \"one\";\n\tpublic static ONE_MINUS_DESTINATION_ALPHA:string = \"oneMinusDestinationAlpha\";\n\tpublic static ONE_MINUS_DESTINATION_COLOR:string = \"oneMinusDestinationColor\";\n\tpublic static ONE_MINUS_SOURCE_ALPHA:string = \"oneMinusSourceAlpha\";\n\tpublic static ONE_MINUS_SOURCE_COLOR:string = \"oneMinusSourceColor\";\n\tpublic static SOURCE_ALPHA:string = \"sourceAlpha\";\n\tpublic static SOURCE_COLOR:string = \"sourceColor\";\n\tpublic static ZERO:string = \"zero\";\n}",
    "export class ContextGLClearMask\n{\n\tstatic COLOR:number = 1;\n\tstatic DEPTH:number = 2;\n\tstatic STENCIL:number = 4;\n\tstatic ALL:number = ContextGLClearMask.COLOR | ContextGLClearMask.DEPTH | ContextGLClearMask.STENCIL;\n}",
    "export class ContextGLCompareMode\n{\n\tpublic static ALWAYS:string = \"always\";\n\tpublic static EQUAL:string = \"equal\";\n\tpublic static GREATER:string = \"greater\";\n\tpublic static GREATER_EQUAL:string = \"greaterEqual\";\n\tpublic static LESS:string = \"less\";\n\tpublic static LESS_EQUAL:string = \"lessEqual\";\n\tpublic static NEVER:string = \"never\";\n\tpublic static NOT_EQUAL:string = \"notEqual\";\n}",
    "export class ContextGLDrawMode\n{\n\tpublic static TRIANGLES:string = \"triangles\";\n\tpublic static LINES:string = \"lines\";\n}",
    "export class ContextGLMipFilter\n{\n\tpublic static MIPLINEAR:string = \"miplinear\";\n\tpublic static MIPNEAREST:string = \"mipnearest\";\n\tpublic static MIPNONE:string = \"mipnone\";\n}",
    "export class ContextGLProfile\n{\n\tpublic static BASELINE:string = \"baseline\";\n\tpublic static BASELINE_CONSTRAINED:string = \"baselineConstrained\";\n\tpublic static BASELINE_EXTENDED:string = \"baselineExtended\";\n}\nexport default ContextGLProfile;",
    "export class ContextGLProgramType\n{\n\tstatic FRAGMENT:number = 0;\n\tstatic SAMPLER:number = 1;\n\tstatic VERTEX:number = 2;\n}",
    "export class ContextGLStencilAction\n{\n\tpublic static DECREMENT_SATURATE:string = \"decrementSaturate\";\n\tpublic static DECREMENT_WRAP:string = \"decrementWrap\";\n\tpublic static INCREMENT_SATURATE:string = \"incrementSaturate\";\n\tpublic static INCREMENT_WRAP:string = \"incrementWrap\";\n\tpublic static INVERT:string = \"invert\";\n\tpublic static KEEP:string = \"keep\";\n\tpublic static SET:string = \"set\";\n\tpublic static ZERO:string = \"zero\";\n}",
    "export class ContextGLTextureFilter\n{\n\tpublic static LINEAR:string = \"linear\";\n\tpublic static NEAREST:string = \"nearest\";\n}",
    "export class ContextGLTextureFormat\n{\n\tstatic BGRA:string = \"bgra\";\n\tstatic BGRA_PACKED:string = \"bgraPacked4444\";\n\tstatic BGR_PACKED:string = \"bgrPacked565\";\n\tstatic COMPRESSED:string = \"compressed\";\n\tstatic COMPRESSED_ALPHA:string = \"compressedAlpha\";\n}",
    "export class ContextGLTriangleFace\n{\n\tstatic BACK:string = \"back\";\n\tstatic FRONT:string = \"front\";\n\tstatic FRONT_AND_BACK:string = \"frontAndBack\";\n\tstatic NONE:string = \"none\";\n}",
    "export class ContextGLVertexBufferFormat\n{\n\tstatic FLOAT_1:number = 0;\n\tstatic FLOAT_2:number = 1;\n\tstatic FLOAT_3:number = 2;\n\tstatic FLOAT_4:number = 3;\n\tstatic BYTE_1:number = 4;\n\tstatic BYTE_2:number = 5;\n\tstatic BYTE_3:number = 6;\n\tstatic BYTE_4:number = 7;\n\tstatic UNSIGNED_BYTE_1:number = 8;\n\tstatic UNSIGNED_BYTE_2:number = 9;\n\tstatic UNSIGNED_BYTE_3:number = 10;\n\tstatic UNSIGNED_BYTE_4:number = 11;\n\tstatic SHORT_1:number = 12;\n\tstatic SHORT_2:number = 13;\n\tstatic SHORT_3:number = 14;\n\tstatic SHORT_4:number = 15;\n\tstatic UNSIGNED_SHORT_1:number = 16;\n\tstatic UNSIGNED_SHORT_2:number = 17;\n\tstatic UNSIGNED_SHORT_3:number = 18;\n\tstatic UNSIGNED_SHORT_4:number = 19;\n}",
    "export class ContextGLWrapMode\n{\n\tpublic static CLAMP:string = \"clamp\";\n\tpublic static REPEAT:string = \"repeat\";\n}",
    "export class ContextMode\n{\n\tstatic AUTO:string = \"auto\";\n\tstatic WEBGL:string = \"webgl\";\n\tstatic FLASH:string = \"flash\";\n\tstatic NATIVE:string = \"native\";\n\tstatic SOFTWARE:string = \"software\";\n}",
    "import {BitmapImage2D}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImage2D\";\nimport {Matrix3D}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Matrix3D\";\nimport {Matrix}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Matrix\";\nimport {Point}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Point\";\nimport {Vector3D}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Vector3D\";\nimport {Rectangle}\t\t\t\t\tfrom \"awayjs-core/lib/geom/Rectangle\";\nimport {ColorUtils}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ColorUtils\";\n\nimport {ContextGLBlendFactor}\t\t\tfrom \"../base/ContextGLBlendFactor\";\nimport {ContextGLClearMask}\t\t\tfrom \"../base/ContextGLClearMask\";\nimport {ContextGLCompareMode}\t\t\tfrom \"../base/ContextGLCompareMode\";\nimport {ContextGLProgramType}\t\t\tfrom \"../base/ContextGLProgramType\";\nimport {ContextGLTriangleFace}\t\tfrom \"../base/ContextGLTriangleFace\";\nimport {IContextGL}\t\t\t\t\tfrom \"../base/IContextGL\";\nimport {IIndexBuffer}\t\t\t\t\tfrom \"../base/IIndexBuffer\";\nimport {ICubeTexture}\t\t\t\t\tfrom \"../base/ICubeTexture\";\nimport {ITextureBase}\t\t\t\t\tfrom \"../base/ITextureBase\";\nimport {IndexBufferSoftware}\t\t\tfrom \"../base/IndexBufferSoftware\";\nimport {VertexBufferSoftware}\t\t\tfrom \"../base/VertexBufferSoftware\";\nimport {TextureSoftware}\t\t\t\tfrom \"../base/TextureSoftware\";\nimport {ProgramSoftware}\t\t\t\tfrom \"../base/ProgramSoftware\";\nimport {ProgramVOSoftware}\t\t\tfrom \"../base/ProgramVOSoftware\";\nimport {SoftwareSamplerState}\t\t\tfrom \"../base/SoftwareSamplerState\";\n\nexport class ContextSoftware implements IContextGL\n{\n\tprivate _canvas:HTMLCanvasElement;\n\n\tpublic static MAX_SAMPLERS:number = 8;\n\n\tprivate _backBufferRect:Rectangle = new Rectangle();\n\tprivate _backBufferWidth:number = 100;\n\tprivate _backBufferHeight:number = 100;\n\tprivate _backBufferColor:BitmapImage2D;\n\tprivate _frontBuffer:BitmapImage2D;\n\n\tprivate _zbuffer:Float32Array;\n\tprivate _zbufferClear:Float32Array;\n\tprivate _colorClearUint8:Uint8ClampedArray;\n\tprivate _colorClearUint32:Uint32Array;\n\tprivate _cullingMode:string = ContextGLTriangleFace.BACK;\n\tprivate _blendSource:string = ContextGLBlendFactor.ONE;\n\tprivate _blendDestination:string = ContextGLBlendFactor.ZERO;\n\tprivate _colorMaskR:boolean = true;\n\tprivate _colorMaskG:boolean = true;\n\tprivate _colorMaskB:boolean = true;\n\tprivate _colorMaskA:boolean = true;\n\tprivate _writeDepth:boolean = true;\n\tprivate _depthCompareMode:string = ContextGLCompareMode.LESS;\n\tprivate _program:ProgramSoftware;\n\n\tprivate _screenMatrix:Matrix3D = new Matrix3D();\n\tprivate _frontBufferMatrix:Matrix = new Matrix();\n\n\tprivate _bboxMin:Point = new Point();\n\tprivate _bboxMax:Point = new Point();\n\tprivate _clamp:Point = new Point();\n\n\tpublic _samplerStates:SoftwareSamplerState[] = [];\n\tpublic _textures:Array<TextureSoftware> = [];\n\tpublic _vertexBuffers:Array<VertexBufferSoftware> = [];\n\tpublic _vertexBufferOffsets:Array<number> = [];\n\tpublic _vertexBufferFormats:Array<number> = [];\n\n\tpublic _fragmentConstants:Float32Array;\n\tpublic _vertexConstants:Float32Array;\n\n\t//public static _drawCallback:Function = null;\n\n\tprivate _antialias:number = 0;\n\n\tconstructor(canvas:HTMLCanvasElement)\n\t{\n\t\tthis._canvas = canvas;\n\n\t\tthis._backBufferColor = new BitmapImage2D(this._backBufferWidth, this._backBufferHeight, false, 0, false);\n\t\tthis._frontBuffer = new BitmapImage2D(this._backBufferWidth, this._backBufferHeight, true, 0, false);\n\n\t\tif (document && document.body) \n\t\t\tdocument.body.appendChild(this._frontBuffer.getCanvas());\n\t}\n\n\tpublic get frontBuffer():BitmapImage2D\n\t{\n\t\treturn this._frontBuffer;\n\t}\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._canvas;\n\t}\n\n\tpublic clear(red:number = 0, green:number = 0, blue:number = 0, alpha:number = 1, depth:number = 1, stencil:number = 0, mask:number = ContextGLClearMask.ALL):void\n\t{\n\t\tthis._backBufferColor.lock();\n\n\t\tif (mask & ContextGLClearMask.COLOR) {\n\t\t\tthis._colorClearUint32.fill(((alpha*0xFF << 24) | (red*0xFF << 16) | (green*0xFF << 8) | blue*0xFF));\n\t\t\tthis._backBufferColor.setPixels(this._backBufferRect, this._colorClearUint8);\n\t\t}\n\n\t\t//TODO: mask & ContextGLClearMask.STENCIL\n\n\t\tif (mask & ContextGLClearMask.DEPTH)\n\t\t\tthis._zbuffer.set(this._zbufferClear); //fast memcpy\n\t}\n\n\tpublic configureBackBuffer(width:number, height:number, antiAlias:number, enableDepthAndStencil:boolean):void\n\t{\n\t\tthis._antialias = antiAlias;\n\n\t\tif (this._antialias % 2 != 0)\n\t\t\tthis._antialias = Math.floor(this._antialias - 0.5);\n\n\t\tif (this._antialias == 0)\n\t\t\tthis._antialias = 1;\n\n\t\tthis._frontBuffer._setSize(width, height);\n\n\t\tthis._backBufferWidth = width*this._antialias;\n\t\tthis._backBufferHeight = height*this._antialias;\n\n\t\t//double buffer for fast clearing\n\t\tvar len:number = this._backBufferWidth*this._backBufferHeight;\n\t\tvar zbufferBytes:ArrayBuffer = new ArrayBuffer(len*8);\n\t\tthis._zbuffer = new Float32Array(zbufferBytes, 0, len);\n\t\tthis._zbufferClear = new Float32Array(zbufferBytes, len*4, len);\n\t\tfor (var i:number = 0; i < len; i++)\n\t\t\tthis._zbufferClear[i] = 10000000;\n\n\t\tvar colorClearBuffer:ArrayBuffer = new ArrayBuffer(len*4);\n\n\t\tthis._colorClearUint8 = new Uint8ClampedArray(colorClearBuffer);\n\t\tthis._colorClearUint32 = new Uint32Array(colorClearBuffer);\n\t\tthis._backBufferRect.width = this._backBufferWidth;\n\t\tthis._backBufferRect.height = this._backBufferHeight;\n\n\t\tthis._backBufferColor._setSize(this._backBufferWidth, this._backBufferHeight);\n\n\t\tvar raw:Float32Array = this._screenMatrix.rawData;\n\n\t\traw[0] = this._backBufferWidth /2;\n\t\traw[1] = 0;\n\t\traw[2] = 0;\n\t\traw[3] = this._backBufferWidth/2;\n\n\t\traw[4] = 0;\n\t\traw[5] = -this._backBufferHeight/2;\n\t\traw[6] = 0;\n\t\traw[7] = this._backBufferHeight/2;\n\n\t\traw[8] = 0;\n\t\traw[9] = 0;\n\t\traw[10] = 1;\n\t\traw[11] = 0;\n\n\t\traw[12] = 0;\n\t\traw[13] = 0;\n\t\traw[14] = 0;\n\t\traw[15] = 0;\n\n\t\tthis._screenMatrix.transpose();\n\n\t\tthis._frontBufferMatrix = new Matrix();\n\t\tthis._frontBufferMatrix.scale(1/this._antialias, 1/this._antialias);\n\t}\n\n\tpublic createCubeTexture(size:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number):ICubeTexture\n\t{\n\t\t//TODO: impl\n\t\treturn undefined;\n\t}\n\n\tpublic createIndexBuffer(numIndices:number):IIndexBuffer {\n\t\treturn new IndexBufferSoftware(numIndices);\n\t}\n\n\tpublic createProgram():ProgramSoftware {\n\t\treturn new ProgramSoftware();\n\t}\n\n\tpublic createTexture(width:number, height:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number):TextureSoftware\n\t{\n\t\treturn new TextureSoftware(width, height);\n\t}\n\n\tpublic createVertexBuffer(numVertices:number, dataPerVertex:number):VertexBufferSoftware\n\t{\n\t\treturn new VertexBufferSoftware(numVertices, dataPerVertex);\n\t}\n\n\tpublic dispose():void\n\t{\n\t}\n\n\tpublic setBlendFactors(sourceFactor:string, destinationFactor:string):void\n\t{\n\t\tthis._blendSource = sourceFactor;\n\t\tthis._blendDestination = destinationFactor;\n\t}\n\n\tpublic setColorMask(red:boolean, green:boolean, blue:boolean, alpha:boolean):void\n\t{\n\t\tthis._colorMaskR = red;\n\t\tthis._colorMaskG = green;\n\t\tthis._colorMaskB = blue;\n\t\tthis._colorMaskA = alpha;\n\t}\n\n\tpublic setStencilActions(triangleFace:string, compareMode:string, actionOnBothPass:string, actionOnDepthFail:string, actionOnDepthPassStencilFail:string, coordinateSystem:string):void\n\t{\n\t\t//TODO:\n\t}\n\n\tpublic setStencilReferenceValue(referenceValue:number, readMask:number, writeMask:number):void\n\t{\n\t\t//TODO:\n\t}\n\n\tpublic setCulling(triangleFaceToCull:string, coordinateSystem:string):void\n\t{\n\t\t//TODO: CoordinateSystem.RIGHT_HAND\n\t\tthis._cullingMode = triangleFaceToCull;\n\t}\n\n\tpublic setDepthTest(depthMask:boolean, passCompareMode:string):void\n\t{\n\t\tthis._writeDepth = depthMask;\n\t\tthis._depthCompareMode = passCompareMode;\n\t}\n\n\tpublic setProgram(program:ProgramSoftware):void\n\t{\n\t\tthis._program = program;\n\t}\n\n\tpublic setProgramConstantsFromArray(programType:number, data:Float32Array):void\n\t{\n\t\tvar target:Float32Array;\n\t\tif (programType == ContextGLProgramType.VERTEX)\n\t\t\ttarget = this._vertexConstants = new Float32Array(data.length);\n\t\telse if (programType == ContextGLProgramType.FRAGMENT)\n\t\t\ttarget = this._fragmentConstants = new Float32Array(data.length);\n\n\t\ttarget.set(data);\n\t}\n\n\tpublic setTextureAt(sampler:number, texture:TextureSoftware):void\n\t{\n\t\tthis._textures[sampler] = texture;\n\t}\n\n\tpublic setVertexBufferAt(index:number, buffer:VertexBufferSoftware, bufferOffset:number, format:number):void\n\t{\n\t\tthis._vertexBuffers[index] = buffer;\n\t\tthis._vertexBufferOffsets[index] = bufferOffset;\n\t\tthis._vertexBufferFormats[index] = format;\n\t}\n\n\tpublic present():void\n\t{\n\t\tthis._backBufferColor.unlock();\n\n\t\tthis._frontBuffer.fillRect(this._frontBuffer.rect, ColorUtils.ARGBtoFloat32(0, 0, 0, 0));\n\t\tthis._frontBuffer.draw(this._backBufferColor, this._frontBufferMatrix);\n\t}\n\n\tpublic drawToBitmapImage2D(destination:BitmapImage2D):void\n\t{\n\t}\n\n\tpublic drawIndices(mode:string, indexBuffer:IndexBufferSoftware, firstIndex:number, numIndices:number):void\n\t{\n\t\tif (!this._program)\n\t\t\treturn;\n\n\t\tvar position0:Float32Array = new Float32Array(4);\n\t\tvar position1:Float32Array = new Float32Array(4);\n\t\tvar position2:Float32Array = new Float32Array(4);\n\t\t\n\t\tvar varying0:Float32Array = new Float32Array(this._program.numVarying*4);\n\t\tvar varying1:Float32Array = new Float32Array(this._program.numVarying*4);\n\t\tvar varying2:Float32Array = new Float32Array(this._program.numVarying*4);\n\n\t\tif (this._cullingMode == ContextGLTriangleFace.BACK) {\n\t\t\tfor (var i:number = firstIndex; i < numIndices; i += 3) {\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position0, varying0);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position2, varying2);\n\n\t\t\t\tthis._triangle(position0, position1, position2, varying0, varying1, varying2);\n\t\t\t}\n\t\t} else if (this._cullingMode == ContextGLTriangleFace.FRONT) {\n\t\t\tfor (var i:number = firstIndex; i < numIndices; i += 3) {\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position0, varying0);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position2, varying2);\n\n\t\t\t\tthis._triangle(position0, position1, position2, varying0, varying1, varying2);\n\t\t\t}\n\t\t} else if (this._cullingMode == ContextGLTriangleFace.FRONT_AND_BACK || this._cullingMode == ContextGLTriangleFace.NONE) {\n\t\t\tfor (var i:number = firstIndex; i < numIndices; i += 3) {\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position0, varying0);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position2, varying2);\n\n\t\t\t\tthis._triangle(position0, position1, position2, varying0, varying1, varying2);\n\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i], position0, varying0);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 1], position1, varying1);\n\t\t\t\tthis._program.vertex(this, indexBuffer.data[indexBuffer.startOffset + i + 2], position2, varying2);\n\n\t\t\t\tthis._triangle(position0, position1, position2, varying0, varying1, varying2);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic drawVertices(mode:string, firstVertex:number, numVertices:number):void\n\t{\n\t\t//TODO:\n\t}\n\n\tpublic setScissorRectangle(rectangle:Rectangle):void\n\t{\n\t\t//TODO:\n\t}\n\n\tpublic setSamplerStateAt(sampler:number, wrap:string, filter:string, mipfilter:string):void\n\t{\n\t\tvar state:SoftwareSamplerState = this._samplerStates[sampler];\n\n\t\tif (!state)\n\t\t\tstate = this._samplerStates[sampler] = new SoftwareSamplerState();\n\n\t\tstate.wrap = wrap;\n\t\tstate.filter = filter;\n\t\tstate.mipfilter = mipfilter;\n\t}\n\n\tpublic setRenderToTexture(target:ITextureBase, enableDepthAndStencil:boolean, antiAlias:number, surfaceSelector:number) \n\t{\n\t\t//TODO:\n\t}\n\n\tpublic setRenderToBackBuffer():void\n\t{\n\t\t//TODO:\n\t}\n\n\tprivate _putPixel(x:number, y:number, source:Uint8ClampedArray, dest:Uint8ClampedArray):void\n\t{\n\t\targb[0] = 0;\n\t\targb[1] = 0;\n\t\targb[2] = 0;\n\t\targb[3] = 0;\n\n\t\tBlendModeSoftware[this._blendDestination](dest, dest, source);\n\t\tBlendModeSoftware[this._blendSource](source, dest, source);\n\n\t\tthis._backBufferColor.setPixelData(x, y, argb);\n\t}\n\n\tpublic clamp(value:number, min:number = 0, max:number = 1):number\n\t{\n\t\treturn Math.max(min, Math.min(value, max));\n\t}\n\n\tpublic interpolate(min:number, max:number, gradient:number):number\n\t{\n\t\treturn min + (max - min)*this.clamp(gradient);\n\t}\n\n\tprivate _triangle(position0:Float32Array, position1:Float32Array, position2:Float32Array, varying0:Float32Array, varying1:Float32Array, varying2:Float32Array):void\n\t{\n\t\tvar p0:Vector3D = new Vector3D(position0[0], position0[1], position0[2], position0[3]);\n\t\tif (!p0 || p0.w == 0 || isNaN(p0.w)) {\n\t\t\tconsole.error(\"wrong position: \" + position0);\n\t\t\treturn;\n\t\t}\n\t\tvar p1:Vector3D = new Vector3D(position1[0], position1[1], position1[2], position1[3]);\n\t\tvar p2:Vector3D = new Vector3D(position2[0], position2[1], position2[2], position2[3]);\n\n\t\tp0.z = p0.z * 2 - p0.w;\n\t\tp1.z = p1.z * 2 - p1.w;\n\t\tp2.z = p2.z * 2 - p2.w;\n\n\t\tp0.scaleBy(1 / p0.w);\n\t\tp1.scaleBy(1 / p1.w);\n\t\tp2.scaleBy(1 / p2.w);\n\n\t\tvar project:Vector3D = new Vector3D(p0.w, p1.w, p2.w);\n\t\tp0 = this._screenMatrix.transformVector(p0);\n\t\tp1 = this._screenMatrix.transformVector(p1);\n\t\tp2 = this._screenMatrix.transformVector(p2);\n\t\tvar depth:Vector3D = new Vector3D(p0.z, p1.z, p2.z);\n\n\t\tthis._bboxMin.x = 1000000;\n\t\tthis._bboxMin.y = 1000000;\n\t\tthis._bboxMax.x = -1000000;\n\t\tthis._bboxMax.y = -1000000;\n\n\t\tthis._clamp.x = this._backBufferWidth - 1;\n\t\tthis._clamp.y = this._backBufferHeight - 1;\n\n\t\tthis._bboxMin.x = Math.max(0, Math.min(this._bboxMin.x, p0.x));\n\t\tthis._bboxMin.y = Math.max(0, Math.min(this._bboxMin.y, p0.y));\n\n\t\tthis._bboxMin.x = Math.max(0, Math.min(this._bboxMin.x, p1.x));\n\t\tthis._bboxMin.y = Math.max(0, Math.min(this._bboxMin.y, p1.y));\n\n\t\tthis._bboxMin.x = Math.max(0, Math.min(this._bboxMin.x, p2.x));\n\t\tthis._bboxMin.y = Math.max(0, Math.min(this._bboxMin.y, p2.y));\n\n\t\tthis._bboxMax.x = Math.min(this._clamp.x, Math.max(this._bboxMax.x, p0.x));\n\t\tthis._bboxMax.y = Math.min(this._clamp.y, Math.max(this._bboxMax.y, p0.y));\n\n\t\tthis._bboxMax.x = Math.min(this._clamp.x, Math.max(this._bboxMax.x, p1.x));\n\t\tthis._bboxMax.y = Math.min(this._clamp.y, Math.max(this._bboxMax.y, p1.y));\n\n\t\tthis._bboxMax.x = Math.min(this._clamp.x, Math.max(this._bboxMax.x, p2.x));\n\t\tthis._bboxMax.y = Math.min(this._clamp.y, Math.max(this._bboxMax.y, p2.y));\n\n\t\tthis._bboxMin.x = Math.floor(this._bboxMin.x);\n\t\tthis._bboxMin.y = Math.floor(this._bboxMin.y);\n\t\tthis._bboxMax.x = Math.floor(this._bboxMax.x);\n\t\tthis._bboxMax.y = Math.floor(this._bboxMax.y);\n\n\t\tfor (var x:number = this._bboxMin.x; x <= this._bboxMax.x; x++)\n\t\t\tfor (var y:number = this._bboxMin.y; y <= this._bboxMax.y; y++) {\n\t\t\t\t\n\t\t\t\tvar screen:Vector3D = this._barycentric(p0, p1, p2, x, y);\n\t\t\t\tif (screen.x < 0 || screen.y < 0 || screen.z < 0)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tvar screenRight:Vector3D = this._barycentric(p0, p1, p2, x + 1, y);\n\t\t\t\tvar screenBottom:Vector3D = this._barycentric(p0, p1, p2, x, y + 1);\n\n\t\t\t\tvar clip:Vector3D = new Vector3D(screen.x/project.x, screen.y/project.y, screen.z/project.z);\n\t\t\t\tclip.scaleBy(1/(clip.x + clip.y + clip.z));\n\n\t\t\t\tvar clipRight:Vector3D = new Vector3D(screenRight.x/project.x, screenRight.y/project.y, screenRight.z/project.z);\n\t\t\t\tclipRight.scaleBy(1/(clipRight.x + clipRight.y + clipRight.z));\n\n\t\t\t\tvar clipBottom:Vector3D = new Vector3D(screenBottom.x/project.x, screenBottom.y/project.y, screenBottom.z/project.z);\n\t\t\t\tclipBottom.scaleBy(1/(clipBottom.x + clipBottom.y + clipBottom.z));\n\n\t\t\t\tvar index:number = (x % this._backBufferWidth) + y*this._backBufferWidth;\n\n\t\t\t\tvar fragDepth:number = depth.x*screen.x + depth.y*screen.y + depth.z*screen.z;\n\t\t\t\t\n\t\t\t\tif (!DepthCompareModeSoftware[this._depthCompareMode](fragDepth, this._zbuffer[index]))\n\t\t\t\t\tcontinue;\n\n\t\t\t\tvar fragmentVO:ProgramVOSoftware = this._program.fragment(this, clip, clipRight, clipBottom, varying0, varying1, varying2, fragDepth);\n\n\t\t\t\tif (fragmentVO.discard)\n\t\t\t\t\tcontinue;\n\n\t\t\t\tif (this._writeDepth)\n\t\t\t\t\tthis._zbuffer[index] = fragDepth;//todo: fragmentVO.outputDepth?\n\n\t\t\t\t//set source\n\t\t\t\tsource[0] = fragmentVO.outputColor[0]*255;\n\t\t\t\tsource[1] = fragmentVO.outputColor[1]*255;\n\t\t\t\tsource[2] = fragmentVO.outputColor[2]*255;\n\t\t\t\tsource[3] = fragmentVO.outputColor[3]*255;\n\n\t\t\t\t//set dest\n\t\t\t\tthis._backBufferColor.getPixelData(x, y, dest);\n\t\t\t\t\n\t\t\t\tthis._putPixel(x, y, source, dest);\n\t\t\t}\n\t}\n\n\tprivate _sx:Vector3D = new Vector3D();\n\tprivate _sy:Vector3D = new Vector3D();\n\tprivate _u:Vector3D = new Vector3D();\n\t\n\tprivate _barycentric(a:Vector3D, b:Vector3D, c:Vector3D, x:number, y:number):Vector3D\n\t{\n\t\tthis._sx.x = c.x - a.x;\n\t\tthis._sx.y = b.x - a.x;\n\t\tthis._sx.z = a.x - x;\n\t\t\n\t\tthis._sy.x = c.y - a.y;\n\t\tthis._sy.y = b.y - a.y;\n\t\tthis._sy.z = a.y - y;\n\n\t\tthis._u = this._sx.crossProduct(this._sy, this._u);\n\t\t\n\t\tif (this._u.z < 0.01)\n\t\t\treturn new Vector3D(1 - (this._u.x + this._u.y)/this._u.z, this._u.y/this._u.z, this._u.x/this._u.z);\n\t\t\n\t\treturn new Vector3D(-1, 1, 1);\n\t}\n}\n\nexport class BlendModeSoftware\n{\n\tpublic static destinationAlpha(result:Uint8ClampedArray, dest:Uint8ClampedArray, source:Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*dest[0]/0xFF;\n\t\targb[1] += result[1]*dest[0]/0xFF;\n\t\targb[2] += result[2]*dest[0]/0xFF;\n\t\targb[3] += result[3]*dest[0]/0xFF;\n\t}\n\n\n\tpublic static destinationColor(result:Uint8ClampedArray, dest:Uint8ClampedArray, source:Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*dest[0]/0xFF;\n\t\targb[1] += result[1]*dest[1]/0xFF;\n\t\targb[2] += result[2]*dest[2]/0xFF;\n\t\targb[3] += result[3]*dest[3]/0xFF;\n\t}\n\n\tpublic static zero(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t}\n\n\tpublic static one(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0];\n\t\targb[1] += result[1];\n\t\targb[2] += result[2];\n\t\targb[3] += result[3];\n\t}\n\n\tpublic static oneMinusDestinationAlpha(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*(1 - dest[0]/0xFF);\n\t\targb[1] += result[1]*(1 - dest[0]/0xFF);\n\t\targb[2] += result[2]*(1 - dest[0]/0xFF);\n\t\targb[3] += result[3]*(1 - dest[0]/0xFF);\n\t}\n\n\tpublic static oneMinusDestinationColor(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*(1 - dest[0]/0xFF);\n\t\targb[1] += result[1]*(1 - dest[1]/0xFF);\n\t\targb[2] += result[2]*(1 - dest[2]/0xFF);\n\t\targb[3] += result[3]*(1 - dest[3]/0xFF);\n\t}\n\n\tpublic static oneMinusSourceAlpha(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*(1 - source[0]/0xFF);\n\t\targb[1] += result[1]*(1 - source[0]/0xFF);\n\t\targb[2] += result[2]*(1 - source[0]/0xFF);\n\t\targb[3] += result[3]*(1 - source[0]/0xFF);\n\t}\n\n\tpublic static oneMinusSourceColor(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*(1 - source[0]/0xFF);\n\t\targb[1] += result[1]*(1 - source[1]/0xFF);\n\t\targb[2] += result[2]*(1 - source[2]/0xFF);\n\t\targb[3] += result[3]*(1 - source[3]/0xFF);\n\t}\n\n\tpublic static sourceAlpha(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*source[0]/0xFF;\n\t\targb[1] += result[1]*source[0]/0xFF;\n\t\targb[2] += result[2]*source[0]/0xFF;\n\t\targb[3] += result[3]*source[0]/0xFF;\n\t}\n\n\tpublic static sourceColor(result: Uint8ClampedArray, dest: Uint8ClampedArray, source: Uint8ClampedArray):void\n\t{\n\t\targb[0] += result[0]*source[0]/0xFF;\n\t\targb[1] += result[1]*source[1]/0xFF;\n\t\targb[2] += result[2]*source[2]/0xFF;\n\t\targb[3] += result[3]*source[3]/0xFF;\n\t}\n}\n\n\nexport class DepthCompareModeSoftware\n{\n\tpublic static always(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn true;\n\t}\n\n\tpublic static equal(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn fragDepth == currentDepth;\n\t}\n\n\tpublic static greater(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn fragDepth > currentDepth;\n\t}\n\n\tpublic static greaterEqual(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn fragDepth >= currentDepth;\n\t}\n\n\tpublic static less(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn fragDepth < currentDepth;\n\t}\n\n\tpublic static lessEqual(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn fragDepth <= currentDepth;\n\t}\n\n\tpublic static never(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn false;\n\t}\n\n\tpublic static notEqual(fragDepth:number, currentDepth:number):boolean\n\t{\n\t\treturn fragDepth != currentDepth;\n\t}\n}\n\nvar argb:Uint8ClampedArray = new Uint8ClampedArray(4);\nvar source:Uint8ClampedArray = new Uint8ClampedArray(4);\nvar dest:Uint8ClampedArray = new Uint8ClampedArray(4);\n",
    "import {BitmapImage2D}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImage2D\";\nimport {Matrix3D}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Matrix3D\";\nimport {Matrix3DUtils}\t\t\t\tfrom \"awayjs-core/lib/geom/Matrix3DUtils\";\nimport {Rectangle}\t\t\t\t\tfrom \"awayjs-core/lib/geom/Rectangle\";\n\n//import {swfobject}\t\t\t\t\tfrom \"../swfobject\";\nimport {ContextGLClearMask}\t\t\tfrom \"../base/ContextGLClearMask\";\nimport {ContextGLProgramType}\t\t\tfrom \"../base/ContextGLProgramType\";\nimport {CubeTextureFlash}\t\t\t\tfrom \"../base/CubeTextureFlash\";\nimport {IContextGL}\t\t\t\t\tfrom \"../base/IContextGL\";\nimport {IndexBufferFlash}\t\t\t\tfrom \"../base/IndexBufferFlash\";\nimport {OpCodes}\t\t\t\t\t\tfrom \"../base/OpCodes\";\nimport {ProgramFlash}\t\t\t\t\tfrom \"../base/ProgramFlash\";\nimport {TextureFlash}\t\t\t\t\tfrom \"../base/TextureFlash\";\nimport {ResourceBaseFlash}\t\t\tfrom \"../base/ResourceBaseFlash\";\nimport {VertexBufferFlash}\t\t\tfrom \"../base/VertexBufferFlash\";\n\nexport class ContextStage3D implements IContextGL\n{\n\tpublic static contexts:Object = new Object();\n\n\tpublic _iDriverInfo;\n\n\tprivate _container:HTMLElement;\n\tprivate _width:number;\n\tprivate _height:number;\n\tprivate _cmdStream:string = \"\";\n\tprivate _errorCheckingEnabled:boolean;\n\tprivate _resources:Array<ResourceBaseFlash>;\n\tprivate _oldCanvas:HTMLCanvasElement;\n\tprivate _oldParent:HTMLElement;\n\n\n\tpublic static debug:boolean = false;\n\tpublic static logStream:boolean = false;\n\n\tpublic _iCallback:(context:IContextGL) => void;\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._container;\n\t}\n\n\tpublic get driverInfo():void\n\t{\n\t\treturn this._iDriverInfo;\n\t}\n\n\tpublic get errorCheckingEnabled():boolean\n\t{\n\t\treturn this._errorCheckingEnabled;\n\t}\n\n\tpublic set errorCheckingEnabled(value:boolean)\n\t{\n\t\tif (this._errorCheckingEnabled == value)\n\t\t\treturn;\n\n\t\tthis._errorCheckingEnabled = value;\n\n\t\tthis.addStream(String.fromCharCode(OpCodes.enableErrorChecking, value? OpCodes.trueValue : OpCodes.falseValue));\n\t\tthis.execute();\n\t}\n\n\t//TODO: get rid of hack that fixes including definition file\n\tconstructor(container:HTMLCanvasElement, callback:(context:IContextGL) => void)\n\t{\n\t\tthis._resources = new Array<ResourceBaseFlash>();\n\n\t\tvar swfVersionStr = \"11.0.0\";\n\n\t\t// To use express install, set to playerProductInstall.swf, otherwise the empty string.\n\t\tvar flashvars = {\n\t\t\tid:container.id\n\t\t};\n\n\t\tvar params = {\n\t\t\tquality:\"high\",\n\t\t\tbgcolor:\"#ffffff\",\n\t\t\tallowscriptaccess:\"sameDomain\",\n\t\t\tallowfullscreen:\"true\",\n\t\t\twmode:\"direct\"\n\t\t};\n\n\t\tthis._errorCheckingEnabled = false;\n\t\tthis._iDriverInfo = \"Unknown\";\n\n\t\tvar attributes = {\n\t\t\tsalign:\"tl\",\n\t\t\tid:container.id,\n\t\t\tname:container[\"name\"] //TODO: needed?\n\t\t};\n\n\t\tthis._oldCanvas = <HTMLCanvasElement> container.cloneNode(); // keep the old one to restore on dispose\n\t\tthis._oldParent = <HTMLElement> container.parentNode;\n\n\t\tvar context3dObj = this;\n\t\tContextStage3D.contexts[container.id] = this;\n\n\t\tfunction callbackSWFObject(callbackInfo)\n\t\t{\n\t\t\tif (!callbackInfo.success)\n\t\t\t\treturn;\n\n\t\t\tcontext3dObj._container = callbackInfo.ref;\n\t\t\tcontext3dObj._iCallback = callback;\n\t\t}\n\n\t\t//swfobject.embedSWF(\"libs/molehill_js_flashbridge.swf\", container.id, String(container.width), String(container.height), swfVersionStr, \"\", flashvars, params, attributes, callbackSWFObject);\n\t}\n\n\tpublic _iAddResource(resource:ResourceBaseFlash):void\n\t{\n\t\tthis._resources.push(resource);\n\t}\n\n\tpublic _iRemoveResource(resource:ResourceBaseFlash):void\n\t{\n\t\tthis._resources.splice(this._resources.indexOf(resource));\n\t}\n\n\tpublic createTexture(width:number, height:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):TextureFlash\n\t{\n\t\t//TODO:streaming\n\t\treturn new TextureFlash(this, width, height, format, optimizeForRenderToTexture);\n\t}\n\n\tpublic createCubeTexture(size:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):CubeTextureFlash\n\t{\n\t\t//TODO:streaming\n\t\treturn new CubeTextureFlash(this, size, format, optimizeForRenderToTexture);\n\t}\n\n\n\tpublic setTextureAt(sampler:number, texture:ResourceBaseFlash):void\n\t{\n\t\tif (texture) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setTextureAt) + sampler + \",\" + texture.id + \",\");\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearTextureAt) + sampler.toString() + \",\");\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setSamplerStateAt(sampler:number, wrap:string, filter:string, mipfilter:string):void\n\t{\n\t\t//nothing to do here\n\t}\n\n\tpublic setStencilActions(triangleFace:string = \"frontAndBack\", compareMode:string = \"always\", actionOnBothPass:string = \"keep\", actionOnDepthFail:string = \"keep\", actionOnDepthPassStencilFail:string = \"keep\", coordinateSystem:string = \"leftHanded\"):void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setStencilActions) + triangleFace + \"$\" + compareMode + \"$\" + actionOnBothPass + \"$\" + actionOnDepthFail + \"$\" + actionOnDepthPassStencilFail + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setStencilReferenceValue(referenceValue:number, readMask:number = 255, writeMask:number = 255):void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setStencilReferenceValue, referenceValue + OpCodes.intMask, readMask + OpCodes.intMask, writeMask + OpCodes.intMask));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setCulling(triangleFaceToCull:string, coordinateSystem:string = \"leftHanded\"):void\n\t{\n\t\t//TODO implement coordinateSystem option\n\t\tthis.addStream(String.fromCharCode(OpCodes.setCulling) + triangleFaceToCull + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic drawIndices(mode:string, indexBuffer:IndexBufferFlash, firstIndex:number = 0, numIndices:number = -1):void\n\t{\n\t\tfirstIndex = firstIndex || 0;\n\t\tif (!numIndices || numIndices < 0)\n\t\t\tnumIndices = indexBuffer.numIndices;\n\n\t\t//assume triangles\n\t\tthis.addStream(String.fromCharCode(OpCodes.drawTriangles, indexBuffer.id + OpCodes.intMask) + firstIndex + \",\" + numIndices + \",\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic drawVertices(mode:string, firstVertex:number = 0, numVertices:number = -1):void\n\t{\n\t\t//can't be done in Stage3D\n\t}\n\n\tpublic setProgramConstantsFromArray(programType:number, data:Float32Array):void\n\t{\n\t\tvar startIndex:number;\n\t\tvar numRegisters:number = data.length/4\n\t\tvar target:number = (programType == ContextGLProgramType.VERTEX)? OpCodes.trueValue : OpCodes.falseValue;\n\t\tfor (var i:number = 0; i < numRegisters; i++) {\n\t\t\tstartIndex = i*4;\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setProgramConstant, target, i + OpCodes.intMask) + data[startIndex] + \",\" + data[startIndex + 1] + \",\" + data[startIndex + 2] + \",\" + data[startIndex + 3] + \",\");\n\n\t\t\tif (ContextStage3D.debug)\n\t\t\t\tthis.execute();\n\t\t}\n\t}\n\n\tpublic setProgram(program:ProgramFlash):void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setProgram, program.id + OpCodes.intMask));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic present():void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.present));\n\t\tthis.execute();\n\t}\n\n\tpublic clear(red:number = 0, green:number = 0, blue:number = 0, alpha:number = 1, depth:number = 1, stencil:number = 0, mask:number = ContextGLClearMask.ALL):void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.clear) + red + \",\" + green + \",\" + blue + \",\" + alpha + \",\" + depth + \",\" + stencil + \",\" + mask + \",\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic createProgram():ProgramFlash\n\t{\n\t\treturn new ProgramFlash(this);\n\t}\n\n\tpublic createVertexBuffer(numVertices:number, data32PerVertex:number):VertexBufferFlash\n\t{\n\t\treturn new VertexBufferFlash(this, numVertices, data32PerVertex);\n\t}\n\n\tpublic createIndexBuffer(numIndices:number):IndexBufferFlash\n\t{\n\t\treturn new IndexBufferFlash(this, numIndices);\n\t}\n\n\tpublic configureBackBuffer(width:number, height:number, antiAlias:number, enableDepthAndStencil:boolean = true):void\n\t{\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\t//TODO: add Anitalias setting\n\t\tthis.addStream(String.fromCharCode(OpCodes.configureBackBuffer) + width + \",\" + height + \",\");\n\t}\n\n\tpublic drawToBitmapImage2D(destination:BitmapImage2D):void\n\t{\n\t\t//TODO\n\t}\n\n\tpublic setVertexBufferAt(index:number, buffer:VertexBufferFlash, bufferOffset:number = 0, format:number = null):void\n\t{\n\t\tif (buffer) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setVertexBufferAt, index + OpCodes.intMask) + buffer.id + \",\" + bufferOffset + \",\" + format + \"$\");\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearVertexBufferAt, index + OpCodes.intMask));\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setColorMask(red:boolean, green:boolean, blue:boolean, alpha:boolean):void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setColorMask, red? OpCodes.trueValue : OpCodes.falseValue, green? OpCodes.trueValue : OpCodes.falseValue, blue? OpCodes.trueValue : OpCodes.falseValue, alpha? OpCodes.trueValue : OpCodes.falseValue));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setBlendFactors(sourceFactor:string, destinationFactor:string):void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setBlendFactors) + sourceFactor + \"$\" + destinationFactor + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setRenderToTexture(target:ResourceBaseFlash, enableDepthAndStencil:boolean = false, antiAlias:number = 0, surfaceSelector:number = 0):void\n\t{\n\t\tif (target === null || target === undefined) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearRenderToTexture));\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setRenderToTexture, enableDepthAndStencil? OpCodes.trueValue : OpCodes.falseValue) + target.id + \",\" + (antiAlias || 0) + \",\");\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\n\tpublic setRenderToBackBuffer():void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.clearRenderToTexture));\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setScissorRectangle(rectangle:Rectangle):void\n\t{\n\t\tif (rectangle) {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.setScissorRect) + rectangle.x + \",\" + rectangle.y + \",\" + rectangle.width + \",\" + rectangle.height + \",\");\n\t\t} else {\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.clearScissorRect));\n\t\t}\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic setDepthTest(depthMask:boolean, passCompareMode:string):void\n\t{\n\t\tthis.addStream(String.fromCharCode(OpCodes.setDepthTest, depthMask? OpCodes.trueValue : OpCodes.falseValue) + passCompareMode + \"$\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis.execute();\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tif (this._container == null)\n\t\t\treturn;\n\n\t\tconsole.log(\"Context3D dispose, releasing \" + this._resources.length + \" resources.\");\n\n\t\twhile (this._resources.length)\n\t\t\tthis._resources[0].dispose();\n\n\t\tif (this._container) {\n\t\t\t// encode command\n\t\t\tthis.addStream(String.fromCharCode(OpCodes.disposeContext));\n\t\t\tthis.execute();\n\t\t\t//swfobject.removeSWF(this._oldCanvas.id);\n\t\t\tif (this._oldCanvas && this._oldParent) {\n\t\t\t\tthis._oldParent.appendChild(this._oldCanvas);\n\t\t\t\tthis._oldParent = null;\n\t\t\t}\n\t\t\tthis._container = null;\n\t\t}\n\n\t\tthis._oldCanvas = null;\n\t}\n\n\tpublic addStream(stream:string):void\n\t{\n\t\tthis._cmdStream += stream;\n\t}\n\n\tpublic execute():number\n\t{\n\t\tif (ContextStage3D.logStream)\n\t\t\tconsole.log(this._cmdStream);\n\n\t\tvar result:number = this._container[\"CallFunction\"](\"<invoke name=\\\"execStage3dOpStream\\\" returntype=\\\"javascript\\\"><arguments><string>\" + this._cmdStream + \"</string></arguments></invoke>\");\n\n\t\tif (Number(result) <= -3)\n\t\t\tthrow \"Exec stream failed\";\n\n\t\tthis._cmdStream = \"\";\n\n\t\treturn Number(result);\n\t}\n}\n\n/**\n* global function for flash callback\n*/\nfunction mountain_js_context_available(id, driverInfo)\n{\n\tvar ctx:ContextStage3D = ContextStage3D.contexts[id];\n\tif (ctx._iCallback) {\n\t\tctx._iDriverInfo = driverInfo;\n\t\t// get out of the current JS stack frame and call back from flash player\n\t\tvar timeOutId = window.setTimeout(function ()\n\t\t{\n\t\t\twindow.clearTimeout(timeOutId);\n\t\t\ttry {\n\t\t\t\tctx._iCallback(ctx);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.log(\"Callback failed during flash initialization with '\" + e.toString() + \"'\");\n\t\t\t}\n\t\t}, 1);\n\t}\n}\n",
    "import {BitmapImage2D}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImage2D\";\nimport {Matrix3D}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Matrix3D\";\nimport {Matrix3DUtils}\t\t\t\tfrom \"awayjs-core/lib/geom/Matrix3DUtils\";\nimport {Rectangle}\t\t\t\t\tfrom \"awayjs-core/lib/geom/Rectangle\";\nimport {ByteArray}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nimport {ContextGLBlendFactor}\t\t\tfrom \"../base/ContextGLBlendFactor\";\nimport {ContextGLDrawMode}\t\t\tfrom \"../base/ContextGLDrawMode\";\nimport {ContextGLClearMask}\t\t\tfrom \"../base/ContextGLClearMask\";\nimport {ContextGLCompareMode}\t\t\tfrom \"../base/ContextGLCompareMode\";\nimport {ContextGLMipFilter}\t\t\tfrom \"../base/ContextGLMipFilter\";\nimport {ContextGLProgramType}\t\t\tfrom \"../base/ContextGLProgramType\";\nimport {ContextGLStencilAction}\t\tfrom \"../base/ContextGLStencilAction\";\nimport {ContextGLTextureFilter}\t\tfrom \"../base/ContextGLTextureFilter\";\nimport {ContextGLTriangleFace}\t\tfrom \"../base/ContextGLTriangleFace\";\nimport {ContextGLVertexBufferFormat}\tfrom \"../base/ContextGLVertexBufferFormat\";\nimport {ContextGLWrapMode}\t\t\tfrom \"../base/ContextGLWrapMode\";\nimport {CubeTextureWebGL}\t\t\t\tfrom \"../base/CubeTextureWebGL\";\nimport {IContextGL}\t\t\t\t    from \"../base/IContextGL\";\nimport {IndexBufferWebGL}\t\t\t\tfrom \"../base/IndexBufferWebGL\";\nimport {ProgramWebGL}\t\t\t\t\tfrom \"../base/ProgramWebGL\";\nimport {TextureBaseWebGL}\t\t\t\tfrom \"../base/TextureBaseWebGL\";\nimport {TextureWebGL}\t\t\t\t\tfrom \"../base/TextureWebGL\";\nimport {SamplerState}\t\t\t\t\tfrom \"../base/SamplerState\";\nimport {VertexBufferWebGL}\t\t\tfrom \"../base/VertexBufferWebGL\";\n\nexport class ContextWebGL implements IContextGL\n{\n\tprivate _blendFactorDictionary:Object = new Object();\n\tprivate _drawModeDictionary:Object = new Object();\n\tprivate _compareModeDictionary:Object = new Object();\n\tprivate _stencilActionDictionary:Object = new Object();\n\tprivate _textureIndexDictionary:Array<number> = new Array<number>(8);\n\tprivate _textureTypeDictionary:Object = new Object();\n\tprivate _wrapDictionary:Object = new Object();\n\tprivate _filterDictionary:Object = new Object();\n\tprivate _mipmapFilterDictionary:Object = new Object();\n\tprivate _vertexBufferPropertiesDictionary:Array<VertexBufferProperties> = [];\n\n\tprivate _container:HTMLElement;\n\tprivate _width:number;\n\tprivate _height:number;\n\tprivate _drawing:boolean;\n\tprivate _blendEnabled:boolean;\n\tprivate _blendSourceFactor:number;\n\tprivate _blendDestinationFactor:number;\n\n\tprivate _standardDerivatives:boolean;\n\n\tprivate _samplerStates:Array<SamplerState> = new Array<SamplerState>(8);\n\n\tpublic static MAX_SAMPLERS:number = 8;\n\n\t//@protected\n\tpublic _gl:WebGLRenderingContext;\n\n\t//@protected\n\tpublic _currentProgram:ProgramWebGL;\n\tprivate _currentArrayBuffer:VertexBufferWebGL;\n\tprivate _activeTexture:number;\n\n    private _stencilCompareMode:number;\n    private _stencilCompareModeBack:number;\n    private _stencilCompareModeFront:number;\n    private _stencilReferenceValue : number = 0;\n    private _stencilReadMask : number = 0xff;\n    private _separateStencil : boolean = false;\n\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._container;\n\t}\n\tpublic get standardDerivatives():boolean\n\t{\n\t\treturn this._standardDerivatives;\n\t}\n\tconstructor(canvas:HTMLCanvasElement)\n\t{\n\t\tthis._container = canvas;\n\n\t\ttry {\n\t\t\tthis._gl = <WebGLRenderingContext> canvas.getContext(\"experimental-webgl\", { premultipliedAlpha:false, alpha:false, stencil:true });\n\n\t\t\tif (!this._gl)\n\t\t\t\tthis._gl = <WebGLRenderingContext> canvas.getContext(\"webgl\", { premultipliedAlpha:false, alpha:false, stencil:true });\n\t\t} catch (e) {\n\t\t\t//this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_FAILED, e ) );\n\t\t}\n\n\t\tif (this._gl) {\n\t\t\t//this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_SUCCESS ) );\n\n\t\t\tif(this._gl.getExtension(\"OES_standard_derivatives\"))\n\t\t\t{\n\t\t\t\tthis._standardDerivatives = true;\n\t\t\t}else{\n\t\t\t\tthis._standardDerivatives = false;\n\t\t\t}\n\n\t\t\t//setup shortcut dictionaries\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE] = this._gl.ONE;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.DESTINATION_ALPHA] = this._gl.DST_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.DESTINATION_COLOR] = this._gl.DST_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE] = this._gl.ONE;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_DESTINATION_ALPHA] = this._gl.ONE_MINUS_DST_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_DESTINATION_COLOR] = this._gl.ONE_MINUS_DST_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_SOURCE_ALPHA] = this._gl.ONE_MINUS_SRC_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ONE_MINUS_SOURCE_COLOR] = this._gl.ONE_MINUS_SRC_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.SOURCE_ALPHA] = this._gl.SRC_ALPHA;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.SOURCE_COLOR] = this._gl.SRC_COLOR;\n\t\t\tthis._blendFactorDictionary[ContextGLBlendFactor.ZERO] = this._gl.ZERO;\n\n\t\t\tthis._drawModeDictionary[ContextGLDrawMode.LINES] = this._gl.LINES;\n\t\t\tthis._drawModeDictionary[ContextGLDrawMode.TRIANGLES] = this._gl.TRIANGLES;\n\n            this._compareModeDictionary[ContextGLCompareMode.ALWAYS] = this._gl.ALWAYS;\n            this._compareModeDictionary[ContextGLCompareMode.EQUAL] = this._gl.EQUAL;\n            this._compareModeDictionary[ContextGLCompareMode.GREATER] = this._gl.GREATER;\n\t\t\tthis._compareModeDictionary[ContextGLCompareMode.GREATER_EQUAL] = this._gl.GEQUAL;\n\t\t\tthis._compareModeDictionary[ContextGLCompareMode.LESS] = this._gl.LESS;\n\t\t\tthis._compareModeDictionary[ContextGLCompareMode.LESS_EQUAL] = this._gl.LEQUAL;\n\t\t\tthis._compareModeDictionary[ContextGLCompareMode.NEVER] = this._gl.NEVER;\n\t\t\tthis._compareModeDictionary[ContextGLCompareMode.NOT_EQUAL] = this._gl.NOTEQUAL;\n\n            this._stencilActionDictionary[ContextGLStencilAction.DECREMENT_SATURATE] = this._gl.DECR;\n            this._stencilActionDictionary[ContextGLStencilAction.DECREMENT_WRAP] = this._gl.DECR_WRAP;\n            this._stencilActionDictionary[ContextGLStencilAction.INCREMENT_SATURATE] = this._gl.INCR;\n            this._stencilActionDictionary[ContextGLStencilAction.INCREMENT_WRAP] = this._gl.INCR_WRAP;\n            this._stencilActionDictionary[ContextGLStencilAction.INVERT] = this._gl.INVERT;\n            this._stencilActionDictionary[ContextGLStencilAction.KEEP] = this._gl.KEEP;\n            this._stencilActionDictionary[ContextGLStencilAction.SET] = this._gl.REPLACE;\n            this._stencilActionDictionary[ContextGLStencilAction.ZERO] = this._gl.ZERO;\n\n\t\t\tthis._textureIndexDictionary[0] = this._gl.TEXTURE0;\n\t\t\tthis._textureIndexDictionary[1] = this._gl.TEXTURE1;\n\t\t\tthis._textureIndexDictionary[2] = this._gl.TEXTURE2;\n\t\t\tthis._textureIndexDictionary[3] = this._gl.TEXTURE3;\n\t\t\tthis._textureIndexDictionary[4] = this._gl.TEXTURE4;\n\t\t\tthis._textureIndexDictionary[5] = this._gl.TEXTURE5;\n\t\t\tthis._textureIndexDictionary[6] = this._gl.TEXTURE6;\n\t\t\tthis._textureIndexDictionary[7] = this._gl.TEXTURE7;\n\n\t\t\tthis._textureTypeDictionary[\"texture2d\"] = this._gl.TEXTURE_2D;\n\t\t\tthis._textureTypeDictionary[\"textureCube\"] = this._gl.TEXTURE_CUBE_MAP;\n\n\t\t\tthis._wrapDictionary[ContextGLWrapMode.REPEAT] = this._gl.REPEAT;\n\t\t\tthis._wrapDictionary[ContextGLWrapMode.CLAMP] = this._gl.CLAMP_TO_EDGE;\n\n\t\t\tthis._filterDictionary[ContextGLTextureFilter.LINEAR] = this._gl.LINEAR;\n\t\t\tthis._filterDictionary[ContextGLTextureFilter.NEAREST] = this._gl.NEAREST;\n\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR] = new Object();\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR][ContextGLMipFilter.MIPNEAREST] = this._gl.LINEAR_MIPMAP_NEAREST;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR][ContextGLMipFilter.MIPLINEAR] = this._gl.LINEAR_MIPMAP_LINEAR;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.LINEAR][ContextGLMipFilter.MIPNONE] = this._gl.LINEAR;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST] = new Object();\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST][ContextGLMipFilter.MIPNEAREST] = this._gl.NEAREST_MIPMAP_NEAREST;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST][ContextGLMipFilter.MIPLINEAR] = this._gl.NEAREST_MIPMAP_LINEAR;\n\t\t\tthis._mipmapFilterDictionary[ContextGLTextureFilter.NEAREST][ContextGLMipFilter.MIPNONE] = this._gl.NEAREST;\n\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.FLOAT_1] = new VertexBufferProperties(1, this._gl.FLOAT, false);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.FLOAT_2] = new VertexBufferProperties(2, this._gl.FLOAT, false);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.FLOAT_3] = new VertexBufferProperties(3, this._gl.FLOAT, false);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.FLOAT_4] = new VertexBufferProperties(4, this._gl.FLOAT, false);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.BYTE_1] = new VertexBufferProperties(1, this._gl.BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.BYTE_2] = new VertexBufferProperties(2, this._gl.BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.BYTE_3] = new VertexBufferProperties(3, this._gl.BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.BYTE_4] = new VertexBufferProperties(4, this._gl.BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_BYTE_1] = new VertexBufferProperties(1, this._gl.UNSIGNED_BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_BYTE_2] = new VertexBufferProperties(2, this._gl.UNSIGNED_BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_BYTE_3] = new VertexBufferProperties(3, this._gl.UNSIGNED_BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_BYTE_4] = new VertexBufferProperties(4, this._gl.UNSIGNED_BYTE, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.SHORT_1] = new VertexBufferProperties(1, this._gl.SHORT, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.SHORT_2] = new VertexBufferProperties(2, this._gl.SHORT, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.SHORT_3] = new VertexBufferProperties(3, this._gl.SHORT, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.SHORT_4] = new VertexBufferProperties(4, this._gl.SHORT, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_SHORT_1] = new VertexBufferProperties(1, this._gl.UNSIGNED_SHORT, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_SHORT_2] = new VertexBufferProperties(2, this._gl.UNSIGNED_SHORT, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_SHORT_3] = new VertexBufferProperties(3, this._gl.UNSIGNED_SHORT, true);\n\t\t\tthis._vertexBufferPropertiesDictionary[ContextGLVertexBufferFormat.UNSIGNED_SHORT_4] = new VertexBufferProperties(4, this._gl.UNSIGNED_SHORT, true);\n\n            this._stencilCompareMode = this._gl.ALWAYS;\n            this._stencilCompareModeBack = this._gl.ALWAYS;\n            this._stencilCompareModeFront = this._gl.ALWAYS;\n\t\t} else {\n\t\t\t//this.dispatchEvent( new away.events.AwayEvent( away.events.AwayEvent.INITIALIZE_FAILED, e ) );\n\t\t\talert(\"WebGL is not available.\");\n\t\t}\n\n\t\t//defaults\n\t\tfor (var i:number = 0; i < ContextWebGL.MAX_SAMPLERS; ++i) {\n\t\t\tthis._samplerStates[i] = new SamplerState();\n\t\t\tthis._samplerStates[i].wrap = this._gl.REPEAT;\n\t\t\tthis._samplerStates[i].filter = this._gl.LINEAR;\n\t\t\tthis._samplerStates[i].mipfilter = this._gl.LINEAR;\n\t\t}\n\t}\n\n\tpublic gl():WebGLRenderingContext\n\t{\n\t\treturn this._gl;\n\t}\n\n\tpublic clear(red:number = 0, green:number = 0, blue:number = 0, alpha:number = 1, depth:number = 1, stencil:number = 0, mask:number = ContextGLClearMask.ALL):void\n\t{\n\t\tif (!this._drawing) {\n\t\t\tthis.updateBlendStatus();\n\t\t\tthis._drawing = true;\n\t\t}\n\n\t\tvar glmask:number = 0;\n\t\tif (mask & ContextGLClearMask.COLOR) glmask |= this._gl.COLOR_BUFFER_BIT;\n\t\tif (mask & ContextGLClearMask.STENCIL) glmask |= this._gl.STENCIL_BUFFER_BIT;\n\t\tif (mask & ContextGLClearMask.DEPTH) glmask |= this._gl.DEPTH_BUFFER_BIT;\n\n\t\tthis._gl.clearColor(red, green, blue, alpha);\n\t\tthis._gl.clearDepth(depth);\n\t\tthis._gl.clearStencil(stencil);\n\t\tthis._gl.clear(glmask);\n\t}\n\n\tpublic configureBackBuffer(width:number, height:number, antiAlias:number, enableDepthAndStencil:boolean = true):void\n\t{\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tif (enableDepthAndStencil) {\n\t\t\tthis._gl.enable(this._gl.STENCIL_TEST);\n\t\t\tthis._gl.enable(this._gl.DEPTH_TEST);\n\t\t}\n\n\t\tthis._gl.viewport['width'] = width;\n\t\tthis._gl.viewport['height'] = height;\n\n\t\tthis._gl.viewport(0, 0, width, height);\n\t}\n\n\tpublic createCubeTexture(size:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):CubeTextureWebGL\n\t{\n\t\treturn new CubeTextureWebGL(this._gl, size);\n\t}\n\n\tpublic createIndexBuffer(numIndices:number):IndexBufferWebGL\n\t{\n\t\treturn new IndexBufferWebGL(this._gl, numIndices);\n\t}\n\n\tpublic createProgram():ProgramWebGL\n\t{\n\t\treturn new ProgramWebGL(this._gl);\n\t}\n\n\tpublic createTexture(width:number, height:number, format:string, optimizeForRenderToTexture:boolean, streamingLevels:number = 0):TextureWebGL\n\t{\n\t\t//TODO streaming\n\t\treturn new TextureWebGL(this._gl, width, height);\n\t}\n\n\tpublic createVertexBuffer(numVertices:number, dataPerVertex:number):VertexBufferWebGL\n\t{\n\t\treturn new VertexBufferWebGL(this._gl, numVertices, dataPerVertex);\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tfor (var i:number = 0; i < this._samplerStates.length; ++i)\n\t\t\tthis._samplerStates[i] = null;\n\t}\n\n\tpublic drawToBitmapImage2D(destination:BitmapImage2D):void\n\t{\n\t\tvar pixels:Uint8ClampedArray = new Uint8ClampedArray(destination.width*destination.height*4);\n\n\t\tthis._gl.readPixels(0, 0, destination.width, destination.height, this._gl.RGBA, this._gl.UNSIGNED_BYTE, pixels);\n\n\t\tdestination.setPixels(new Rectangle(0, 0, destination.width, destination.height), pixels);\n\t}\n\n\tpublic drawIndices(mode:string, indexBuffer:IndexBufferWebGL, firstIndex:number = 0, numIndices:number = -1):void\n\t{\n\t\tif (!this._drawing)\n\t\t\tthrow \"Need to clear before drawing if the buffer has not been cleared since the last present() call.\";\n\n\n\t\tthis._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, indexBuffer.glBuffer);\n\t\tthis._gl.drawElements(this._drawModeDictionary[mode], (numIndices == -1)? indexBuffer.numIndices : numIndices, this._gl.UNSIGNED_SHORT, firstIndex*2);\n\t}\n\n\tpublic drawVertices(mode:string, firstVertex:number = 0, numVertices:number = -1):void\n\t{\n\t\tif (!this._drawing)\n\t\t\tthrow \"Need to clear before drawing if the buffer has not been cleared since the last present() call.\";\n\n\t\tthis._gl.drawArrays(this._drawModeDictionary[mode], firstVertex, numVertices);\n\t}\n\n\tpublic present():void\n\t{\n\t\tthis._drawing = false;\n\t}\n\n\tpublic setBlendFactors(sourceFactor:string, destinationFactor:string):void\n\t{\n\t\tthis._blendEnabled = true;\n\n\t\tthis._blendSourceFactor = this._blendFactorDictionary[sourceFactor];\n\n\t\tthis._blendDestinationFactor = this._blendFactorDictionary[destinationFactor];\n\n\t\tthis.updateBlendStatus();\n\t}\n\n\tpublic setColorMask(red:boolean, green:boolean, blue:boolean, alpha:boolean):void\n\t{\n\t\tthis._gl.colorMask(red, green, blue, alpha);\n\t}\n\n\tpublic setCulling(triangleFaceToCull:string, coordinateSystem:string = \"leftHanded\"):void\n\t{\n\t\tif (triangleFaceToCull == ContextGLTriangleFace.NONE) {\n\t\t\tthis._gl.disable(this._gl.CULL_FACE);\n\t\t} else {\n\t\t\tthis._gl.enable(this._gl.CULL_FACE);\n            this._gl.cullFace(this.translateTriangleFace(triangleFaceToCull, coordinateSystem));\n\t\t}\n\t}\n\n\t// TODO ContextGLCompareMode\n\tpublic setDepthTest(depthMask:boolean, passCompareMode:string):void\n\t{\n\t\tthis._gl.depthFunc(this._compareModeDictionary[passCompareMode]);\n\n\t\tthis._gl.depthMask(depthMask);\n\t}\n\n    public setStencilActions(triangleFace:string = \"frontAndBack\", compareMode:string = \"always\", actionOnBothPass:string = \"keep\", actionOnDepthFail:string = \"keep\", actionOnDepthPassStencilFail:string = \"keep\", coordinateSystem:string = \"leftHanded\")\n    {\n        this._separateStencil = triangleFace != \"frontAndBack\";\n\n        var compareModeGL = this._compareModeDictionary[compareMode];\n\n        var fail = this._stencilActionDictionary[actionOnDepthPassStencilFail];\n        var zFail = this._stencilActionDictionary[actionOnDepthFail];\n        var pass = this._stencilActionDictionary[actionOnBothPass];\n\n        if (!this._separateStencil) {\n            this._stencilCompareMode = compareModeGL;\n            this._gl.stencilFunc(compareModeGL, this._stencilReferenceValue, this._stencilReadMask);\n            this._gl.stencilOp(fail, zFail, pass);\n        }\n        else if (triangleFace == \"back\") {\n            this._stencilCompareModeBack = compareModeGL;\n            this._gl.stencilFuncSeparate(this._gl.BACK, compareModeGL, this._stencilReferenceValue, this._stencilReadMask);\n            this._gl.stencilOpSeparate(this._gl.BACK, fail, zFail, pass);\n        }\n        else if (triangleFace == \"front\") {\n            this._stencilCompareModeFront = compareModeGL;\n            this._gl.stencilFuncSeparate(this._gl.FRONT, compareModeGL, this._stencilReferenceValue, this._stencilReadMask);\n            this._gl.stencilOpSeparate(this._gl.FRONT, fail, zFail, pass);\n        }\n    }\n\n    public setStencilReferenceValue(referenceValue:number, readMask:number, writeMask:number)\n    {\n        this._stencilReferenceValue = referenceValue;\n        this._stencilReadMask = readMask;\n\n        if (this._separateStencil) {\n            this._gl.stencilFuncSeparate(this._gl.FRONT, this._stencilCompareModeFront, referenceValue, readMask);\n            this._gl.stencilFuncSeparate(this._gl.BACK, this._stencilCompareModeBack, referenceValue, readMask);\n        }\n        else {\n            this._gl.stencilFunc(this._stencilCompareMode, referenceValue, readMask);\n        }\n\n        this._gl.stencilMask(writeMask);\n    }\n\n\tpublic setProgram(program:ProgramWebGL):void\n\t{\n\t\t//TODO decide on construction/reference resposibilities\n\t\tthis._currentProgram = program;\n\t\tprogram.focusProgram();\n\t}\n\n\tpublic static modulo:number = 0;\n\n\tpublic setProgramConstantsFromArray(programType:number, data:Float32Array):void\n\t{\n\t\tif (data.length)\n\t\t\tthis._gl.uniform4fv(this._currentProgram.getUniformLocation(programType), data);\n\t}\n\n\tpublic setScissorRectangle(rectangle:Rectangle):void\n\t{\n\t\tif (!rectangle) {\n\t\t\tthis._gl.disable(this._gl.SCISSOR_TEST);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._gl.enable(this._gl.SCISSOR_TEST);\n\t\tthis._gl.scissor(rectangle.x, rectangle.y, rectangle.width, rectangle.height);\n\t}\n\n\tpublic setTextureAt(sampler:number, texture:TextureBaseWebGL):void\n\t{\n\t\tvar samplerState:SamplerState = this._samplerStates[sampler];\n\n\t\tif (this._activeTexture != sampler && (texture || samplerState.type)) {\n\t\t\tthis._activeTexture = sampler;\n\t\t\tthis._gl.activeTexture(this._textureIndexDictionary[sampler]);\n\t\t}\n\n\t\tif (!texture) {\n\t\t\tif (samplerState.type) {\n\t\t\t\tthis._gl.bindTexture(samplerState.type, null);\n\t\t\t\tsamplerState.type = null;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvar textureType:number = this._textureTypeDictionary[texture.textureType];\n\t\tsamplerState.type = textureType;\n\n\t\tthis._gl.bindTexture(textureType, texture.glTexture);\n\n\t\tthis._gl.uniform1i(this._currentProgram.getUniformLocation(ContextGLProgramType.SAMPLER, sampler), sampler);\n\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_WRAP_S, samplerState.wrap);\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_WRAP_T, samplerState.wrap);\n\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_MAG_FILTER, samplerState.filter);\n\t\tthis._gl.texParameteri(textureType, this._gl.TEXTURE_MIN_FILTER, samplerState.mipfilter);\n\t}\n\n\tpublic setSamplerStateAt(sampler:number, wrap:string, filter:string, mipfilter:string):void\n\t{\n\t\tif (0 <= sampler && sampler < ContextWebGL.MAX_SAMPLERS) {\n\t\t\tthis._samplerStates[sampler].wrap = this._wrapDictionary[wrap];\n\t\t\tthis._samplerStates[sampler].filter = this._filterDictionary[filter];\n\t\t\tthis._samplerStates[sampler].mipfilter = this._mipmapFilterDictionary[filter][mipfilter];\n\t\t} else {\n\t\t\tthrow \"Sampler is out of bounds.\";\n\t\t}\n\t}\n\n\tpublic setVertexBufferAt(index:number, buffer:VertexBufferWebGL, bufferOffset:number = 0, format:number = 4):void\n\t{\n\t\tvar location:number = this._currentProgram? this._currentProgram.getAttribLocation(index) : -1;\n\n\t\tif (!buffer) {\n\t\t\tif (location > -1)\n\t\t\t\tthis._gl.disableVertexAttribArray(location);\n\n\t\t\treturn;\n\t\t}\n\n\t\t//buffer may not have changed if concatenated buffers are being used\n\t\tif (this._currentArrayBuffer != buffer) {\n\t\t\tthis._currentArrayBuffer = buffer;\n\t\t\tthis._gl.bindBuffer(this._gl.ARRAY_BUFFER, buffer? buffer.glBuffer : null);\n\t\t}\n\n\t\tvar properties:VertexBufferProperties = this._vertexBufferPropertiesDictionary[format];\n\n\t\tthis._gl.enableVertexAttribArray(location);\n\t\tthis._gl.vertexAttribPointer(location, properties.size, properties.type, properties.normalized, buffer.dataPerVertex, bufferOffset);\n\t}\n\n\tpublic setRenderToTexture(target:TextureBaseWebGL, enableDepthAndStencil:boolean = false, antiAlias:number = 0, surfaceSelector:number = 0):void\n\t{\n\t\tvar texture:TextureWebGL = <TextureWebGL> target;\n\t\tvar frameBuffer:WebGLFramebuffer = texture.frameBuffer;\n\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, frameBuffer);\n\n\t\tif (enableDepthAndStencil) {\n\t\t\tthis._gl.enable(this._gl.STENCIL_TEST);\n\t\t\tthis._gl.enable(this._gl.DEPTH_TEST);\n\t\t}\n\n\t\tthis._gl.viewport(0, 0, texture.width, texture.height );\n\t}\n\n\tpublic setRenderToBackBuffer():void\n\t{\n\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n\t}\n\n\tprivate updateBlendStatus():void\n\t{\n\t\tif (this._blendEnabled) {\n\t\t\tthis._gl.enable(this._gl.BLEND);\n\t\t\tthis._gl.blendEquation(this._gl.FUNC_ADD);\n\t\t\tthis._gl.blendFunc(this._blendSourceFactor, this._blendDestinationFactor);\n\t\t} else {\n\t\t\tthis._gl.disable(this._gl.BLEND);\n\t\t}\n\t}\n\n    private translateTriangleFace(triangleFace:string, coordinateSystem:string)\n    {\n        switch (triangleFace) {\n            case ContextGLTriangleFace.BACK:\n                return (coordinateSystem == \"leftHanded\")? this._gl.FRONT : this._gl.BACK;\n            case ContextGLTriangleFace.FRONT:\n                return (coordinateSystem == \"leftHanded\")? this._gl.BACK : this._gl.FRONT;\n            case ContextGLTriangleFace.FRONT_AND_BACK:\n                return this._gl.FRONT_AND_BACK;\n            default:\n                throw \"Unknown ContextGLTriangleFace type.\"; // TODO error\n        }\n    }\n}\n\n\nexport class VertexBufferProperties\n{\n\tpublic size:number;\n\n\tpublic type:number;\n\n\tpublic normalized:boolean;\n\n\tconstructor(size:number, type:number, normalized:boolean)\n\t{\n\t\tthis.size = size;\n\t\tthis.type = type;\n\t\tthis.normalized = normalized;\n\t}\n}",
    "import {ByteArray}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\nimport {ByteArrayBase}\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArrayBase\";\n\nimport {ContextStage3D}\t\t\t\tfrom \"../base/ContextStage3D\";\nimport {ICubeTexture}\t\t\t\t\tfrom \"../base/ICubeTexture\";\nimport {OpCodes}\t\t\t\t\t\tfrom \"../base/OpCodes\";\nimport {ResourceBaseFlash}\t\t\tfrom \"../base/ResourceBaseFlash\";\n\nexport class CubeTextureFlash extends ResourceBaseFlash implements ICubeTexture\n{\n\tprivate _context:ContextStage3D;\n\tprivate _size:number;\n\n\tpublic get size():number\n\t{\n\t\treturn this._size;\n\t}\n\n\tconstructor(context:ContextStage3D, size:number, format:string, forRTT:boolean, streaming:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._size = size;\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initCubeTexture, (forRTT? OpCodes.trueValue : OpCodes.falseValue)) + size + \",\" + streaming + \",\" + format + \"$\");\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeCubeTexture) + this._pId.toString() + \",\");\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n\n\tpublic uploadFromData(image:HTMLImageElement, side:number, miplevel?:number);\n\tpublic uploadFromData(imageData:ImageData, side:number, miplevel?:number);\n\tpublic uploadFromData(data:any, side:number, miplevel:number = 0):void\n\t{\n\t\tif (data instanceof HTMLImageElement) {\n\t\t\tvar can = document.createElement(\"canvas\");\n\t\t\tvar w = data.width;\n\t\t\tvar h = data.height;\n\t\t\tcan.width = w;\n\t\t\tcan.height = h;\n\t\t\tvar ctx = can.getContext(\"2d\");\n\t\t\tctx.drawImage(data, 0, 0);\n\t\t\tdata = ctx.getImageData(0, 0, w, h).data;\n\t\t}\n\n\t\tvar pos = 0;\n\t\tvar bytes = ByteArrayBase.internalGetBase64String(data.length, function () {\n\t\t\treturn data[pos++];\n\t\t}, null);\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadBytesCubeTexture) + this._pId + \",\" + miplevel + \",\" + side + \",\" + (this.size >> miplevel) + \",\" + bytes + \"%\");\n\t\tthis._context.execute();\n\t}\n\n\tpublic uploadCompressedTextureFromByteArray(data:ByteArray, byteArrayOffset:number /*uint*/, async:boolean = false):void\n\t{\n\n\t}\n}",
    "import {ByteArray}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nimport {ICubeTexture}\t\t\t\t\tfrom \"../base/ICubeTexture\";\nimport {TextureBaseWebGL}\t\t\t\tfrom \"../base/TextureBaseWebGL\";\n\nexport class CubeTextureWebGL extends TextureBaseWebGL implements ICubeTexture\n{\n\n\tprivate _textureSelectorDictionary:Array<number> = new Array<number>(6);\n\n\tpublic textureType:string = \"textureCube\";\n\tprivate _texture:WebGLTexture;\n\tprivate _size:number;\n\n\tconstructor(gl:WebGLRenderingContext, size:number)\n\t{\n\t\tsuper(gl);\n\t\tthis._size = size;\n\t\tthis._texture = this._gl.createTexture();\n\n\t\tthis._textureSelectorDictionary[0] = gl.TEXTURE_CUBE_MAP_POSITIVE_X;\n\t\tthis._textureSelectorDictionary[1] = gl.TEXTURE_CUBE_MAP_NEGATIVE_X;\n\t\tthis._textureSelectorDictionary[2] = gl.TEXTURE_CUBE_MAP_POSITIVE_Y;\n\t\tthis._textureSelectorDictionary[3] = gl.TEXTURE_CUBE_MAP_NEGATIVE_Y;\n\t\tthis._textureSelectorDictionary[4] = gl.TEXTURE_CUBE_MAP_POSITIVE_Z;\n\t\tthis._textureSelectorDictionary[5] = gl.TEXTURE_CUBE_MAP_NEGATIVE_Z;\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._gl.deleteTexture(this._texture);\n\t}\n\n\tpublic uploadFromData(image:HTMLImageElement, side:number, miplevel?:number);\n\tpublic uploadFromData(imageData:ImageData, side:number, miplevel?:number);\n\tpublic uploadFromData(data:any, side:number, miplevel:number = 0):void\n\t{\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP, this._texture);\n\t\tthis._gl.texImage2D(this._textureSelectorDictionary[side], miplevel, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, data);\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_CUBE_MAP, null);\n\t}\n\n\tpublic uploadCompressedTextureFromByteArray(data:ByteArray, byteArrayOffset:number /*uint*/, async:boolean = false):void\n\t{\n\n\t}\n\n\tpublic get size():number\n\t{\n\t\treturn this._size;\n\t}\n\n\tpublic get glTexture():WebGLTexture\n\t{\n\t\treturn this._texture;\n\t}\n}",
    "import {ContextStage3D}\t\t\t\tfrom \"../base/ContextStage3D\";\nimport {IIndexBuffer}\t\t\t\t\tfrom \"../base/IIndexBuffer\";\nimport {OpCodes}\t\t\t\t\t\tfrom \"../base/OpCodes\";\nimport {ResourceBaseFlash}\t\t\tfrom \"../base/ResourceBaseFlash\";\n\nexport class IndexBufferFlash extends ResourceBaseFlash implements IIndexBuffer\n{\n\tprivate _context:ContextStage3D;\n\tprivate _numIndices:number;\n\n\tconstructor(context:ContextStage3D, numIndices:number)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._numIndices = numIndices;\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initIndexBuffer, numIndices + OpCodes.intMask));\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\tpublic uploadFromArray(data:number[], startOffset:number, count:number):void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadArrayIndexBuffer, this._pId + OpCodes.intMask) + data.join() + \"#\" + startOffset + \",\" + count + \",\");\n\t\tthis._context.execute();\n\t}\n\n\tpublic uploadFromByteArray(data:ArrayBuffer, startOffset:number, count:number):void\n\t{\n\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeIndexBuffer, this._pId + OpCodes.intMask));\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n\n\tpublic get numIndices():number\n\t{\n\t\treturn this._numIndices;\n\t}\n}",
    "import {IIndexBuffer}\t\t\t\t\tfrom \"../base/IIndexBuffer\";\n\nexport class IndexBufferSoftware implements IIndexBuffer\n{\n\tprivate _numIndices:number;\n\tprivate _data:Uint16Array;\n\tprivate _startOffset:number;\n\n\tconstructor(numIndices:number)\n\t{\n\t\tthis._numIndices = numIndices;\n\t}\n\n\tpublic uploadFromArray(data:number[], startOffset:number, count:number):void\n\t{\n\t\tthis._startOffset = startOffset*2;\n\t\tthis._data = new Uint16Array(data);\n\t}\n\n\tpublic uploadFromByteArray(data:ArrayBuffer, startOffset:number, count:number):void\n\t{\n\t\tthis._startOffset = startOffset*2;\n\t\tthis._data = new Uint16Array(data);\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._data = null;\n\t}\n\n\tpublic get numIndices():number\n\t{\n\t\treturn this._numIndices;\n\t}\n\n\tpublic get data():Uint16Array\n\t{\n\t\treturn this._data;\n\t}\n\n\tpublic get startOffset():number\n\t{\n\t\treturn this._startOffset;\n\t}\n\n}",
    "import {IIndexBuffer}\t\t\t\t\tfrom \"../base/IIndexBuffer\";\n\nexport class IndexBufferWebGL implements IIndexBuffer\n{\n\n\tprivate _gl:WebGLRenderingContext;\n\tprivate _numIndices:number;\n\tprivate _buffer:WebGLBuffer;\n\n\tconstructor(gl:WebGLRenderingContext, numIndices:number)\n\t{\n\t\tthis._gl = gl;\n\t\tthis._buffer = this._gl.createBuffer();\n\t\tthis._numIndices = numIndices;\n\t}\n\n\tpublic uploadFromArray(data:number[], startOffset:number, count:number):void\n\t{\n\t\tthis._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this._buffer);\n\n\t\tif (startOffset)\n\t\t\tthis._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER, startOffset*2, new Uint16Array(data));\n\t\telse\n\t\t\tthis._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(data), this._gl.STATIC_DRAW);\n\t}\n\n\tpublic uploadFromByteArray(data:ArrayBuffer, startOffset:number, count:number):void\n\t{\n\t\tthis._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this._buffer);\n\n\t\tif (startOffset)\n\t\t\tthis._gl.bufferSubData(this._gl.ELEMENT_ARRAY_BUFFER, startOffset*2, data);\n\t\telse\n\t\t\tthis._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, data, this._gl.STATIC_DRAW);\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._gl.deleteBuffer(this._buffer);\n\t}\n\n\tpublic get numIndices():number\n\t{\n\t\treturn this._numIndices;\n\t}\n\n\tpublic get glBuffer():WebGLBuffer\n\t{\n\t\treturn this._buffer;\n\t}\n}",
    "export class OpCodes\n{\n\tpublic static trueValue:number = 32;\n\tpublic static falseValue:number = 33;\n\tpublic static intMask:number = 63;\n\tpublic static drawTriangles:number = 41;\n\tpublic static setProgramConstant:number = 42;\n\tpublic static setProgram:number = 43;\n\tpublic static present:number = 44;\n\tpublic static clear:number = 45;\n\tpublic static initProgram:number = 46;\n\tpublic static initVertexBuffer:number = 47;\n\tpublic static initIndexBuffer:number = 48;\n\tpublic static configureBackBuffer:number = 49;\n\tpublic static uploadArrayIndexBuffer:number = 50;\n\tpublic static uploadArrayVertexBuffer:number = 51;\n\tpublic static uploadAGALBytesProgram:number = 52;\n\tpublic static setVertexBufferAt:number = 53;\n\tpublic static uploadBytesIndexBuffer:number = 54;\n\tpublic static uploadBytesVertexBuffer:number = 55;\n\tpublic static setColorMask:number = 56;\n\tpublic static setDepthTest:number = 57;\n\tpublic static disposeProgram:number = 58;\n\tpublic static disposeContext:number = 59;\n\t// must skip 60 '<' as it will invalidate xml being passed over the bridge\n\tpublic static disposeVertexBuffer:number = 61;\n\t// must skip 62 '>' as it will invalidate xml being passed over the bridge\n\tpublic static disposeIndexBuffer:number = 63;\n\tpublic static initTexture:number = 64;\n\tpublic static setTextureAt:number = 65;\n\tpublic static uploadBytesTexture:number = 66;\n\tpublic static disposeTexture:number = 67;\n\tpublic static setCulling:number = 68;\n\tpublic static setScissorRect:number = 69;\n\tpublic static clearScissorRect:number = 70;\n\tpublic static setBlendFactors:number = 71;\n\tpublic static setRenderToTexture:number = 72;\n\tpublic static clearTextureAt:number = 73;\n\tpublic static clearVertexBufferAt:number = 74;\n\tpublic static setStencilActions:number = 75;\n\tpublic static setStencilReferenceValue:number = 76;\n\tpublic static initCubeTexture:number = 77;\n\tpublic static disposeCubeTexture:number = 78;\n\tpublic static uploadBytesCubeTexture:number = 79;\n\tpublic static clearRenderToTexture:number = 80;\n\tpublic static enableErrorChecking:number = 81;\n}",
    "import {ByteArray}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nimport {ContextStage3D}\t\t\t\tfrom \"../base/ContextStage3D\";\nimport {IProgram}\t\t\t\t\t\tfrom \"../base/IProgram\";\nimport {OpCodes}\t\t\t\t\t\tfrom \"../base/OpCodes\";\nimport {ResourceBaseFlash}\t\t\tfrom \"../base/ResourceBaseFlash\";\n\nexport class ProgramFlash extends ResourceBaseFlash implements IProgram\n{\n\tprivate _context:ContextStage3D;\n\n\tconstructor(context:ContextStage3D)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initProgram));\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic upload(vertexProgram:ByteArray, fragmentProgram:ByteArray):void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadAGALBytesProgram, this._pId + OpCodes.intMask) + vertexProgram.readBase64String(vertexProgram.length) + \"%\" + fragmentProgram.readBase64String(fragmentProgram.length) + \"%\");\n\n\t\tif (ContextStage3D.debug)\n\t\t\tthis._context.execute();\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeProgram, this._pId + OpCodes.intMask));\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n}",
    "import {Matrix3D}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Matrix3D\";\nimport {Vector3D}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Vector3D\";\nimport {ByteArray}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nimport {AGALTokenizer}\t\t\t\tfrom \"../aglsl/AGALTokenizer\";\nimport {IProgram}\t\t\t\t\t\tfrom \"../base/IProgram\";\nimport {ProgramVOSoftware}\t\t\tfrom \"../base/ProgramVOSoftware\";\nimport {ContextSoftware}\t\t\t\tfrom \"../base/ContextSoftware\";\nimport {Description}\t\t\t\t\tfrom \"../aglsl/Description\";\nimport {Token}\t\t\t\t\t\tfrom \"../aglsl/Token\";\nimport {Destination}\t\t\t\t\tfrom \"../aglsl/Destination\";\nimport {VertexBufferSoftware}\t\t\tfrom \"../base/VertexBufferSoftware\";\nimport {ContextGLVertexBufferFormat}\tfrom \"../base/ContextGLVertexBufferFormat\";\nimport {TextureSoftware}\t\t\t\tfrom \"../base/TextureSoftware\";\nimport {SoftwareSamplerState}\t\t\tfrom \"../base/SoftwareSamplerState\";\nimport {ContextGLTextureFilter}\t\tfrom \"../base/ContextGLTextureFilter\";\nimport {ContextGLMipFilter}\t\t\tfrom \"../base/ContextGLMipFilter\";\nimport {ContextGLWrapMode}\t\t\tfrom \"../base/ContextGLWrapMode\";\n\nexport class ProgramSoftware implements IProgram\n{\n\tprivate static _defaultSamplerState:SoftwareSamplerState = new SoftwareSamplerState();\n\tprivate static _tokenizer:AGALTokenizer = new AGALTokenizer();\n\tprivate static _opCodeFunc:{(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void}[] = [\n\t\tProgramSoftware.mov,\n\t\tProgramSoftware.add,\n\t\tProgramSoftware.sub,\n\t\tProgramSoftware.mul,\n\t\tProgramSoftware.div,\n\t\tProgramSoftware.rcp,\n\t\tProgramSoftware.min,\n\t\tProgramSoftware.max,\n\t\tProgramSoftware.frc,\n\t\tProgramSoftware.sqt,\n\t\tProgramSoftware.rsq,\n\t\tProgramSoftware.pow,\n\t\tProgramSoftware.log,\n\t\tProgramSoftware.exp,\n\t\tProgramSoftware.nrm,\n\t\tProgramSoftware.sin,\n\t\tProgramSoftware.cos,\n\t\tProgramSoftware.crs,\n\t\tProgramSoftware.dp3,\n\t\tProgramSoftware.dp4,\n\t\tProgramSoftware.abs,\n\t\tProgramSoftware.neg,\n\t\tProgramSoftware.sat,\n\t\tProgramSoftware.m33,\n\t\tProgramSoftware.m44,\n\t\tProgramSoftware.m34,//25\n\t\tnull,//26\n\t\tnull,//27\n\t\tnull,//28\n\t\tnull,//29\n\t\tnull,//30\n\t\tnull,//31\n\t\tnull,//32\n\t\tnull,//33\n\t\tnull,//34\n\t\tnull,//35\n\t\tnull,//36\n\t\tnull,//37\n\t\tnull,//38\n\t\tProgramSoftware.kil,\n\t\tProgramSoftware.tex,\n\t\tProgramSoftware.sge,\n\t\tProgramSoftware.slt,\n\t\tProgramSoftware.sgn,\n\t\tProgramSoftware.seq,\n\t\tProgramSoftware.sne\n\t];\n\n\tprivate _vertexDescr:Description;\n\tprivate _vertexVO:ProgramVOSoftware;\n\tprivate _numVarying:number = 0;\n\n\tprivate _fragmentDescr:Description;\n\tprivate _fragmentVO:ProgramVOSoftware;\n\n\tpublic get numVarying():number\n\t{\n\t\treturn this._numVarying;\n\t}\n\n\tpublic upload(vertexProgram:ByteArray, fragmentProgram:ByteArray):void\n\t{\n\t\tthis._vertexDescr = ProgramSoftware._tokenizer.decribeAGALByteArray(vertexProgram);\n\t\tthis._vertexVO = new ProgramVOSoftware();\n\n\t\tthis._vertexVO.temp = new Float32Array(this._vertexDescr.regwrite[0x2].length*4);\n\t\tthis._vertexVO.attributes = new Float32Array(this._vertexDescr.regread[0x0].length*4);\n\t\tthis._numVarying = this._vertexDescr.regwrite[0x4].length;\n\n\t\tthis._fragmentDescr = ProgramSoftware._tokenizer.decribeAGALByteArray(fragmentProgram);\n\t\tthis._fragmentVO = new ProgramVOSoftware();\n\t\t\n\t\tthis._fragmentVO.temp = new Float32Array(this._fragmentDescr.regwrite[0x2].length*4);\n\t\tthis._fragmentVO.varying = new Float32Array(this._fragmentDescr.regread[0x4].length*4);\n\t\tthis._fragmentVO.derivativeX = new Float32Array(this._fragmentVO.varying.length);\n\t\tthis._fragmentVO.derivativeY = new Float32Array(this._fragmentVO.varying.length);\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._vertexDescr = null;\n\t\tthis._fragmentDescr = null;\n\t}\n\n\tpublic vertex(context:ContextSoftware, vertexIndex:number, position:Float32Array, varying:Float32Array):void\n\t{\n\t\t//set attributes\n\t\tvar i:number;\n\t\tvar j:number = 0;\n\t\tvar numAttributes:number = this._vertexDescr.regread[0x0].length;\n\t\tvar attributes:Float32Array = this._vertexVO.attributes;\n\t\tfor (i = 0; i < numAttributes; i++) {\n\t\t\tvar buffer:VertexBufferSoftware = context._vertexBuffers[i];\n\n\t\t\tif (!buffer)\n\t\t\t\tcontinue;\n\n\t\t\tvar index:number = context._vertexBufferOffsets[i]/4 + vertexIndex*buffer.attributesPerVertex;\n\t\t\tif (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat.UNSIGNED_BYTE_4) {\n\t\t\t\tattributes[j++] = buffer.uintData[index*4];\n\t\t\t\tattributes[j++] = buffer.uintData[index*4+1];\n\t\t\t\tattributes[j++] = buffer.uintData[index*4+2];\n\t\t\t\tattributes[j++] = buffer.uintData[index*4+3];\n\t\t\t} else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat.FLOAT_4) {\n\t\t\t\tattributes[j++] = buffer.data[index];\n\t\t\t\tattributes[j++] = buffer.data[index + 1];\n\t\t\t\tattributes[j++] = buffer.data[index + 2];\n\t\t\t\tattributes[j++] = buffer.data[index + 3];\n\t\t\t} else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat.FLOAT_3) {\n\t\t\t\tattributes[j++] = buffer.data[index];\n\t\t\t\tattributes[j++] = buffer.data[index + 1];\n\t\t\t\tattributes[j++] = buffer.data[index + 2];\n\t\t\t\tattributes[j++] = 1;\n\t\t\t} else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat.FLOAT_2) {\n\t\t\t\tattributes[j++] = buffer.data[index];\n\t\t\t\tattributes[j++] = buffer.data[index + 1];\n\t\t\t\tattributes[j++] = 0;\n\t\t\t\tattributes[j++] = 1\n\t\t\t} else if (context._vertexBufferFormats[i] == ContextGLVertexBufferFormat.FLOAT_1) {\n\t\t\t\tattributes[j++] = buffer.data[index];\n\t\t\t\tattributes[j++] = 0;\n\t\t\t\tattributes[j++] = 0;\n\t\t\t\tattributes[j++] = 1;\n\t\t\t}\n\t\t}\n\n\t\t//clear temps\n\t\tvar temp:Float32Array = this._vertexVO.temp;\n\t\tvar numTemp:number = temp.length;\n\t\tfor (var i:number = 0; i < numTemp; i+=4) {\n\t\t\ttemp[i] = 0;\n\t\t\ttemp[i + 1] = 0;\n\t\t\ttemp[i + 2] = 0;\n\t\t\ttemp[i + 3] = 1;\n\t\t}\n\n\t\tthis._vertexVO.outputPosition = position;\n\t\t\n\t\tthis._vertexVO.varying = varying;\n\n\t\tvar len:number = this._vertexDescr.tokens.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tvar token:Token = this._vertexDescr.tokens[i];\n\t\t\tProgramSoftware._opCodeFunc[token.opcode](this._vertexVO, this._vertexDescr, token.dest, token.a, token.b, context);\n\t\t}\n\t}\n\n\tpublic fragment(context:ContextSoftware, clip:Vector3D, clipRight:Vector3D, clipBottom:Vector3D, varying0:Float32Array, varying1:Float32Array, varying2:Float32Array, fragDepth:number):ProgramVOSoftware\n\t{\n\t\tthis._fragmentVO.outputDepth = fragDepth;\n\n\t\t//clear temps\n\t\tvar temp:Float32Array = this._fragmentVO.temp;\n\t\tvar numTemp:number = temp.length;\n\t\tfor (var i:number = 0; i < numTemp; i+=4) {\n\t\t\ttemp[i] = 0;\n\t\t\ttemp[i + 1] = 0;\n\t\t\ttemp[i + 2] = 0;\n\t\t\ttemp[i + 3] = 1;\n\t\t}\n\n\t\t//check for requirement of derivatives\n\t\tvar varyingDerivatives:number[] = [];\n\t\tvar len:number = this._fragmentDescr.tokens.length;\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tvar token:Token = this._fragmentDescr.tokens[i];\n\t\t\tif (token.opcode == 0x28 && context._samplerStates[token.b.regnum] && context._samplerStates[token.b.regnum].mipfilter == ContextGLMipFilter.MIPLINEAR && context._textures[token.b.regnum].getMipLevelsCount() > 1)\n\t\t\t\tvaryingDerivatives.push(token.a.regnum);\n\t\t}\n\n\t\tvar derivativeX:Float32Array = this._fragmentVO.derivativeX;\n\t\tvar derivativeY:Float32Array = this._fragmentVO.derivativeY;\n\n\t\tvar varying:Float32Array = this._fragmentVO.varying;\n\t\tvar numVarying:number = varying.length;\n\t\tfor (var i:number = 0; i < numVarying; i+=4) {\n\t\t\t\n\t\t\t// if (!varying0 || !varying1 || !varying2) continue;\n\t\t\t\n\t\t\tvarying[i] = clip.x*varying0[i] + clip.y*varying1[i] + clip.z*varying2[i];\n\t\t\tvarying[i+1] = clip.x*varying0[i+1] + clip.y*varying1[i+1] + clip.z*varying2[i+1];\n\t\t\tvarying[i+2] = clip.x*varying0[i+2] + clip.y*varying1[i+2] + clip.z*varying2[i+2];\n\t\t\tvarying[i+3] = clip.x*varying0[i+3] + clip.y*varying1[i+3] + clip.z*varying2[i+3];\n\n\t\t\tif (varyingDerivatives.indexOf(i) == -1)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tderivativeX[i] = clipRight.x*varying0[i] + clipRight.y*varying1[i] + clipRight.z*varying2[i];\n\t\t\tderivativeX[i+1] = clipRight.x*varying0[i+1] + clipRight.y*varying1[i+1] + clipRight.z*varying2[i+1];\n\t\t\tderivativeX[i+2] = clipRight.x*varying0[i+2] + clipRight.y*varying1[i+2] + clipRight.z*varying2[i+2];\n\t\t\tderivativeX[i+3] = clipRight.x*varying0[i+3] + clipRight.y*varying1[i+3] + clipRight.z*varying2[i+3];\n\t\t\tderivativeX[i] -= varying[i];\n\t\t\tderivativeX[i+1] -= varying[i+1];\n\t\t\tderivativeX[i+2] -= varying[i+2];\n\t\t\tderivativeX[i+3] -= varying[i+3];\n\t\t\t\n\t\t\tderivativeY[i] = clipBottom.x*varying0[i] + clipBottom.y*varying1[i] + clipBottom.z*varying2[i];\n\t\t\tderivativeY[i+1] = clipBottom.x*varying0[i+1] + clipBottom.y*varying1[i+1] + clipBottom.z*varying2[i+1];\n\t\t\tderivativeY[i+2] = clipBottom.x*varying0[i+2] + clipBottom.y*varying1[i+2] + clipBottom.z*varying2[i+2];\n\t\t\tderivativeY[i+3] = clipBottom.x*varying0[i+3] + clipBottom.y*varying1[i+3] + clipBottom.z*varying2[i+3];\n\t\t\tderivativeY[i] -= varying[i];\n\t\t\tderivativeY[i+1] -= varying[i+1];\n\t\t\tderivativeY[i+2] -= varying[i+2];\n\t\t\tderivativeY[i+3] -= varying[i+3];\n\t\t}\n\n\t\tfor (var i:number = 0; i < len; i++) {\n\t\t\tvar token:Token = this._fragmentDescr.tokens[i];\n\t\t\tProgramSoftware._opCodeFunc[token.opcode](this._fragmentVO, this._fragmentDescr, token.dest, token.a, token.b, context);\n\t\t}\n\n\t\treturn this._fragmentVO;\n\t}\n\n\tprivate static getDestTarget(vo:ProgramVOSoftware, desc:Description, dest:Destination):Float32Array\n\t{\n\t\tvar target:Float32Array;\n\n\t\tif (dest.regtype == 0x2) {\n\t\t\ttarget = vo.temp;\n\t\t} else if (dest.regtype == 0x3) {\n\n\t\t\tif (desc.header.type == \"vertex\") {\n\t\t\t\ttarget = vo.outputPosition;\n\t\t\t} else {\n\t\t\t\ttarget = vo.outputColor;\n\t\t\t}\n\t\t} else if (dest.regtype == 0x4) {\n\t\t\ttarget = vo.varying;\n\t\t}\n\t\t\n\t\treturn target;\n\t}\n\n\tprivate static getSourceTarget(vo:ProgramVOSoftware, desc:Description, dest:Destination, context:ContextSoftware):Float32Array\n\t{\n\t\tvar target:Float32Array;\n\n\t\tif (dest.regtype == 0x0) {\n\t\t\ttarget = vo.attributes;\n\t\t} else if (dest.regtype == 0x1) {\n\t\t\tif (desc.header.type == \"vertex\") {\n\t\t\t\ttarget = context._vertexConstants;\n\t\t\t} else {\n\t\t\t\ttarget = context._fragmentConstants;\n\t\t\t}\n\t\t} else if (dest.regtype == 0x2) {\n\t\t\ttarget = vo.temp;\n\t\t} else if (dest.regtype == 0x4) {\n\t\t\ttarget = vo.varying;\n\t\t}\n\n\t\treturn target;\n\t}\n\n\tpublic static mov(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\t\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1.swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1.swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1.swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1.swizzle >> 6) & 3)];\n\t}\n\n\tpublic static m44(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\t\n\t\tvar mask:number = dest.mask;\n\t\t\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg]*source2Target[source2Reg] + source1Target[source1Reg + 1]*source2Target[source2Reg + 1] + source1Target[source1Reg + 2]*source2Target[source2Reg + 2] + source2Target[source2Reg + 3];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg]*source2Target[source2Reg + 4] + source1Target[source1Reg + 1]*source2Target[source2Reg + 5] + source1Target[source1Reg + 2]*source2Target[source2Reg + 6] + source2Target[source2Reg + 7];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg]*source2Target[source2Reg + 8] + source1Target[source1Reg + 1]*source2Target[source2Reg + 9] + source1Target[source1Reg + 2]*source2Target[source2Reg + 10] + source2Target[source2Reg + 11];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg]*source2Target[source2Reg + 12] + source1Target[source1Reg + 1]*source2Target[source2Reg + 13] + source1Target[source1Reg + 2]*source2Target[source2Reg + 14] + source2Target[source2Reg + 15];\n\t}\n\n\tprivate static sample(vo:ProgramVOSoftware, desc:Description, context:ContextSoftware, source1:Destination, textureIndex:number):Float32Array\n\t{\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\t\n\t\tvar u:number = source1Target[((source1.swizzle >> 0) & 3)];\n\t\tvar v:number = source1Target[((source1.swizzle >> 2) & 3)];\n\t\t\n\t\tif (textureIndex >= context._textures.length || context._textures[textureIndex] == null)\n\t\t\treturn new Float32Array([1, u, v, 0]);\n\n\t\tvar texture:TextureSoftware = context._textures[textureIndex];\n\t\tvar state:SoftwareSamplerState = context._samplerStates[textureIndex] || this._defaultSamplerState;\n\t\t\n\t\tvar repeat:boolean = state.wrap == ContextGLWrapMode.REPEAT;\n\t\tvar mipmap:boolean = state.mipfilter == ContextGLMipFilter.MIPLINEAR;\n\t\tif (mipmap && texture.getMipLevelsCount() > 1) {\n\t\t\tvar dux:number = Math.abs(vo.derivativeX[source1Reg + ((source1.swizzle >> 0) & 3)]);\n\t\t\tvar dvx:number = Math.abs(vo.derivativeX[source1Reg + ((source1.swizzle >> 2) & 3)]);\n\t\t\tvar duy:number = Math.abs(vo.derivativeY[source1Reg + ((source1.swizzle >> 0) & 3)]);\n\t\t\tvar dvy:number = Math.abs(vo.derivativeY[source1Reg + ((source1.swizzle >> 2) & 3)]);\n\n\t\t\tvar lambda:number = Math.log(Math.max(texture.width * Math.sqrt(dux * dux + dvx * dvx), texture.height * Math.sqrt(duy * duy + dvy * dvy))) / Math.LN2;\n\t\t\tif (lambda > 0) {\n\n\t\t\t\tvar miplevelLow:number = Math.floor(lambda);\n\t\t\t\tvar miplevelHigh:number = Math.ceil(lambda);\n\n\t\t\t\tvar maxmiplevel:number = Math.log(Math.min(texture.width, texture.height)) / Math.LN2;\n\n\t\t\t\tif (miplevelHigh > maxmiplevel)\n\t\t\t\t\tmiplevelHigh = maxmiplevel;\n\n\t\t\t\tif (miplevelLow > maxmiplevel)\n\t\t\t\t\tmiplevelLow = maxmiplevel;\n\n\t\t\t\tvar mipblend:number = lambda - Math.floor(lambda);\n\n\t\t\t\tvar resultLow:Float32Array;\n\t\t\t\tvar resultHigh:Float32Array;\n\n\n\t\t\t\tvar dataLow:number[] = texture.getData(miplevelLow);\n\t\t\t\tvar dataLowWidth:number = texture.width / Math.pow(2, miplevelLow);\n\t\t\t\tvar dataLowHeight:number = texture.height / Math.pow(2, miplevelLow);\n\t\t\t\tvar dataHigh:number[] = texture.getData(miplevelHigh);\n\t\t\t\tvar dataHighWidth:number = texture.width / Math.pow(2, miplevelHigh);\n\t\t\t\tvar dataHighHeight:number = texture.height / Math.pow(2, miplevelHigh);\n\n\t\t\t\tif (state.filter == ContextGLTextureFilter.LINEAR) {\n\t\t\t\t\tresultLow = ProgramSoftware.sampleBilinear(u, v, dataLow, dataLowWidth, dataLowHeight, repeat);\n\t\t\t\t\tresultHigh = ProgramSoftware.sampleBilinear(u, v, dataHigh, dataHighWidth, dataHighHeight, repeat);\n\t\t\t\t} else {\n\t\t\t\t\tresultLow = ProgramSoftware.sampleNearest(u, v, dataLow, dataLowWidth, dataLowHeight, repeat);\n\t\t\t\t\tresultHigh = ProgramSoftware.sampleNearest(u, v, dataHigh, dataHighWidth, dataHighHeight, repeat);\n\t\t\t\t}\n\n\t\t\t\treturn ProgramSoftware.interpolateColor(resultLow, resultHigh, mipblend);\n\t\t\t}\n\t\t}\n\n\t\tvar result:Float32Array;\n\t\tvar data:number[] = texture.getData(0);\n\t\tif (state.filter == ContextGLTextureFilter.LINEAR) {\n\t\t\tresult = ProgramSoftware.sampleBilinear(u, v, data, texture.width, texture.height, repeat);\n\t\t} else {\n\t\t\tresult = ProgramSoftware.sampleNearest(u, v, data, texture.width, texture.height, repeat);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate static sampleNearest(u:number, v:number, textureData:number[], textureWidth:number, textureHeight:number, repeat:boolean):Float32Array\n\t{\n\t\tu *= textureWidth;\n\t\tv *= textureHeight;\n\n\t\tif (repeat) {\n\t\t\tu = Math.abs(u % textureWidth);\n\t\t\tv = Math.abs(v % textureHeight);\n\t\t} else {\n\t\t\tif (u < 0)\n\t\t\t\tu = 0;\n\t\t\telse if (u > textureWidth - 1)\n\t\t\t\tu = textureWidth - 1;\n\n\t\t\tif (v < 0)\n\t\t\t\tv = 0;\n\t\t\telse if (v > textureHeight - 1)\n\t\t\t\tv = textureHeight - 1;\n\t\t}\n\n\t\tu = Math.floor(u);\n\t\tv = Math.floor(v);\n\n\t\tvar pos:number = (u + v*textureWidth)*4;\n\t\tvar r:number = textureData[pos]/255;\n\t\tvar g:number = textureData[pos + 1]/255;\n\t\tvar b:number = textureData[pos + 2]/255;\n\t\tvar a:number = textureData[pos + 3]/255;\n\n\t\treturn new Float32Array([a, r, g, b]);\n\t}\n\n\tprivate static sampleBilinear(u:number, v:number, textureData:number[], textureWidth:number, textureHeight:number, repeat:boolean):Float32Array\n\t{\n\t\tvar texelSizeX:number = 1/textureWidth;\n\t\tvar texelSizeY:number = 1/textureHeight;\n\t\tu -= texelSizeX/2;\n\t\tv -= texelSizeY/2;\n\n\t\tvar color00:Float32Array = ProgramSoftware.sampleNearest(u, v, textureData, textureWidth, textureHeight, repeat);\n\t\tvar color10:Float32Array = ProgramSoftware.sampleNearest(u + texelSizeX, v, textureData, textureWidth, textureHeight, repeat);\n\n\t\tvar color01:Float32Array = ProgramSoftware.sampleNearest(u, v + texelSizeY, textureData, textureWidth, textureHeight, repeat);\n\t\tvar color11:Float32Array = ProgramSoftware.sampleNearest(u + texelSizeX, v + texelSizeY, textureData, textureWidth, textureHeight, repeat);\n\n\t\tvar a:number = u*textureWidth;\n\t\ta = a - Math.floor(a);\n\n\t\tvar interColor0:Float32Array = ProgramSoftware.interpolateColor(color00, color10, a);\n\t\tvar interColor1:Float32Array = ProgramSoftware.interpolateColor(color01, color11, a);\n\n\t\tvar b:number = v*textureHeight;\n\t\tb = b - Math.floor(b);\n\t\treturn ProgramSoftware.interpolateColor(interColor0, interColor1, b);\n\t}\n\n\n\tprivate static interpolateColor(source:Float32Array, target:Float32Array, a:number):Float32Array\n\t{\n\t\tvar result:Float32Array = new Float32Array(4);\n\t\tresult[0] = source[0] + (target[0] - source[0])*a;\n\t\tresult[1] = source[1] + (target[1] - source[1])*a;\n\t\tresult[2] = source[2] + (target[2] - source[2])*a;\n\t\tresult[3] = source[3] + (target[3] - source[3])*a;\n\t\treturn result;\n\t}\n\n\tpublic static tex(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar color:Float32Array = ProgramSoftware.sample(vo, desc, context, source1, source2.regnum);\n\n\t\tvar mask:number = dest.mask;\n\t\t\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = color[1];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = color[2];\n\t\t\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = color[3];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = color[0];\n\t}\n\n\tpublic static add(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\t\t\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] + source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static sub(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] - source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static mul(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]*source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]*source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]*source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]*source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static div(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\t\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]/source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]/source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]/source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]/source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static rcp(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = 1/source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = 1/source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = 1/source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = 1/source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static min(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)], source2Target[source2Reg + ((source2Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)], source2Target[source2Reg + ((source2Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)], source2Target[source2Reg + ((source2Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.min(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)], source2Target[source2Reg + ((source2Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static max(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)], source2Target[source2Reg + ((source2Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)], source2Target[source2Reg + ((source2Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)], source2Target[source2Reg + ((source2Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.max(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)], source2Target[source2Reg + ((source2Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static frc(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\t\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)] - Math.floor(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static sqt(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static rsq(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = 1/Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = 1/Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = 1/Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = 1/Math.sqrt(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static pow(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)], source2Target[source2Reg + ((source2Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)], source2Target[source2Reg + ((source2Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)], source2Target[source2Reg + ((source2Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.pow(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)], source2Target[source2Reg + ((source2Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static log(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\t\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)])/Math.LN2;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)])/Math.LN2;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)])/Math.LN2;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.log(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)])/Math.LN2;\n\t}\n\n\tpublic static exp(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.exp(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static nrm(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\t\n\t\tvar x:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar y:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar z:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\n\t\tvar len:number = Math.sqrt(x*x + y*y + z*z);\n\t\tx /= len;\n\t\ty /= len;\n\t\tz /= len;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = x;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = y;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = z;\n\t}\n\n\tpublic static sin(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.sin(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static cos(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\t\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.cos(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static crs(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\t\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\t\t\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\tvar source2TargetX:number = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\t\tvar source2TargetY:number = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\t\tvar source2TargetZ:number = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1TargetY*source2TargetZ - source1TargetZ*source2TargetY;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1TargetZ*source2TargetX - source1TargetX*source2TargetZ;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1TargetX*source2TargetY - source1TargetY*source2TargetX;\n\t}\n\n\tpublic static dp3(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\tvar source2TargetX:number = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\t\tvar source2TargetY:number = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\t\tvar source2TargetZ:number = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ;\n\t}\n\n\tpublic static dp4(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\t\t\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\t\tvar source1TargetW:number = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\tvar source2TargetX:number = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\t\tvar source2TargetY:number = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\t\tvar source2TargetZ:number = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\t\tvar source2TargetW:number = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ + source1TargetW*source2TargetW;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ + source1TargetW*source2TargetW;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ + source1TargetW*source2TargetW;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1TargetX*source2TargetX + source1TargetY*source2TargetY + source1TargetZ*source2TargetZ + source1TargetW*source2TargetW;\n\t}\n\n\tpublic static abs(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]);\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]);\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]);\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.abs(source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]);\n\t}\n\n\tpublic static neg(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = -source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = -source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = -source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = -source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static sat(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 0) & 3)]));\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 2) & 3)]));\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 4) & 3)]));\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = Math.max(0, Math.min(1, source1Target[source1Reg + ((source1Swizzle >> 6) & 3)]));\n\t}\n\n\tpublic static m33(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\n\t\tvar mask:number = dest.mask;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg]*source2Target[source2Reg] + source1Target[source1Reg + 1]*source2Target[source2Reg + 1] + source1Target[source1Reg + 2]*source2Target[source2Reg + 2];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg]*source2Target[source2Reg + 4] + source1Target[source1Reg + 1]*source2Target[source2Reg + 5] + source1Target[source1Reg + 2]*source2Target[source2Reg + 6];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg]*source2Target[source2Reg + 8] + source1Target[source1Reg + 1]*source2Target[source2Reg + 9] + source1Target[source1Reg + 2]*source2Target[source2Reg + 10];\n\t}\n\n\tpublic static m34(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source2.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\t\n\t\tvar mask:number = dest.mask;\n\t\t\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg]*source2Target[source2Reg] + source1Target[source1Reg + 1]*source2Target[source2Reg + 1] + source1Target[source1Reg + 2]*source2Target[source2Reg + 2] + source2Target[source2Reg + 3];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg]*source2Target[source2Reg + 4] + source1Target[source1Reg + 1]*source2Target[source2Reg + 5] + source1Target[source1Reg + 2]*source2Target[source2Reg + 6] + source2Target[source2Reg + 7];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg]*source2Target[source2Reg + 8] + source1Target[source1Reg + 1]*source2Target[source2Reg + 9] + source1Target[source1Reg + 2]*source2Target[source2Reg + 10] + source2Target[source2Reg + 11];\n\t}\n\n\tpublic static ddx(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = vo.derivativeX;\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\t\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static ddy(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\tvar source1Target:Float32Array = vo.derivativeY;\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\t}\n\n\tpublic static sge(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\t\t\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\t\tvar source1TargetW:number = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\tvar source2TargetX:number = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\t\tvar source2TargetY:number = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\t\tvar source2TargetZ:number = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\t\tvar source2TargetW:number = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1TargetX >= source2TargetX ? 1 : 0;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1TargetY >= source2TargetY ? 1 : 0;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1TargetZ >= source2TargetZ ? 1 : 0;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1TargetW >= source2TargetW ? 1 : 0;\n\t}\n\n\tpublic static slt(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\t\t\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\t\tvar source1TargetW:number = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\tvar source2TargetX:number = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\t\tvar source2TargetY:number = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\t\tvar source2TargetZ:number = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\t\tvar source2TargetW:number = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1TargetX < source2TargetX ? 1 : 0;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1TargetY < source2TargetY ? 1 : 0;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1TargetZ < source2TargetZ ? 1 : 0;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1TargetW < source2TargetW ? 1 : 0;\n\t}\n\n\tpublic static seq(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\t\tvar source1TargetW:number = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\tvar source2TargetX:number = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\t\tvar source2TargetY:number = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\t\tvar source2TargetZ:number = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\t\tvar source2TargetW:number = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1TargetX == source2TargetX ? 1 : 0;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1TargetY == source2TargetY ? 1 : 0;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1TargetZ == source2TargetZ ? 1 : 0;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1TargetW == source2TargetW ? 1 : 0;\n\t}\n\n\tpublic static sne(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source2Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\tvar source2Swizzle:number = source2.swizzle;\n\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\t\tvar source1TargetW:number = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\n\t\tvar source2Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source2, context);\n\t\tvar source2TargetX:number = source2Target[source2Reg + ((source2Swizzle >> 0) & 3)];\n\t\tvar source2TargetY:number = source2Target[source2Reg + ((source2Swizzle >> 2) & 3)];\n\t\tvar source2TargetZ:number = source2Target[source2Reg + ((source2Swizzle >> 4) & 3)];\n\t\tvar source2TargetW:number = source2Target[source2Reg + ((source2Swizzle >> 6) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = source1TargetX != source2TargetX ? 1 : 0;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = source1TargetY != source2TargetY ? 1 : 0;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = source1TargetZ != source2TargetZ ? 1 : 0;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = source1TargetW != source2TargetW ? 1 : 0;\n\t}\n\n\tpublic static sgn(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar targetReg:number = 4*dest.regnum;\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\t\n\t\tvar target:Float32Array = ProgramSoftware.getDestTarget(vo, desc, dest);\n\t\t\n\t\tvar mask:number = dest.mask;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\t\tvar source1TargetY:number = source1Target[source1Reg + ((source1Swizzle >> 2) & 3)];\n\t\tvar source1TargetZ:number = source1Target[source1Reg + ((source1Swizzle >> 4) & 3)];\n\t\tvar source1TargetW:number = source1Target[source1Reg + ((source1Swizzle >> 6) & 3)];\n\n\t\tif (mask & 1)\n\t\t\ttarget[targetReg] = (source1TargetX < 0)? -1 : (source1TargetX > 0)? 1 : 0;\n\n\t\tif (mask & 2)\n\t\t\ttarget[targetReg + 1] = (source1TargetY < 0)? -1 : (source1TargetY > 0)? 1 : 0;\n\n\t\tif (mask & 4)\n\t\t\ttarget[targetReg + 2] = (source1TargetZ < 0)? -1 : (source1TargetZ > 0)? 1 : 0;\n\n\t\tif (mask & 8)\n\t\t\ttarget[targetReg + 3] = (source1TargetW < 0)? -1 : (source1TargetW > 0)? 1 : 0;\n\t}\n\n\tpublic static kil(vo:ProgramVOSoftware, desc:Description, dest:Destination, source1:Destination, source2:Destination, context:ContextSoftware):void\n\t{\n\t\tvar source1Reg:number = 4*source1.regnum;\n\t\tvar source1Swizzle:number = source1.swizzle;\n\t\t\n\t\tvar source1Target:Float32Array = ProgramSoftware.getSourceTarget(vo, desc, source1, context);\n\t\tvar source1TargetX:number = source1Target[source1Reg + ((source1Swizzle >> 0) & 3)];\n\n\t\tif(source1TargetX < 0)\n\t\t\tvo.discard = true;\n\t}\n}\n",
    "import {Vector3D}\t\t\t\t\t\tfrom \"awayjs-core/lib/geom/Vector3D\";\n\nexport class ProgramVOSoftware\n{\n\tpublic outputPosition:Float32Array;\n\tpublic outputColor:Float32Array = new Float32Array([0,0,0,1]);\n\tpublic outputDepth:number;\n\tpublic varying:Float32Array;\n\tpublic derivativeX:Float32Array;\n\tpublic derivativeY:Float32Array;\n\tpublic temp:Float32Array;\n\tpublic attributes:Float32Array;\n\tpublic discard:boolean = false;\n}",
    "import {ByteArray}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nimport {AGALTokenizer}\t\t\t\tfrom \"../aglsl/AGALTokenizer\";\nimport {AGLSLParser}\t\t\t\t\tfrom \"../aglsl/AGLSLParser\";\nimport {IProgram}\t\t\t\t\t\tfrom \"../base/IProgram\";\nimport {VertexBufferWebGL}\t\t\tfrom \"../base/VertexBufferWebGL\";\n\nexport class ProgramWebGL implements IProgram\n{\n\tprivate static _tokenizer:AGALTokenizer = new AGALTokenizer();\n\tprivate static _aglslParser:AGLSLParser = new AGLSLParser();\n\tprivate static _uniformLocationNameDictionary:Array<string> = [\"fc\", \"fs\", \"vc\"];\n\t// private static _uniformLocationNameDictionary:Array<string> = [\"fcarrr\", \"fs\", \"vcarrr\"];\n\n\tprivate _gl:WebGLRenderingContext;\n\tprivate _program:WebGLProgram;\n\tprivate _vertexShader:WebGLShader;\n\tprivate _fragmentShader:WebGLShader;\n\tprivate _uniforms:Array<Array<WebGLUniformLocation>> = [[],[],[]];\n\tprivate _attribs:Array<number> = [];\n\n\tconstructor(gl:WebGLRenderingContext)\n\t{\n\t\tthis._gl = gl;\n\t\tthis._program = this._gl.createProgram();\n\t}\n\n\tpublic upload(vertexProgram:ByteArray, fragmentProgram:ByteArray):void\n\t{\n\t\tvar vertexString:string = ProgramWebGL._aglslParser.parse(ProgramWebGL._tokenizer.decribeAGALByteArray(vertexProgram));\n\t\tvar fragmentString:string = ProgramWebGL._aglslParser.parse(ProgramWebGL._tokenizer.decribeAGALByteArray(fragmentProgram));\n\n\t\tthis._vertexShader = this._gl.createShader(this._gl.VERTEX_SHADER);\n\t\tthis._fragmentShader = this._gl.createShader(this._gl.FRAGMENT_SHADER);\n\n\t\tthis._gl.shaderSource(this._vertexShader, vertexString);\n\t\tthis._gl.compileShader(this._vertexShader);\n\n\t\tif (!this._gl.getShaderParameter(this._vertexShader, this._gl.COMPILE_STATUS))\n\t\t\tthrow new Error(this._gl.getShaderInfoLog(this._vertexShader));\n\n\t\tthis._gl.shaderSource(this._fragmentShader, fragmentString);\n\t\tthis._gl.compileShader(this._fragmentShader);\n\n\t\tif (!this._gl.getShaderParameter(this._fragmentShader, this._gl.COMPILE_STATUS))\n\t\t\tthrow new Error(this._gl.getShaderInfoLog(this._fragmentShader));\n\n\t\tthis._gl.attachShader(this._program, this._vertexShader);\n\t\tthis._gl.attachShader(this._program, this._fragmentShader);\n\t\tthis._gl.linkProgram(this._program);\n\n\t\tif (!this._gl.getProgramParameter(this._program, this._gl.LINK_STATUS))\n\t\t\tthrow new Error(this._gl.getProgramInfoLog(this._program));\n\n\t\tthis._uniforms[0].length = 0;\n\t\tthis._uniforms[1].length = 0;\n\t\tthis._uniforms[2].length = 0;\n\t\tthis._attribs.length = 0;\n\t}\n\n\tpublic getUniformLocation(programType:number, index:number = -1):WebGLUniformLocation\n\t{\n\t\tif (this._uniforms[programType][index + 1] != null)\n\t\t\treturn this._uniforms[programType][index + 1];\n\t\n\t\tvar name:string =  (index == -1)? ProgramWebGL._uniformLocationNameDictionary[programType] : ProgramWebGL._uniformLocationNameDictionary[programType] + index;\n\t\treturn (this._uniforms[programType][index + 1] = this._gl.getUniformLocation(this._program, name));\n\t}\n\t\n\t//\n\t// public getUniformLocation(programType:number, index:number):WebGLUniformLocation\n\t// {\n\t// \tif (this._uniforms[programType][index] != null)\n\t// \t\treturn this._uniforms[programType][index];\n\t//\n\t// \treturn (this._uniforms[programType][index] = this._gl.getUniformLocation(this._program, ProgramWebGL._uniformLocationNameDictionary[programType] + index));\n\t// }\n\n\n\tpublic getAttribLocation(index:number):number\n\t{\n\t\tif (this._attribs[index] != null)\n\t\t\treturn this._attribs[index];\n\n\t\treturn (this._attribs[index] = this._gl.getAttribLocation(this._program, \"va\" + index));\n\t}\n\n\n\tpublic dispose():void\n\t{\n\t\tthis._gl.deleteProgram(this._program);\n\t}\n\n\tpublic focusProgram():void\n\t{\n\t\tthis._gl.useProgram(this._program);\n\t}\n\n\tpublic get glProgram():WebGLProgram\n\t{\n\t\treturn this._program;\n\t}\n}",
    "export class ResourceBaseFlash\n{\n\tpublic _pId:number;\n\n\tpublic get id():number\n\t{\n\t\treturn this._pId;\n\t}\n\n\tpublic dispose():void\n\t{\n\n\t}\n}",
    "export class SamplerState\n{\n\tpublic type:number;\n\tpublic wrap:number;\n\tpublic filter:number;\n\tpublic mipfilter:number;\n}",
    "import {ContextGLTextureFilter}\t\tfrom \"./ContextGLTextureFilter\";\nimport {ContextGLMipFilter}\t\t\tfrom \"./ContextGLMipFilter\";\nimport {ContextGLWrapMode}\t\t\tfrom \"./ContextGLWrapMode\";\n\n/**\n * The same as SamplerState, but with strings\n * TODO: replace two similar classes with one\n */\nexport class SoftwareSamplerState\n{\n\tpublic type:string;\n\tpublic wrap:string = ContextGLWrapMode.REPEAT;\n\tpublic filter:string = ContextGLTextureFilter.LINEAR;\n\tpublic mipfilter:string = ContextGLMipFilter.MIPLINEAR;\n}\nexport default SoftwareSamplerState;",
    "import {EventDispatcher}\t\t\t\tfrom \"awayjs-core/lib/events/EventDispatcher\";\nimport {Rectangle}\t\t\t\t\tfrom \"awayjs-core/lib/geom/Rectangle\";\nimport {ImageBase}\t\t\t\t\tfrom \"awayjs-core/lib/image/ImageBase\";\nimport {AbstractionBase}\t\t\t\tfrom \"awayjs-core/lib/library/AbstractionBase\";\nimport {IAsset}\t\t\t\t\t\tfrom \"awayjs-core/lib/library/IAsset\";\nimport {IAssetClass}\t\t\t\t\tfrom \"awayjs-core/lib/library/IAssetClass\";\nimport {IAbstractionPool}\t\t\t\tfrom \"awayjs-core/lib/library/IAbstractionPool\";\nimport {CSS}\t\t\t\t\t\t\tfrom \"awayjs-core/lib/utils/CSS\";\n\nimport {ContextMode}\t\t\t\t\tfrom \"../base/ContextMode\";\nimport {ContextGLMipFilter}\t\t\tfrom \"../base/ContextGLMipFilter\";\nimport {ContextGLTextureFilter}\t\tfrom \"../base/ContextGLTextureFilter\";\nimport {ContextGLVertexBufferFormat}\tfrom \"../base/ContextGLVertexBufferFormat\";\nimport {ContextGLWrapMode}\t\t\tfrom \"../base/ContextGLWrapMode\";\nimport {ContextWebGL}\t\t\t\t\tfrom \"../base/ContextWebGL\";\nimport {ContextStage3D}\t\t\t\tfrom \"../base/ContextStage3D\";\nimport {ContextSoftware}\t\t\t\tfrom \"../base/ContextSoftware\";\nimport {IContextGL}\t\t\t\t\tfrom \"../base/IContextGL\";\nimport {IVertexBuffer}\t\t\t\tfrom \"../base/IVertexBuffer\";\nimport {StageEvent}\t\t\t\t\tfrom \"../events/StageEvent\";\nimport {GL_ImageBase}\t\t\t\t\tfrom \"../image/GL_ImageBase\";\nimport {GL_IAssetClass}\t\t\t\tfrom \"../library/GL_IAssetClass\";\nimport {ProgramData}\t\t\t\t\tfrom \"../image/ProgramData\";\nimport {ProgramDataPool}\t\t\t\tfrom \"../image/ProgramDataPool\";\nimport {StageManager}\t\t\t\t\tfrom \"../managers/StageManager\";\n\n/**\n * Stage provides a proxy class to handle the creation and attachment of the Context\n * (and in turn the back buffer) it uses. Stage should never be created directly,\n * but requested through StageManager.\n *\n * @see away.managers.StageManager\n *\n */\nexport class Stage extends EventDispatcher implements IAbstractionPool\n{\n\tprivate static _abstractionClassPool:Object = new Object();\n\n\tprivate _abstractionPool:Object = new Object();\n\n\tprivate _programData:Array<ProgramData> = new Array<ProgramData>();\n\tprivate _programDataPool:ProgramDataPool;\n\tprivate _context:IContextGL;\n\tprivate _container:HTMLElement;\n\tprivate _width:number;\n\tprivate _height:number;\n\tprivate _x:number = 0;\n\tprivate _y:number = 0;\n\n\t//private static _frameEventDriver:Shape = new Shape(); // TODO: add frame driver/request animation frame\n\n\tprivate _stageIndex:number = -1;\n\n\tprivate _usesSoftwareRendering:boolean;\n\tprivate _profile:string;\n\tprivate _stageManager:StageManager;\n\tprivate _antiAlias:number = 0;\n\tprivate _enableDepthAndStencil:boolean;\n\tprivate _contextRequested:boolean;\n\n\t//private var _activeVertexBuffers : Vector.<VertexBuffer> = new Vector.<VertexBuffer>(8, true);\n\t//private var _activeTextures : Vector.<TextureBase> = new Vector.<TextureBase>(8, true);\n\tprivate _renderTarget:ImageBase = null;\n\tprivate _renderSurfaceSelector:number = 0;\n\tprivate _scissorRect:Rectangle;\n\tprivate _color:number;\n\tprivate _backBufferDirty:boolean;\n\tprivate _viewPort:Rectangle;\n\tprivate _viewportUpdated:StageEvent;\n\tprivate _viewportDirty:boolean;\n\tprivate _bufferClear:boolean;\n\n\n\t//private _mouse3DManager:away.managers.Mouse3DManager;\n\t//private _touch3DManager:Touch3DManager; //TODO: imeplement dependency Touch3DManager\n\n\tprivate _initialised:boolean = false;\n\n\tprivate _bufferFormatDictionary:Array<Array<number>> = new Array<Array<number>>(5);\n\n\tpublic globalDisableMipmap:boolean = false;\n\n\tpublic globalDisableSmooth:boolean = false;\n\t\n\tconstructor(container:HTMLCanvasElement, stageIndex:number, stageManager:StageManager, forceSoftware:boolean = false, profile:string = \"baseline\")\n\t{\n\t\tsuper();\n\n\t\tthis._programDataPool = new ProgramDataPool(this);\n\n\t\tthis._container = container;\n\t\tif(this._container) {\n\t\t\tthis._container.addEventListener(\"webglcontextlost\", (event) => this.onContextLost(event));\n\t\t\tthis._container.addEventListener(\"webglcontextrestored\", (event) => this.onContextRestored(event));\n\t\t}\n\n\t\tthis._stageIndex = stageIndex;\n\n\t\tthis._stageManager = stageManager;\n\n\t\tthis._viewPort = new Rectangle();\n\n\t\tthis._enableDepthAndStencil = true;\n\n\t\tCSS.setElementX(this._container, 0);\n\t\tCSS.setElementY(this._container, 0);\n\n\t\tthis._bufferFormatDictionary[1] = new Array<number>(5);\n\t\tthis._bufferFormatDictionary[1][1] = ContextGLVertexBufferFormat.BYTE_1;\n\t\tthis._bufferFormatDictionary[1][2] = ContextGLVertexBufferFormat.BYTE_2;\n\t\tthis._bufferFormatDictionary[1][3] = ContextGLVertexBufferFormat.BYTE_3;\n\t\tthis._bufferFormatDictionary[1][4] = ContextGLVertexBufferFormat.BYTE_4;\n\t\tthis._bufferFormatDictionary[2] = new Array<number>(5);\n\t\tthis._bufferFormatDictionary[2][1] = ContextGLVertexBufferFormat.SHORT_1;\n\t\tthis._bufferFormatDictionary[2][2] = ContextGLVertexBufferFormat.SHORT_2;\n\t\tthis._bufferFormatDictionary[2][3] = ContextGLVertexBufferFormat.SHORT_3;\n\t\tthis._bufferFormatDictionary[2][4] = ContextGLVertexBufferFormat.SHORT_4;\n\t\tthis._bufferFormatDictionary[4] = new Array<number>(5);\n\t\tthis._bufferFormatDictionary[4][1] = ContextGLVertexBufferFormat.FLOAT_1;\n\t\tthis._bufferFormatDictionary[4][2] = ContextGLVertexBufferFormat.FLOAT_2;\n\t\tthis._bufferFormatDictionary[4][3] = ContextGLVertexBufferFormat.FLOAT_3;\n\t\tthis._bufferFormatDictionary[4][4] = ContextGLVertexBufferFormat.FLOAT_4;\n\t\tthis._bufferFormatDictionary[5] = new Array<number>(5);\n\t\tthis._bufferFormatDictionary[5][1] = ContextGLVertexBufferFormat.UNSIGNED_BYTE_1;\n\t\tthis._bufferFormatDictionary[5][2] = ContextGLVertexBufferFormat.UNSIGNED_BYTE_2;\n\t\tthis._bufferFormatDictionary[5][3] = ContextGLVertexBufferFormat.UNSIGNED_BYTE_3;\n\t\tthis._bufferFormatDictionary[5][4] = ContextGLVertexBufferFormat.UNSIGNED_BYTE_4;\n\t\tthis._bufferFormatDictionary[6] = new Array<number>(5);\n\t\tthis._bufferFormatDictionary[6][1] = ContextGLVertexBufferFormat.UNSIGNED_SHORT_1;\n\t\tthis._bufferFormatDictionary[6][2] = ContextGLVertexBufferFormat.UNSIGNED_SHORT_2;\n\t\tthis._bufferFormatDictionary[6][3] = ContextGLVertexBufferFormat.UNSIGNED_SHORT_3;\n\t\tthis._bufferFormatDictionary[6][4] = ContextGLVertexBufferFormat.UNSIGNED_SHORT_4;\n\n\n\n\t\tthis.visible = true;\n\t}\n\n\tpublic getProgramData(vertexString:string, fragmentString:string):ProgramData\n\t{\n\t\treturn this._programDataPool.getItem(vertexString, fragmentString);\n\t}\n\n\tpublic setRenderTarget(target:ImageBase, enableDepthAndStencil:boolean = false, surfaceSelector:number = 0):void\n\t{\n\t\tif (this._renderTarget === target && surfaceSelector == this._renderSurfaceSelector && this._enableDepthAndStencil == enableDepthAndStencil)\n\t\t\treturn;\n\n\t\tthis._renderTarget = target;\n\t\tthis._renderSurfaceSelector = surfaceSelector;\n\t\tthis._enableDepthAndStencil = enableDepthAndStencil;\n\t\tif (target) {\n\t\t\tthis._context.setRenderToTexture((<GL_ImageBase> this.getAbstraction(target)).texture, enableDepthAndStencil, this._antiAlias, surfaceSelector);\n\t\t} else {\n\t\t\tthis._context.setRenderToBackBuffer();\n\t\t\tthis.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n\t\t}\n\t}\n\n\tpublic getAbstraction(asset:IAsset):AbstractionBase\n\t{\n\t\treturn (this._abstractionPool[asset.id] || (this._abstractionPool[asset.id] = new (<GL_IAssetClass> Stage._abstractionClassPool[asset.assetType])(asset, this)));\n\t}\n\n\t/**\n\t *\n\t * @param image\n\t */\n\tpublic clearAbstraction(asset:IAsset):void\n\t{\n\t\tthis._abstractionPool[asset.id] = null;\n\t}\n\n\t/**\n\t *\n\t * @param imageObjectClass\n\t */\n\tpublic static registerAbstraction(gl_assetClass:GL_IAssetClass, assetClass:IAssetClass):void\n\t{\n\t\tStage._abstractionClassPool[assetClass.assetType] = gl_assetClass;\n\t}\n\n\t/**\n\t * Requests a Context object to attach to the managed gl canvas.\n\t */\n\tpublic requestContext(forceSoftware:boolean = false, profile:string = \"baseline\", mode:string = \"auto\"):void\n\t{\n\t\t// If forcing software, we can be certain that the\n\t\t// returned Context will be running software mode.\n\t\t// If not, we can't be sure and should stick to the\n\t\t// old value (will likely be same if re-requesting.)\n\n\t\tif (this._usesSoftwareRendering != null)\n\t\t\tthis._usesSoftwareRendering = forceSoftware;\n\n\t\tthis._profile = profile;\n\n\t\ttry {\n\t\t\tif (mode == ContextMode.FLASH)\n\t\t\t\tnew ContextStage3D(<HTMLCanvasElement> this._container, (context:IContextGL) => this._callback(context));\n\t\t\telse if(mode == ContextMode.SOFTWARE)\n\t\t\t\tthis._context = new ContextSoftware(<HTMLCanvasElement> this._container);\n\t\t\telse\n\t\t\t\tthis._context = new ContextWebGL(<HTMLCanvasElement> this._container);\n\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tif (mode == ContextMode.AUTO)\n\t\t\t\t\tnew ContextStage3D(<HTMLCanvasElement> this._container, (context:IContextGL) => this._callback(context));\n\t\t\t\telse\n\t\t\t\t\tthis.dispatchEvent(new StageEvent(StageEvent.STAGE_ERROR, this));\n\t\t\t} catch (e) {\n\t\t\t\tthis.dispatchEvent(new StageEvent(StageEvent.STAGE_ERROR, this));\n\t\t\t}\n\n\t\t}\n\n\t\tif (this._context)\n\t\t\tthis._callback(this._context);\n\t}\n\n\t/**\n\t * The width of the gl canvas\n\t */\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic set width(val:number)\n\t{\n\t\tif (this._width == val)\n\t\t\treturn;\n\n\t\tCSS.setElementWidth(this._container, val);\n\n\t\tthis._width = this._viewPort.width = val;\n\n\t\tthis._backBufferDirty = true;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\t/**\n\t * The height of the gl canvas\n\t */\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic set height(val:number)\n\t{\n\t\tif (this._height == val)\n\t\t\treturn;\n\n\t\tCSS.setElementHeight(this._container, val);\n\n\t\tthis._height = this._viewPort.height = val;\n\n\t\tthis._backBufferDirty = true;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\t/**\n\t * The x position of the gl canvas\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._x;\n\t}\n\n\tpublic set x(val:number)\n\t{\n\t\tif (this._x == val)\n\t\t\treturn;\n\n\t\tCSS.setElementX(this._container, val);\n\n\t\tthis._x = this._viewPort.x = val;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\t/**\n\t * The y position of the gl canvas\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._y;\n\t}\n\n\tpublic set y(val:number)\n\t{\n\t\tif (this._y == val)\n\t\t\treturn;\n\n\t\tCSS.setElementY(this._container, val);\n\n\t\tthis._y = this._viewPort.y = val;\n\n\t\tthis.notifyViewportUpdated();\n\t}\n\n\tpublic set visible(val:boolean)\n\t{\n\t\tCSS.setElementVisibility(this._container, val);\n\t}\n\n\tpublic get visible():boolean\n\t{\n\t\treturn CSS.getElementVisibility(this._container);\n\t}\n\n\tpublic get container():HTMLElement\n\t{\n\t\treturn this._container;\n\t}\n\n\t/**\n\t * The Context object associated with the given stage object.\n\t */\n\tpublic get context():IContextGL\n\t{\n\t\treturn this._context;\n\t}\n\n\tprivate notifyViewportUpdated():void\n\t{\n\t\tif (this._viewportDirty)\n\t\t\treturn;\n\n\t\tthis._viewportDirty = true;\n\n\t\tthis.dispatchEvent(new StageEvent(StageEvent.VIEWPORT_UPDATED, this));\n\t}\n\n\tpublic get profile():string\n\t{\n\t\treturn this._profile;\n\t}\n\n\t/**\n\t * Disposes the Stage object, freeing the Context attached to the Stage.\n\t */\n\tpublic dispose():void\n\t{\n\t\tfor (var id in this._abstractionPool)\n\t\t\tthis._abstractionPool[id].clear();\n\n\t\tthis._abstractionPool = null;\n\n\t\tthis._stageManager.iRemoveStage(this);\n\t\tthis.freeContext();\n\t\tthis._stageManager = null;\n\t\tthis._stageIndex = -1;\n\t}\n\n\t/**\n\t * Configures the back buffer associated with the Stage object.\n\t * @param backBufferWidth The width of the backbuffer.\n\t * @param backBufferHeight The height of the backbuffer.\n\t * @param antiAlias The amount of anti-aliasing to use.\n\t * @param enableDepthAndStencil Indicates whether the back buffer contains a depth and stencil buffer.\n\t */\n\tpublic configureBackBuffer(backBufferWidth:number, backBufferHeight:number, antiAlias:number, enableDepthAndStencil:boolean):void\n\t{\n\t\tthis.width = backBufferWidth;\n\t\tthis.height = backBufferHeight;\n\n\t\tthis._antiAlias = antiAlias;\n\t\tthis._enableDepthAndStencil = enableDepthAndStencil;\n\n\t\tif (this._context)\n\t\t\tthis._context.configureBackBuffer(backBufferWidth, backBufferHeight, antiAlias, enableDepthAndStencil);\n\t}\n\n\t/*\n\t * Indicates whether the depth and stencil buffer is used\n\t */\n\tpublic get enableDepthAndStencil():boolean\n\t{\n\t\treturn this._enableDepthAndStencil;\n\t}\n\n\tpublic set enableDepthAndStencil(enableDepthAndStencil:boolean)\n\t{\n\t\tthis._enableDepthAndStencil = enableDepthAndStencil;\n\t\tthis._backBufferDirty = true;\n\t}\n\n\tpublic get renderTarget():ImageBase\n\t{\n\t\treturn this._renderTarget;\n\t}\n\n\tpublic get renderSurfaceSelector():number\n\t{\n\t\treturn this._renderSurfaceSelector;\n\t}\n\n\t/*\n\t * Clear and reset the back buffer when using a shared context\n\t */\n\tpublic clear():void\n\t{\n\t\tif (!this._context)\n\t\t\treturn;\n\n\t\tif (this._backBufferDirty) {\n\t\t\tthis.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n\t\t\tthis._backBufferDirty = false;\n\t\t}\n\n\t\tthis._context.clear(( this._color & 0xff000000 ) >>> 24, // <--------- Zero-fill right shift\n\t\t\t\t\t\t\t  ( this._color & 0xff0000 ) >>> 16, // <-------------|\n\t\t\t\t\t\t\t  ( this._color & 0xff00 ) >>> 8, // <----------------|\n\t\t\t\t\t\t\t\tthis._color & 0xff);\n\n\t\tthis._bufferClear = true;\n\t}\n\n\tpublic get scissorRect():Rectangle\n\t{\n\t\treturn this._scissorRect;\n\t}\n\n\tpublic set scissorRect(value:Rectangle)\n\t{\n\t\tthis._scissorRect = value;\n\n\t\tthis._context.setScissorRectangle(this._scissorRect);\n\t}\n\n\t/**\n\t * The index of the Stage which is managed by this instance of StageProxy.\n\t */\n\tpublic get stageIndex():number\n\t{\n\t\treturn this._stageIndex;\n\t}\n\n\t/**\n\t * Indicates whether the Stage managed by this proxy is running in software mode.\n\t * Remember to wait for the CONTEXT_CREATED event before checking this property,\n\t * as only then will it be guaranteed to be accurate.\n\t */\n\tpublic get usesSoftwareRendering():boolean\n\t{\n\t\treturn this._usesSoftwareRendering;\n\t}\n\n\t/**\n\t * The antiAliasing of the Stage.\n\t */\n\tpublic get antiAlias():number\n\t{\n\t\treturn this._antiAlias;\n\t}\n\n\tpublic set antiAlias(antiAlias:number)\n\t{\n\t\tthis._antiAlias = antiAlias;\n\t\tthis._backBufferDirty = true;\n\t}\n\n\t/**\n\t * A viewPort rectangle equivalent of the Stage size and position.\n\t */\n\tpublic get viewPort():Rectangle\n\t{\n\t\tthis._viewportDirty = false;\n\n\t\treturn this._viewPort;\n\t}\n\n\t/**\n\t * The background color of the Stage.\n\t */\n\tpublic get color():number\n\t{\n\t\treturn this._color;\n\t}\n\n\tpublic set color(color:number)\n\t{\n\t\tthis._color = color;\n\t}\n\n\t/**\n\t * The freshly cleared state of the backbuffer before any rendering\n\t */\n\tpublic get bufferClear():boolean\n\t{\n\t\treturn this._bufferClear;\n\t}\n\n\tpublic set bufferClear(newBufferClear:boolean)\n\t{\n\t\tthis._bufferClear = newBufferClear;\n\t}\n\n\n\tpublic registerProgram(programData:ProgramData):void\n\t{\n\t\tvar i:number = 0;\n\t\twhile (this._programData[i] != null)\n\t\t\ti++;\n\n\t\tthis._programData[i] = programData;\n\t\tprogramData.id = i;\n\t}\n\n\tpublic unRegisterProgram(programData:ProgramData):void\n\t{\n\t\tthis._programData[programData.id] = null;\n\t\tprogramData.id = -1;\n\t}\n\n\t/**\n\t * Frees the Context associated with this StageProxy.\n\t */\n\tprivate freeContext():void\n\t{\n\t\tif (this._context) {\n\t\t\tthis._context.dispose();\n\n\t\t\tthis.dispatchEvent(new StageEvent(StageEvent.CONTEXT_DISPOSED, this));\n\t\t}\n\n\t\tthis._context = null;\n\n\t\tthis._initialised = false;\n\t}\n\n\tprivate onContextLost(event):void\n\t{\n\n\t}\n\n\tprivate onContextRestored(event):void\n\t{\n\n\t}\n\n\tpublic recoverFromDisposal():boolean\n\t{\n\t\tif (!this._context)\n\t\t\treturn false;\n\n\t\t//away.Debug.throwPIR( 'StageProxy' , 'recoverFromDisposal' , '' );\n\n\t\t/*\n\t\t if (this._iContext.driverInfo == \"Disposed\")\n\t\t {\n\t\t this._iContext = null;\n\t\t this.dispatchEvent(new StageEvent(StageEvent.CONTEXT_DISPOSED));\n\t\t return false;\n\n\t\t }\n\t\t */\n\t\treturn true;\n\n\t}\n\n\tprivate _callback(context:IContextGL):void\n\t{\n\t\tthis._context = context;\n\n\t\tthis._container = this._context.container;\n\n\t\t// Only configure back buffer if width and height have been set,\n\t\t// which they may not have been if View.render() has yet to be\n\t\t// invoked for the first time.\n\t\tif (this._width && this._height)\n\t\t\tthis._context.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);\n\n\t\t// Dispatch the appropriate event depending on whether context was\n\t\t// created for the first time or recreated after a device loss.\n\t\tthis.dispatchEvent(new StageEvent(this._initialised? StageEvent.CONTEXT_RECREATED : StageEvent.CONTEXT_CREATED, this));\n\n\t\tthis._initialised = true;\n\t}\n\n\tpublic setVertexBuffer(index:number, buffer:IVertexBuffer, size:number, dimensions:number, offset:number, unsigned:boolean = false):void\n\t{\n\t\tthis._context.setVertexBufferAt(index, buffer, offset, this._bufferFormatDictionary[unsigned? size + 4 : size][dimensions]);\n\t}\n\n\tpublic setSamplerState(index:number, repeat:boolean, smooth:boolean, mipmap:boolean):void\n\t{\n\t\tvar wrap:string = repeat? ContextGLWrapMode.REPEAT :ContextGLWrapMode.CLAMP;\n\t\tvar filter:string = (smooth && !this.globalDisableSmooth)? ContextGLTextureFilter.LINEAR : ContextGLTextureFilter.NEAREST;\n\t\tvar mipfilter:string = (mipmap && !this.globalDisableMipmap) ? ContextGLMipFilter.MIPLINEAR : ContextGLMipFilter.MIPNONE;\n\n\t\tthis._context.setSamplerStateAt(index, wrap, filter, mipfilter);\n\t}\n}",
    "import {AbstractMethodError}\t\t\tfrom \"awayjs-core/lib/errors/AbstractMethodError\";\n\nexport class TextureBaseWebGL\n{\n\tpublic textureType:string = \"\";\n\tpublic _gl:WebGLRenderingContext;\n\n\tconstructor(gl:WebGLRenderingContext)\n\t{\n\t\tthis._gl = gl;\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthrow \"Abstract method must be overridden.\";\n\t}\n\n\tpublic get glTexture():WebGLTexture\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}",
    "import {ByteArrayBase}\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArrayBase\";\n\nimport {ContextStage3D}\t\t\t\tfrom \"../base/ContextStage3D\";\nimport {ITexture}\t\t\t\t\t\tfrom \"../base/ITexture\";\nimport {OpCodes}\t\t\t\t\t\tfrom \"../base/OpCodes\";\nimport {ResourceBaseFlash}\t\t\tfrom \"../base/ResourceBaseFlash\";\n\nexport class TextureFlash extends ResourceBaseFlash implements ITexture\n{\n\tprivate _context:ContextStage3D;\n\tprivate _width:number;\n\tprivate _height:number;\n\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tconstructor(context:ContextStage3D, width:number, height:number, format:string, forRTT:boolean, streaming:boolean = false)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initTexture, (forRTT? OpCodes.trueValue : OpCodes.falseValue)) + width + \",\" + height + \",\" + streaming + \",\" + format + \"$\");\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeTexture) + this._pId.toString() + \",\");\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n\n\tpublic uploadFromData(image:HTMLImageElement, miplevel?:number);\n\tpublic uploadFromData(imageData:ImageData, miplevel?:number);\n\tpublic uploadFromData(data:any, miplevel:number = 0):void\n\t{\n\t\tif (data instanceof HTMLImageElement) {\n\t\t\tvar can = document.createElement(\"canvas\");\n\t\t\tvar w = data.width;\n\t\t\tvar h = data.height;\n\t\t\tcan.width = w;\n\t\t\tcan.height = h;\n\t\t\tvar ctx = can.getContext(\"2d\");\n\t\t\tctx.drawImage(data, 0, 0);\n\t\t\tdata = ctx.getImageData(0, 0, w, h).data;\n\t\t}\n\n\t\tvar pos = 0;\n\t\tvar bytes = ByteArrayBase.internalGetBase64String(data.length, function () {\n\t\t\treturn data[pos++];\n\t\t}, null);\n\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadBytesTexture) + this._pId + \",\" + miplevel + \",\" + (this._width >> miplevel) + \",\" + (this._height >> miplevel) + \",\" + bytes + \"%\");\n\t\tthis._context.execute();\n\t}\n}",
    "import {ITexture}\t\t\t\t\t\tfrom \"../base/ITexture\";\n\nexport class TextureSoftware implements ITexture\n{\n\tpublic textureType:string = \"texture2d\";\n\n\tprivate _width:number;\n\tprivate _height:number;\n\tprivate _mipLevels:number[][] = [];\n\n\tconstructor(width:number, height:number)\n\t{\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._mipLevels = null;\n\t}\n\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic uploadFromData(image:HTMLImageElement, miplevel?:number);\n\tpublic uploadFromData(imageData:ImageData, miplevel?:number);\n\tpublic uploadFromData(data:any, miplevel:number = 0):void\n\t{\n\t\tthis._mipLevels[miplevel] = data.data;\n\t}\n\n\tpublic getData(miplevel:number):number[]\n\t{\n\t\treturn this._mipLevels[miplevel];\n\t}\n\n\tpublic getMipLevelsCount():number\n\t{\n\t\treturn this._mipLevels.length;\n\t}\n}",
    "import {ByteArray}\t\t\t\t\tfrom \"awayjs-core/lib/utils/ByteArray\";\n\nimport {ITexture}\t\t\t\t\t\tfrom \"../base/ITexture\";\nimport {TextureBaseWebGL}\t\t\t\tfrom \"../base/TextureBaseWebGL\";\n\nexport class TextureWebGL extends TextureBaseWebGL implements ITexture\n{\n\n\tpublic textureType:string = \"texture2d\";\n\n\tprivate _width:number;\n\tprivate _height:number;\n\n\tprivate _frameBuffer:WebGLFramebuffer;\n\n\tprivate _glTexture:WebGLTexture;\n\n\tconstructor(gl:WebGLRenderingContext, width:number, height:number)\n\t{\n\t\tsuper(gl);\n\t\tthis._width = width;\n\t\tthis._height = height;\n\n\t\tthis._glTexture = this._gl.createTexture();\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._gl.deleteTexture(this._glTexture);\n\t}\n\n\tpublic get width():number\n\t{\n\t\treturn this._width;\n\t}\n\n\tpublic get height():number\n\t{\n\t\treturn this._height;\n\t}\n\n\tpublic get frameBuffer():WebGLFramebuffer\n\t{\n\t\tif (!this._frameBuffer) {\n\t\t\tthis._frameBuffer = this._gl.createFramebuffer();\n\t\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, this._frameBuffer);\n\t\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, this._glTexture);\n\t\t\tthis._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._width, this._height, 0, this._gl.RGBA, this._gl.UNSIGNED_BYTE, null);\n\n\t\t\tvar renderBuffer:WebGLRenderbuffer = this._gl.createRenderbuffer();\n\t\t\tthis._gl.bindRenderbuffer(this._gl.RENDERBUFFER, renderBuffer);\n\t\t\tthis._gl.renderbufferStorage(this._gl.RENDERBUFFER, this._gl.DEPTH_STENCIL, this._width, this._height);\n\n\t\t\tthis._gl.framebufferTexture2D(this._gl.FRAMEBUFFER, this._gl.COLOR_ATTACHMENT0, this._gl.TEXTURE_2D, this._glTexture, 0);\n\t\t\tthis._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER, this._gl.DEPTH_STENCIL_ATTACHMENT, this._gl.RENDERBUFFER, renderBuffer);\n\n\t\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, null);\n\t\t\tthis._gl.bindRenderbuffer(this._gl.RENDERBUFFER, null);\n\t\t\tthis._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null);\n\t\t}\n\n\t\treturn this._frameBuffer;\n\t}\n\n\tpublic uploadFromData(image:HTMLImageElement, miplevel?:number);\n\tpublic uploadFromData(imageData:ImageData, miplevel?:number);\n\tpublic uploadFromData(data:any, miplevel:number = 0):void\n\t{\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, this._glTexture);\n\t\tthis._gl.texImage2D(this._gl.TEXTURE_2D, miplevel, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, data);\n\t\tthis._gl.bindTexture(this._gl.TEXTURE_2D, null);\n\t}\n\n\tpublic uploadCompressedTextureFromByteArray(data:ByteArray, byteArrayOffset:number /*uint*/, async:boolean = false):void\n\t{\n\t\tvar ext:Object = this._gl.getExtension(\"WEBKIT_WEBGL_compressed_texture_s3tc\");\n\t\t//this._gl.compressedTexImage2D(this._gl.TEXTURE_2D, 0, this)\n\t}\n\n\tpublic get glTexture():WebGLTexture\n\t{\n\t\treturn this._glTexture;\n\t}\n\n\tpublic generateMipmaps():void\n\t{\n\t\t//TODO: implement generating mipmaps\n\t\t//this._gl.bindTexture( this._gl.TEXTURE_2D, this._glTexture );\n\t\t//this._gl.generateMipmap(this._gl.TEXTURE_2D);\n\t\t//this._gl.bindTexture( this._gl.TEXTURE_2D, null );\n\t}\n}",
    "import {ContextStage3D}\t\t\t\tfrom \"../base/ContextStage3D\";\nimport {IVertexBuffer}\t\t\t\tfrom \"../base/IVertexBuffer\";\nimport {OpCodes}\t\t\t\t\t\tfrom \"../base/OpCodes\";\nimport {ResourceBaseFlash}\t\t\tfrom \"../base/ResourceBaseFlash\";\n\nexport class VertexBufferFlash extends ResourceBaseFlash implements IVertexBuffer\n{\n\tprivate _context:ContextStage3D;\n\tprivate _numVertices:number;\n\tprivate _dataPerVertex:number;\n\n\tconstructor(context:ContextStage3D, numVertices:number, dataPerVertex:number)\n\t{\n\t\tsuper();\n\n\t\tthis._context = context;\n\t\tthis._numVertices = numVertices;\n\t\tthis._dataPerVertex = dataPerVertex;\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.initVertexBuffer, dataPerVertex + OpCodes.intMask) + numVertices.toString() + \",\");\n\t\tthis._pId = this._context.execute();\n\t\tthis._context._iAddResource(this);\n\t}\n\n\tpublic uploadFromArray(data:number[], startVertex:number, numVertices:number):void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.uploadArrayVertexBuffer, this._pId + OpCodes.intMask) + data.join() + \"#\" + [startVertex, numVertices].join() + \",\");\n\t\tthis._context.execute();\n\t}\n\n\tpublic uploadFromByteArray(data:ArrayBuffer, startVertex:number, numVertices:number):void\n\t{\n\n\t}\n\n\tpublic get numVertices():number\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get dataPerVertex():number\n\t{\n\t\treturn this._dataPerVertex;\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._context.addStream(String.fromCharCode(OpCodes.disposeVertexBuffer, this._pId + OpCodes.intMask));\n\t\tthis._context.execute();\n\t\tthis._context._iRemoveResource(this);\n\n\t\tthis._context = null;\n\t}\n}",
    "import {IVertexBuffer}\t\t\t\tfrom \"../base/IVertexBuffer\";\n\nexport class VertexBufferSoftware implements IVertexBuffer\n{\n\tprivate _numVertices:number;\n\tprivate _dataPerVertex:number;\n\tprivate _floatData:Float32Array;\n\tprivate _uintData:Uint8Array;\n\t//private _dataOffset:number;\n\n\tconstructor(numVertices:number, dataPerVertex:number)\n\t{\n\t\tthis._numVertices = numVertices;\n\t\tthis._dataPerVertex = dataPerVertex;\n\t}\n\n\tpublic uploadFromArray(vertices:number[], startVertex:number, numVertices:number):void\n\t{\n\t\t//this._dataOffset = startVertex * this._dataPerVertex;\n\t\tthis._floatData = new Float32Array(vertices);\n\t}\n\n\tpublic uploadFromByteArray(data:ArrayBuffer, startVertex:number, numVertices:number):void\n\t{\n\t\t//this._dataOffset = startVertex * this._dataPerVertex;\n\t\tthis._floatData = new Float32Array(data, startVertex*this._dataPerVertex, numVertices*this._dataPerVertex/4);\n\t\tthis._uintData = new Uint8Array(data);\n\t}\n\n\tpublic get numVertices():number\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get dataPerVertex():number\n\t{\n\t\treturn this._dataPerVertex;\n\t}\n\n\tpublic get attributesPerVertex():number\n\t{\n\t\treturn this._dataPerVertex/4;\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._floatData = null;\n\t}\n\n\tpublic get data():Float32Array\n\t{\n\t\treturn this._floatData;\n\t}\n\n\tpublic get uintData():Uint8Array\n\t{\n\t\treturn this._uintData;\n\t}\n}",
    "import {IVertexBuffer}\t\t\t\tfrom \"../base/IVertexBuffer\";\n\nexport class VertexBufferWebGL implements IVertexBuffer\n{\n\n\tprivate _gl:WebGLRenderingContext;\n\tprivate _numVertices:number;\n\tprivate _dataPerVertex:number;\n\tprivate _buffer:WebGLBuffer;\n\n\tconstructor(gl:WebGLRenderingContext, numVertices:number, dataPerVertex:number)\n\t{\n\t\tthis._gl = gl;\n\t\tthis._buffer = this._gl.createBuffer();\n\t\tthis._numVertices = numVertices;\n\t\tthis._dataPerVertex = dataPerVertex;\n\t}\n\n\tpublic uploadFromArray(vertices:number[], startVertex:number, numVertices:number):void\n\t{\n\t\tthis._gl.bindBuffer(this._gl.ARRAY_BUFFER, this._buffer);\n\n\t\tif (startVertex)\n\t\t\tthis._gl.bufferSubData(this._gl.ARRAY_BUFFER, startVertex*this._dataPerVertex, new Float32Array(vertices));\n\t\telse\n\t\t\tthis._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array(vertices), this._gl.STATIC_DRAW);\n\t}\n\n\n\tpublic uploadFromByteArray(data:ArrayBuffer, startVertex:number, numVertices:number):void\n\t{\n\t\tthis._gl.bindBuffer(this._gl.ARRAY_BUFFER, this._buffer);\n\n\t\tif (startVertex)\n\t\t\tthis._gl.bufferSubData(this._gl.ARRAY_BUFFER, startVertex*this._dataPerVertex, data);\n\t\telse\n\t\t\tthis._gl.bufferData(this._gl.ARRAY_BUFFER, data, this._gl.STATIC_DRAW);\n\t}\n\n\tpublic get numVertices():number\n\t{\n\t\treturn this._numVertices;\n\t}\n\n\tpublic get dataPerVertex():number\n\t{\n\t\treturn this._dataPerVertex;\n\t}\n\n\tpublic get glBuffer():WebGLBuffer\n\t{\n\t\treturn this._buffer;\n\t}\n\n\tpublic dispose():void\n\t{\n\t\tthis._gl.deleteBuffer(this._buffer);\n\t}\n}",
    "export {ContextGLBlendFactor}\t\t\tfrom \"./base/ContextGLBlendFactor\";\nexport {ContextGLClearMask}\t\t\t\tfrom \"./base/ContextGLClearMask\";\nexport {ContextGLCompareMode}\t\t\tfrom \"./base/ContextGLCompareMode\";\nexport {ContextGLDrawMode}\t\t\t\tfrom \"./base/ContextGLDrawMode\";\nexport {ContextGLMipFilter}\t\t\t\tfrom \"./base/ContextGLMipFilter\";\nexport {ContextGLProfile}\t\t\t\tfrom \"./base/ContextGLProfile\";\nexport {ContextGLProgramType}\t\t\tfrom \"./base/ContextGLProgramType\";\nexport {ContextGLStencilAction}\t\t\tfrom \"./base/ContextGLStencilAction\";\nexport {ContextGLTextureFilter}\t\t\tfrom \"./base/ContextGLTextureFilter\";\nexport {ContextGLTextureFormat}\t\t\tfrom \"./base/ContextGLTextureFormat\";\nexport {ContextGLTriangleFace}\t\t\tfrom \"./base/ContextGLTriangleFace\";\nexport {ContextGLVertexBufferFormat}\t\tfrom \"./base/ContextGLVertexBufferFormat\";\nexport {ContextGLWrapMode}\t\t\t\tfrom \"./base/ContextGLWrapMode\";\nexport {ContextMode}\t\t\t\t\t\tfrom \"./base/ContextMode\";\nexport {ContextSoftware}\t\t\t\t\tfrom \"./base/ContextSoftware\";\nexport {ContextStage3D}\t\t\t\t\tfrom \"./base/ContextStage3D\";\nexport {ContextWebGL}\t\t\t\t\tfrom \"./base/ContextWebGL\";\nexport {CubeTextureFlash}\t\t\t\tfrom \"./base/CubeTextureFlash\";\nexport {CubeTextureWebGL}\t\t\t\tfrom \"./base/CubeTextureWebGL\";\nexport {IContextGL}\t\t\t\t\t\tfrom \"./base/IContextGL\";\nexport {ICubeTexture}\t\t\t\t\tfrom \"./base/ICubeTexture\";\nexport {IIndexBuffer}\t\t\t\t\tfrom \"./base/IIndexBuffer\";\nexport {IndexBufferFlash}\t\t\t\tfrom \"./base/IndexBufferFlash\";\nexport {IndexBufferSoftware}\t\t\t\tfrom \"./base/IndexBufferSoftware\";\nexport {IndexBufferWebGL}\t\t\t\tfrom \"./base/IndexBufferWebGL\";\nexport {IProgram}\t\t\t\t\t\tfrom \"./base/IProgram\";\nexport {ITexture}\t\t\t\t\t\tfrom \"./base/ITexture\";\nexport {ITextureBase}\t\t\t\t\tfrom \"./base/ITextureBase\";\nexport {IVertexBuffer}\t\t\t\t\tfrom \"./base/IVertexBuffer\";\nexport {OpCodes}\t\t\t\t\t\t\tfrom \"./base/OpCodes\";\nexport {ProgramFlash}\t\t\t\t\tfrom \"./base/ProgramFlash\";\nexport {ProgramSoftware}\t\t\t\t\tfrom \"./base/ProgramSoftware\";\nexport {ProgramVOSoftware}\t\t\t\tfrom \"./base/ProgramVOSoftware\";\nexport {ProgramWebGL}\t\t\t\t\tfrom \"./base/ProgramWebGL\";\nexport {ResourceBaseFlash}\t\t\t\tfrom \"./base/ResourceBaseFlash\";\nexport {SamplerState}\t\t\t\t\tfrom \"./base/SamplerState\";\nexport {SoftwareSamplerState}\t\t\tfrom \"./base/SoftwareSamplerState\";\nexport {Stage}\t\t\t\t\t\t\tfrom \"./base/Stage\";\nexport {TextureBaseWebGL}\t\t\t\tfrom \"./base/TextureBaseWebGL\";\nexport {TextureFlash}\t\t\t\t\tfrom \"./base/TextureFlash\";\nexport {TextureSoftware}\t\t\t\t\tfrom \"./base/TextureSoftware\";\nexport {TextureWebGL}\t\t\t\t\tfrom \"./base/TextureWebGL\";\nexport {VertexBufferFlash}\t\t\t\tfrom \"./base/VertexBufferFlash\";\nexport {VertexBufferSoftware}\t\t\tfrom \"./base/VertexBufferSoftware\";\nexport {VertexBufferWebGL}\t\t\t\tfrom \"./base/VertexBufferWebGL\";",
    "import {EventBase}\t\t\t\tfrom \"awayjs-core/lib/events/EventBase\";\n\nimport {Stage}\t\t\t\t\tfrom \"../base/Stage\";\n\nexport class StageEvent extends EventBase\n{\n\t/**\n\t *\n\t */\n\tpublic static STAGE_ERROR:string = \"stageError\";\n\n\t/**\n\t *\n\t */\n\tpublic static CONTEXT_CREATED:string = \"contextCreated\";\n\n\t/**\n\t *\n\t */\n\tpublic static CONTEXT_DISPOSED:string = \"contextDisposed\";\n\n\t/**\n\t *\n\t */\n\tpublic static CONTEXT_RECREATED:string = \"contextRecreated\";\n\n\t/**\n\t *\n\t */\n\tpublic static VIEWPORT_UPDATED:string = \"viewportUpdated\";\n\n\tprivate _stage:Stage;\n\n\t/**\n\t *\n\t */\n\tpublic get stage():Stage\n\t{\n\t\treturn this._stage;\n\t}\n\n\tconstructor(type:string, stage:Stage)\n\t{\n\t\tsuper(type);\n\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic clone():StageEvent\n\t{\n\t\treturn new StageEvent(this.type, this._stage);\n\t}\n}",
    "export {StageEvent}\t\t\t\t\t\tfrom \"./events/StageEvent\";",
    "import {BitmapImage2D}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImage2D\";\nimport {AssetEvent}\t\t\t\t\tfrom \"awayjs-core/lib/events/AssetEvent\";\nimport {MipmapGenerator}\t\t\t\tfrom \"awayjs-core/lib/utils/MipmapGenerator\";\n\nimport {GL_Image2D}\t\t\t\t\tfrom \"../image/GL_Image2D\";\nimport {ITexture}\t\t\t\t\t\tfrom \"../base/ITexture\";\n\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nexport class GL_BitmapImage2D extends GL_Image2D\n{\n\tprivate _mipmapData:Array<BitmapImage2D>;\n\n\tpublic activate(index:number, mipmap:boolean):void\n\t{\n\t\tif (mipmap && this._stage.globalDisableMipmap)\n\t\t\tmipmap = false;\n\t\t\n\t\tif (!this._texture) {\n\t\t\tthis._createTexture();\n\t\t\tthis._invalid = true;\n\t\t}\n\n\t\tif (!this._mipmap && mipmap) {\n\t\t\tthis._mipmap = true;\n\t\t\tthis._invalid = true;\n\t\t}\n\n\t\tif (this._invalid) {\n\t\t\tthis._invalid = false;\n\t\t\tif (mipmap) {\n\t\t\t\tvar mipmapData:Array<BitmapImage2D> = this._mipmapData || (this._mipmapData = new Array<BitmapImage2D>());\n\n\t\t\t\tMipmapGenerator._generateMipMaps((<BitmapImage2D> this._asset).getCanvas(), mipmapData, true);\n\t\t\t\tvar len:number = mipmapData.length;\n\t\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\t\t(<ITexture> this._texture).uploadFromData(mipmapData[i].getImageData(), i);\n\t\t\t} else {\n\t\t\t\t(<ITexture> this._texture).uploadFromData((<BitmapImage2D> this._asset).getImageData(), 0);\n\t\t\t}\n\t\t}\n\n\t\tsuper.activate(index, mipmap);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onClear(event:AssetEvent):void\n\t{\n\t\tsuper.onClear(event);\n\n\t\tif (this._mipmapData) {\n\t\t\tvar len:number = this._mipmapData.length;\n\t\t\tfor (var i:number = 0; i < len; i++)\n\t\t\t\tMipmapGenerator._freeMipMapHolder(this._mipmapData[i]);\n\t\t}\n\t}\n}",
    "import {IAssetClass}\t\t\t\t\tfrom \"awayjs-core/lib/library/IAssetClass\";\nimport {BitmapImageCube}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImageCube\";\nimport {BitmapImage2D}\t\t\t\tfrom \"awayjs-core/lib/image/BitmapImage2D\";\nimport {AssetEvent}\t\t\t\t\tfrom \"awayjs-core/lib/events/AssetEvent\";\nimport {MipmapGenerator}\t\t\t\tfrom \"awayjs-core/lib/utils/MipmapGenerator\";\n\nimport {GL_ImageCube}\t\t\t\t\tfrom \"../image/GL_ImageCube\";\nimport {ICubeTexture}\t\t\t\t\tfrom \"../base/ICubeTexture\";\n\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nexport class GL_BitmapImageCube extends GL_ImageCube\n{\n\tpublic _mipmapDataArray:Array<Array<BitmapImage2D>> = new Array<Array<BitmapImage2D>>(6);\n\n\tpublic activate(index:number, mipmap:boolean):void\n\t{\n\t\tif (mipmap && this._stage.globalDisableMipmap)\n\t\t\tmipmap = false;\n\t\t\n\t\tif (!this._texture) {\n\t\t\tthis._createTexture();\n\t\t\tthis._invalid = true;\n\t\t}\n\n\t\tif (!this._mipmap && mipmap) {\n\t\t\tthis._mipmap = true;\n\t\t\tthis._invalid = true;\n\t\t}\n\n\t\tif (this._invalid) {\n\t\t\tthis._invalid = false;\n\t\t\tfor (var i:number = 0; i < 6; ++i) {\n\t\t\t\tif (mipmap) {\n\t\t\t\t\tvar mipmapData:Array<BitmapImage2D> = this._mipmapDataArray[i] || (this._mipmapDataArray[i] = new Array<BitmapImage2D>());\n\n\t\t\t\t\tMipmapGenerator._generateMipMaps((<BitmapImageCube> this._asset).getCanvas(i), mipmapData, true);\n\t\t\t\t\tvar len:number = mipmapData.length;\n\t\t\t\t\tfor (var j:number = 0; j < len; j++)\n\t\t\t\t\t\t(<ICubeTexture> this._texture).uploadFromData(mipmapData[j].getImageData(), i, j);\n\t\t\t\t} else {\n\t\t\t\t\t(<ICubeTexture> this._texture).uploadFromData((<BitmapImageCube> this._asset).getImageData(i), i, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper.activate(index, mipmap);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onClear(event:AssetEvent):void\n\t{\n\t\tsuper.onClear(event);\n\n\t\tfor (var i:number = 0; i < 6; i++) {\n\t\t\tvar mipmapData:Array<BitmapImage2D> = this._mipmapDataArray[i];\n\n\t\t\tif (mipmapData) {\n\t\t\t\tvar len:number = mipmapData.length;\n\n\t\t\t\tfor (var j:number = 0; j < len; i++)\n\t\t\t\t\tMipmapGenerator._freeMipMapHolder(mipmapData[j]);\n\t\t\t}\n\t\t}\n\t}\n}",
    "import {Image2D}\t\t\t\t\t\tfrom \"awayjs-core/lib/image/Image2D\";\n\nimport {ContextGLTextureFormat}\t\tfrom \"../base/ContextGLTextureFormat\";\nimport {GL_ImageBase}\t\t\t\t\tfrom \"../image/GL_ImageBase\";\n\n/**\n *\n * @class away.pool.GL_ImageBase\n */\nexport class GL_Image2D extends GL_ImageBase\n{\n\t/**\n\t *\n\t * @param context\n\t * @returns {ITexture}\n\t */\n\tpublic _createTexture():void\n\t{\n\t\tthis._texture = this._stage.context.createTexture((<Image2D> this._asset).width, (<Image2D> this._asset).height, ContextGLTextureFormat.BGRA, true);\n\t}\n}",
    "import {AbstractMethodError}\t\t\tfrom \"awayjs-core/lib/errors/AbstractMethodError\";\nimport {AssetEvent}\t\t\t\t\tfrom \"awayjs-core/lib/events/AssetEvent\";\nimport {IAsset}\t\t\t\t\t\tfrom \"awayjs-core/lib/library/IAsset\";\nimport {AbstractionBase}\t\t\t\tfrom \"awayjs-core/lib/library/AbstractionBase\";\n\nimport {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\nimport {ITextureBase}\t\t\t\t\tfrom \"../base/ITextureBase\";\n\n/**\n *\n * @class away.pool.GL_ImageBase\n */\nexport class GL_ImageBase extends AbstractionBase\n{\n\tpublic usages:number = 0;\n\n\tpublic _texture:ITextureBase;\n\n\tpublic _mipmap:boolean;\n\n\tpublic _stage:Stage;\n\n\tpublic get texture():ITextureBase\n\t{\n\t\tif (!this._texture) {\n\t\t\tthis._createTexture();\n\t\t\tthis._invalid = true;\n\t\t}\n\n\t\treturn this._texture;\n\t}\n\n\tconstructor(asset:IAsset, stage:Stage)\n\t{\n\t\tsuper(asset, stage);\n\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic onClear(event:AssetEvent):void\n\t{\n\t\tsuper.onClear(event);\n\n\t\tif (this._texture) {\n\t\t\tthis._texture.dispose();\n\t\t\tthis._texture = null;\n\t\t}\n\t}\n\n\tpublic activate(index:number, mipmap:boolean):void\n\t{\n\t\tthis._stage.context.setTextureAt(index, this._texture);\n\t}\n\n\tpublic _createTexture():void\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}",
    "import {ImageCube}\t\t\t\t\tfrom \"awayjs-core/lib/image/ImageCube\";\n\nimport {ContextGLTextureFormat}\t\tfrom \"../base/ContextGLTextureFormat\";\nimport {GL_ImageBase}\t\t\t\t\tfrom \"../image/GL_ImageBase\";\n\n/**\n *\n * @class away.pool.GL_ImageCubeBase\n */\nexport class GL_ImageCube extends GL_ImageBase\n{\n\t/**\n\t *\n\t * @param context\n\t * @returns {ITexture}\n\t */\n\tpublic _createTexture():void\n\t{\n\t\tthis._texture = this._stage.context.createCubeTexture((<ImageCube> this._asset).size, ContextGLTextureFormat.BGRA, false);\n\t}\n}",
    "import {GL_Image2D}\t\t\t\t\tfrom \"../image/GL_Image2D\";\n\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nexport class GL_RenderImage2D extends GL_Image2D\n{\n\n\tpublic activate(index:number, mipmap:boolean):void\n\t{\n\t\tsuper.activate(index, false);\n\n\t\t//TODO: allow automatic mipmap generation\n\t}\n}",
    "import {GL_ImageCube}\t\t\t\t\tfrom \"../image/GL_ImageCube\";\n\n/**\n *\n * @class away.pool.ImageObjectBase\n */\nexport class GL_RenderImageCube extends GL_ImageCube\n{\n\tpublic activate(index:number, mipmap:boolean):void\n\t{\n\t\tsuper.activate(index, false);\n\n\t\t//TODO: allow automatic mipmap generation\n\n\t}\n}",
    "import {Sampler2D}\t\t\t\t\tfrom \"awayjs-core/lib/image/Sampler2D\";\n\nimport {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\nimport {GL_SamplerBase}\t\t\t\tfrom \"../image/GL_SamplerBase\";\n\n/**\n *\n * @class away.pool.GL_SamplerBase\n */\nexport class GL_Sampler2D extends GL_SamplerBase\n{\n\tpublic _sampler:Sampler2D;\n\n\tconstructor(sampler:Sampler2D, stage:Stage)\n\t{\n\t\tsuper(sampler, stage);\n\n\t\tthis._sampler = sampler;\n\t}\n\n\tpublic activate(index:number):void\n\t{\n\t\tthis._stage.setSamplerState(index, this._sampler.repeat, this._sampler.smooth, this._sampler.mipmap);\n\t}\n}",
    "import {AbstractMethodError}\t\t\tfrom \"awayjs-core/lib/errors/AbstractMethodError\";\nimport {IAsset}\t\t\t\t\t\tfrom \"awayjs-core/lib/library/IAsset\";\nimport {AbstractionBase}\t\t\t\tfrom \"awayjs-core/lib/library/AbstractionBase\";\n\nimport {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\n\n/**\n *\n * @class away.pool.GL_SamplerBase\n */\nexport class GL_SamplerBase extends AbstractionBase\n{\n\tpublic _stage:Stage;\n\n\tconstructor(asset:IAsset, stage:Stage)\n\t{\n\t\tsuper(asset, stage);\n\n\t\tthis._stage = stage;\n\t}\n\n\tpublic activate(index:number):void\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n}",
    "import {SamplerCube}\t\t\t\t\tfrom \"awayjs-core/lib/image/SamplerCube\";\n\nimport {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\nimport {GL_SamplerBase}\t\t\t\tfrom \"../image/GL_SamplerBase\";\n\n/**\n *\n * @class away.pool.GL_SamplerBase\n */\nexport class GL_SamplerCube extends GL_SamplerBase\n{\n\tpublic _sampler:SamplerCube;\n\n\tconstructor(sampler:SamplerCube, stage:Stage)\n\t{\n\t\tsuper(sampler, stage);\n\n\t\tthis._sampler = sampler;\n\t}\n\n\tpublic activate(index:number):void\n\t{\n\t\tthis._stage.setSamplerState(index, false, this._sampler.smooth, this._sampler.mipmap);\n\t}\n}",
    "import {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\nimport {ProgramData}\t\t\t\t\tfrom \"../image/ProgramData\";\n\n/**\n * @class away.pool.ProgramDataPool\n */\nexport class ProgramDataPool\n{\n\tprivate _pool:Object = new Object();\n\tprivate _stage:Stage;\n\n\t/**\n\t * //TODO\n\t *\n\t * @param textureDataClass\n\t */\n\tconstructor(stage:Stage)\n\t{\n\t\tthis._stage = stage;\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t * @returns ITexture\n\t */\n\tpublic getItem(vertexString:string, fragmentString:string):ProgramData\n\t{\n\t\tvar key:string = vertexString + fragmentString;\n\t\treturn this._pool[key] || (this._pool[key] = new ProgramData(this, this._stage, vertexString, fragmentString));\n\t}\n\n\t/**\n\t * //TODO\n\t *\n\t * @param materialOwner\n\t */\n\tpublic disposeItem(key:string):void\n\t{\n\t\tthis._pool[key] = null;\n\t}\n}",
    "import {ProgramDataPool}\t\t\t\tfrom \"../image/ProgramDataPool\";\nimport {IProgram}\t\t\t\t\t\tfrom \"../base/IProgram\";\nimport {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\n\n/**\n *\n * @class away.pool.ProgramDataBase\n */\nexport class ProgramData\n{\n\tpublic static PROGRAMDATA_ID_COUNT:number = 0;\n\n\tprivate _pool:ProgramDataPool;\n\n\tpublic vertexString:string;\n\n\tpublic fragmentString:string;\n\n\tpublic stage:Stage;\n\n\tpublic usages:number = 0;\n\n\tpublic program:IProgram;\n\n\tpublic id:number;\n\n\tconstructor(pool:ProgramDataPool, context:Stage, vertexString:string, fragmentString:string)\n\t{\n\t\tthis._pool = pool;\n\t\tthis.stage = context;\n\t\tthis.vertexString = vertexString;\n\t\tthis.fragmentString = fragmentString;\n\t\tthis.stage.registerProgram(this);\n\t}\n\n\t/**\n\t *\n\t */\n\tpublic dispose():void\n\t{\n\t\tthis.usages--;\n\n\t\tif (!this.usages) {\n\t\t\tthis._pool.disposeItem(this.vertexString + this.fragmentString);\n\n\t\t\tthis.stage.unRegisterProgram(this);\n\n\t\t\tif (this.program) {\n\t\t\t\tthis.program.dispose();\n\t\t\t\tthis.program = null;\n\t\t\t}\n\t\t}\n\t}\n}",
    "export {GL_BitmapImage2D}\t\t\t\tfrom \"./image/GL_BitmapImage2D\";\nexport {GL_BitmapImageCube}\t\t\t\tfrom \"./image/GL_BitmapImageCube\";\nexport {GL_Image2D}\t\t\t\t\t\tfrom \"./image/GL_Image2D\";\nexport {GL_ImageBase}\t\t\t\t\tfrom \"./image/GL_ImageBase\";\nexport {GL_ImageCube}\t\t\t\t\tfrom \"./image/GL_ImageCube\";\nexport {GL_RenderImage2D}\t\t\t\tfrom \"./image/GL_RenderImage2D\";\nexport {GL_RenderImageCube}\t\t\t\tfrom \"./image/GL_RenderImageCube\";\nexport {GL_Sampler2D}\t\t\t\t\tfrom \"./image/GL_Sampler2D\";\nexport {GL_SamplerBase}\t\t\t\t\tfrom \"./image/GL_SamplerBase\";\nexport {GL_SamplerCube}\t\t\t\t\tfrom \"./image/GL_SamplerCube\";\nexport {ProgramData}\t\t\t\t\t\tfrom \"./image/ProgramData\";\nexport {ProgramDataPool}\t\t\t\t\tfrom \"./image/ProgramDataPool\";",
    "import {EventDispatcher}\t\t\t\tfrom \"awayjs-core/lib/events/EventDispatcher\";\nimport {ArgumentError}\t\t\t\tfrom \"awayjs-core/lib/errors/ArgumentError\";\n\nimport {Stage}\t\t\t\t\t\tfrom \"../base/Stage\";\nimport {StageEvent}\t\t\t\t\tfrom \"../events/StageEvent\";\n\n/**\n * The StageManager class provides a multiton object that handles management for Stage objects.\n *\n * @see away.base.Stage\n */\nexport class StageManager extends EventDispatcher\n{\n\tprivate static STAGE_MAX_QUANTITY:number = 8;\n\tprivate _stages:Array<Stage>;\n\n\tprivate static _instance:StageManager;\n\tprivate static _numStages:number = 0;\n\tprivate _onContextCreatedDelegate:(event:StageEvent) => void;\n\n\t/**\n\t * Creates a new StageManager class.\n\t * @param stage The Stage object that contains the Stage objects to be managed.\n\t * @private\n\t */\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis._stages = new Array<Stage>(StageManager.STAGE_MAX_QUANTITY);\n\n\t\tthis._onContextCreatedDelegate = (event:StageEvent) => this.onContextCreated(event);\n\t}\n\n\t/**\n\t * Gets a StageManager instance for the given Stage object.\n\t * @param stage The Stage object that contains the Stage objects to be managed.\n\t * @return The StageManager instance for the given Stage object.\n\t */\n\tpublic static getInstance():StageManager\n\t{\n\t\tif (this._instance == null)\n\t\t\tthis._instance = new StageManager();\n\n\t\treturn this._instance;\n\t}\n\n\t/**\n\t * Requests the Stage for the given index.\n\t *\n\t * @param index The index of the requested Stage.\n\t * @param forceSoftware Whether to force software mode even if hardware acceleration is available.\n\t * @param profile The compatibility profile, an enumeration of ContextProfile\n\t * @return The Stage for the given index.\n\t */\n\tpublic getStageAt(index:number, forceSoftware:boolean = false, profile:string = \"baseline\", mode:string = \"auto\"):Stage\n\t{\n\t\tif (index < 0 || index >= StageManager.STAGE_MAX_QUANTITY)\n\t\t\tthrow new ArgumentError(\"Index is out of bounds [0..\" + StageManager.STAGE_MAX_QUANTITY + \"]\");\n\n\t\tif (!this._stages[index]) {\n\t\t\tStageManager._numStages++;\n\n\t\t\tif(document) {\n\t\t\t\tvar canvas:HTMLCanvasElement = document.createElement(\"canvas\");\n\t\t\t\tcanvas.id = \"stage\" + index;\n\t\t\t\tdocument.body.appendChild(canvas);\n\t\t\t}\n\t\t\tvar stage:Stage = this._stages[index] = new Stage(canvas, index, this, forceSoftware, profile);\n\t\t\tstage.addEventListener(StageEvent.CONTEXT_CREATED, this._onContextCreatedDelegate);\n\t\t\tstage.requestContext(forceSoftware, profile, mode);\n\t\t}\n\n\t\treturn stage;\n\t}\n\n\t/**\n\t * Removes a Stage from the manager.\n\t * @param stage\n\t * @private\n\t */\n\tpublic iRemoveStage(stage:Stage):void\n\t{\n\t\tStageManager._numStages--;\n\n\t\tstage.removeEventListener(StageEvent.CONTEXT_CREATED, this._onContextCreatedDelegate);\n\n\t\tthis._stages[stage.stageIndex] = null;\n\t}\n\n\t/**\n\t * Get the next available stage. An error is thrown if there are no StageProxies available\n\t * @param forceSoftware Whether to force software mode even if hardware acceleration is available.\n\t * @param profile The compatibility profile, an enumeration of ContextProfile\n\t * @return The allocated stage\n\t */\n\tpublic getFreeStage(forceSoftware:boolean = false, profile:string = \"baseline\", mode:string = \"auto\"):Stage\n\t{\n\t\tvar i:number = 0;\n\t\tvar len:number = this._stages.length;\n\n\t\twhile (i < len) {\n\t\t\tif (!this._stages[i])\n\t\t\t\treturn this.getStageAt(i, forceSoftware, profile, mode);\n\n\t\t\t++i;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t/**\n\t * Checks if a new stage can be created and managed by the class.\n\t * @return true if there is one slot free for a new stage\n\t */\n\tpublic get hasFreeStage():boolean\n\t{\n\t\treturn StageManager._numStages < StageManager.STAGE_MAX_QUANTITY? true : false;\n\t}\n\n\t/**\n\t * Returns the amount of stage objects that can be created and managed by the class\n\t * @return the amount of free slots\n\t */\n\tpublic get numSlotsFree():number\n\t{\n\t\treturn StageManager.STAGE_MAX_QUANTITY - StageManager._numStages;\n\t}\n\n\t/**\n\t * Returns the amount of Stage objects currently managed by the class.\n\t * @return the amount of slots used\n\t */\n\tpublic get numSlotsUsed():number\n\t{\n\t\treturn StageManager._numStages;\n\t}\n\n\t/**\n\t * The maximum amount of Stage objects that can be managed by the class\n\t */\n\tpublic get numSlotsTotal():number\n\t{\n\t\treturn this._stages.length;\n\t}\n\n\tprivate onContextCreated(event:StageEvent):void\n\t{\n\t\t//var stage:Stage = <Stage> e.target;\n\t\t//document.body.appendChild(stage.canvas)\n\t}\n}",
    "export {StageManager}\t\t\t\t\tfrom \"./managers/StageManager\";"
  ],
  "sourceRoot": ""
}