var MaterialPassDataPool = require("awayjs-stagegl/lib/pool/MaterialPassDataPool");
/**
 *
 * @class away.pool.MaterialData
 */
var MaterialData = (function () {
    function MaterialData(pool, context, material) {
        this.invalidAnimation = true;
        this._pool = pool;
        this.context = context;
        this.material = material;
        this._materialPassDataPool = new MaterialPassDataPool(material);
    }
    MaterialData.prototype.getMaterialPass = function (materialPass, profile) {
        var materialPassData = this._materialPassDataPool.getItem(materialPass);
        if (!materialPassData.shaderObject) {
            materialPassData.shaderObject = materialPass.createShaderObject(profile);
            materialPassData.invalid = true;
        }
        if (materialPassData.invalid) {
            materialPassData.invalid = false;
            var compiler = materialPassData.shaderObject.createCompiler(this.material, materialPass);
            compiler.compile();
            materialPassData.shadedTarget = compiler.shadedTarget;
            materialPassData.vertexCode = compiler.vertexCode;
            materialPassData.fragmentCode = compiler.fragmentCode;
            materialPassData.postAnimationFragmentCode = compiler.postAnimationFragmentCode;
            materialPassData.key = "";
        }
        return materialPassData;
    };
    MaterialData.prototype.getMaterialPasses = function (profile) {
        if (this._passes == null) {
            var passes = this.material._iScreenPasses;
            var numPasses = passes.length;
            //reset the material passes in MaterialData
            this._passes = new Array(numPasses);
            for (var i = 0; i < numPasses; i++)
                this._passes[i] = this.getMaterialPass(passes[i], profile);
        }
        return this._passes;
    };
    /**
     *
     */
    MaterialData.prototype.dispose = function () {
        this._materialPassDataPool.disposePool();
        this._materialPassDataPool = null;
        this._pool.disposeItem(this.material);
        this._passes = null;
    };
    /**
     *
     */
    MaterialData.prototype.invalidateMaterial = function () {
        this._passes = null;
        this.invalidateAnimation();
    };
    /**
     *
     */
    MaterialData.prototype.invalidateAnimation = function () {
        this.invalidAnimation = true;
    };
    return MaterialData;
})();
module.exports = MaterialData;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1zdGFnZWdsL2xpYi9wb29sL21hdGVyaWFsZGF0YS50cyJdLCJuYW1lcyI6WyJNYXRlcmlhbERhdGEiLCJNYXRlcmlhbERhdGEuY29uc3RydWN0b3IiLCJNYXRlcmlhbERhdGEuZ2V0TWF0ZXJpYWxQYXNzIiwiTWF0ZXJpYWxEYXRhLmdldE1hdGVyaWFsUGFzc2VzIiwiTWF0ZXJpYWxEYXRhLmRpc3Bvc2UiLCJNYXRlcmlhbERhdGEuaW52YWxpZGF0ZU1hdGVyaWFsIiwiTWF0ZXJpYWxEYXRhLmludmFsaWRhdGVBbmltYXRpb24iXSwibWFwcGluZ3MiOiJBQUlBLElBQU8sb0JBQW9CLFdBQWEsOENBQThDLENBQUMsQ0FBQztBQU94RixBQUlBOzs7R0FERztJQUNHLFlBQVk7SUFnQmpCQSxTQWhCS0EsWUFBWUEsQ0FnQkxBLElBQXFCQSxFQUFFQSxPQUFxQkEsRUFBRUEsUUFBNEJBO1FBRi9FQyxxQkFBZ0JBLEdBQVdBLElBQUlBLENBQUNBO1FBSXRDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUNsQkEsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsT0FBT0EsQ0FBQ0E7UUFDdkJBLElBQUlBLENBQUNBLFFBQVFBLEdBQUdBLFFBQVFBLENBQUNBO1FBRXpCQSxJQUFJQSxDQUFDQSxxQkFBcUJBLEdBQUdBLElBQUlBLG9CQUFvQkEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7SUFDakVBLENBQUNBO0lBRU1ELHNDQUFlQSxHQUF0QkEsVUFBdUJBLFlBQTZCQSxFQUFFQSxPQUFjQTtRQUVuRUUsSUFBSUEsZ0JBQWdCQSxHQUFvQkEsSUFBSUEsQ0FBQ0EscUJBQXFCQSxDQUFDQSxPQUFPQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQTtRQUV6RkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNwQ0EsZ0JBQWdCQSxDQUFDQSxZQUFZQSxHQUFHQSxZQUFZQSxD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QWIsWUFBWSxDQUFDIiwiZmlsZSI6InBvb2wvTWF0ZXJpYWxEYXRhLmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJTWF0ZXJpYWxEYXRhXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcG9vbC9JTWF0ZXJpYWxEYXRhXCIpO1xuXG5pbXBvcnQgTWF0ZXJpYWxEYXRhUG9vbFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL3Bvb2wvTWF0ZXJpYWxEYXRhUG9vbFwiKTtcbmltcG9ydCBNYXRlcmlhbFBhc3NEYXRhXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvcG9vbC9NYXRlcmlhbFBhc3NEYXRhXCIpO1xuaW1wb3J0IE1hdGVyaWFsUGFzc0RhdGFQb29sXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL3Bvb2wvTWF0ZXJpYWxQYXNzRGF0YVBvb2xcIik7XG5pbXBvcnQgQ29udGV4dEdMQmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvQ29udGV4dEdMQmFzZVwiKTtcbmltcG9ydCBTdGFnZUdMTWF0ZXJpYWxCYXNlXHRcdFx0PSByZXF1aXJlKFwibWF0ZXJpYWxzL1N0YWdlR0xNYXRlcmlhbEJhc2VcIik7XG5pbXBvcnQgTWF0ZXJpYWxQYXNzQmFzZVx0XHRcdFx0PSByZXF1aXJlKFwibWF0ZXJpYWxzL3Bhc3Nlcy9NYXRlcmlhbFBhc3NCYXNlXCIpO1xuaW1wb3J0IFNoYWRlckNvbXBpbGVyQmFzZVx0XHRcdD0gcmVxdWlyZShcIm1hdGVyaWFscy9jb21waWxhdGlvbi9TaGFkZXJDb21waWxlckJhc2VcIik7XG5pbXBvcnQgU2hhZGVyT2JqZWN0QmFzZVx0XHRcdFx0PSByZXF1aXJlKFwibWF0ZXJpYWxzL2NvbXBpbGF0aW9uL1NoYWRlck9iamVjdEJhc2VcIik7XG5cbi8qKlxuICpcbiAqIEBjbGFzcyBhd2F5LnBvb2wuTWF0ZXJpYWxEYXRhXG4gKi9cbmNsYXNzIE1hdGVyaWFsRGF0YSBpbXBsZW1lbnRzIElNYXRlcmlhbERhdGFcbntcblx0cHJpdmF0ZSBfcG9vbDpNYXRlcmlhbERhdGFQb29sO1xuXG5cdHByaXZhdGUgX21hdGVyaWFsUGFzc0RhdGFQb29sOk1hdGVyaWFsUGFzc0RhdGFQb29sO1xuXG5cdHByaXZhdGUgX3Bhc3NlczpBcnJheTxNYXRlcmlhbFBhc3NEYXRhPjtcblxuXHRwdWJsaWMgY29udGV4dDpDb250ZXh0R0xCYXNlO1xuXG5cdHB1YmxpYyBtYXRlcmlhbDpTdGFnZUdMTWF0ZXJpYWxCYXNlO1xuXG5cdHB1YmxpYyByZW5kZXJPcmRlcklkOm51bWJlcjtcblxuXHRwdWJsaWMgaW52YWxpZEFuaW1hdGlvbjpib29sZWFuID0gdHJ1ZTtcblxuXHRjb25zdHJ1Y3Rvcihwb29sOk1hdGVyaWFsRGF0YVBvb2wsIGNvbnRleHQ6Q29udGV4dEdMQmFzZSwgbWF0ZXJpYWw6U3RhZ2VHTE1hdGVyaWFsQmFzZSlcblx0e1xuXHRcdHRoaXMuX3Bvb2wgPSBwb29sO1xuXHRcdHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG5cdFx0dGhpcy5tYXRlcmlhbCA9IG1hdGVyaWFsO1xuXG5cdFx0dGhpcy5fbWF0ZXJpYWxQYXNzRGF0YVBvb2wgPSBuZXcgTWF0ZXJpYWxQYXNzRGF0YVBvb2wobWF0ZXJpYWwpO1xuXHR9XG5cblx0cHVibGljIGdldE1hdGVyaWFsUGFzcyhtYXRlcmlhbFBhc3M6TWF0ZXJpYWxQYXNzQmFzZSwgcHJvZmlsZTpzdHJpbmcpOk1hdGVyaWFsUGFzc0RhdGFcblx0e1xuXHRcdHZhciBtYXRlcmlhbFBhc3NEYXRhOk1hdGVyaWFsUGFzc0RhdGEgPSB0aGlzLl9tYXRlcmlhbFBhc3NEYXRhUG9vbC5nZXRJdGVtKG1hdGVyaWFsUGFzcyk7XG5cblx0XHRpZiAoIW1hdGVyaWFsUGFzc0RhdGEuc2hhZGVyT2JqZWN0KSB7XG5cdFx0XHRtYXRlcmlhbFBhc3NEYXRhLnNoYWRlck9iamVjdCA9IG1hdGVyaWFsUGFzcy5jcmVhdGVTaGFkZXJPYmplY3QocHJvZmlsZSk7XG5cdFx0XHRtYXRlcmlhbFBhc3NEYXRhLmludmFsaWQgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmIChtYXRlcmlhbFBhc3NEYXRhLmludmFsaWQpIHtcblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEuaW52YWxpZCA9IGZhbHNlO1xuXHRcdFx0dmFyIGNvbXBpbGVyOlNoYWRlckNvbXBpbGVyQmFzZSA9IG1hdGVyaWFsUGFzc0RhdGEuc2hhZGVyT2JqZWN0LmNyZWF0ZUNvbXBpbGVyKHRoaXMubWF0ZXJpYWwsIG1hdGVyaWFsUGFzcyk7XG5cdFx0XHRjb21waWxlci5jb21waWxlKCk7XG5cblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEuc2hhZGVkVGFyZ2V0ID0gY29tcGlsZXIuc2hhZGVkVGFyZ2V0O1xuXHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS52ZXJ0ZXhDb2RlID0gY29tcGlsZXIudmVydGV4Q29kZTtcblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEuZnJhZ21lbnRDb2RlID0gY29tcGlsZXIuZnJhZ21lbnRDb2RlO1xuXHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5wb3N0QW5pbWF0aW9uRnJhZ21lbnRDb2RlID0gY29tcGlsZXIucG9zdEFuaW1hdGlvbkZyYWdtZW50Q29kZTtcblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEua2V5ID0gXCJcIjtcblx0XHR9XG5cblx0XHRyZXR1cm4gbWF0ZXJpYWxQYXNzRGF0YTtcblx0fVxuXG5cdHB1YmxpYyBnZXRNYXRlcmlhbFBhc3Nlcyhwcm9maWxlOnN0cmluZyk6QXJyYXk8TWF0ZXJpYWxQYXNzRGF0YT5cblx0e1xuXHRcdGlmICh0aGlzLl9wYXNzZXMgPT0gbnVsbCkge1xuXHRcdFx0dmFyIHBhc3NlczpBcnJheTxNYXRlcmlhbFBhc3NCYXNlPiA9IDxBcnJheTxNYXRlcmlhbFBhc3NCYXNlPj4gdGhpcy5tYXRlcmlhbC5faVNjcmVlblBhc3Nlcztcblx0XHRcdHZhciBudW1QYXNzZXM6bnVtYmVyID0gcGFzc2VzLmxlbmd0aDtcblxuXHRcdFx0Ly9yZXNldCB0aGUgbWF0ZXJpYWwgcGFzc2VzIGluIE1hdGVyaWFsRGF0YVxuXHRcdFx0dGhpcy5fcGFzc2VzID0gbmV3IEFycmF5PE1hdGVyaWFsUGFzc0RhdGE+KG51bVBhc3Nlcyk7XG5cblx0XHRcdC8vZ2V0IHRoZSBzaGFkZXIgb2JqZWN0IGZvciBlYWNoIHNjcmVlbiBwYXNzIGFuZCBzdG9yZVxuXHRcdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgbnVtUGFzc2VzOyBpKyspXG5cdFx0XHRcdHRoaXMuX3Bhc3Nlc1tpXSA9IHRoaXMuZ2V0TWF0ZXJpYWxQYXNzKHBhc3Nlc1tpXSwgcHJvZmlsZSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuX3Bhc3Nlcztcblx0fVxuXG5cdC8qKlxuXHQgKlxuXHQgKi9cblx0cHVibGljIGRpc3Bvc2UoKVxuXHR7XG5cdFx0dGhpcy5fbWF0ZXJpYWxQYXNzRGF0YVBvb2wuZGlzcG9zZVBvb2woKTtcblxuXHRcdHRoaXMuX21hdGVyaWFsUGFzc0RhdGFQb29sID0gbnVsbDtcblxuXHRcdHRoaXMuX3Bvb2wuZGlzcG9zZUl0ZW0odGhpcy5tYXRlcmlhbCk7XG5cblx0XHR0aGlzLl9wYXNzZXMgPSBudWxsO1xuXHR9XG5cblx0LyoqXG5cdCAqXG5cdCAqL1xuXHRwdWJsaWMgaW52YWxpZGF0ZU1hdGVyaWFsKClcblx0e1xuXHRcdHRoaXMuX3Bhc3NlcyA9IG51bGw7XG5cblx0XHR0aGlzLmludmFsaWRhdGVBbmltYXRpb24oKTtcblx0fVxuXG5cdC8qKlxuXHQgKlxuXHQgKi9cblx0cHVibGljIGludmFsaWRhdGVBbmltYXRpb24oKVxuXHR7XG5cdFx0dGhpcy5pbnZhbGlkQW5pbWF0aW9uID0gdHJ1ZTtcblx0fVxufVxuXG5leHBvcnQgPSBNYXRlcmlhbERhdGE7Il19