var TriangleSubGeometry = require("awayjs-core/lib/core/base/TriangleSubGeometry");
var ContextGLTriangleFace = require("awayjs-stagegl/lib/core/stagegl/ContextGLTriangleFace");
var ShaderCompilerBase = require("awayjs-stagegl/lib/materials/compilation/ShaderCompilerBase");
/**
 * ShaderObjectBase keeps track of the number of dependencies for "named registers" used across a pass.
 * Named registers are that are not necessarily limited to a single method. They are created by the compiler and
 * passed on to methods. The compiler uses the results to reserve usages through RegisterPool, which can be removed
 * each time a method has been compiled into the shader.
 *
 * @see RegisterPool.addUsage
 */
var ShaderObjectBase = (function () {
    /**
     * Creates a new MethodCompilerVO object.
     */
    function ShaderObjectBase(profile) {
        this._defaultCulling = ContextGLTriangleFace.BACK;
        this._pInverseSceneMatrix = new Array();
        //set ambient values to default
        this.ambientR = 0xFF;
        this.ambientG = 0xFF;
        this.ambientB = 0xFF;
        /**
         * Indicates whether there are any dependencies on the world-space position vector.
         */
        this.usesGlobalPosFragment = false;
        this.vertexConstantData = new Array();
        this.fragmentConstantData = new Array();
        this.profile = profile;
    }
    /**
     * Factory method to create a concrete compiler object for this object
     *
     * @param materialPassVO
     * @returns {away.materials.ShaderCompilerBase}
     */
    ShaderObjectBase.prototype.createCompiler = function (material, materialPass) {
        return new ShaderCompilerBase(material, materialPass, this);
    };
    /**
     * Clears dependency counts for all registers. Called when recompiling a pass.
     */
    ShaderObjectBase.prototype.reset = function () {
        this.projectionDependencies = 0;
        this.normalDependencies = 0;
        this.viewDirDependencies = 0;
        this.uvDependencies = 0;
        this.secondaryUVDependencies = 0;
        this.globalPosDependencies = 0;
        this.tangentDependencies = 0;
        this.usesGlobalPosFragment = false;
        this.usesFragmentAnimation = false;
        this.usesTangentSpace = false;
        this.outputsNormals = false;
        this.outputsTangentNormals = false;
    };
    /**
     * Adds any external world space dependencies, used to force world space calculations.
     */
    ShaderObjectBase.prototype.addWorldSpaceDependencies = function (fragmentLights) {
        if (this.viewDirDependencies > 0)
            ++this.globalPosDependencies;
    };
    ShaderObjectBase.prototype.pInitRegisterIndices = function () {
        this.commonsDataIndex = -1;
        this.cameraPositionIndex = -1;
        this.uvBufferIndex = -1;
        this.uvTransformIndex = -1;
        this.secondaryUVBufferIndex = -1;
        this.normalBufferIndex = -1;
        this.tangentBufferIndex = -1;
        this.sceneMatrixIndex = -1;
        this.sceneNormalMatrixIndex = -1;
    };
    /**
     * Initializes the unchanging constant data for this shader object.
     */
    ShaderObjectBase.prototype.initConstantData = function (registerCache, animatableAttributes, animationTargetRegisters, uvSource, uvTarget) {
        //Updates the amount of used register indices.
        this.numUsedVertexConstants = registerCache.numUsedVertexConstants;
        this.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;
        this.numUsedStreams = registerCache.numUsedStreams;
        this.numUsedTextures = registerCache.numUsedTextures;
        this.numUsedVaryings = registerCache.numUsedVaryings;
        this.numUsedFragmentConstants = registerCache.numUsedFragmentConstants;
        this.animatableAttributes = animatableAttributes;
        this.animationTargetRegisters = animationTargetRegisters;
        this.uvSource = uvSource;
        this.uvTarget = uvTarget;
        this.vertexConstantData.length = this.numUsedVertexConstants * 4;
        this.fragmentConstantData.length = this.numUsedFragmentConstants * 4;
        //Initializes commonly required constant values.
        this.fragmentConstantData[this.commonsDataIndex] = .5;
        this.fragmentConstantData[this.commonsDataIndex + 1] = 0;
        this.fragmentConstantData[this.commonsDataIndex + 2] = 1 / 255;
        this.fragmentConstantData[this.commonsDataIndex + 3] = 1;
        //Initializes the default UV transformation matrix.
        if (this.uvTransformIndex >= 0) {
            this.vertexConstantData[this.uvTransformIndex] = 1;
            this.vertexConstantData[this.uvTransformIndex + 1] = 0;
            this.vertexConstantData[this.uvTransformIndex + 2] = 0;
            this.vertexConstantData[this.uvTransformIndex + 3] = 0;
            this.vertexConstantData[this.uvTransformIndex + 4] = 0;
            this.vertexConstantData[this.uvTransformIndex + 5] = 1;
            this.vertexConstantData[this.uvTransformIndex + 6] = 0;
            this.vertexConstantData[this.uvTransformIndex + 7] = 0;
        }
        if (this.cameraPositionIndex >= 0)
            this.vertexConstantData[this.cameraPositionIndex + 3] = 1;
    };
    /**
     * @inheritDoc
     */
    ShaderObjectBase.prototype.iActivate = function (stage, camera) {
        stage.context.setCulling(this.useBothSides ? ContextGLTriangleFace.NONE : this._defaultCulling, camera.projection.coordinateSystem);
        if (!this.usesTangentSpace && this.cameraPositionIndex >= 0) {
            var pos = camera.scenePosition;
            this.vertexConstantData[this.cameraPositionIndex] = pos.x;
            this.vertexConstantData[this.cameraPositionIndex + 1] = pos.y;
            this.vertexConstantData[this.cameraPositionIndex + 2] = pos.z;
        }
    };
    /**
     * @inheritDoc
     */
    ShaderObjectBase.prototype.iDeactivate = function (stage) {
    };
    /**
     *
     *
     * @param renderable
     * @param stage
     * @param camera
     */
    ShaderObjectBase.prototype.setRenderState = function (renderable, stage, camera, viewProjection) {
        var context = stage.context;
        if (renderable.materialOwner.animator)
            renderable.materialOwner.animator.setRenderState(this, renderable, stage, camera, this.numUsedVertexConstants, this.numUsedStreams);
        if (this.uvBufferIndex >= 0)
            context.activateBuffer(this.uvBufferIndex, renderable.getVertexData(TriangleSubGeometry.UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.UV_DATA), TriangleSubGeometry.UV_FORMAT);
        if (this.secondaryUVBufferIndex >= 0)
            context.activateBuffer(this.secondaryUVBufferIndex, renderable.getVertexData(TriangleSubGeometry.SECONDARY_UV_DATA), renderable.getVertexOffset(TriangleSubGeometry.SECONDARY_UV_DATA), TriangleSubGeometry.SECONDARY_UV_FORMAT);
        if (this.normalBufferIndex >= 0)
            context.activateBuffer(this.normalBufferIndex, renderable.getVertexData(TriangleSubGeometry.NORMAL_DATA), renderable.getVertexOffset(TriangleSubGeometry.NORMAL_DATA), TriangleSubGeometry.NORMAL_FORMAT);
        if (this.tangentBufferIndex >= 0)
            context.activateBuffer(this.tangentBufferIndex, renderable.getVertexData(TriangleSubGeometry.TANGENT_DATA), renderable.getVertexOffset(TriangleSubGeometry.TANGENT_DATA), TriangleSubGeometry.TANGENT_FORMAT);
        if (this.usesUVTransform) {
            var uvTransform = renderable.materialOwner.uvTransform.matrix;
            if (uvTransform) {
                this.vertexConstantData[this.uvTransformIndex] = uvTransform.a;
                this.vertexConstantData[this.uvTransformIndex + 1] = uvTransform.b;
                this.vertexConstantData[this.uvTransformIndex + 3] = uvTransform.tx;
                this.vertexConstantData[this.uvTransformIndex + 4] = uvTransform.c;
                this.vertexConstantData[this.uvTransformIndex + 5] = uvTransform.d;
                this.vertexConstantData[this.uvTransformIndex + 7] = uvTransform.ty;
            }
            else {
                this.vertexConstantData[this.uvTransformIndex] = 1;
                this.vertexConstantData[this.uvTransformIndex + 1] = 0;
                this.vertexConstantData[this.uvTransformIndex + 3] = 0;
                this.vertexConstantData[this.uvTransformIndex + 4] = 0;
                this.vertexConstantData[this.uvTransformIndex + 5] = 1;
                this.vertexConstantData[this.uvTransformIndex + 7] = 0;
            }
        }
        if (this.sceneNormalMatrixIndex >= 0)
            renderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this.vertexConstantData, this.sceneNormalMatrixIndex, false);
        if (this.usesTangentSpace && this.cameraPositionIndex >= 0) {
            renderable.sourceEntity.inverseSceneTransform.copyRawDataTo(this._pInverseSceneMatrix);
            var pos = camera.scenePosition;
            var x = pos.x;
            var y = pos.y;
            var z = pos.z;
            this.vertexConstantData[this.cameraPositionIndex] = this._pInverseSceneMatrix[0] * x + this._pInverseSceneMatrix[4] * y + this._pInverseSceneMatrix[8] * z + this._pInverseSceneMatrix[12];
            this.vertexConstantData[this.cameraPositionIndex + 1] = this._pInverseSceneMatrix[1] * x + this._pInverseSceneMatrix[5] * y + this._pInverseSceneMatrix[9] * z + this._pInverseSceneMatrix[13];
            this.vertexConstantData[this.cameraPositionIndex + 2] = this._pInverseSceneMatrix[2] * x + this._pInverseSceneMatrix[6] * y + this._pInverseSceneMatrix[10] * z + this._pInverseSceneMatrix[14];
        }
    };
    ShaderObjectBase.prototype.dispose = function () {
        //TODO uncount associated program data
    };
    return ShaderObjectBase;
})();
module.exports = ShaderObjectBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hdGVyaWFscy9jb21waWxhdGlvbi9zaGFkZXJvYmplY3RiYXNlLnRzIl0sIm5hbWVzIjpbIlNoYWRlck9iamVjdEJhc2UiLCJTaGFkZXJPYmplY3RCYXNlLmNvbnN0cnVjdG9yIiwiU2hhZGVyT2JqZWN0QmFzZS5jcmVhdGVDb21waWxlciIsIlNoYWRlck9iamVjdEJhc2UucmVzZXQiLCJTaGFkZXJPYmplY3RCYXNlLmFkZFdvcmxkU3BhY2VEZXBlbmRlbmNpZXMiLCJTaGFkZXJPYmplY3RCYXNlLnBJbml0UmVnaXN0ZXJJbmRpY2VzIiwiU2hhZGVyT2JqZWN0QmFzZS5pbml0Q29uc3RhbnREYXRhIiwiU2hhZGVyT2JqZWN0QmFzZS5pQWN0aXZhdGUiLCJTaGFkZXJPYmplY3RCYXNlLmlEZWFjdGl2YXRlIiwiU2hhZGVyT2JqZWN0QmFzZS5zZXRSZW5kZXJTdGF0ZSIsIlNoYWRlck9iamVjdEJhc2UuZGlzcG9zZSJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBTyxtQkFBbUIsV0FBYSwrQ0FBK0MsQ0FBQyxDQUFDO0FBY3hGLElBQU8scUJBQXFCLFdBQVksdURBQXVELENBQUMsQ0FBQztBQUVqRyxJQUFPLGtCQUFrQixXQUFhLDZEQUE2RCxDQUFDLENBQUM7QUFJckcsQUFRQTs7Ozs7OztHQURHO0lBQ0csZ0JBQWdCO0lBa0xyQkE7O09BRUdBO0lBQ0hBLFNBckxLQSxnQkFBZ0JBLENBcUxUQSxPQUFPQTtRQWxMWEMsb0JBQWVBLEdBQVVBLHFCQUFxQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7UUFFckRBLHlCQUFvQkEsR0FBaUJBLElBQUlBLEtBQUtBLEVBQVVBLENBQUNBO1FBK0NoRUEsK0JBQStCQTtRQUN4QkEsYUFBUUEsR0FBVUEsSUFBSUEsQ0FBQ0E7UUFDdkJBLGFBQVFBLEdBQVVBLElBQUlBLENBQUNBO1FBQ3ZCQSxhQUFRQSxHQUFVQSxJQUFJQSxDQUFDQTtRQWlFOUJBOztXQUVHQTtRQUNJQSwwQkFBcUJBLEdBQVdBLEtBQUtBLENBQUNBO1FBRXRDQSx1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QUFHQSxDQUFDQSxDQUFDQTtRQUV6REEsQUFDQUEsbURBRG1EQTtRQUNuREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNoQ0EsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBQ25EQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDdkRBLElBQUlBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUN2REEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBQ3ZEQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDdkRBLElBQUlBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUN2REEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1lBQ3ZEQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDeERBLENBQUNBO1FBRURBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLG1CQUFtQkEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDakNBLElBQUlB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Q0EsR0FBR0EsV0FBV0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7Z0JBQ3BFQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsV0FBV0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ25FQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsV0FBV0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ25FQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsV0FBV0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7WUFDckVBLENBQUNBO1lBQUNBLElBQUlBLENBQUNBLENBQUNBO2dCQUNQQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ25EQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3ZEQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3ZEQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3ZEQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3ZEQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLGdCQUFnQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDeERBLENBQUNBO1FBQ0ZBLENBQUNBO1FBRURBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLHNCQUFzQkEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDcENBLFVBQVVBLENBQUNBLFlBQVlBLENBQUNBLHFCQUFxQkEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxFQUFFQSxJQUFJQSxDQUFDQSxzQkFBc0JBLEVBQUVBLEtBQUtBLENBQUNBLENBQUNBO1FBRTFIQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxnQkFBZ0JBLElBQUlBLElBQUlBLENBQUNBLG1CQUFtQkEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFNURBLFVBQVVBLENBQUNBLFlBQVlBLENBQUNBLHFCQUFxQkEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQTtZQUN2RkEsSUFBSUEsR0FBR0EsR0FBWUEsTUFBTUEsQ0FBQ0EsYUFBYUEsQ0FBQ0E7WUFDeENBLElBQUlBLENBQUNBLEdBQVVBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO1lBQ3JCQSxJQUFJQSxDQUFDQSxHQUFVQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNyQkEsSUFBSUEsQ0FBQ0EsR0FBVUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFFckJBLElBQUlBLENBQUNBLGtCQUFrQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsbUJBQW1CQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBO1lBQ3JMQSxJQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLG1CQUFtQkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxFQUFFQSxDQUFDQSxDQUFDQTtZQUN6TEEsSUFBSUEsQ0FBQ0Esa0JBQWtCQSxDQUFDQSxJQUFJQSxDQUFDQSxtQkFBbUJBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxvQkFBb0JBLENBQUNBLEVBQUVBLENBQUNBLEdBQUNBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0E7UUFDM0xBLENBQUNBO0lBQ0ZBLENBQUNBO0lBRU1ULGtDQUFPQSxHQUFkQTtRQUVDVSxzQ0FBc0NBO0lBQ3ZDQSxDQUFDQTtJQUNGVix1QkFBQ0E7QUFBREEsQ0F2WEEsQUF1WENBLElBQUE7QUFFRCxBQUEwQixpQkFBakIsZ0JBQWdCLENBQUMiLCJmaWxlIjoibWF0ZXJpYWxzL2NvbXBpbGF0aW9uL1NoYWRlck9iamVjdEJhc2UuanMiLCJzb3VyY2VSb290IjoiL1VzZXJzL3JvYmJhdGVtYW4vV2Vic3Rvcm1Qcm9qZWN0cy9hd2F5anMtc3RhZ2VnbC8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9iYXNlL1N0YWdlXCIpO1xuaW1wb3J0IFRyaWFuZ2xlU3ViR2VvbWV0cnlcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvY29yZS9iYXNlL1RyaWFuZ2xlU3ViR2VvbWV0cnlcIik7XG5pbXBvcnQgTWF0cml4XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2NvcmUvZ2VvbS9NYXRyaXhcIik7XG5pbXBvcnQgTWF0cml4M0RcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvY29yZS9nZW9tL01hdHJpeDNEXCIpO1xuaW1wb3J0IE1hdHJpeDNEVXRpbHNcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL2dlb20vTWF0cml4M0RVdGlsc1wiKTtcbmltcG9ydCBSZWN0YW5nbGVcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2NvcmUvZ2VvbS9SZWN0YW5nbGVcIik7XG5pbXBvcnQgVmVjdG9yM0RcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvY29yZS9nZW9tL1ZlY3RvcjNEXCIpO1xuaW1wb3J0IENhbWVyYVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9lbnRpdGllcy9DYW1lcmFcIik7XG5pbXBvcnQgVGV4dHVyZTJEQmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3RleHR1cmVzL1RleHR1cmUyREJhc2VcIik7XG5cbmltcG9ydCBBbmltYXRpb25TZXRCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYW5pbWF0b3JzL0FuaW1hdGlvblNldEJhc2VcIik7XG5pbXBvcnQgQW5pbWF0b3JCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9hbmltYXRvcnMvQW5pbWF0b3JCYXNlXCIpO1xuaW1wb3J0IEFuaW1hdGlvblJlZ2lzdGVyQ2FjaGVcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2FuaW1hdG9ycy9kYXRhL0FuaW1hdGlvblJlZ2lzdGVyQ2FjaGVcIik7XG5pbXBvcnQgUmVuZGVyYWJsZUJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3Bvb2wvUmVuZGVyYWJsZUJhc2VcIik7XG5pbXBvcnQgSUNvbnRleHRTdGFnZUdMXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9zdGFnZWdsL0lDb250ZXh0U3RhZ2VHTFwiKTtcbmltcG9ydCBDb250ZXh0R0xUcmlhbmdsZUZhY2VcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvc3RhZ2VnbC9Db250ZXh0R0xUcmlhbmdsZUZhY2VcIik7XG5pbXBvcnQgU3RhZ2VHTE1hdGVyaWFsQmFzZVx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9tYXRlcmlhbHMvU3RhZ2VHTE1hdGVyaWFsQmFzZVwiKTtcbmltcG9ydCBTaGFkZXJDb21waWxlckJhc2VcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvbWF0ZXJpYWxzL2NvbXBpbGF0aW9uL1NoYWRlckNvbXBpbGVyQmFzZVwiKTtcbmltcG9ydCBTaGFkZXJSZWdpc3RlckNhY2hlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL21hdGVyaWFscy9jb21waWxhdGlvbi9TaGFkZXJSZWdpc3RlckNhY2hlXCIpO1xuaW1wb3J0IElNYXRlcmlhbFBhc3NTdGFnZUdMXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL21hdGVyaWFscy9wYXNzZXMvSU1hdGVyaWFsUGFzc1N0YWdlR0xcIik7XG5cbi8qKlxuICogU2hhZGVyT2JqZWN0QmFzZSBrZWVwcyB0cmFjayBvZiB0aGUgbnVtYmVyIG9mIGRlcGVuZGVuY2llcyBmb3IgXCJuYW1lZCByZWdpc3RlcnNcIiB1c2VkIGFjcm9zcyBhIHBhc3MuXG4gKiBOYW1lZCByZWdpc3RlcnMgYXJlIHRoYXQgYXJlIG5vdCBuZWNlc3NhcmlseSBsaW1pdGVkIHRvIGEgc2luZ2xlIG1ldGhvZC4gVGhleSBhcmUgY3JlYXRlZCBieSB0aGUgY29tcGlsZXIgYW5kXG4gKiBwYXNzZWQgb24gdG8gbWV0aG9kcy4gVGhlIGNvbXBpbGVyIHVzZXMgdGhlIHJlc3VsdHMgdG8gcmVzZXJ2ZSB1c2FnZXMgdGhyb3VnaCBSZWdpc3RlclBvb2wsIHdoaWNoIGNhbiBiZSByZW1vdmVkXG4gKiBlYWNoIHRpbWUgYSBtZXRob2QgaGFzIGJlZW4gY29tcGlsZWQgaW50byB0aGUgc2hhZGVyLlxuICpcbiAqIEBzZWUgUmVnaXN0ZXJQb29sLmFkZFVzYWdlXG4gKi9cbmNsYXNzIFNoYWRlck9iamVjdEJhc2VcbntcblxuXHRwcml2YXRlIF9kZWZhdWx0Q3VsbGluZzpzdHJpbmcgPSBDb250ZXh0R0xUcmlhbmdsZUZhY2UuQkFDSztcblxuXHRwdWJsaWMgX3BJbnZlcnNlU2NlbmVNYXRyaXg6QXJyYXk8bnVtYmVyPiA9IG5ldyBBcnJheTxudW1iZXI+KCk7XG5cblx0cHVibGljIGFuaW1hdGlvblJlZ2lzdGVyQ2FjaGU6QW5pbWF0aW9uUmVnaXN0ZXJDYWNoZTtcblxuXHRwdWJsaWMgcHJvZmlsZTpzdHJpbmc7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgdXNlZCB2ZXJ0ZXggY29uc3RhbnRzIGluIHRoZSB2ZXJ0ZXggY29kZS4gVXNlZCBieSB0aGUgYW5pbWF0aW9uIGNvZGUgZ2VuZXJhdGlvbiB0byBrbm93IGZyb20gd2hpY2ggaW5kZXggb24gcmVnaXN0ZXJzIGFyZSBhdmFpbGFibGUuXG5cdCAqL1xuXHRwdWJsaWMgbnVtVXNlZFZlcnRleENvbnN0YW50czpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgdXNlZCBmcmFnbWVudCBjb25zdGFudHMgaW4gdGhlIGZyYWdtZW50IGNvZGUuIFVzZWQgYnkgdGhlIGFuaW1hdGlvbiBjb2RlIGdlbmVyYXRpb24gdG8ga25vdyBmcm9tIHdoaWNoIGluZGV4IG9uIHJlZ2lzdGVycyBhcmUgYXZhaWxhYmxlLlxuXHQgKi9cblx0cHVibGljIG51bVVzZWRGcmFnbWVudENvbnN0YW50czpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgdXNlZCB2ZXJ0ZXggc3RyZWFtcyBpbiB0aGUgdmVydGV4IGNvZGUuIFVzZWQgYnkgdGhlIGFuaW1hdGlvbiBjb2RlIGdlbmVyYXRpb24gdG8ga25vdyBmcm9tIHdoaWNoIGluZGV4IG9uIHN0cmVhbXMgYXJlIGF2YWlsYWJsZS5cblx0ICovXG5cdHB1YmxpYyBudW1Vc2VkU3RyZWFtczpudW1iZXI7XG5cblx0LyoqXG5cdCAqXG5cdCAqL1xuXHRwdWJsaWMgbnVtVXNlZFRleHR1cmVzOm51bWJlcjtcblxuXHQvKipcblx0ICpcblx0ICovXG5cdHB1YmxpYyBudW1Vc2VkVmFyeWluZ3M6bnVtYmVyO1xuXG5cdHB1YmxpYyBhbmltYXRhYmxlQXR0cmlidXRlczpBcnJheTxzdHJpbmc+O1xuXHRwdWJsaWMgYW5pbWF0aW9uVGFyZ2V0UmVnaXN0ZXJzOkFycmF5PHN0cmluZz47XG5cdHB1YmxpYyB1dlNvdXJjZTpzdHJpbmc7XG5cdHB1YmxpYyB1dlRhcmdldDpzdHJpbmc7XG5cblx0cHVibGljIHVzZUFscGhhUHJlbXVsdGlwbGllZDpib29sZWFuO1xuXHRwdWJsaWMgdXNlQm90aFNpZGVzOmJvb2xlYW47XG5cdHB1YmxpYyB1c2VNaXBtYXBwaW5nOmJvb2xlYW47XG5cdHB1YmxpYyB1c2VTbW9vdGhUZXh0dXJlczpib29sZWFuO1xuXHRwdWJsaWMgcmVwZWF0VGV4dHVyZXM6Ym9vbGVhbjtcblx0cHVibGljIHVzZXNVVlRyYW5zZm9ybTpib29sZWFuO1xuXHRwdWJsaWMgYWxwaGFUaHJlc2hvbGQ6bnVtYmVyO1xuXHRwdWJsaWMgdGV4dHVyZTpUZXh0dXJlMkRCYXNlO1xuXHRwdWJsaWMgY29sb3I6bnVtYmVyO1xuXG5cblx0Ly9zZXQgYW1iaWVudCB2YWx1ZXMgdG8gZGVmYXVsdFxuXHRwdWJsaWMgYW1iaWVudFI6bnVtYmVyID0gMHhGRjtcblx0cHVibGljIGFtYmllbnRHOm51bWJlciA9IDB4RkY7XG5cdHB1YmxpYyBhbWJpZW50QjpudW1iZXIgPSAweEZGO1xuXG5cdC8qKlxuXHQgKiBJbmRpY2F0ZXMgd2hldGhlciB0aGUgcGFzcyByZXF1aXJlcyBhbnkgZnJhZ21lbnQgYW5pbWF0aW9uIGNvZGUuXG5cdCAqL1xuXHRwdWJsaWMgdXNlc0ZyYWdtZW50QW5pbWF0aW9uOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgZGVwZW5kZW5jaWVzIG9uIHRoZSBwcm9qZWN0ZWQgcG9zaXRpb24uXG5cdCAqL1xuXHRwdWJsaWMgcHJvamVjdGlvbkRlcGVuZGVuY2llczpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgZGVwZW5kZW5jaWVzIG9uIHRoZSBub3JtYWwgdmVjdG9yLlxuXHQgKi9cblx0cHVibGljIG5vcm1hbERlcGVuZGVuY2llczpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBhbW91bnQgb2YgZGVwZW5kZW5jaWVzIG9uIHRoZSB2aWV3IGRpcmVjdGlvbi5cblx0ICovXG5cdHB1YmxpYyB2aWV3RGlyRGVwZW5kZW5jaWVzOm51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGFtb3VudCBvZiBkZXBlbmRlbmNpZXMgb24gdGhlIHByaW1hcnkgVVYgY29vcmRpbmF0ZXMuXG5cdCAqL1xuXHRwdWJsaWMgdXZEZXBlbmRlbmNpZXM6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIGRlcGVuZGVuY2llcyBvbiB0aGUgc2Vjb25kYXJ5IFVWIGNvb3JkaW5hdGVzLlxuXHQgKi9cblx0cHVibGljIHNlY29uZGFyeVVWRGVwZW5kZW5jaWVzOm51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGFtb3VudCBvZiBkZXBlbmRlbmNpZXMgb24gdGhlIGxvY2FsIHBvc2l0aW9uLiBUaGlzIGNhbiBiZSAwIHdoaWxlIGhhc0dsb2JhbFBvc0RlcGVuZGVuY2llcyBpcyB0cnVlIHdoZW5cblx0ICogdGhlIGdsb2JhbCBwb3NpdGlvbiBpcyB1c2VkIGFzIGEgdGVtcG9yYXJ5IHZhbHVlIChmZSB0byBjYWxjdWxhdGUgdGhlIHZpZXcgZGlyZWN0aW9uKVxuXHQgKi9cblx0cHVibGljIGxvY2FsUG9zRGVwZW5kZW5jaWVzOm51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGFtb3VudCBvZiBkZXBlbmRlbmNpZXMgb24gdGhlIGdsb2JhbCBwb3NpdGlvbi4gVGhpcyBjYW4gYmUgMCB3aGlsZSBoYXNHbG9iYWxQb3NEZXBlbmRlbmNpZXMgaXMgdHJ1ZSB3aGVuXG5cdCAqIHRoZSBnbG9iYWwgcG9zaXRpb24gaXMgdXNlZCBhcyBhIHRlbXBvcmFyeSB2YWx1ZSAoZmUgdG8gY2FsY3VsYXRlIHRoZSB2aWV3IGRpcmVjdGlvbilcblx0ICovXG5cdHB1YmxpYyBnbG9iYWxQb3NEZXBlbmRlbmNpZXM6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgYW1vdW50IG9mIHRhbmdlbnQgdmVjdG9yIGRlcGVuZGVuY2llcyAoZnJhZ21lbnQgc2hhZGVyKS5cblx0ICovXG5cdHB1YmxpYyB0YW5nZW50RGVwZW5kZW5jaWVzOm51bWJlcjtcblxuXHQvKipcblx0ICpcblx0ICovXG5cdHB1YmxpYyBvdXRwdXRzTm9ybWFsczpib29sZWFuO1xuXG5cdC8qKlxuXHQgKiBJbmRpY2F0ZXMgd2hldGhlciBvciBub3Qgbm9ybWFsIGNhbGN1bGF0aW9ucyBhcmUgZXhwZWN0ZWQgaW4gdGFuZ2VudCBzcGFjZS4gVGhpcyBpcyBvbmx5IHRoZSBjYXNlIGlmIG5vIHdvcmxkLXNwYWNlXG5cdCAqIGRlcGVuZGVuY2llcyBleGlzdC5cblx0ICovXG5cdHB1YmxpYyB1c2VzVGFuZ2VudFNwYWNlOmJvb2xlYW47XG5cblx0LyoqXG5cdCAqIEluZGljYXRlcyB3aGV0aGVyIG9yIG5vdCBub3JtYWwgY2FsY3VsYXRpb25zIGFyZSBvdXRwdXQgaW4gdGFuZ2VudCBzcGFjZS5cblx0ICovXG5cdHB1YmxpYyBvdXRwdXRzVGFuZ2VudE5vcm1hbHM6Ym9vbGVhbjtcblxuXHQvKipcblx0ICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlcmUgYXJlIGFueSBkZXBlbmRlbmNpZXMgb24gdGhlIHdvcmxkLXNwYWNlIHBvc2l0aW9uIHZlY3Rvci5cblx0ICovXG5cdHB1YmxpYyB1c2VzR2xvYmFsUG9zRnJhZ21lbnQ6Ym9vbGVhbiA9IGZhbHNlO1xuXG5cdHB1YmxpYyB2ZXJ0ZXhDb25zdGFudERhdGE6QXJyYXk8bnVtYmVyPiA9IG5ldyBBcnJheTxudW1iZXI+KCk7XG5cdHB1YmxpYyBmcmFnbWVudENvbnN0YW50RGF0YTpBcnJheTxudW1iZXI+ID0gbmV3IEFycmF5PG51bWJlcj4oKTtcblxuXHQvKipcblx0ICogVGhlIGluZGV4IGZvciB0aGUgY29tbW9uIGRhdGEgcmVnaXN0ZXIuXG5cdCAqL1xuXHRwdWJsaWMgY29tbW9uc0RhdGFJbmRleDpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBpbmRleCBmb3IgdGhlIFVWIHZlcnRleCBhdHRyaWJ1dGUgc3RyZWFtLlxuXHQgKi9cblx0cHVibGljIHV2QnVmZmVySW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgaW5kZXggZm9yIHRoZSBzZWNvbmRhcnkgVVYgdmVydGV4IGF0dHJpYnV0ZSBzdHJlYW0uXG5cdCAqL1xuXHRwdWJsaWMgc2Vjb25kYXJ5VVZCdWZmZXJJbmRleDpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBpbmRleCBmb3IgdGhlIHZlcnRleCBub3JtYWwgYXR0cmlidXRlIHN0cmVhbS5cblx0ICovXG5cdHB1YmxpYyBub3JtYWxCdWZmZXJJbmRleDpudW1iZXI7XG5cblx0LyoqXG5cdCAqIFRoZSBpbmRleCBmb3IgdGhlIHZlcnRleCB0YW5nZW50IGF0dHJpYnV0ZSBzdHJlYW0uXG5cdCAqL1xuXHRwdWJsaWMgdGFuZ2VudEJ1ZmZlckluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGluZGV4IG9mIHRoZSB2ZXJ0ZXggY29uc3RhbnQgY29udGFpbmluZyB0aGUgdmlldyBtYXRyaXguXG5cdCAqL1xuXHRwdWJsaWMgdmlld01hdHJpeEluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGluZGV4IG9mIHRoZSB2ZXJ0ZXggY29uc3RhbnQgY29udGFpbmluZyB0aGUgc2NlbmUgbWF0cml4LlxuXHQgKi9cblx0cHVibGljIHNjZW5lTWF0cml4SW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgaW5kZXggb2YgdGhlIHZlcnRleCBjb25zdGFudCBjb250YWluaW5nIHRoZSB1bmlmb3JtIHNjZW5lIG1hdHJpeCAodGhlIGludmVyc2UgdHJhbnNwb3NlKS5cblx0ICovXG5cdHB1YmxpYyBzY2VuZU5vcm1hbE1hdHJpeEluZGV4Om51bWJlcjtcblxuXHQvKipcblx0ICogVGhlIGluZGV4IG9mIHRoZSB2ZXJ0ZXggY29uc3RhbnQgY29udGFpbmluZyB0aGUgY2FtZXJhIHBvc2l0aW9uLlxuXHQgKi9cblx0cHVibGljIGNhbWVyYVBvc2l0aW9uSW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBUaGUgaW5kZXggZm9yIHRoZSBVViB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggdmVydGV4IGNvbnN0YW50LlxuXHQgKi9cblx0cHVibGljIHV2VHJhbnNmb3JtSW5kZXg6bnVtYmVyO1xuXG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgbmV3IE1ldGhvZENvbXBpbGVyVk8gb2JqZWN0LlxuXHQgKi9cblx0Y29uc3RydWN0b3IocHJvZmlsZSlcblx0e1xuXHRcdHRoaXMucHJvZmlsZSA9IHByb2ZpbGU7XG5cdH1cblxuXHQvKipcblx0ICogRmFjdG9yeSBtZXRob2QgdG8gY3JlYXRlIGEgY29uY3JldGUgY29tcGlsZXIgb2JqZWN0IGZvciB0aGlzIG9iamVjdFxuXHQgKlxuXHQgKiBAcGFyYW0gbWF0ZXJpYWxQYXNzVk9cblx0ICogQHJldHVybnMge2F3YXkubWF0ZXJpYWxzLlNoYWRlckNvbXBpbGVyQmFzZX1cblx0ICovXG5cdHB1YmxpYyBjcmVhdGVDb21waWxlcihtYXRlcmlhbDpTdGFnZUdMTWF0ZXJpYWxCYXNlLCBtYXRlcmlhbFBhc3M6SU1hdGVyaWFsUGFzc1N0YWdlR0wpOlNoYWRlckNvbXBpbGVyQmFzZVxuXHR7XG5cdFx0cmV0dXJuIG5ldyBTaGFkZXJDb21waWxlckJhc2UobWF0ZXJpYWwsIG1hdGVyaWFsUGFzcywgdGhpcyk7XG5cdH1cblxuXHQvKipcblx0ICogQ2xlYXJzIGRlcGVuZGVuY3kgY291bnRzIGZvciBhbGwgcmVnaXN0ZXJzLiBDYWxsZWQgd2hlbiByZWNvbXBpbGluZyBhIHBhc3MuXG5cdCAqL1xuXHRwdWJsaWMgcmVzZXQoKVxuXHR7XG5cdFx0dGhpcy5wcm9qZWN0aW9uRGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLm5vcm1hbERlcGVuZGVuY2llcyA9IDA7XG5cdFx0dGhpcy52aWV3RGlyRGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLnV2RGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLnNlY29uZGFyeVVWRGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLmdsb2JhbFBvc0RlcGVuZGVuY2llcyA9IDA7XG5cdFx0dGhpcy50YW5nZW50RGVwZW5kZW5jaWVzID0gMDtcblx0XHR0aGlzLnVzZXNHbG9iYWxQb3NGcmFnbWVudCA9IGZhbHNlO1xuXHRcdHRoaXMudXNlc0ZyYWdtZW50QW5pbWF0aW9uID0gZmFsc2U7XG5cdFx0dGhpcy51c2VzVGFuZ2VudFNwYWNlID0gZmFsc2U7XG5cdFx0dGhpcy5vdXRwdXRzTm9ybWFscyA9IGZhbHNlO1xuXHRcdHRoaXMub3V0cHV0c1RhbmdlbnROb3JtYWxzID0gZmFsc2U7XG5cdH1cblxuXHQvKipcblx0ICogQWRkcyBhbnkgZXh0ZXJuYWwgd29ybGQgc3BhY2UgZGVwZW5kZW5jaWVzLCB1c2VkIHRvIGZvcmNlIHdvcmxkIHNwYWNlIGNhbGN1bGF0aW9ucy5cblx0ICovXG5cdHB1YmxpYyBhZGRXb3JsZFNwYWNlRGVwZW5kZW5jaWVzKGZyYWdtZW50TGlnaHRzOmJvb2xlYW4pXG5cdHtcblx0XHRpZiAodGhpcy52aWV3RGlyRGVwZW5kZW5jaWVzID4gMClcblx0XHRcdCsrdGhpcy5nbG9iYWxQb3NEZXBlbmRlbmNpZXM7XG5cdH1cblxuXHRwdWJsaWMgcEluaXRSZWdpc3RlckluZGljZXMoKVxuXHR7XG5cdFx0dGhpcy5jb21tb25zRGF0YUluZGV4ID0gLTE7XG5cdFx0dGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ID0gLTE7XG5cdFx0dGhpcy51dkJ1ZmZlckluZGV4ID0gLTE7XG5cdFx0dGhpcy51dlRyYW5zZm9ybUluZGV4ID0gLTE7XG5cdFx0dGhpcy5zZWNvbmRhcnlVVkJ1ZmZlckluZGV4ID0gLTE7XG5cdFx0dGhpcy5ub3JtYWxCdWZmZXJJbmRleCA9IC0xO1xuXHRcdHRoaXMudGFuZ2VudEJ1ZmZlckluZGV4ID0gLTE7XG5cdFx0dGhpcy5zY2VuZU1hdHJpeEluZGV4ID0gLTE7XG5cdFx0dGhpcy5zY2VuZU5vcm1hbE1hdHJpeEluZGV4ID0gLTE7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZXMgdGhlIHVuY2hhbmdpbmcgY29uc3RhbnQgZGF0YSBmb3IgdGhpcyBzaGFkZXIgb2JqZWN0LlxuXHQgKi9cblx0cHVibGljIGluaXRDb25zdGFudERhdGEocmVnaXN0ZXJDYWNoZTpTaGFkZXJSZWdpc3RlckNhY2hlLCBhbmltYXRhYmxlQXR0cmlidXRlczpBcnJheTxzdHJpbmc+LCBhbmltYXRpb25UYXJnZXRSZWdpc3RlcnM6QXJyYXk8c3RyaW5nPiwgdXZTb3VyY2U6c3RyaW5nLCB1dlRhcmdldDpzdHJpbmcpXG5cdHtcblx0XHQvL1VwZGF0ZXMgdGhlIGFtb3VudCBvZiB1c2VkIHJlZ2lzdGVyIGluZGljZXMuXG5cdFx0dGhpcy5udW1Vc2VkVmVydGV4Q29uc3RhbnRzID0gcmVnaXN0ZXJDYWNoZS5udW1Vc2VkVmVydGV4Q29uc3RhbnRzO1xuXHRcdHRoaXMubnVtVXNlZEZyYWdtZW50Q29uc3RhbnRzID0gcmVnaXN0ZXJDYWNoZS5udW1Vc2VkRnJhZ21lbnRDb25zdGFudHM7XG5cdFx0dGhpcy5udW1Vc2VkU3RyZWFtcyA9IHJlZ2lzdGVyQ2FjaGUubnVtVXNlZFN0cmVhbXM7XG5cdFx0dGhpcy5udW1Vc2VkVGV4dHVyZXMgPSByZWdpc3RlckNhY2hlLm51bVVzZWRUZXh0dXJlcztcblx0XHR0aGlzLm51bVVzZWRWYXJ5aW5ncyA9IHJlZ2lzdGVyQ2FjaGUubnVtVXNlZFZhcnlpbmdzO1xuXHRcdHRoaXMubnVtVXNlZEZyYWdtZW50Q29uc3RhbnRzID0gcmVnaXN0ZXJDYWNoZS5udW1Vc2VkRnJhZ21lbnRDb25zdGFudHM7XG5cblx0XHR0aGlzLmFuaW1hdGFibGVBdHRyaWJ1dGVzID0gYW5pbWF0YWJsZUF0dHJpYnV0ZXM7XG5cdFx0dGhpcy5hbmltYXRpb25UYXJnZXRSZWdpc3RlcnMgPSBhbmltYXRpb25UYXJnZXRSZWdpc3RlcnM7XG5cdFx0dGhpcy51dlNvdXJjZSA9IHV2U291cmNlO1xuXHRcdHRoaXMudXZUYXJnZXQgPSB1dlRhcmdldDtcblxuXHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhLmxlbmd0aCA9IHRoaXMubnVtVXNlZFZlcnRleENvbnN0YW50cyo0O1xuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGEubGVuZ3RoID0gdGhpcy5udW1Vc2VkRnJhZ21lbnRDb25zdGFudHMqNDtcblxuXHRcdC8vSW5pdGlhbGl6ZXMgY29tbW9ubHkgcmVxdWlyZWQgY29uc3RhbnQgdmFsdWVzLlxuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbdGhpcy5jb21tb25zRGF0YUluZGV4XSA9IC41O1xuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbdGhpcy5jb21tb25zRGF0YUluZGV4ICsgMV0gPSAwO1xuXHRcdHRoaXMuZnJhZ21lbnRDb25zdGFudERhdGFbdGhpcy5jb21tb25zRGF0YUluZGV4ICsgMl0gPSAxLzI1NTtcblx0XHR0aGlzLmZyYWdtZW50Q29uc3RhbnREYXRhW3RoaXMuY29tbW9uc0RhdGFJbmRleCArIDNdID0gMTtcblxuXHRcdC8vSW5pdGlhbGl6ZXMgdGhlIGRlZmF1bHQgVVYgdHJhbnNmb3JtYXRpb24gbWF0cml4LlxuXHRcdGlmICh0aGlzLnV2VHJhbnNmb3JtSW5kZXggPj0gMCkge1xuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4XSA9IDE7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAxXSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAyXSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAzXSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA0XSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA1XSA9IDE7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA2XSA9IDA7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA3XSA9IDA7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuY2FtZXJhUG9zaXRpb25JbmRleCA+PSAwKVxuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ICsgM10gPSAxO1xuXHR9XG5cblxuXHQvKipcblx0ICogQGluaGVyaXREb2Ncblx0ICovXG5cdHB1YmxpYyBpQWN0aXZhdGUoc3RhZ2U6U3RhZ2UsIGNhbWVyYTpDYW1lcmEpXG5cdHtcblx0XHQoPElDb250ZXh0U3RhZ2VHTD4gc3RhZ2UuY29udGV4dCkuc2V0Q3VsbGluZyh0aGlzLnVzZUJvdGhTaWRlcz8gQ29udGV4dEdMVHJpYW5nbGVGYWNlLk5PTkUgOiB0aGlzLl9kZWZhdWx0Q3VsbGluZywgY2FtZXJhLnByb2plY3Rpb24uY29vcmRpbmF0ZVN5c3RlbSk7XG5cblx0XHRpZiAoIXRoaXMudXNlc1RhbmdlbnRTcGFjZSAmJiB0aGlzLmNhbWVyYVBvc2l0aW9uSW5kZXggPj0gMCkge1xuXHRcdFx0dmFyIHBvczpWZWN0b3IzRCA9IGNhbWVyYS5zY2VuZVBvc2l0aW9uO1xuXG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLmNhbWVyYVBvc2l0aW9uSW5kZXhdID0gcG9zLng7XG5cdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLmNhbWVyYVBvc2l0aW9uSW5kZXggKyAxXSA9IHBvcy55O1xuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ICsgMl0gPSBwb3Muejtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogQGluaGVyaXREb2Ncblx0ICovXG5cdHB1YmxpYyBpRGVhY3RpdmF0ZShzdGFnZTpTdGFnZSlcblx0e1xuXG5cdH1cblxuXG5cdC8qKlxuXHQgKlxuXHQgKlxuXHQgKiBAcGFyYW0gcmVuZGVyYWJsZVxuXHQgKiBAcGFyYW0gc3RhZ2Vcblx0ICogQHBhcmFtIGNhbWVyYVxuXHQgKi9cblx0cHVibGljIHNldFJlbmRlclN0YXRlKHJlbmRlcmFibGU6UmVuZGVyYWJsZUJhc2UsIHN0YWdlOlN0YWdlLCBjYW1lcmE6Q2FtZXJhLCB2aWV3UHJvamVjdGlvbjpNYXRyaXgzRClcblx0e1xuXHRcdHZhciBjb250ZXh0OklDb250ZXh0U3RhZ2VHTCA9IDxJQ29udGV4dFN0YWdlR0w+IHN0YWdlLmNvbnRleHQ7XG5cblx0XHRpZiAocmVuZGVyYWJsZS5tYXRlcmlhbE93bmVyLmFuaW1hdG9yKVxuXHRcdFx0KDxBbmltYXRvckJhc2U+IHJlbmRlcmFibGUubWF0ZXJpYWxPd25lci5hbmltYXRvcikuc2V0UmVuZGVyU3RhdGUodGhpcywgcmVuZGVyYWJsZSwgc3RhZ2UsIGNhbWVyYSwgdGhpcy5udW1Vc2VkVmVydGV4Q29uc3RhbnRzLCB0aGlzLm51bVVzZWRTdHJlYW1zKTtcblxuXHRcdGlmICh0aGlzLnV2QnVmZmVySW5kZXggPj0gMClcblx0XHRcdGNvbnRleHQuYWN0aXZhdGVCdWZmZXIodGhpcy51dkJ1ZmZlckluZGV4LCByZW5kZXJhYmxlLmdldFZlcnRleERhdGEoVHJpYW5nbGVTdWJHZW9tZXRyeS5VVl9EQVRBKSwgcmVuZGVyYWJsZS5nZXRWZXJ0ZXhPZmZzZXQoVHJpYW5nbGVTdWJHZW9tZXRyeS5VVl9EQVRBKSwgVHJpYW5nbGVTdWJHZW9tZXRyeS5VVl9GT1JNQVQpO1xuXG5cdFx0aWYgKHRoaXMuc2Vjb25kYXJ5VVZCdWZmZXJJbmRleCA+PSAwKVxuXHRcdFx0Y29udGV4dC5hY3RpdmF0ZUJ1ZmZlcih0aGlzLnNlY29uZGFyeVVWQnVmZmVySW5kZXgsIHJlbmRlcmFibGUuZ2V0VmVydGV4RGF0YShUcmlhbmdsZVN1Ykdlb21ldHJ5LlNFQ09OREFSWV9VVl9EQVRBKSwgcmVuZGVyYWJsZS5nZXRWZXJ0ZXhPZmZzZXQoVHJpYW5nbGVTdWJHZW9tZXRyeS5TRUNPTkRBUllfVVZfREFUQSksIFRyaWFuZ2xlU3ViR2VvbWV0cnkuU0VDT05EQVJZX1VWX0ZPUk1BVCk7XG5cblx0XHRpZiAodGhpcy5ub3JtYWxCdWZmZXJJbmRleCA+PSAwKVxuXHRcdFx0Y29udGV4dC5hY3RpdmF0ZUJ1ZmZlcih0aGlzLm5vcm1hbEJ1ZmZlckluZGV4LCByZW5kZXJhYmxlLmdldFZlcnRleERhdGEoVHJpYW5nbGVTdWJHZW9tZXRyeS5OT1JNQUxfREFUQSksIHJlbmRlcmFibGUuZ2V0VmVydGV4T2Zmc2V0KFRyaWFuZ2xlU3ViR2VvbWV0cnkuTk9STUFMX0RBVEEpLCBUcmlhbmdsZVN1Ykdlb21ldHJ5Lk5PUk1BTF9GT1JNQVQpO1xuXG5cdFx0aWYgKHRoaXMudGFuZ2VudEJ1ZmZlckluZGV4ID49IDApXG5cdFx0XHRjb250ZXh0LmFjdGl2YXRlQnVmZmVyKHRoaXMudGFuZ2VudEJ1ZmZlckluZGV4LCByZW5kZXJhYmxlLmdldFZlcnRleERhdGEoVHJpYW5nbGVTdWJHZW9tZXRyeS5UQU5HRU5UX0RBVEEpLCByZW5kZXJhYmxlLmdldFZlcnRleE9mZnNldChUcmlhbmdsZVN1Ykdlb21ldHJ5LlRBTkdFTlRfREFUQSksIFRyaWFuZ2xlU3ViR2VvbWV0cnkuVEFOR0VOVF9GT1JNQVQpO1xuXG5cblx0XHRpZiAodGhpcy51c2VzVVZUcmFuc2Zvcm0pIHtcblx0XHRcdHZhciB1dlRyYW5zZm9ybTpNYXRyaXggPSByZW5kZXJhYmxlLm1hdGVyaWFsT3duZXIudXZUcmFuc2Zvcm0ubWF0cml4O1xuXG5cdFx0XHRpZiAodXZUcmFuc2Zvcm0pIHtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4XSA9IHV2VHJhbnNmb3JtLmE7XG5cdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMudXZUcmFuc2Zvcm1JbmRleCArIDFdID0gdXZUcmFuc2Zvcm0uYjtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgM10gPSB1dlRyYW5zZm9ybS50eDtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgNF0gPSB1dlRyYW5zZm9ybS5jO1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA1XSA9IHV2VHJhbnNmb3JtLmQ7XG5cdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMudXZUcmFuc2Zvcm1JbmRleCArIDddID0gdXZUcmFuc2Zvcm0udHk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXhdID0gMTtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgMV0gPSAwO1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyAzXSA9IDA7XG5cdFx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMudXZUcmFuc2Zvcm1JbmRleCArIDRdID0gMDtcblx0XHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy51dlRyYW5zZm9ybUluZGV4ICsgNV0gPSAxO1xuXHRcdFx0XHR0aGlzLnZlcnRleENvbnN0YW50RGF0YVt0aGlzLnV2VHJhbnNmb3JtSW5kZXggKyA3XSA9IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuc2NlbmVOb3JtYWxNYXRyaXhJbmRleCA+PSAwKVxuXHRcdFx0cmVuZGVyYWJsZS5zb3VyY2VFbnRpdHkuaW52ZXJzZVNjZW5lVHJhbnNmb3JtLmNvcHlSYXdEYXRhVG8odGhpcy52ZXJ0ZXhDb25zdGFudERhdGEsIHRoaXMuc2NlbmVOb3JtYWxNYXRyaXhJbmRleCwgZmFsc2UpO1xuXG5cdFx0aWYgKHRoaXMudXNlc1RhbmdlbnRTcGFjZSAmJiB0aGlzLmNhbWVyYVBvc2l0aW9uSW5kZXggPj0gMCkge1xuXG5cdFx0XHRyZW5kZXJhYmxlLnNvdXJjZUVudGl0eS5pbnZlcnNlU2NlbmVUcmFuc2Zvcm0uY29weVJhd0RhdGFUbyh0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4KTtcblx0XHRcdHZhciBwb3M6VmVjdG9yM0QgPSBjYW1lcmEuc2NlbmVQb3NpdGlvbjtcblx0XHRcdHZhciB4Om51bWJlciA9IHBvcy54O1xuXHRcdFx0dmFyIHk6bnVtYmVyID0gcG9zLnk7XG5cdFx0XHR2YXIgejpudW1iZXIgPSBwb3MuejtcblxuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4XSA9IHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMF0qeCArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbNF0qeSArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbOF0qeiArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMTJdO1xuXHRcdFx0dGhpcy52ZXJ0ZXhDb25zdGFudERhdGFbdGhpcy5jYW1lcmFQb3NpdGlvbkluZGV4ICsgMV0gPSB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzFdKnggKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzVdKnkgKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzldKnogKyB0aGlzLl9wSW52ZXJzZVNjZW5lTWF0cml4WzEzXTtcblx0XHRcdHRoaXMudmVydGV4Q29uc3RhbnREYXRhW3RoaXMuY2FtZXJhUG9zaXRpb25JbmRleCArIDJdID0gdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFsyXSp4ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFs2XSp5ICsgdGhpcy5fcEludmVyc2VTY2VuZU1hdHJpeFsxMF0qeiArIHRoaXMuX3BJbnZlcnNlU2NlbmVNYXRyaXhbMTRdO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlKClcblx0e1xuXHRcdC8vVE9ETyB1bmNvdW50IGFzc29jaWF0ZWQgcHJvZ3JhbSBkYXRhXG5cdH1cbn1cblxuZXhwb3J0ID0gU2hhZGVyT2JqZWN0QmFzZTsiXX0=