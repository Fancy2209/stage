var Mapping = require("awayjs-stagegl/lib/aglsl/Mapping");
var ContextStage3D = require("awayjs-stagegl/lib/base/ContextStage3D");
var AGLSLParser = (function () {
    function AGLSLParser() {
    }
    AGLSLParser.prototype.parse = function (desc) {
        var header = "";
        var body = "";
        header += "precision highp float;\n";
        var tag = desc.header.type[0]; //TODO
        // declare uniforms
        if (desc.header.type == "vertex") {
            header += "uniform float yflip;\n";
        }
        if (!desc.hasindirect) {
            for (var i = 0; i < desc.regread[0x1].length; i++) {
                if (desc.regread[0x1][i]) {
                    header += "uniform vec4 " + tag + "c" + i + ";\n";
                }
            }
        }
        else {
            header += "uniform vec4 " + tag + "carrr[" + ContextStage3D.maxvertexconstants + "];\n"; // use max const count instead
        }
        for (var i = 0; i < desc.regread[0x2].length || i < desc.regwrite[0x2].length; i++) {
            if (desc.regread[0x2][i] || desc.regwrite[0x2][i]) {
                header += "vec4 " + tag + "t" + i + ";\n";
            }
        }
        for (var i = 0; i < desc.regread[0x0].length; i++) {
            if (desc.regread[0x0][i]) {
                header += "attribute vec4 va" + i + ";\n";
            }
        }
        for (var i = 0; i < desc.regread[0x4].length || i < desc.regwrite[0x4].length; i++) {
            if (desc.regread[0x4][i] || desc.regwrite[0x4][i]) {
                header += "varying vec4 vi" + i + ";\n";
            }
        }
        // declare samplers
        var samptype = ["2D", "Cube", "3D", ""];
        for (var i = 0; i < desc.samplers.length; i++) {
            if (desc.samplers[i]) {
                header += "uniform sampler" + samptype[desc.samplers[i].dim & 3] + " fs" + i + ";\n";
            }
        }
        // extra gl fluff: setup position and depth adjust temps
        if (desc.header.type == "vertex") {
            header += "vec4 outpos;\n";
        }
        if (desc.writedepth) {
            header += "vec4 tmp_FragDepth;\n";
        }
        //if ( desc.hasmatrix ) 
        //    header += "vec4 tmp_matrix;\n";
        var derivatives = false;
        // start body of code
        body += "void main() {\n";
        for (var i = 0; i < desc.tokens.length; i++) {
            var lutentry = Mapping.agal2glsllut[desc.tokens[i].opcode];
            if (lutentry.s.indexOf("dFdx") != -1 || lutentry.s.indexOf("dFdy") != -1)
                derivatives = true;
            if (!lutentry) {
                throw "Opcode not valid or not implemented yet: ";
            }
            var sublines = lutentry.matrixheight || 1;
            for (var sl = 0; sl < sublines; sl++) {
                var line = "  " + lutentry.s;
                if (desc.tokens[i].dest) {
                    if (lutentry.matrixheight) {
                        if (((desc.tokens[i].dest.mask >> sl) & 1) != 1) {
                            continue;
                        }
                        var destregstring = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);
                        var destcaststring = "float";
                        var destmaskstring = ["x", "y", "z", "w"][sl];
                        destregstring += "." + destmaskstring;
                    }
                    else {
                        var destregstring = this.regtostring(desc.tokens[i].dest.regtype, desc.tokens[i].dest.regnum, desc, tag);
                        var destcaststring;
                        var destmaskstring;
                        if (desc.tokens[i].dest.mask != 0xf) {
                            var ndest = 0;
                            destmaskstring = "";
                            if (desc.tokens[i].dest.mask & 1) {
                                ndest++;
                                destmaskstring += "x";
                            }
                            if (desc.tokens[i].dest.mask & 2) {
                                ndest++;
                                destmaskstring += "y";
                            }
                            if (desc.tokens[i].dest.mask & 4) {
                                ndest++;
                                destmaskstring += "z";
                            }
                            if (desc.tokens[i].dest.mask & 8) {
                                ndest++;
                                destmaskstring += "w";
                            }
                            destregstring += "." + destmaskstring;
                            switch (ndest) {
                                case 1:
                                    destcaststring = "float";
                                    break;
                                case 2:
                                    destcaststring = "vec2";
                                    break;
                                case 3:
                                    destcaststring = "vec3";
                                    break;
                                default:
                                    throw "Unexpected destination mask";
                            }
                        }
                        else {
                            destcaststring = "vec4";
                            destmaskstring = "xyzw";
                        }
                    }
                    line = line.replace("%dest", destregstring);
                    line = line.replace("%cast", destcaststring);
                    line = line.replace("%dm", destmaskstring);
                }
                var dwm = 0xf;
                if (!lutentry.ndwm && lutentry.dest && desc.tokens[i].dest) {
                    dwm = desc.tokens[i].dest.mask;
                }
                if (desc.tokens[i].a) {
                    line = line.replace("%a", this.sourcetostring(desc.tokens[i].a, 0, dwm, lutentry.scalar, desc, tag));
                }
                if (desc.tokens[i].b) {
                    line = line.replace("%b", this.sourcetostring(desc.tokens[i].b, sl, dwm, lutentry.scalar, desc, tag));
                    if (desc.tokens[i].b.regtype == 0x5) {
                        // sampler dim
                        var texdim = ["2D", "Cube", "3D"][desc.tokens[i].b.dim];
                        var texsize = ["vec2", "vec3", "vec3"][desc.tokens[i].b.dim];
                        line = line.replace("%texdim", texdim);
                        line = line.replace("%texsize", texsize);
                        var texlod = "";
                        line = line.replace("%lod", texlod);
                    }
                }
                body += line;
            }
        }
        // adjust z from opengl range of -1..1 to 0..1 as in d3d, this also enforces a left handed coordinate system
        if (desc.header.type == "vertex") {
            body += "  gl_Position = vec4(outpos.x, outpos.y, outpos.z*2.0 - outpos.w, outpos.w);\n";
        }
        //flag based switch
        if (derivatives && desc.header.type == "fragment") {
            header = "#extension GL_OES_standard_derivatives : enable\n" + header;
        }
        // clamp fragment depth
        if (desc.writedepth) {
            body += "  gl_FragDepth = clamp(tmp_FragDepth,0.0,1.0);\n";
        }
        // close main
        body += "}\n";
        console.log(header + body);
        return header + body;
    };
    AGLSLParser.prototype.regtostring = function (regtype, regnum, desc, tag) {
        switch (regtype) {
            case 0x0:
                return "va" + regnum;
            case 0x1:
                if (desc.hasindirect && desc.header.type == "vertex") {
                    return "vcarrr[" + regnum + "]";
                }
                else {
                    return tag + "c" + regnum;
                }
            case 0x2:
                return tag + "t" + regnum;
            case 0x3:
                return desc.header.type == "vertex" ? "outpos" : "gl_FragColor";
            case 0x4:
                return "vi" + regnum;
            case 0x5:
                return "fs" + regnum;
            case 0x6:
                return "tmp_FragDepth";
            default:
                throw "Unknown register type";
        }
    };
    AGLSLParser.prototype.sourcetostring = function (s, subline, dwm, isscalar, desc, tag) {
        var swiz = ["x", "y", "z", "w"];
        var r;
        if (s.indirectflag) {
            r = "vcarrr[int(" + this.regtostring(s.indexregtype, s.regnum, desc, tag) + "." + swiz[s.indexselect] + ")";
            var realofs = subline + s.indexoffset;
            if (realofs < 0)
                r += realofs.toString();
            if (realofs > 0)
                r += "+" + realofs.toString();
            r += "]";
        }
        else {
            r = this.regtostring(s.regtype, s.regnum + subline, desc, tag);
        }
        // samplers never add swizzle        
        if (s.regtype == 0x5) {
            return r;
        }
        // scalar, first component only
        if (isscalar) {
            return r + "." + swiz[(s.swizzle >> 0) & 3];
        }
        // identity
        if (s.swizzle == 0xe4 && dwm == 0xf) {
            return r;
        }
        // with destination write mask folded in
        r += ".";
        if (dwm & 1)
            r += swiz[(s.swizzle >> 0) & 3];
        if (dwm & 2)
            r += swiz[(s.swizzle >> 2) & 3];
        if (dwm & 4)
            r += swiz[(s.swizzle >> 4) & 3];
        if (dwm & 8)
            r += swiz[(s.swizzle >> 6) & 3];
        return r;
    };
    return AGLSLParser;
})();
module.exports = AGLSLParser;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1zdGFnZWdsL2xpYi9hZ2xzbC9BR0xTTFBhcnNlci50cyJdLCJuYW1lcyI6WyJBR0xTTFBhcnNlciIsIkFHTFNMUGFyc2VyLmNvbnN0cnVjdG9yIiwiQUdMU0xQYXJzZXIucGFyc2UiLCJBR0xTTFBhcnNlci5yZWd0b3N0cmluZyIsIkFHTFNMUGFyc2VyLnNvdXJjZXRvc3RyaW5nIl0sIm1hcHBpbmdzIjoiQUFDQSxJQUFPLE9BQU8sV0FBZSxrQ0FBa0MsQ0FBQyxDQUFDO0FBQ2pFLElBQU8sY0FBYyxXQUFhLHdDQUF3QyxDQUFDLENBQUM7QUFFNUUsSUFBTSxXQUFXO0lBQWpCQSxTQUFNQSxXQUFXQTtJQXFQakJDLENBQUNBO0lBblBPRCwyQkFBS0EsR0FBWkEsVUFBYUEsSUFBZ0JBO1FBRTVCRSxJQUFJQSxNQUFNQSxHQUFVQSxFQUFFQSxDQUFDQTtRQUN2QkEsSUFBSUEsSUFBSUEsR0FBVUEsRUFBRUEsQ0FBQ0E7UUFFckJBLE1BQU1BLElBQUlBLDBCQUEwQkEsQ0FBQ0E7UUFDckNBLElBQUlBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLEVBQUVBLE1BQU1BO1FBRXJDQSxBQUNBQSxtQkFEbUJBO1FBQ25CQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxJQUFJQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNsQ0EsTUFBTUEsSUFBSUEsd0JBQXdCQSxDQUFDQTtRQUNwQ0EsQ0FBQ0E7UUFDREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDdkJBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQVVBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO2dCQUMxREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQzFCQSxNQUFNQSxJQUFJQSxlQUFlQSxHQUFHQSxHQUFHQSxHQUFHQSxHQUFHQSxHQUFHQSxDQUFDQSxHQUFHQSxLQUFLQSxDQUFDQTtnQkFDbkRBLENBQUNBO1lBQ0ZBLENBQUNBO1FBQ0ZBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ1BBLE1BQU1BLElBQUlBLGVBQWVBLEdBQUdBLEdBQUdBLEdBQUdBLFFBQVFBLEdBQUdBLGNBQWNBLENBQUNBLGtCQUFrQkEsR0FBR0EsTUFBTUEsRUFBaUJBLDhCQUE4QkE7UUFDdklBLENBQUNBLEdBRHdGQTtRQUl6RkEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsSUFBSUEsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7WUFDcEZBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQ2xEQSxDQUFDQTtnQkFDQUEsTUFBTUEsSUFBSUEsT0FBT0EsR0FBR0EsR0FBR0EsR0FBR0EsR0FBR0EsR0FBR0EsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0E7WUFDM0NBLENBQUNBO1FBQ0ZBLENBQUNBO1FBR0RBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQVVBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO1lBQzFEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDMUJBLE1BQU1BLElBQUlBLG1CQUFtQkEsR0FBR0EsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0E7WUFDM0NBLENBQUNBO1FBQ0ZBLENBQUNBO1FBR0RBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQVVBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLE1BQU1BLElBQUlBLENBQUNBLEdBQUdBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLE1BQU1BLEVBQUVBLENBQUNBLEVBQUVBLEVBQUVBLENBQUNBO1lBQzNGQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDbkRBLE1BQU1BLElBQUlBLGlCQUFpQkEsR0FBR0EsQ0FBQ0EsR0FBR0EsS0FBS0EsQ0FBQ0E7WUFDekNBLENBQUNBO1FBQ0ZBLENBQUNBO1FBRURBLEFBQ0FBLG1CQURtQkE7WUFDZkEsUUFBUUEsR0FBaUJBLENBQUNBLElBQUlBLEVBQUVBLE1BQU1BLEVBQUVBLElBQUlBLEVBQUVBLEVBQUVBLENBQUNBLENBQUNBO1FBQ3REQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFVQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxRQUFRQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFFQSxDQUFDQTtZQUN0REEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ3RCQSxNQUFNQSxJQUFJQSxpQkFBaUJBLEdBQUdBLFFBQVFBLENBQUVBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUVBLEdBQUdBLEtBQUtBLEdBQUdBLENBQUNBLEdBQUdBLEtBQUtBLENBQUNBO1lBQ3hGQSxDQUFDQTtRQUNGQSxDQUFDQTtRQUVEQSxBQUNBQSx3REFEd0RBO1FBQ3hEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxJQUFJQSxJQUFJQSxRQUFRQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNsQ0EsTUFBTUEsSUFBSUEsZ0JBQWdCQSxDQUFDQTtRQUM1QkEsQ0FBQ0E7UUFDREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDckJBLE1BQU1BLElBQUlBLHVCQUF1QkEsQ0FBQ0E7UUFDbkNBLENBQUNBO1FBQ0RBLEFBR0FBLHdCQUh3QkE7UUFDeEJBLHFDQUFxQ0E7WUFFakNBLFdBQVdBLEdBQVdBLEtBQUtBLENBQUNBO1FBRWhDQSxBQUNBQSxxQkFEcUJBO1FBQ3JCQSxJQUFJQSxJQUFJQSxpQkFBaUJBLENBQUNBO1FBRTFCQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFVQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFFQSxDQUFDQTtZQUVwREEsSUFBSUEsUUFBUUEsR0FBR0EsT0FBT0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7WUFFM0RBLEVBQUVBLENBQUFBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLENBQUNBLElBQUlBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO2dCQUFDQSxXQUFXQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUM1RkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ2ZBLE1BQU1BLDJDQUEyQ0EsQ0FBQUE7WUFFbERBLENBQUNBO1lBQ0RBLElBQUlBLFFBQVFBLEdBQUdBLFFBQVFBLENBQUNBLFlBQVlBLElBQUlBLENBQUNBLENBQUNBO1lBRTFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxHQUFVQSxDQUFDQSxFQUFFQSxFQUFFQSxHQUFHQSxRQUFRQSxFQUFFQSxFQUFFQSxFQUFFQSxFQUFFQSxDQUFDQTtnQkFDN0NBLElBQUlBLElBQUlBLEdBQVVBLElBQUlBLEdBQUdBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBO2dCQUNwQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3pCQSxFQUFFQSxDQUFDQSxDQUFDQSxRQUFRQSxDQUFDQSxZQUFZQSxDQUFDQSxDQUFDQSxDQUFDQTt3QkFDM0JBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLElBQUlBLElBQUlBLEVBQUVBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBOzRCQUNqREEsUUFBUUEsQ0FBQ0E7d0JBQ1ZBLENBQUNBO3dCQUNEQSxJQUFJQSxhQUFhQSxHQUFVQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxFQUFFQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxFQUFFQSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQTt3QkFDaEhBLElBQUlBLGNBQWNBLEdBQVVBLE9BQU9BLENBQUNBO3dCQUNwQ0EsSUFBSUEsY0FBY0EsR0FBR0EsQ0FBQ0EsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBR0EsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0E7d0JBQzlDQSxhQUFhQSxJQUFJQSxHQUFHQSxHQUFHQSxjQUFjQSxDQUFDQTtvQkFDdkNBLENBQUNBO29CQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTt3QkFDUEEsSUFBSUEsYUFBYUEsR0FBVUEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsRUFBRUEsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsRUFBRUEsSUFBSUEsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0E7d0JBQ2hIQSxJQUFJQSxjQUFxQkEsQ0FBQ0E7d0JBQzFCQSxJQUFJQSxjQUFxQkEsQ0FBQ0E7d0JBQzFCQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTs0QkFDckNBLElBQUlBLEtBQUtBLEdBQVVBLENBQUNBLENBQUNBOzRCQUNyQkEsY0FBY0EsR0FBR0EsRUFBRUEsQ0FBQ0E7NEJBQ3BCQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQ0FDbENBLEtBQUtBLEVBQUVBLENBQUNBO2dDQUNSQSxjQUFjQSxJQUFJQSxHQUFHQSxDQUFDQTs0QkFDdkJBLENBQUNBOzRCQUNEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQ0FDbENBLEtBQUtBLEVBQUVBLENBQUNBO2dDQUNSQSxjQUFjQSxJQUFJQSxHQUFHQSxDQUFDQTs0QkFDdkJBLENBQUNBOzRCQUNEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQ0FDbENBLEtBQUtBLEVBQUVBLENBQUNBO2dDQUNSQSxjQUFjQSxJQUFJQSxHQUFHQSxDQUFDQTs0QkFDdkJBLENBQUNBOzRCQUNEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQ0FDbENBLEtBQUtBLEVBQUVBLENBQUNBO2dDQUNSQSxjQUFjQSxJQUFJQSxHQUFHQSxDQUFDQTs0QkFDdkJBLENBQUNBOzRCQUNEQSxhQUFhQSxJQUFJQSxHQUFHQSxHQUFHQSxjQUFjQSxDQUFDQTs0QkFDdENBLE1BQU1BLENBQUNBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLENBQUNBO2dDQUNmQSxLQUFLQSxDQUFDQTtvQ0FDTEEsY0FBY0EsR0FBR0EsT0FBT0EsQ0FBQ0E7b0NBQ3pCQSxLQUFLQSxDQUFDQTtnQ0FDUEEsS0FBS0EsQ0FBQ0E7b0NBQ0xBLGNBQWNBLEdBQUdBLE1BQU1BLENBQUNBO29DQUN4QkEsS0FBS0EsQ0FBQ0E7Z0NBQ1BBLEtBQUtBLENBQUNBO29DQUNMQSxjQUFjQSxHQUFHQSxNQUFNQSxDQUFDQTtvQ0FDeEJBLEtBQUtBLENBQUNBO2dDQUNQQTtvQ0FDQ0EsTUFBTUEsNkJBQTZCQSxDQUFDQTs0QkFDdENBLENBQUNBO3dCQUNGQSxDQUFDQTt3QkFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7NEJBQ1BBLGNBQWNBLEdBQUdBLE1BQU1BLENBQUNBOzRCQUN4QkEsY0FBY0EsR0FBR0EsTUFBTUEsQ0FBQ0E7d0JBQ3pCQSxDQUFDQTtvQkFDRkEsQ0FBQ0E7b0JBQ0RBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLE9BQU9BLEVBQUVBLGFBQWFBLENBQUNBLENBQUNBO29CQUM1Q0EsSUFBSUEsR0FBR0EsSUFBSUEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsT0FBT0EsRUFBRUEsY0FBY0EsQ0FBQ0EsQ0FBQ0E7b0JBQzdDQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxLQUFLQSxFQUFFQSxjQUFjQSxDQUFDQSxDQUFDQTtnQkFDNUNBLENBQUNBO2dCQUNEQSxJQUFJQSxHQUFHQSxHQUFVQSxHQUFHQSxDQUFDQTtnQkFDckJBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLFFBQVFBLENBQUNBLElBQUlBLElBQUlBLFFBQVFBLENBQUNBLElBQUlBLElBQUlBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO29CQUM1REEsR0FBR0EsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7Z0JBQ2hDQSxDQUFDQTtnQkFDREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3RCQSxJQUFJQSxHQUFHQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxJQUFJQSxFQUFFQSxJQUFJQSxDQUFDQSxjQUFjQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxHQUFHQSxFQUFFQSxRQUFRQSxDQUFDQSxNQUFNQSxFQUFFQSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDdEdBLENBQUNBO2dCQUNEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtvQkFDdEJBLElBQUlBLEdBQUdBLElBQUlBLENBQUNBLE9BQU9BLENBQUNBLElBQUlBLEVBQUVBLElBQUlBLENBQUNBLGNBQWNBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEVBQUVBLEVBQUVBLEVBQUVBLEdBQUdBLEVBQUVBLFFBQVFBLENBQUNBLE1BQU1BLEVBQUVBLElBQUlBLEVBQUVBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO29CQUN0R0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7d0JBQ3JDQSxBQUNBQSxjQURjQTs0QkFDVkEsTUFBTUEsR0FBR0EsQ0FBQ0EsSUFBSUEsRUFBRUEsTUFBTUEsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7d0JBQ3hEQSxJQUFJQSxPQUFPQSxHQUFHQSxDQUFD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QSxDQUFDQSxJQUFJQSxHQUFHQSxDQUFDQTtRQUNWQSxDQUFDQTtRQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtZQUNQQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxDQUFDQSxDQUFDQSxPQUFPQSxFQUFFQSxDQUFDQSxDQUFDQSxNQUFNQSxHQUFHQSxPQUFPQSxFQUFFQSxJQUFJQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQTtRQUNoRUEsQ0FBQ0E7UUFFREEsQUFDQUEscUNBRHFDQTtRQUNyQ0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsSUFBSUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDdEJBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO1FBQ1ZBLENBQUNBO1FBRURBLEFBQ0FBLCtCQUQrQkE7UUFDL0JBLEVBQUVBLENBQUNBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBLENBQUNBO1lBQ2RBLE1BQU1BLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLEdBQUdBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO1FBQzdDQSxDQUFDQTtRQUVEQSxBQUNBQSxXQURXQTtRQUNYQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxPQUFPQSxJQUFJQSxJQUFJQSxJQUFJQSxHQUFHQSxJQUFJQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNyQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDVkEsQ0FBQ0E7UUFFREEsQUFDQUEsd0NBRHdDQTtRQUN4Q0EsQ0FBQ0EsSUFBSUEsR0FBR0EsQ0FBQ0E7UUFDVEEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFBQ0EsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDN0NBLEVBQUVBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO1lBQUNBLENBQUNBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLE9BQU9BLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLENBQUNBO1FBQzdDQSxFQUFFQSxDQUFDQSxDQUFDQSxHQUFHQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxPQUFPQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM3Q0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFBQ0EsQ0FBQ0EsSUFBSUEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsT0FBT0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDN0NBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO0lBQ1ZBLENBQUNBO0lBQ0ZKLGtCQUFDQTtBQUFEQSxDQXJQQSxBQXFQQ0EsSUFBQTtBQUVELEFBQXFCLGlCQUFaLFdBQVcsQ0FBQyIsImZpbGUiOiJhZ2xzbC9BR0xTTFBhcnNlci5qcyIsInNvdXJjZVJvb3QiOiIuLi8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRGVzY3JpcHRpb25cdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9hZ2xzbC9EZXNjcmlwdGlvblwiKTtcclxuaW1wb3J0IE1hcHBpbmdcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2FnbHNsL01hcHBpbmdcIik7XHJcbmltcG9ydCBDb250ZXh0U3RhZ2UzRFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0NvbnRleHRTdGFnZTNEXCIpO1xyXG5cclxuY2xhc3MgQUdMU0xQYXJzZXJcclxue1xyXG5cdHB1YmxpYyBwYXJzZShkZXNjOkRlc2NyaXB0aW9uKVxyXG5cdHtcclxuXHRcdHZhciBoZWFkZXI6c3RyaW5nID0gXCJcIjtcclxuXHRcdHZhciBib2R5OnN0cmluZyA9IFwiXCI7XHJcblxyXG5cdFx0aGVhZGVyICs9IFwicHJlY2lzaW9uIGhpZ2hwIGZsb2F0O1xcblwiO1xyXG5cdFx0dmFyIHRhZyA9IGRlc2MuaGVhZGVyLnR5cGVbMF07IC8vVE9ET1xyXG5cclxuXHRcdC8vIGRlY2xhcmUgdW5pZm9ybXNcclxuXHRcdGlmIChkZXNjLmhlYWRlci50eXBlID09IFwidmVydGV4XCIpIHtcclxuXHRcdFx0aGVhZGVyICs9IFwidW5pZm9ybSBmbG9hdCB5ZmxpcDtcXG5cIjtcclxuXHRcdH1cclxuXHRcdGlmICghZGVzYy5oYXNpbmRpcmVjdCkge1xyXG5cdFx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCBkZXNjLnJlZ3JlYWRbMHgxXS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGlmIChkZXNjLnJlZ3JlYWRbMHgxXVtpXSkge1xyXG5cdFx0XHRcdFx0aGVhZGVyICs9IFwidW5pZm9ybSB2ZWM0IFwiICsgdGFnICsgXCJjXCIgKyBpICsgXCI7XFxuXCI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRoZWFkZXIgKz0gXCJ1bmlmb3JtIHZlYzQgXCIgKyB0YWcgKyBcImNhcnJyW1wiICsgQ29udGV4dFN0YWdlM0QubWF4dmVydGV4Y29uc3RhbnRzICsgXCJdO1xcblwiOyAgICAgICAgICAgICAgICAvLyB1c2UgbWF4IGNvbnN0IGNvdW50IGluc3RlYWRcclxuXHRcdH1cclxuXHJcblx0XHQvLyBkZWNsYXJlIHRlbXBzXHJcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGRlc2MucmVncmVhZFsweDJdLmxlbmd0aCB8fCBpIDwgZGVzYy5yZWd3cml0ZVsweDJdLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGlmIChkZXNjLnJlZ3JlYWRbMHgyXVtpXSB8fCBkZXNjLnJlZ3dyaXRlWzB4Ml1baV0pIC8vIGR1aCwgaGF2ZSB0byBjaGVjayB3cml0ZSBvbmx5IGFsc28uLi5cclxuXHRcdFx0e1xyXG5cdFx0XHRcdGhlYWRlciArPSBcInZlYzQgXCIgKyB0YWcgKyBcInRcIiArIGkgKyBcIjtcXG5cIjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGRlY2xhcmUgc3RyZWFtc1xyXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgZGVzYy5yZWdyZWFkWzB4MF0ubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0aWYgKGRlc2MucmVncmVhZFsweDBdW2ldKSB7XHJcblx0XHRcdFx0aGVhZGVyICs9IFwiYXR0cmlidXRlIHZlYzQgdmFcIiArIGkgKyBcIjtcXG5cIjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGRlY2xhcmUgaW50ZXJwb2xhdGVkXHJcblx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCBkZXNjLnJlZ3JlYWRbMHg0XS5sZW5ndGggfHwgaSA8IGRlc2MucmVnd3JpdGVbMHg0XS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRpZiAoZGVzYy5yZWdyZWFkWzB4NF1baV0gfHwgZGVzYy5yZWd3cml0ZVsweDRdW2ldKSB7XHJcblx0XHRcdFx0aGVhZGVyICs9IFwidmFyeWluZyB2ZWM0IHZpXCIgKyBpICsgXCI7XFxuXCI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBkZWNsYXJlIHNhbXBsZXJzXHJcblx0XHR2YXIgc2FtcHR5cGU6QXJyYXk8c3RyaW5nPiA9IFtcIjJEXCIsIFwiQ3ViZVwiLCBcIjNEXCIsIFwiXCJdO1xyXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgZGVzYy5zYW1wbGVycy5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRpZiAoZGVzYy5zYW1wbGVyc1tpXSkge1xyXG5cdFx0XHRcdGhlYWRlciArPSBcInVuaWZvcm0gc2FtcGxlclwiICsgc2FtcHR5cGVbIGRlc2Muc2FtcGxlcnNbaV0uZGltICYgMyBdICsgXCIgZnNcIiArIGkgKyBcIjtcXG5cIjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGV4dHJhIGdsIGZsdWZmOiBzZXR1cCBwb3NpdGlvbiBhbmQgZGVwdGggYWRqdXN0IHRlbXBzXHJcblx0XHRpZiAoZGVzYy5oZWFkZXIudHlwZSA9PSBcInZlcnRleFwiKSB7XHJcblx0XHRcdGhlYWRlciArPSBcInZlYzQgb3V0cG9zO1xcblwiO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGRlc2Mud3JpdGVkZXB0aCkge1xyXG5cdFx0XHRoZWFkZXIgKz0gXCJ2ZWM0IHRtcF9GcmFnRGVwdGg7XFxuXCI7XHJcblx0XHR9XHJcblx0XHQvL2lmICggZGVzYy5oYXNtYXRyaXggKSBcclxuXHRcdC8vICAgIGhlYWRlciArPSBcInZlYzQgdG1wX21hdHJpeDtcXG5cIjtcclxuXHJcblx0XHR2YXIgZGVyaXZhdGl2ZXM6Ym9vbGVhbiA9IGZhbHNlO1xyXG5cclxuXHRcdC8vIHN0YXJ0IGJvZHkgb2YgY29kZVxyXG5cdFx0Ym9keSArPSBcInZvaWQgbWFpbigpIHtcXG5cIjtcclxuXHJcblx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCBkZXNjLnRva2Vucy5sZW5ndGg7IGkrKykge1xyXG5cclxuXHRcdFx0dmFyIGx1dGVudHJ5ID0gTWFwcGluZy5hZ2FsMmdsc2xsdXRbZGVzYy50b2tlbnNbaV0ub3Bjb2RlXTtcclxuXHJcblx0XHRcdGlmKGx1dGVudHJ5LnMuaW5kZXhPZihcImRGZHhcIikgIT0gLTEgfHwgbHV0ZW50cnkucy5pbmRleE9mKFwiZEZkeVwiKSAhPSAtMSkgZGVyaXZhdGl2ZXMgPSB0cnVlO1xyXG5cdFx0XHRpZiAoIWx1dGVudHJ5KSB7XHJcblx0XHRcdFx0dGhyb3cgXCJPcGNvZGUgbm90IHZhbGlkIG9yIG5vdCBpbXBsZW1lbnRlZCB5ZXQ6IFwiXHJcblx0XHRcdFx0LyordG9rZW4ub3Bjb2RlOyovXHJcblx0XHRcdH1cclxuXHRcdFx0dmFyIHN1YmxpbmVzID0gbHV0ZW50cnkubWF0cml4aGVpZ2h0IHx8IDE7XHJcblxyXG5cdFx0XHRmb3IgKHZhciBzbDpudW1iZXIgPSAwOyBzbCA8IHN1YmxpbmVzOyBzbCsrKSB7XHJcblx0XHRcdFx0dmFyIGxpbmU6c3RyaW5nID0gXCIgIFwiICsgbHV0ZW50cnkucztcclxuXHRcdFx0XHRpZiAoZGVzYy50b2tlbnNbaV0uZGVzdCkge1xyXG5cdFx0XHRcdFx0aWYgKGx1dGVudHJ5Lm1hdHJpeGhlaWdodCkge1xyXG5cdFx0XHRcdFx0XHRpZiAoKChkZXNjLnRva2Vuc1tpXS5kZXN0Lm1hc2sgPj4gc2wpICYgMSkgIT0gMSkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdHZhciBkZXN0cmVnc3RyaW5nOnN0cmluZyA9IHRoaXMucmVndG9zdHJpbmcoZGVzYy50b2tlbnNbaV0uZGVzdC5yZWd0eXBlLCBkZXNjLnRva2Vuc1tpXS5kZXN0LnJlZ251bSwgZGVzYywgdGFnKTtcclxuXHRcdFx0XHRcdFx0dmFyIGRlc3RjYXN0c3RyaW5nOnN0cmluZyA9IFwiZmxvYXRcIjtcclxuXHRcdFx0XHRcdFx0dmFyIGRlc3RtYXNrc3RyaW5nID0gW1wieFwiLCBcInlcIiwgXCJ6XCIsIFwid1wiXVtzbF07XHJcblx0XHRcdFx0XHRcdGRlc3RyZWdzdHJpbmcgKz0gXCIuXCIgKyBkZXN0bWFza3N0cmluZztcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHZhciBkZXN0cmVnc3RyaW5nOnN0cmluZyA9IHRoaXMucmVndG9zdHJpbmcoZGVzYy50b2tlbnNbaV0uZGVzdC5yZWd0eXBlLCBkZXNjLnRva2Vuc1tpXS5kZXN0LnJlZ251bSwgZGVzYywgdGFnKTtcclxuXHRcdFx0XHRcdFx0dmFyIGRlc3RjYXN0c3RyaW5nOnN0cmluZztcclxuXHRcdFx0XHRcdFx0dmFyIGRlc3RtYXNrc3RyaW5nOnN0cmluZztcclxuXHRcdFx0XHRcdFx0aWYgKGRlc2MudG9rZW5zW2ldLmRlc3QubWFzayAhPSAweGYpIHtcclxuXHRcdFx0XHRcdFx0XHR2YXIgbmRlc3Q6bnVtYmVyID0gMDtcclxuXHRcdFx0XHRcdFx0XHRkZXN0bWFza3N0cmluZyA9IFwiXCI7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGRlc2MudG9rZW5zW2ldLmRlc3QubWFzayAmIDEpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5kZXN0Kys7XHJcblx0XHRcdFx0XHRcdFx0XHRkZXN0bWFza3N0cmluZyArPSBcInhcIjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYgKGRlc2MudG9rZW5zW2ldLmRlc3QubWFzayAmIDIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5kZXN0Kys7XHJcblx0XHRcdFx0XHRcdFx0XHRkZXN0bWFza3N0cmluZyArPSBcInlcIjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYgKGRlc2MudG9rZW5zW2ldLmRlc3QubWFzayAmIDQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5kZXN0Kys7XHJcblx0XHRcdFx0XHRcdFx0XHRkZXN0bWFza3N0cmluZyArPSBcInpcIjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0aWYgKGRlc2MudG9rZW5zW2ldLmRlc3QubWFzayAmIDgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5kZXN0Kys7XHJcblx0XHRcdFx0XHRcdFx0XHRkZXN0bWFza3N0cmluZyArPSBcIndcIjtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0ZGVzdHJlZ3N0cmluZyArPSBcIi5cIiArIGRlc3RtYXNrc3RyaW5nO1xyXG5cdFx0XHRcdFx0XHRcdHN3aXRjaCAobmRlc3QpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgMTpcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVzdGNhc3RzdHJpbmcgPSBcImZsb2F0XCI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0XHRcdFx0Y2FzZSAyOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHRkZXN0Y2FzdHN0cmluZyA9IFwidmVjMlwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdGNhc2UgMzpcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZGVzdGNhc3RzdHJpbmcgPSBcInZlYzNcIjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHRkZWZhdWx0OlxyXG5cdFx0XHRcdFx0XHRcdFx0XHR0aHJvdyBcIlVuZXhwZWN0ZWQgZGVzdGluYXRpb24gbWFza1wiO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRkZXN0Y2FzdHN0cmluZyA9IFwidmVjNFwiO1xyXG5cdFx0XHRcdFx0XHRcdGRlc3RtYXNrc3RyaW5nID0gXCJ4eXp3XCI7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGxpbmUgPSBsaW5lLnJlcGxhY2UoXCIlZGVzdFwiLCBkZXN0cmVnc3RyaW5nKTtcclxuXHRcdFx0XHRcdGxpbmUgPSBsaW5lLnJlcGxhY2UoXCIlY2FzdFwiLCBkZXN0Y2FzdHN0cmluZyk7XHJcblx0XHRcdFx0XHRsaW5lID0gbGluZS5yZXBsYWNlKFwiJWRtXCIsIGRlc3RtYXNrc3RyaW5nKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dmFyIGR3bTpudW1iZXIgPSAweGY7XHJcblx0XHRcdFx0aWYgKCFsdXRlbnRyeS5uZHdtICYmIGx1dGVudHJ5LmRlc3QgJiYgZGVzYy50b2tlbnNbaV0uZGVzdCkge1xyXG5cdFx0XHRcdFx0ZHdtID0gZGVzYy50b2tlbnNbaV0uZGVzdC5tYXNrO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZGVzYy50b2tlbnNbaV0uYSkge1xyXG5cdFx0XHRcdFx0bGluZSA9IGxpbmUucmVwbGFjZShcIiVhXCIsIHRoaXMuc291cmNldG9zdHJpbmcoZGVzYy50b2tlbnNbaV0uYSwgMCwgZHdtLCBsdXRlbnRyeS5zY2FsYXIsIGRlc2MsIHRhZykpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZGVzYy50b2tlbnNbaV0uYikge1xyXG5cdFx0XHRcdFx0bGluZSA9IGxpbmUucmVwbGFjZShcIiViXCIsIHRoaXMuc291cmNldG9zdHJpbmcoZGVzYy50b2tlbnNbaV0uYiwgc2wsIGR3bSwgbHV0ZW50cnkuc2NhbGFyLCBkZXNjLCB0YWcpKTtcclxuXHRcdFx0XHRcdGlmIChkZXNjLnRva2Vuc1tpXS5iLnJlZ3R5cGUgPT0gMHg1KSB7XHJcblx0XHRcdFx0XHRcdC8vIHNhbXBsZXIgZGltXHJcblx0XHRcdFx0XHRcdHZhciB0ZXhkaW0gPSBbXCIyRFwiLCBcIkN1YmVcIiwgXCIzRFwiXVtkZXNjLnRva2Vuc1tpXS5iLmRpbV07XHJcblx0XHRcdFx0XHRcdHZhciB0ZXhzaXplID0gW1widmVjMlwiLCBcInZlYzNcIiwgXCJ2ZWMzXCJdW2Rlc2MudG9rZW5zW2ldLmIuZGltXTtcclxuXHRcdFx0XHRcdFx0bGluZSA9IGxpbmUucmVwbGFjZShcIiV0ZXhkaW1cIiwgdGV4ZGltKTtcclxuXHRcdFx0XHRcdFx0bGluZSA9IGxpbmUucmVwbGFjZShcIiV0ZXhzaXplXCIsIHRleHNpemUpO1xyXG5cdFx0XHRcdFx0XHR2YXIgdGV4bG9kOnN0cmluZyA9IFwiXCI7XHJcblx0XHRcdFx0XHRcdGxpbmUgPSBsaW5lLnJlcGxhY2UoXCIlbG9kXCIsIHRleGxvZCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGJvZHkgKz0gbGluZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGFkanVzdCB6IGZyb20gb3BlbmdsIHJhbmdlIG9mIC0xLi4xIHRvIDAuLjEgYXMgaW4gZDNkLCB0aGlzIGFsc28gZW5mb3JjZXMgYSBsZWZ0IGhhbmRlZCBjb29yZGluYXRlIHN5c3RlbVxyXG5cdFx0aWYgKGRlc2MuaGVhZGVyLnR5cGUgPT0gXCJ2ZXJ0ZXhcIikge1xyXG5cdFx0XHRib2R5ICs9IFwiICBnbF9Qb3NpdGlvbiA9IHZlYzQob3V0cG9zLngsIG91dHBvcy55LCBvdXRwb3MueioyLjAgLSBvdXRwb3Mudywgb3V0cG9zLncpO1xcblwiO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vZmxhZyBiYXNlZCBzd2l0Y2hcclxuXHRcdGlmIChkZXJpdmF0aXZlcyAmJiBkZXNjLmhlYWRlci50eXBlID09IFwiZnJhZ21lbnRcIikge1xyXG5cdFx0XHRoZWFkZXIgPSBcIiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlXFxuXCIgKyBoZWFkZXI7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gY2xhbXAgZnJhZ21lbnQgZGVwdGhcclxuXHRcdGlmIChkZXNjLndyaXRlZGVwdGgpIHtcclxuXHRcdFx0Ym9keSArPSBcIiAgZ2xfRnJhZ0RlcHRoID0gY2xhbXAodG1wX0ZyYWdEZXB0aCwwLjAsMS4wKTtcXG5cIjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBjbG9zZSBtYWluXHJcblx0XHRib2R5ICs9IFwifVxcblwiO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGhlYWRlciArIGJvZHkpO1xyXG5cdFx0cmV0dXJuIGhlYWRlciArIGJvZHk7XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcmVndG9zdHJpbmcocmVndHlwZTpudW1iZXIsIHJlZ251bTpudW1iZXIsIGRlc2M6RGVzY3JpcHRpb24sIHRhZylcclxuXHR7XHJcblx0XHRzd2l0Y2ggKHJlZ3R5cGUpIHtcclxuXHRcdFx0Y2FzZSAweDA6XHJcblx0XHRcdFx0cmV0dXJuIFwidmFcIiArIHJlZ251bTtcclxuXHRcdFx0Y2FzZSAweDE6XHJcblx0XHRcdFx0aWYgKGRlc2MuaGFzaW5kaXJlY3QgJiYgZGVzYy5oZWFkZXIudHlwZSA9PSBcInZlcnRleFwiKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gXCJ2Y2FycnJbXCIgKyByZWdudW0gKyBcIl1cIjtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRhZyArIFwiY1wiICsgcmVnbnVtO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0Y2FzZSAweDI6XHJcblx0XHRcdFx0cmV0dXJuIHRhZyArIFwidFwiICsgcmVnbnVtO1xyXG5cdFx0XHRjYXNlIDB4MzpcclxuXHRcdFx0XHRyZXR1cm4gZGVzYy5oZWFkZXIudHlwZSA9PSBcInZlcnRleFwiPyBcIm91dHBvc1wiIDogXCJnbF9GcmFnQ29sb3JcIjtcclxuXHRcdFx0Y2FzZSAweDQ6XHJcblx0XHRcdFx0cmV0dXJuIFwidmlcIiArIHJlZ251bTtcclxuXHRcdFx0Y2FzZSAweDU6XHJcblx0XHRcdFx0cmV0dXJuIFwiZnNcIiArIHJlZ251bTtcclxuXHRcdFx0Y2FzZSAweDY6XHJcblx0XHRcdFx0cmV0dXJuIFwidG1wX0ZyYWdEZXB0aFwiO1xyXG5cdFx0XHRkZWZhdWx0OlxyXG5cdFx0XHRcdHRocm93IFwiVW5rbm93biByZWdpc3RlciB0eXBlXCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgc291cmNldG9zdHJpbmcocywgc3VibGluZSwgZHdtLCBpc3NjYWxhciwgZGVzYywgdGFnKTpzdHJpbmdcclxuXHR7XHJcblx0XHR2YXIgc3dpeiA9IFsgXCJ4XCIsIFwieVwiLCBcInpcIiwgXCJ3XCIgXTtcclxuXHRcdHZhciByO1xyXG5cclxuXHRcdGlmIChzLmluZGlyZWN0ZmxhZykge1xyXG5cdFx0XHRyID0gXCJ2Y2FycnJbaW50KFwiICsgdGhpcy5yZWd0b3N0cmluZyhzLmluZGV4cmVndHlwZSwgcy5yZWdudW0sIGRlc2MsIHRhZykgKyBcIi5cIiArIHN3aXpbcy5pbmRleHNlbGVjdF0gKyBcIilcIjtcclxuXHRcdFx0dmFyIHJlYWxvZnMgPSBzdWJsaW5lICsgcy5pbmRleG9mZnNldDtcclxuXHRcdFx0aWYgKHJlYWxvZnMgPCAwKSByICs9IHJlYWxvZnMudG9TdHJpbmcoKTtcclxuXHRcdFx0aWYgKHJlYWxvZnMgPiAwKSByICs9IFwiK1wiICsgcmVhbG9mcy50b1N0cmluZygpO1xyXG5cdFx0XHRyICs9IFwiXVwiO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ciA9IHRoaXMucmVndG9zdHJpbmcocy5yZWd0eXBlLCBzLnJlZ251bSArIHN1YmxpbmUsIGRlc2MsIHRhZyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gc2FtcGxlcnMgbmV2ZXIgYWRkIHN3aXp6bGUgICAgICAgIFxyXG5cdFx0aWYgKHMucmVndHlwZSA9PSAweDUpIHtcclxuXHRcdFx0cmV0dXJuIHI7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gc2NhbGFyLCBmaXJzdCBjb21wb25lbnQgb25seVxyXG5cdFx0aWYgKGlzc2NhbGFyKSB7XHJcblx0XHRcdHJldHVybiByICsgXCIuXCIgKyBzd2l6WyhzLnN3aXp6bGUgPj4gMCkgJiAzXTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBpZGVudGl0eVxyXG5cdFx0aWYgKHMuc3dpenpsZSA9PSAweGU0ICYmIGR3bSA9PSAweGYpIHtcclxuXHRcdFx0cmV0dXJuIHI7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gd2l0aCBkZXN0aW5hdGlvbiB3cml0ZSBtYXNrIGZvbGRlZCBpblxyXG5cdFx0ciArPSBcIi5cIjtcclxuXHRcdGlmIChkd20gJiAxKSByICs9IHN3aXpbKHMuc3dpenpsZSA+PiAwKSAmIDNdO1xyXG5cdFx0aWYgKGR3bSAmIDIpIHIgKz0gc3dpelsocy5zd2l6emxlID4+IDIpICYgM107XHJcblx0XHRpZiAoZHdtICYgNCkgciArPSBzd2l6WyhzLnN3aXp6bGUgPj4gNCkgJiAzXTtcclxuXHRcdGlmIChkd20gJiA4KSByICs9IHN3aXpbKHMuc3dpenpsZSA+PiA2KSAmIDNdO1xyXG5cdFx0cmV0dXJuIHI7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgPSBBR0xTTFBhcnNlcjsiXX0=