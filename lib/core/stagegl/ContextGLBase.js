var AbstractMethodError = require("awayjs-core/lib/errors/AbstractMethodError");
var RenderTexture = require("awayjs-core/lib/textures/RenderTexture");
var AGALMiniAssembler = require("awayjs-stagegl/lib/aglsl/assembler/AGALMiniAssembler");
var TextureDataPool = require("awayjs-stagegl/lib/core/pool/TextureDataPool");
var ProgramDataPool = require("awayjs-stagegl/lib/core/pool/ProgramDataPool");
var MaterialDataPool = require("awayjs-stagegl/lib/core/pool/MaterialDataPool");
var ContextGLClearMask = require("awayjs-stagegl/lib/core/stagegl/ContextGLClearMask");
var ContextGLTextureFormat = require("awayjs-stagegl/lib/core/stagegl/ContextGLTextureFormat");
/**
 * Stage provides a proxy class to handle the creation and attachment of the Context
 * (and in turn the back buffer) it uses. Stage should never be created directly,
 * but requested through StageManager.
 *
 * @see away.managers.StageManager
 *
 */
var ContextGLBase = (function () {
    function ContextGLBase(stageIndex) {
        this._programData = new Array();
        this._numUsedStreams = 0;
        this._numUsedTextures = 0;
        //private static _frameEventDriver:Shape = new Shape(); // TODO: add frame driver / request animation frame
        this._stageIndex = -1;
        this._antiAlias = 0;
        this._renderTarget = null;
        this._renderSurfaceSelector = 0;
        this._stageIndex = stageIndex;
        this._texturePool = new TextureDataPool(this);
        this._materialDataPool = new MaterialDataPool(this);
        this._programDataPool = new ProgramDataPool(this);
    }
    Object.defineProperty(ContextGLBase.prototype, "container", {
        get: function () {
            return this._pContainer;
        },
        enumerable: true,
        configurable: true
    });
    ContextGLBase.prototype.setRenderTarget = function (target, enableDepthAndStencil, surfaceSelector) {
        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = false; }
        if (surfaceSelector === void 0) { surfaceSelector = 0; }
        if (this._renderTarget === target && surfaceSelector == this._renderSurfaceSelector && this._enableDepthAndStencil == enableDepthAndStencil)
            return;
        this._renderTarget = target;
        this._renderSurfaceSelector = surfaceSelector;
        this._enableDepthAndStencil = enableDepthAndStencil;
        if (target instanceof RenderTexture) {
            this.setRenderToTexture(this.getRenderTexture(target), enableDepthAndStencil, this._antiAlias, surfaceSelector);
        }
        else {
            this.setRenderToBackBuffer();
            this.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);
        }
    };
    ContextGLBase.prototype.getRenderTexture = function (textureProxy) {
        var textureData = this._texturePool.getItem(textureProxy);
        if (!textureData.texture)
            textureData.texture = this.createTexture(textureProxy.width, textureProxy.height, ContextGLTextureFormat.BGRA, true);
        return textureData.texture;
    };
    ContextGLBase.prototype.getProgram = function (materialPassData) {
        //check key doesn't need re-concatenating
        if (!materialPassData.key.length) {
            materialPassData.key = materialPassData.animationVertexCode + materialPassData.vertexCode + "---" + materialPassData.fragmentCode + materialPassData.animationFragmentCode + materialPassData.postAnimationFragmentCode;
        }
        else {
            return materialPassData.programData;
        }
        var programData = this._programDataPool.getItem(materialPassData.key);
        //check program data hasn't changed, keep count of program usages
        if (materialPassData.programData != programData) {
            if (materialPassData.programData)
                materialPassData.programData.dispose();
            materialPassData.programData = programData;
            programData.usages++;
        }
        return programData;
    };
    /**
     *
     * @param material
     */
    ContextGLBase.prototype.getMaterial = function (material, profile) {
        var materialData = this._materialDataPool.getItem(material);
        if (materialData.invalidAnimation) {
            materialData.invalidAnimation = false;
            var materialDataPasses = materialData.getMaterialPasses(profile);
            var enabledGPUAnimation = this.getEnabledGPUAnimation(material, materialDataPasses);
            var renderOrderId = 0;
            var mult = 1;
            var materialPassData;
            var len = materialDataPasses.length;
            for (var i = 0; i < len; i++) {
                materialPassData = materialDataPasses[i];
                if (materialPassData.usesAnimation != enabledGPUAnimation) {
                    materialPassData.usesAnimation = enabledGPUAnimation;
                    materialPassData.key == "";
                }
                if (materialPassData.key == "")
                    this.calcAnimationCode(material, materialPassData);
                renderOrderId += this.getProgram(materialPassData).id * mult;
                mult *= 1000;
            }
            materialData.renderOrderId = renderOrderId;
        }
        return materialData;
    };
    /**
     * Assigns an attribute stream
     *
     * @param index The attribute stream index for the vertex shader
     * @param buffer
     * @param offset
     * @param stride
     * @param format
     */
    ContextGLBase.prototype.activateBuffer = function (index, buffer, offset, format) {
        if (!buffer.contexts[this._stageIndex])
            buffer.contexts[this._stageIndex] = this;
        if (!buffer.buffers[this._stageIndex]) {
            buffer.buffers[this._stageIndex] = this.createVertexBuffer(buffer.data.length / buffer.dataPerVertex, buffer.dataPerVertex);
            buffer.invalid[this._stageIndex] = true;
        }
        if (buffer.invalid[this._stageIndex]) {
            buffer.buffers[this._stageIndex].uploadFromArray(buffer.data, 0, buffer.data.length / buffer.dataPerVertex);
            buffer.invalid[this._stageIndex] = false;
        }
        this.setVertexBufferAt(index, buffer.buffers[this._stageIndex], offset, format);
    };
    ContextGLBase.prototype.disposeVertexData = function (buffer) {
        buffer.buffers[this._stageIndex].dispose();
        buffer.buffers[this._stageIndex] = null;
    };
    ContextGLBase.prototype.activateRenderTexture = function (index, textureProxy) {
        this.setTextureAt(index, this.getRenderTexture(textureProxy));
    };
    ContextGLBase.prototype.activateMaterialPass = function (materialPassData, stage, camera) {
        var shaderObject = materialPassData.shaderObject;
        for (var i = shaderObject.numUsedStreams; i < this._numUsedStreams; i++)
            this.setVertexBufferAt(i, null);
        for (var i = shaderObject.numUsedTextures; i < this._numUsedTextures; i++)
            this.setTextureAt(i, null);
        if (materialPassData.usesAnimation)
            materialPassData.material.animationSet.activate(shaderObject, stage);
        //activate shader object
        shaderObject.iActivate(stage, camera);
        //check program data is uploaded
        var programData = this.getProgram(materialPassData);
        if (!programData.program) {
            programData.program = this.createProgram();
            var vertexByteCode = (new AGALMiniAssembler().assemble("part vertex 1\n" + materialPassData.animationVertexCode + materialPassData.vertexCode + "endpart"))['vertex'].data;
            var fragmentByteCode = (new AGALMiniAssembler().assemble("part fragment 1\n" + materialPassData.fragmentCode + materialPassData.animationFragmentCode + materialPassData.postAnimationFragmentCode + "endpart"))['fragment'].data;
            programData.program.upload(vertexByteCode, fragmentByteCode);
        }
        //set program data
        this.setProgram(programData.program);
    };
    ContextGLBase.prototype.deactivateMaterialPass = function (materialPassData, stage) {
        var shaderObject = materialPassData.shaderObject;
        if (materialPassData.usesAnimation)
            materialPassData.material.animationSet.deactivate(shaderObject, stage);
        materialPassData.shaderObject.iDeactivate(stage);
        this._numUsedStreams = shaderObject.numUsedStreams;
        this._numUsedTextures = shaderObject.numUsedTextures;
    };
    ContextGLBase.prototype.activateTexture = function (index, textureProxy) {
        var textureData = this._texturePool.getItem(textureProxy);
        if (!textureData.texture) {
            textureData.texture = this.createTexture(textureProxy.width, textureProxy.height, ContextGLTextureFormat.BGRA, true);
            textureData.invalid = true;
        }
        if (textureData.invalid) {
            textureData.invalid = false;
            if (textureProxy.generateMipmaps) {
                var mipmapData = textureProxy._iGetMipmapData();
                var len = mipmapData.length;
                for (var i = 0; i < len; i++)
                    textureData.texture.uploadFromData(mipmapData[i], i);
            }
            else {
                textureData.texture.uploadFromData(textureProxy._iGetTextureData(), 0);
            }
        }
        this.setTextureAt(index, textureData.texture);
    };
    ContextGLBase.prototype.activateCubeTexture = function (index, textureProxy) {
        var textureData = this._texturePool.getItem(textureProxy);
        if (!textureData.texture) {
            textureData.texture = this.createCubeTexture(textureProxy.size, ContextGLTextureFormat.BGRA, false);
            textureData.invalid = true;
        }
        if (textureData.invalid) {
            textureData.invalid = false;
            for (var i = 0; i < 6; ++i) {
                if (textureProxy.generateMipmaps) {
                    var mipmapData = textureProxy._iGetMipmapData(i);
                    var len = mipmapData.length;
                    for (var j = 0; j < len; j++)
                        textureData.texture.uploadFromData(mipmapData[j], i, j);
                }
                else {
                    textureData.texture.uploadFromData(textureProxy._iGetTextureData(i), i, 0);
                }
            }
        }
        this.setTextureAt(index, textureData.texture);
    };
    /**
     * Retrieves the VertexBuffer object that contains triangle indices.
     * @param context The ContextWeb for which we request the buffer
     * @return The VertexBuffer object that contains triangle indices.
     */
    ContextGLBase.prototype.getIndexBuffer = function (buffer) {
        if (!buffer.contexts[this._stageIndex])
            buffer.contexts[this._stageIndex] = this;
        if (!buffer.buffers[this._stageIndex]) {
            buffer.buffers[this._stageIndex] = this.createIndexBuffer(buffer.data.length);
            buffer.invalid[this._stageIndex] = true;
        }
        if (buffer.invalid[this._stageIndex]) {
            buffer.buffers[this._stageIndex].uploadFromArray(buffer.data, 0, buffer.data.length);
            buffer.invalid[this._stageIndex] = false;
        }
        return buffer.buffers[this._stageIndex];
    };
    ContextGLBase.prototype.disposeIndexData = function (buffer) {
        buffer.buffers[this._stageIndex].dispose();
        buffer.buffers[this._stageIndex] = null;
    };
    ContextGLBase.prototype.clear = function (red, green, blue, alpha, depth, stencil, mask) {
        if (red === void 0) { red = 0; }
        if (green === void 0) { green = 0; }
        if (blue === void 0) { blue = 0; }
        if (alpha === void 0) { alpha = 1; }
        if (depth === void 0) { depth = 1; }
        if (stencil === void 0) { stencil = 0; }
        if (mask === void 0) { mask = ContextGLClearMask.ALL; }
    };
    ContextGLBase.prototype.configureBackBuffer = function (width, height, antiAlias, enableDepthAndStencil) {
        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = true; }
        this._width = width;
        this._height = height;
    };
    ContextGLBase.prototype.createIndexBuffer = function (numIndices) {
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createVertexBuffer = function (numVertices, data32PerVertex) {
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createTexture = function (width, height, format, optimizeForRenderToTexture, streamingLevels) {
        if (streamingLevels === void 0) { streamingLevels = 0; }
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createCubeTexture = function (size, format, optimizeForRenderToTexture, streamingLevels) {
        if (streamingLevels === void 0) { streamingLevels = 0; }
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createProgram = function () {
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.dispose = function () {
    };
    ContextGLBase.prototype.present = function () {
    };
    ContextGLBase.prototype.setRenderToTexture = function (target, enableDepthAndStencil, antiAlias, surfaceSelector) {
        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = false; }
        if (antiAlias === void 0) { antiAlias = 0; }
        if (surfaceSelector === void 0) { surfaceSelector = 0; }
    };
    ContextGLBase.prototype.setRenderToBackBuffer = function () {
    };
    ContextGLBase.prototype.setScissorRectangle = function (rectangle) {
    };
    ContextGLBase.prototype.setTextureAt = function (sampler, texture) {
    };
    ContextGLBase.prototype.setVertexBufferAt = function (index, buffer, bufferOffset, format) {
        if (bufferOffset === void 0) { bufferOffset = 0; }
        if (format === void 0) { format = null; }
    };
    ContextGLBase.prototype.setProgram = function (program) {
    };
    ContextGLBase.prototype.registerProgram = function (programData) {
        var i = 0;
        while (this._programData[i] != null)
            i++;
        this._programData[i] = programData;
        programData.id = i;
    };
    ContextGLBase.prototype.unRegisterProgram = function (programData) {
        this._programData[programData.id] = null;
        programData.id = -1;
    };
    /**
     * test if animation will be able to run on gpu BEFORE compiling materials
     * test if the shader objects supports animating the animation set in the vertex shader
     * if any object using this material fails to support accelerated animations for any of the shader objects,
     * we should do everything on cpu (otherwise we have the cost of both gpu + cpu animations)
     */
    ContextGLBase.prototype.getEnabledGPUAnimation = function (material, materialDataPasses) {
        if (material.animationSet) {
            material.animationSet.resetGPUCompatibility();
            var owners = material.iOwners;
            var numOwners = owners.length;
            var len = materialDataPasses.length;
            for (var i = 0; i < len; i++)
                for (var j = 0; j < numOwners; j++)
                    if (owners[j].animator)
                        owners[j].animator.testGPUCompatibility(materialDataPasses[i].shaderObject);
            return !material.animationSet.usesCPU;
        }
        return false;
    };
    ContextGLBase.prototype.calcAnimationCode = function (material, materialPassData) {
        //reset key so that the program is re-calculated
        materialPassData.key = "";
        materialPassData.animationVertexCode = "";
        materialPassData.animationFragmentCode = "";
        var shaderObject = materialPassData.shaderObject;
        //check to see if GPU animation is used
        if (materialPassData.usesAnimation) {
            var animationSet = material.animationSet;
            materialPassData.animationVertexCode += animationSet.getAGALVertexCode(shaderObject);
            if (shaderObject.uvDependencies > 0 && !shaderObject.usesUVTransform)
                materialPassData.animationVertexCode += animationSet.getAGALUVCode(shaderObject);
            if (shaderObject.usesFragmentAnimation)
                materialPassData.animationFragmentCode += animationSet.getAGALFragmentCode(shaderObject, materialPassData.shadedTarget);
            animationSet.doneAGALCode(shaderObject);
        }
        else {
            // simply write attributes to targets, do not animate them
            // projection will pick up on targets[0] to do the projection
            var len = shaderObject.animatableAttributes.length;
            for (var i = 0; i < len; ++i)
                materialPassData.animationVertexCode += "mov " + shaderObject.animationTargetRegisters[i] + ", " + shaderObject.animatableAttributes[i] + "\n";
            if (shaderObject.uvDependencies > 0 && !shaderObject.usesUVTransform)
                materialPassData.animationVertexCode += "mov " + shaderObject.uvTarget + "," + shaderObject.uvSource + "\n";
        }
    };
    return ContextGLBase;
})();
module.exports = ContextGLBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvY29udGV4dGdsYmFzZS50cyJdLCJuYW1lcyI6WyJDb250ZXh0R0xCYXNlIiwiQ29udGV4dEdMQmFzZS5jb25zdHJ1Y3RvciIsIkNvbnRleHRHTEJhc2UuY29udGFpbmVyIiwiQ29udGV4dEdMQmFzZS5zZXRSZW5kZXJUYXJnZXQiLCJDb250ZXh0R0xCYXNlLmdldFJlbmRlclRleHR1cmUiLCJDb250ZXh0R0xCYXNlLmdldFByb2dyYW0iLCJDb250ZXh0R0xCYXNlLmdldE1hdGVyaWFsIiwiQ29udGV4dEdMQmFzZS5hY3RpdmF0ZUJ1ZmZlciIsIkNvbnRleHRHTEJhc2UuZGlzcG9zZVZlcnRleERhdGEiLCJDb250ZXh0R0xCYXNlLmFjdGl2YXRlUmVuZGVyVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuYWN0aXZhdGVNYXRlcmlhbFBhc3MiLCJDb250ZXh0R0xCYXNlLmRlYWN0aXZhdGVNYXRlcmlhbFBhc3MiLCJDb250ZXh0R0xCYXNlLmFjdGl2YXRlVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuYWN0aXZhdGVDdWJlVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuZ2V0SW5kZXhCdWZmZXIiLCJDb250ZXh0R0xCYXNlLmRpc3Bvc2VJbmRleERhdGEiLCJDb250ZXh0R0xCYXNlLmNsZWFyIiwiQ29udGV4dEdMQmFzZS5jb25maWd1cmVCYWNrQnVmZmVyIiwiQ29udGV4dEdMQmFzZS5jcmVhdGVJbmRleEJ1ZmZlciIsIkNvbnRleHRHTEJhc2UuY3JlYXRlVmVydGV4QnVmZmVyIiwiQ29udGV4dEdMQmFzZS5jcmVhdGVUZXh0dXJlIiwiQ29udGV4dEdMQmFzZS5jcmVhdGVDdWJlVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuY3JlYXRlUHJvZ3JhbSIsIkNvbnRleHRHTEJhc2UuZGlzcG9zZSIsIkNvbnRleHRHTEJhc2UucHJlc2VudCIsIkNvbnRleHRHTEJhc2Uuc2V0UmVuZGVyVG9UZXh0dXJlIiwiQ29udGV4dEdMQmFzZS5zZXRSZW5kZXJUb0JhY2tCdWZmZXIiLCJDb250ZXh0R0xCYXNlLnNldFNjaXNzb3JSZWN0YW5nbGUiLCJDb250ZXh0R0xCYXNlLnNldFRleHR1cmVBdCIsIkNvbnRleHRHTEJhc2Uuc2V0VmVydGV4QnVmZmVyQXQiLCJDb250ZXh0R0xCYXNlLnNldFByb2dyYW0iLCJDb250ZXh0R0xCYXNlLnJlZ2lzdGVyUHJvZ3JhbSIsIkNvbnRleHRHTEJhc2UudW5SZWdpc3RlclByb2dyYW0iLCJDb250ZXh0R0xCYXNlLmdldEVuYWJsZWRHUFVBbmltYXRpb24iLCJDb250ZXh0R0xCYXNlLmNhbGNBbmltYXRpb25Db2RlIl0sIm1hcHBpbmdzIjoiQUFHQSxJQUFPLG1CQUFtQixXQUFhLDRDQUE0QyxDQUFDLENBQUM7QUFFckYsSUFBTyxhQUFhLFdBQWMsd0NBQXdDLENBQUMsQ0FBQztBQVU1RSxJQUFPLGlCQUFpQixXQUFhLHNEQUFzRCxDQUFDLENBQUM7QUFPN0YsSUFBTyxlQUFlLFdBQWMsOENBQThDLENBQUMsQ0FBQztBQUVwRixJQUFPLGVBQWUsV0FBYyw4Q0FBOEMsQ0FBQyxDQUFDO0FBR3BGLElBQU8sZ0JBQWdCLFdBQWMsK0NBQStDLENBQUMsQ0FBQztBQUV0RixJQUFPLGtCQUFrQixXQUFhLG9EQUFvRCxDQUFDLENBQUM7QUFDNUYsSUFBTyxzQkFBc0IsV0FBWSx3REFBd0QsQ0FBQyxDQUFDO0FBVW5HLEFBUUE7Ozs7Ozs7R0FERztJQUNHLGFBQWE7SUE4QmxCQSxTQTlCS0EsYUFBYUEsQ0E4Qk5BLFVBQWlCQTtRQTVCckJDLGlCQUFZQSxHQUFzQkEsSUFBSUEsS0FBS0EsRUFBZUEsQ0FBQ0E7UUFDM0RBLG9CQUFlQSxHQUFVQSxDQUFDQSxDQUFDQTtRQUMzQkEscUJBQWdCQSxHQUFVQSxDQUFDQSxDQUFDQTtRQWFwQ0EsMkdBQTJHQTtRQUVuR0EsZ0JBQVdBLEdBQVVBLENBQUNBLENBQUNBLENBQUNBO1FBQ3hCQSxlQUFVQSxHQUFVQSxDQUFDQSxDQUFDQTtRQUV0QkEsa0JBQWFBLEdBQW9C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QUFZQSxDQUFDQSxDQUFDQTtRQUV6Q0EsQ0FBQ0E7UUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7WUFDUEEsQUFFQUEsMERBRjBEQTtZQUMxREEsNkRBQTZEQTtnQkFDekRBLEdBQUdBLEdBQVVBLFlBQVlBLENBQUNBLG9CQUFvQkEsQ0FBQ0EsTUFBTUEsQ0FBQ0E7WUFDMURBLEdBQUdBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBLEdBQVVBLENBQUNBLEVBQUVBLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLEVBQUVBLENBQUNBO2dCQUNsQ0EsZ0JBQWdCQSxDQUFDQSxtQkFBbUJBLElBQUlBLE1BQU1BLEdBQUdBLFlBQVlBLENBQUNBLHdCQUF3QkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsR0FBR0EsWUFBWUEsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUVoSkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsY0FBY0EsR0FBR0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsZUFBZUEsQ0FBQ0E7Z0JBQ3BFQSxnQkFBZ0JBLENBQUNBLG1CQUFtQkEsSUFBSUEsTUFBTUEsR0FBR0EsWUFBWUEsQ0FBQ0EsUUFBUUEsR0FBR0EsR0FBR0EsR0FBR0EsWUFBWUEsQ0FBQ0EsUUFBUUEsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDOUdBLENBQUNBO0lBQ0ZBLENBQUNBO0lBQ0ZsQyxvQkFBQ0E7QUFBREEsQ0FqY0EsQUFpY0NBLElBQUE7QUFFRCxBQUF1QixpQkFBZCxhQUFhLENBQUMiLCJmaWxlIjoiY29yZS9zdGFnZWdsL0NvbnRleHRHTEJhc2UuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJpdG1hcERhdGFcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2Jhc2UvQml0bWFwRGF0YVwiKTtcbmltcG9ydCBNYXRyaXgzRFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeDNEXCIpO1xuaW1wb3J0IFJlY3RhbmdsZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9SZWN0YW5nbGVcIik7XG5pbXBvcnQgQWJzdHJhY3RNZXRob2RFcnJvclx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9lcnJvcnMvQWJzdHJhY3RNZXRob2RFcnJvclwiKTtcbmltcG9ydCBDdWJlVGV4dHVyZUJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi90ZXh0dXJlcy9DdWJlVGV4dHVyZUJhc2VcIik7XG5pbXBvcnQgUmVuZGVyVGV4dHVyZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3RleHR1cmVzL1JlbmRlclRleHR1cmVcIik7XG5pbXBvcnQgVGV4dHVyZTJEQmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3RleHR1cmVzL1RleHR1cmUyREJhc2VcIik7XG5pbXBvcnQgVGV4dHVyZVByb3h5QmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3RleHR1cmVzL1RleHR1cmVQcm94eUJhc2VcIik7XG5pbXBvcnQgQnl0ZUFycmF5XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi91dGlscy9CeXRlQXJyYXlcIik7XG5cbmltcG9ydCBJTWF0ZXJpYWxPd25lclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2Jhc2UvSU1hdGVyaWFsT3duZXJcIik7XG5pbXBvcnQgSUNvbnRleHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZGlzcGxheS9JQ29udGV4dFwiKTtcbmltcG9ydCBDYW1lcmFcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZW50aXRpZXMvQ2FtZXJhXCIpO1xuXG5pbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9iYXNlL1N0YWdlXCIpO1xuaW1wb3J0IEFHQUxNaW5pQXNzZW1ibGVyXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2FnbHNsL2Fzc2VtYmxlci9BR0FMTWluaUFzc2VtYmxlclwiKTtcbmltcG9ydCBBbmltYXRvckJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2FuaW1hdG9ycy9BbmltYXRvckJhc2VcIik7XG5pbXBvcnQgQW5pbWF0aW9uU2V0QmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2FuaW1hdG9ycy9BbmltYXRpb25TZXRCYXNlXCIpO1xuaW1wb3J0IEluZGV4RGF0YVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9wb29sL0luZGV4RGF0YVwiKTtcbmltcG9ydCBNYXRlcmlhbFBhc3NEYXRhXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9wb29sL01hdGVyaWFsUGFzc0RhdGFcIik7XG5pbXBvcnQgTWF0ZXJpYWxQYXNzRGF0YVBvb2xcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9wb29sL01hdGVyaWFsUGFzc0RhdGFQb29sXCIpO1xuaW1wb3J0IFRleHR1cmVEYXRhXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3Bvb2wvVGV4dHVyZURhdGFcIik7XG5pbXBvcnQgVGV4dHVyZURhdGFQb29sXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9wb29sL1RleHR1cmVEYXRhUG9vbFwiKTtcbmltcG9ydCBQcm9ncmFtRGF0YVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9wb29sL1Byb2dyYW1EYXRhXCIpO1xuaW1wb3J0IFByb2dyYW1EYXRhUG9vbFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvcG9vbC9Qcm9ncmFtRGF0YVBvb2xcIik7XG5pbXBvcnQgUmVuZGVyYWJsZUJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3Bvb2wvUmVuZGVyYWJsZUJhc2VcIik7XG5pbXBvcnQgTWF0ZXJpYWxEYXRhXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3Bvb2wvTWF0ZXJpYWxEYXRhXCIpO1xuaW1wb3J0IE1hdGVyaWFsRGF0YVBvb2xcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3Bvb2wvTWF0ZXJpYWxEYXRhUG9vbFwiKTtcbmltcG9ydCBWZXJ0ZXhEYXRhXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3Bvb2wvVmVydGV4RGF0YVwiKTtcbmltcG9ydCBDb250ZXh0R0xDbGVhck1hc2tcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9zdGFnZWdsL0NvbnRleHRHTENsZWFyTWFza1wiKTtcbmltcG9ydCBDb250ZXh0R0xUZXh0dXJlRm9ybWF0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvQ29udGV4dEdMVGV4dHVyZUZvcm1hdFwiKTtcbmltcG9ydCBJQ3ViZVRleHR1cmVcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvc3RhZ2VnbC9JQ3ViZVRleHR1cmVcIik7XG5pbXBvcnQgSUluZGV4QnVmZmVyXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvSUluZGV4QnVmZmVyXCIpO1xuaW1wb3J0IElQcm9ncmFtXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvc3RhZ2VnbC9JUHJvZ3JhbVwiKTtcbmltcG9ydCBJVGV4dHVyZVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvSVRleHR1cmVcIik7XG5pbXBvcnQgSVRleHR1cmVCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvSVRleHR1cmVCYXNlXCIpO1xuaW1wb3J0IElWZXJ0ZXhCdWZmZXJcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvSVZlcnRleEJ1ZmZlclwiKTtcbmltcG9ydCBTdGFnZUdMTWF0ZXJpYWxCYXNlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL21hdGVyaWFscy9TdGFnZUdMTWF0ZXJpYWxCYXNlXCIpO1xuaW1wb3J0IFNoYWRlck9iamVjdEJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9tYXRlcmlhbHMvY29tcGlsYXRpb24vU2hhZGVyT2JqZWN0QmFzZVwiKTtcblxuLyoqXG4gKiBTdGFnZSBwcm92aWRlcyBhIHByb3h5IGNsYXNzIHRvIGhhbmRsZSB0aGUgY3JlYXRpb24gYW5kIGF0dGFjaG1lbnQgb2YgdGhlIENvbnRleHRcbiAqIChhbmQgaW4gdHVybiB0aGUgYmFjayBidWZmZXIpIGl0IHVzZXMuIFN0YWdlIHNob3VsZCBuZXZlciBiZSBjcmVhdGVkIGRpcmVjdGx5LFxuICogYnV0IHJlcXVlc3RlZCB0aHJvdWdoIFN0YWdlTWFuYWdlci5cbiAqXG4gKiBAc2VlIGF3YXkubWFuYWdlcnMuU3RhZ2VNYW5hZ2VyXG4gKlxuICovXG5jbGFzcyBDb250ZXh0R0xCYXNlIGltcGxlbWVudHMgSUNvbnRleHRcbntcblx0cHJpdmF0ZSBfcHJvZ3JhbURhdGE6QXJyYXk8UHJvZ3JhbURhdGE+ID0gbmV3IEFycmF5PFByb2dyYW1EYXRhPigpO1xuXHRwcml2YXRlIF9udW1Vc2VkU3RyZWFtczpudW1iZXIgPSAwO1xuXHRwcml2YXRlIF9udW1Vc2VkVGV4dHVyZXM6bnVtYmVyID0gMDtcblxuXHRwdWJsaWMgX3BDb250YWluZXI6SFRNTEVsZW1lbnQ7XG5cblx0cHJpdmF0ZSBfdGV4dHVyZVBvb2w6VGV4dHVyZURhdGFQb29sO1xuXG5cdHByaXZhdGUgX21hdGVyaWFsRGF0YVBvb2w6TWF0ZXJpYWxEYXRhUG9vbDtcblxuXHRwcml2YXRlIF9wcm9ncmFtRGF0YVBvb2w6UHJvZ3JhbURhdGFQb29sO1xuXG5cdHByaXZhdGUgX3dpZHRoOm51bWJlcjtcblx0cHJpdmF0ZSBfaGVpZ2h0Om51bWJlcjtcblxuXHQvL3ByaXZhdGUgc3RhdGljIF9mcmFtZUV2ZW50RHJpdmVyOlNoYXBlID0gbmV3IFNoYXBlKCk7IC8vIFRPRE86IGFkZCBmcmFtZSBkcml2ZXIgLyByZXF1ZXN0IGFuaW1hdGlvbiBmcmFtZVxuXG5cdHByaXZhdGUgX3N0YWdlSW5kZXg6bnVtYmVyID0gLTE7XG5cdHByaXZhdGUgX2FudGlBbGlhczpudW1iZXIgPSAwO1xuXHRwcml2YXRlIF9lbmFibGVEZXB0aEFuZFN0ZW5jaWw6Ym9vbGVhbjtcblx0cHJpdmF0ZSBfcmVuZGVyVGFyZ2V0OlRleHR1cmVQcm94eUJhc2UgPSBudWxsO1xuXHRwcml2YXRlIF9yZW5kZXJTdXJmYWNlU2VsZWN0b3I6bnVtYmVyID0gMDtcblxuXHRwdWJsaWMgZ2V0IGNvbnRhaW5lcigpOkhUTUxFbGVtZW50XG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fcENvbnRhaW5lcjtcblx0fVxuXG5cdGNvbnN0cnVjdG9yKHN0YWdlSW5kZXg6bnVtYmVyKVxuXHR7XG5cdFx0dGhpcy5fc3RhZ2VJbmRleCA9IHN0YWdlSW5kZXg7XG5cdFx0dGhpcy5fdGV4dHVyZVBvb2wgPSBuZXcgVGV4dHVyZURhdGFQb29sKHRoaXMpO1xuXHRcdHRoaXMuX21hdGVyaWFsRGF0YVBvb2wgPSBuZXcgTWF0ZXJpYWxEYXRhUG9vbCh0aGlzKTtcblx0XHR0aGlzLl9wcm9ncmFtRGF0YVBvb2wgPSBuZXcgUHJvZ3JhbURhdGFQb29sKHRoaXMpO1xuXHR9XG5cblx0cHVibGljIHNldFJlbmRlclRhcmdldCh0YXJnZXQ6VGV4dHVyZVByb3h5QmFzZSwgZW5hYmxlRGVwdGhBbmRTdGVuY2lsOmJvb2xlYW4gPSBmYWxzZSwgc3VyZmFjZVNlbGVjdG9yOm51bWJlciA9IDApXG5cdHtcblx0XHRpZiAodGhpcy5fcmVuZGVyVGFyZ2V0ID09PSB0YXJnZXQgJiYgc3VyZmFjZVNlbGVjdG9yID09IHRoaXMuX3JlbmRlclN1cmZhY2VTZWxlY3RvciAmJiB0aGlzLl9lbmFibGVEZXB0aEFuZFN0ZW5jaWwgPT0gZW5hYmxlRGVwdGhBbmRTdGVuY2lsKVxuXHRcdFx0cmV0dXJuO1xuXG5cdFx0dGhpcy5fcmVuZGVyVGFyZ2V0ID0gdGFyZ2V0O1xuXHRcdHRoaXMuX3JlbmRlclN1cmZhY2VTZWxlY3RvciA9IHN1cmZhY2VTZWxlY3Rvcjtcblx0XHR0aGlzLl9lbmFibGVEZXB0aEFuZFN0ZW5jaWwgPSBlbmFibGVEZXB0aEFuZFN0ZW5jaWw7XG5cdFx0aWYgKHRhcmdldCBpbnN0YW5jZW9mIFJlbmRlclRleHR1cmUpIHtcblx0XHRcdHRoaXMuc2V0UmVuZGVyVG9UZXh0dXJlKHRoaXMuZ2V0UmVuZGVyVGV4dHVyZSg8UmVuZGVyVGV4dHVyZT4gdGFyZ2V0KSwgZW5hYmxlRGVwdGhBbmRTdGVuY2lsLCB0aGlzLl9hbnRpQWxpYXMsIHN1cmZhY2VTZWxlY3Rvcik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc2V0UmVuZGVyVG9CYWNrQnVmZmVyKCk7XG5cdFx0XHR0aGlzLmNvbmZpZ3VyZUJhY2tCdWZmZXIodGhpcy5fd2lkdGgsIHRoaXMuX2hlaWdodCwgdGhpcy5fYW50aUFsaWFzLCB0aGlzLl9lbmFibGVEZXB0aEFuZFN0ZW5jaWwpO1xuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBnZXRSZW5kZXJUZXh0dXJlKHRleHR1cmVQcm94eTpSZW5kZXJUZXh0dXJlKTpJVGV4dHVyZUJhc2Vcblx0e1xuXHRcdHZhciB0ZXh0dXJlRGF0YTpUZXh0dXJlRGF0YSA9IHRoaXMuX3RleHR1cmVQb29sLmdldEl0ZW0odGV4dHVyZVByb3h5KTtcblxuXHRcdGlmICghdGV4dHVyZURhdGEudGV4dHVyZSlcblx0XHRcdHRleHR1cmVEYXRhLnRleHR1cmUgPSB0aGlzLmNyZWF0ZVRleHR1cmUodGV4dHVyZVByb3h5LndpZHRoLCB0ZXh0dXJlUHJveHkuaGVpZ2h0LCBDb250ZXh0R0xUZXh0dXJlRm9ybWF0LkJHUkEsIHRydWUpO1xuXG5cdFx0cmV0dXJuIHRleHR1cmVEYXRhLnRleHR1cmU7XG5cdH1cblxuXHRwdWJsaWMgZ2V0UHJvZ3JhbShtYXRlcmlhbFBhc3NEYXRhOk1hdGVyaWFsUGFzc0RhdGEpOlByb2dyYW1EYXRhXG5cdHtcblx0XHQvL2NoZWNrIGtleSBkb2Vzbid0IG5lZWQgcmUtY29uY2F0ZW5hdGluZ1xuXHRcdGlmICghbWF0ZXJpYWxQYXNzRGF0YS5rZXkubGVuZ3RoKSB7XG5cdFx0XHRtYXRlcmlhbFBhc3NEYXRhLmtleSA9IG1hdGVyaWFsUGFzc0RhdGEuYW5pbWF0aW9uVmVydGV4Q29kZSArXG5cdFx0XHRcdG1hdGVyaWFsUGFzc0RhdGEudmVydGV4Q29kZSArXG5cdFx0XHRcdFwiLS0tXCIgK1xuXHRcdFx0XHRtYXRlcmlhbFBhc3NEYXRhLmZyYWdtZW50Q29kZSArXG5cdFx0XHRcdG1hdGVyaWFsUGFzc0RhdGEuYW5pbWF0aW9uRnJhZ21lbnRDb2RlICtcblx0XHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5wb3N0QW5pbWF0aW9uRnJhZ21lbnRDb2RlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gbWF0ZXJpYWxQYXNzRGF0YS5wcm9ncmFtRGF0YTtcblx0XHR9XG5cblx0XHR2YXIgcHJvZ3JhbURhdGE6UHJvZ3JhbURhdGEgPSB0aGlzLl9wcm9ncmFtRGF0YVBvb2wuZ2V0SXRlbShtYXRlcmlhbFBhc3NEYXRhLmtleSk7XG5cblx0XHQvL2NoZWNrIHByb2dyYW0gZGF0YSBoYXNuJ3QgY2hhbmdlZCwga2VlcCBjb3VudCBvZiBwcm9ncmFtIHVzYWdlc1xuXHRcdGlmIChtYXRlcmlhbFBhc3NEYXRhLnByb2dyYW1EYXRhICE9IHByb2dyYW1EYXRhKSB7XG5cdFx0XHRpZiAobWF0ZXJpYWxQYXNzRGF0YS5wcm9ncmFtRGF0YSlcblx0XHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5wcm9ncmFtRGF0YS5kaXNwb3NlKCk7XG5cblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEucHJvZ3JhbURhdGEgPSBwcm9ncmFtRGF0YTtcblxuXHRcdFx0cHJvZ3JhbURhdGEudXNhZ2VzKys7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHByb2dyYW1EYXRhO1xuXHR9XG5cblx0LyoqXG5cdCAqXG5cdCAqIEBwYXJhbSBtYXRlcmlhbFxuXHQgKi9cblx0cHVibGljIGdldE1hdGVyaWFsKG1hdGVyaWFsOlN0YWdlR0xNYXRlcmlhbEJhc2UsIHByb2ZpbGU6c3RyaW5nKTpNYXRlcmlhbERhdGFcblx0e1xuXHRcdHZhciBtYXRlcmlhbERhdGE6TWF0ZXJpYWxEYXRhID0gdGhpcy5fbWF0ZXJpYWxEYXRhUG9vbC5nZXRJdGVtKG1hdGVyaWFsKTtcblxuXHRcdGlmIChtYXRlcmlhbERhdGEuaW52YWxpZEFuaW1hdGlvbikge1xuXHRcdFx0bWF0ZXJpYWxEYXRhLmludmFsaWRBbmltYXRpb24gPSBmYWxzZTtcblxuXHRcdFx0dmFyIG1hdGVyaWFsRGF0YVBhc3NlczpBcnJheTxNYXRlcmlhbFBhc3NEYXRhPiA9IG1hdGVyaWFsRGF0YS5nZXRNYXRlcmlhbFBhc3Nlcyhwcm9maWxlKTtcblxuXHRcdFx0dmFyIGVuYWJsZWRHUFVBbmltYXRpb246Ym9vbGVhbiA9IHRoaXMuZ2V0RW5hYmxlZEdQVUFuaW1hdGlvbihtYXRlcmlhbCwgbWF0ZXJpYWxEYXRhUGFzc2VzKTtcblxuXHRcdFx0dmFyIHJlbmRlck9yZGVySWQgPSAwO1xuXHRcdFx0dmFyIG11bHQ6bnVtYmVyID0gMTtcblx0XHRcdHZhciBtYXRlcmlhbFBhc3NEYXRhOk1hdGVyaWFsUGFzc0RhdGE7XG5cdFx0XHR2YXIgbGVuOm51bWJlciA9IG1hdGVyaWFsRGF0YVBhc3Nlcy5sZW5ndGg7XG5cdFx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0XHRtYXRlcmlhbFBhc3NEYXRhID0gbWF0ZXJpYWxEYXRhUGFzc2VzW2ldO1xuXG5cdFx0XHRcdGlmIChtYXRlcmlhbFBhc3NEYXRhLnVzZXNBbmltYXRpb24gIT0gZW5hYmxlZEdQVUFuaW1hdGlvbikge1xuXHRcdFx0XHRcdG1hdGVyaWFsUGFzc0RhdGEudXNlc0FuaW1hdGlvbiA9IGVuYWJsZWRHUFVBbmltYXRpb247XG5cdFx0XHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5rZXkgPT0gXCJcIjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChtYXRlcmlhbFBhc3NEYXRhLmtleSA9PSBcIlwiKVxuXHRcdFx0XHRcdHRoaXMuY2FsY0FuaW1hdGlvbkNvZGUobWF0ZXJpYWwsIG1hdGVyaWFsUGFzc0RhdGEpO1xuXG5cdFx0XHRcdHJlbmRlck9yZGVySWQgKz0gdGhpcy5nZXRQcm9ncmFtKG1hdGVyaWFsUGFzc0RhdGEpLmlkKm11bHQ7XG5cdFx0XHRcdG11bHQgKj0gMTAwMDtcblx0XHRcdH1cblxuXHRcdFx0bWF0ZXJpYWxEYXRhLnJlbmRlck9yZGVySWQgPSByZW5kZXJPcmRlcklkO1xuXHRcdH1cblxuXHRcdHJldHVybiBtYXRlcmlhbERhdGE7XG5cdH1cblxuXHQvKipcblx0ICogQXNzaWducyBhbiBhdHRyaWJ1dGUgc3RyZWFtXG5cdCAqXG5cdCAqIEBwYXJhbSBpbmRleCBUaGUgYXR0cmlidXRlIHN0cmVhbSBpbmRleCBmb3IgdGhlIHZlcnRleCBzaGFkZXJcblx0ICogQHBhcmFtIGJ1ZmZlclxuXHQgKiBAcGFyYW0gb2Zmc2V0XG5cdCAqIEBwYXJhbSBzdHJpZGVcblx0ICogQHBhcmFtIGZvcm1hdFxuXHQgKi9cblx0cHVibGljIGFjdGl2YXRlQnVmZmVyKGluZGV4Om51bWJlciwgYnVmZmVyOlZlcnRleERhdGEsIG9mZnNldDpudW1iZXIsIGZvcm1hdDpzdHJpbmcpXG5cdHtcblx0XHRpZiAoIWJ1ZmZlci5jb250ZXh0c1t0aGlzLl9zdGFnZUluZGV4XSlcblx0XHRcdGJ1ZmZlci5jb250ZXh0c1t0aGlzLl9zdGFnZUluZGV4XSA9IHRoaXM7XG5cblx0XHRpZiAoIWJ1ZmZlci5idWZmZXJzW3RoaXMuX3N0YWdlSW5kZXhdKSB7XG5cdFx0XHRidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XSA9IHRoaXMuY3JlYXRlVmVydGV4QnVmZmVyKGJ1ZmZlci5kYXRhLmxlbmd0aC9idWZmZXIuZGF0YVBlclZlcnRleCwgYnVmZmVyLmRhdGFQZXJWZXJ0ZXgpO1xuXHRcdFx0YnVmZmVyLmludmFsaWRbdGhpcy5fc3RhZ2VJbmRleF0gPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmIChidWZmZXIuaW52YWxpZFt0aGlzLl9zdGFnZUluZGV4XSkge1xuXHRcdFx0YnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0udXBsb2FkRnJvbUFycmF5KGJ1ZmZlci5kYXRhLCAwLCBidWZmZXIuZGF0YS5sZW5ndGgvYnVmZmVyLmRhdGFQZXJWZXJ0ZXgpO1xuXHRcdFx0YnVmZmVyLmludmFsaWRbdGhpcy5fc3RhZ2VJbmRleF0gPSBmYWxzZTtcblx0XHR9XG5cblx0XHR0aGlzLnNldFZlcnRleEJ1ZmZlckF0KGluZGV4LCBidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XSwgb2Zmc2V0LCBmb3JtYXQpO1xuXHR9XG5cblx0cHVibGljIGRpc3Bvc2VWZXJ0ZXhEYXRhKGJ1ZmZlcjpWZXJ0ZXhEYXRhKVxuXHR7XG5cdFx0YnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0uZGlzcG9zZSgpO1xuXHRcdGJ1ZmZlci5idWZmZXJzW3RoaXMuX3N0YWdlSW5kZXhdID0gbnVsbDtcblx0fVxuXG5cdHB1YmxpYyBhY3RpdmF0ZVJlbmRlclRleHR1cmUoaW5kZXg6bnVtYmVyLCB0ZXh0dXJlUHJveHk6UmVuZGVyVGV4dHVyZSlcblx0e1xuXHRcdHRoaXMuc2V0VGV4dHVyZUF0KGluZGV4LCB0aGlzLmdldFJlbmRlclRleHR1cmUodGV4dHVyZVByb3h5KSk7XG5cdH1cblxuXHRwdWJsaWMgYWN0aXZhdGVNYXRlcmlhbFBhc3MobWF0ZXJpYWxQYXNzRGF0YTpNYXRlcmlhbFBhc3NEYXRhLCBzdGFnZTpTdGFnZSwgY2FtZXJhOkNhbWVyYSlcblx0e1xuXHRcdHZhciBzaGFkZXJPYmplY3Q6U2hhZGVyT2JqZWN0QmFzZSA9IG1hdGVyaWFsUGFzc0RhdGEuc2hhZGVyT2JqZWN0O1xuXG5cdFx0Ly9jbGVhciB1bnVzZWQgdmVydGV4IHN0cmVhbXNcblx0XHRmb3IgKHZhciBpID0gc2hhZGVyT2JqZWN0Lm51bVVzZWRTdHJlYW1zOyBpIDwgdGhpcy5fbnVtVXNlZFN0cmVhbXM7IGkrKylcblx0XHRcdHRoaXMuc2V0VmVydGV4QnVmZmVyQXQoaSwgbnVsbCk7XG5cblx0XHQvL2NsZWFyIHVudXNlZCB0ZXh0dXJlIHN0cmVhbXNcblx0XHRmb3IgKHZhciBpID0gc2hhZGVyT2JqZWN0Lm51bVVzZWRUZXh0dXJlczsgaSA8IHRoaXMuX251bVVzZWRUZXh0dXJlczsgaSsrKVxuXHRcdFx0dGhpcy5zZXRUZXh0dXJlQXQoaSwgbnVsbCk7XG5cblx0XHRpZiAobWF0ZXJpYWxQYXNzRGF0YS51c2VzQW5pbWF0aW9uKVxuXHRcdFx0KDxBbmltYXRpb25TZXRCYXNlPiBtYXRlcmlhbFBhc3NEYXRhLm1hdGVyaWFsLmFuaW1hdGlvblNldCkuYWN0aXZhdGUoc2hhZGVyT2JqZWN0LCBzdGFnZSk7XG5cblx0XHQvL2FjdGl2YXRlIHNoYWRlciBvYmplY3Rcblx0XHRzaGFkZXJPYmplY3QuaUFjdGl2YXRlKHN0YWdlLCBjYW1lcmEpO1xuXG5cdFx0Ly9jaGVjayBwcm9ncmFtIGRhdGEgaXMgdXBsb2FkZWRcblx0XHR2YXIgcHJvZ3JhbURhdGE6UHJvZ3JhbURhdGEgPSB0aGlzLmdldFByb2dyYW0obWF0ZXJpYWxQYXNzRGF0YSk7XG5cblx0XHRpZiAoIXByb2dyYW1EYXRhLnByb2dyYW0pIHtcblx0XHRcdHByb2dyYW1EYXRhLnByb2dyYW0gPSB0aGlzLmNyZWF0ZVByb2dyYW0oKTtcblx0XHRcdHZhciB2ZXJ0ZXhCeXRlQ29kZTpCeXRlQXJyYXkgPSAobmV3IEFHQUxNaW5pQXNzZW1ibGVyKCkuYXNzZW1ibGUoXCJwYXJ0IHZlcnRleCAxXFxuXCIgKyBtYXRlcmlhbFBhc3NEYXRhLmFuaW1hdGlvblZlcnRleENvZGUgKyBtYXRlcmlhbFBhc3NEYXRhLnZlcnRleENvZGUgKyBcImVuZHBhcnRcIikpWyd2ZXJ0ZXgnXS5kYXRhO1xuXHRcdFx0dmFyIGZyYWdtZW50Qnl0ZUNvZGU6Qnl0ZUFycmF5ID0gKG5ldyBBR0FMTWluaUFzc2VtYmxlcigpLmFzc2VtYmxlKFwicGFydCBmcmFnbWVudCAxXFxuXCIgKyBtYXRlcmlhbFBhc3NEYXRhLmZyYWdtZW50Q29kZSArIG1hdGVyaWFsUGFzc0RhdGEuYW5pbWF0aW9uRnJhZ21lbnRDb2RlICsgbWF0ZXJpYWxQYXNzRGF0YS5wb3N0QW5pbWF0aW9uRnJhZ21lbnRDb2RlICsgXCJlbmRwYXJ0XCIpKVsnZnJhZ21lbnQnXS5kYXRhO1xuXHRcdFx0cHJvZ3JhbURhdGEucHJvZ3JhbS51cGxvYWQodmVydGV4Qnl0ZUNvZGUsIGZyYWdtZW50Qnl0ZUNvZGUpO1xuXHRcdH1cblxuXHRcdC8vc2V0IHByb2dyYW0gZGF0YVxuXHRcdHRoaXMuc2V0UHJvZ3JhbShwcm9ncmFtRGF0YS5wcm9ncmFtKTtcblx0fVxuXG5cdHB1YmxpYyBkZWFjdGl2YXRlTWF0ZXJpYWxQYXNzKG1hdGVyaWFsUGFzc0RhdGE6TWF0ZXJpYWxQYXNzRGF0YSwgc3RhZ2U6U3RhZ2UpXG5cdHtcblx0XHR2YXIgc2hhZGVyT2JqZWN0OlNoYWRlck9iamVjdEJhc2UgPSBtYXRlcmlhbFBhc3NEYXRhLnNoYWRlck9iamVjdDtcblxuXHRcdGlmIChtYXRlcmlhbFBhc3NEYXRhLnVzZXNBbmltYXRpb24pXG5cdFx0XHQoPEFuaW1hdGlvblNldEJhc2U+IG1hdGVyaWFsUGFzc0RhdGEubWF0ZXJpYWwuYW5pbWF0aW9uU2V0KS5kZWFjdGl2YXRlKHNoYWRlck9iamVjdCwgc3RhZ2UpO1xuXG5cdFx0bWF0ZXJpYWxQYXNzRGF0YS5zaGFkZXJPYmplY3QuaURlYWN0aXZhdGUoc3RhZ2UpO1xuXG5cdFx0dGhpcy5fbnVtVXNlZFN0cmVhbXMgPSBzaGFkZXJPYmplY3QubnVtVXNlZFN0cmVhbXM7XG5cdFx0dGhpcy5fbnVtVXNlZFRleHR1cmVzID0gc2hhZGVyT2JqZWN0Lm51bVVzZWRUZXh0dXJlcztcblx0fVxuXG5cdHB1YmxpYyBhY3RpdmF0ZVRleHR1cmUoaW5kZXg6bnVtYmVyLCB0ZXh0dXJlUHJveHk6VGV4dHVyZTJEQmFzZSlcblx0e1xuXHRcdHZhciB0ZXh0dXJlRGF0YTpUZXh0dXJlRGF0YSA9IDxUZXh0dXJlRGF0YT4gdGhpcy5fdGV4dHVyZVBvb2wuZ2V0SXRlbSh0ZXh0dXJlUHJveHkpO1xuXG5cdFx0aWYgKCF0ZXh0dXJlRGF0YS50ZXh0dXJlKSB7XG5cdFx0XHR0ZXh0dXJlRGF0YS50ZXh0dXJlID0gdGhpcy5jcmVhdGVUZXh0dXJlKHRleHR1cmVQcm94eS53aWR0aCwgdGV4dHVyZVByb3h5LmhlaWdodCwgQ29udGV4dEdMVGV4dHVyZUZvcm1hdC5CR1JBLCB0cnVlKTtcblx0XHRcdHRleHR1cmVEYXRhLmludmFsaWQgPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmICh0ZXh0dXJlRGF0YS5pbnZhbGlkKSB7XG5cdFx0XHR0ZXh0dXJlRGF0YS5pbnZhbGlkID0gZmFsc2U7XG5cdFx0XHRpZiAodGV4dHVyZVByb3h5LmdlbmVyYXRlTWlwbWFwcykge1xuXHRcdFx0XHR2YXIgbWlwbWFwRGF0YTpBcnJheTxCaXRtYXBEYXRhPiA9IHRleHR1cmVQcm94eS5faUdldE1pcG1hcERhdGEoKTtcblx0XHRcdFx0dmFyIGxlbjpudW1iZXIgPSBtaXBtYXBEYXRhLmxlbmd0aDtcblx0XHRcdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgbGVuOyBpKyspXG5cdFx0XHRcdFx0KDxJVGV4dHVyZT4gdGV4dHVyZURhdGEudGV4dHVyZSkudXBsb2FkRnJvbURhdGEobWlwbWFwRGF0YVtpXSwgaSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQoPElUZXh0dXJlPiB0ZXh0dXJlRGF0YS50ZXh0dXJlKS51cGxvYWRGcm9tRGF0YSh0ZXh0dXJlUHJveHkuX2lHZXRUZXh0dXJlRGF0YSgpLCAwKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLnNldFRleHR1cmVBdChpbmRleCwgdGV4dHVyZURhdGEudGV4dHVyZSk7XG5cdH1cblxuXHRwdWJsaWMgYWN0aXZhdGVDdWJlVGV4dHVyZShpbmRleDpudW1iZXIsIHRleHR1cmVQcm94eTpDdWJlVGV4dHVyZUJhc2UpXG5cdHtcblx0XHR2YXIgdGV4dHVyZURhdGE6VGV4dHVyZURhdGEgPSA8VGV4dHVyZURhdGE+IHRoaXMuX3RleHR1cmVQb29sLmdldEl0ZW0odGV4dHVyZVByb3h5KTtcblxuXHRcdGlmICghdGV4dHVyZURhdGEudGV4dHVyZSkge1xuXHRcdFx0dGV4dHVyZURhdGEudGV4dHVyZSA9IHRoaXMuY3JlYXRlQ3ViZVRleHR1cmUodGV4dHVyZVByb3h5LnNpemUsIENvbnRleHRHTFRleHR1cmVGb3JtYXQuQkdSQSwgZmFsc2UpO1xuXHRcdFx0dGV4dHVyZURhdGEuaW52YWxpZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKHRleHR1cmVEYXRhLmludmFsaWQpIHtcblx0XHRcdHRleHR1cmVEYXRhLmludmFsaWQgPSBmYWxzZTtcblx0XHRcdGZvciAodmFyIGk6bnVtYmVyID0gMDsgaSA8IDY7ICsraSkge1xuXHRcdFx0XHRpZiAodGV4dHVyZVByb3h5LmdlbmVyYXRlTWlwbWFwcykge1xuXHRcdFx0XHRcdHZhciBtaXBtYXBEYXRhOkFycmF5PEJpdG1hcERhdGE+ID0gdGV4dHVyZVByb3h5Ll9pR2V0TWlwbWFwRGF0YShpKTtcblx0XHRcdFx0XHR2YXIgbGVuOm51bWJlciA9IG1pcG1hcERhdGEubGVuZ3RoO1xuXHRcdFx0XHRcdGZvciAodmFyIGo6bnVtYmVyID0gMDsgaiA8IGxlbjsgaisrKVxuXHRcdFx0XHRcdFx0KDxJQ3ViZVRleHR1cmU+IHRleHR1cmVEYXRhLnRleHR1cmUpLnVwbG9hZEZyb21EYXRhKG1pcG1hcERhdGFbal0sIGksIGopO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdCg8SUN1YmVUZXh0dXJlPiB0ZXh0dXJlRGF0YS50ZXh0dXJlKS51cGxvYWRGcm9tRGF0YSh0ZXh0dXJlUHJveHkuX2lHZXRUZXh0dXJlRGF0YShpKSwgaSwgMCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aGlzLnNldFRleHR1cmVBdChpbmRleCwgdGV4dHVyZURhdGEudGV4dHVyZSk7XG5cdH1cblxuXHQvKipcblx0ICogUmV0cmlldmVzIHRoZSBWZXJ0ZXhCdWZmZXIgb2JqZWN0IHRoYXQgY29udGFpbnMgdHJpYW5nbGUgaW5kaWNlcy5cblx0ICogQHBhcmFtIGNvbnRleHQgVGhlIENvbnRleHRXZWIgZm9yIHdoaWNoIHdlIHJlcXVlc3QgdGhlIGJ1ZmZlclxuXHQgKiBAcmV0dXJuIFRoZSBWZXJ0ZXhCdWZmZXIgb2JqZWN0IHRoYXQgY29udGFpbnMgdHJpYW5nbGUgaW5kaWNlcy5cblx0ICovXG5cdHB1YmxpYyBnZXRJbmRleEJ1ZmZlcihidWZmZXI6SW5kZXhEYXRhKTpJSW5kZXhCdWZmZXJcblx0e1xuXHRcdGlmICghYnVmZmVyLmNvbnRleHRzW3RoaXMuX3N0YWdlSW5kZXhdKVxuXHRcdFx0YnVmZmVyLmNvbnRleHRzW3RoaXMuX3N0YWdlSW5kZXhdID0gdGhpcztcblxuXHRcdGlmICghYnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0pIHtcblx0XHRcdGJ1ZmZlci5idWZmZXJzW3RoaXMuX3N0YWdlSW5kZXhdID0gdGhpcy5jcmVhdGVJbmRleEJ1ZmZlcihidWZmZXIuZGF0YS5sZW5ndGgpO1xuXHRcdFx0YnVmZmVyLmludmFsaWRbdGhpcy5fc3RhZ2VJbmRleF0gPSB0cnVlO1xuXHRcdH1cblxuXHRcdGlmIChidWZmZXIuaW52YWxpZFt0aGlzLl9zdGFnZUluZGV4XSkge1xuXHRcdFx0YnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0udXBsb2FkRnJvbUFycmF5KGJ1ZmZlci5kYXRhLCAwLCBidWZmZXIuZGF0YS5sZW5ndGgpO1xuXHRcdFx0YnVmZmVyLmludmFsaWRbdGhpcy5fc3RhZ2VJbmRleF0gPSBmYWxzZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gYnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF07XG5cdH1cblxuXHRwdWJsaWMgZGlzcG9zZUluZGV4RGF0YShidWZmZXI6SW5kZXhEYXRhKVxuXHR7XG5cdFx0YnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0uZGlzcG9zZSgpO1xuXHRcdGJ1ZmZlci5idWZmZXJzW3RoaXMuX3N0YWdlSW5kZXhdID0gbnVsbDtcblx0fVxuXG5cdHB1YmxpYyBjbGVhcihyZWQ6bnVtYmVyID0gMCwgZ3JlZW46bnVtYmVyID0gMCwgYmx1ZTpudW1iZXIgPSAwLCBhbHBoYTpudW1iZXIgPSAxLCBkZXB0aDpudW1iZXIgPSAxLCBzdGVuY2lsOm51bWJlciA9IDAsIG1hc2s6bnVtYmVyID0gQ29udGV4dEdMQ2xlYXJNYXNrLkFMTClcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgY29uZmlndXJlQmFja0J1ZmZlcih3aWR0aDpudW1iZXIsIGhlaWdodDpudW1iZXIsIGFudGlBbGlhczpudW1iZXIsIGVuYWJsZURlcHRoQW5kU3RlbmNpbDpib29sZWFuID0gdHJ1ZSlcblx0e1xuXHRcdHRoaXMuX3dpZHRoID0gd2lkdGg7XG5cdFx0dGhpcy5faGVpZ2h0ID0gaGVpZ2h0O1xuXHR9XG5cblx0cHVibGljIGNyZWF0ZUluZGV4QnVmZmVyKG51bUluZGljZXM6bnVtYmVyKTpJSW5kZXhCdWZmZXJcblx0e1xuXHRcdHRocm93IG5ldyBBYnN0cmFjdE1ldGhvZEVycm9yKCk7XG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlVmVydGV4QnVmZmVyKG51bVZlcnRpY2VzOm51bWJlciwgZGF0YTMyUGVyVmVydGV4Om51bWJlcik6SVZlcnRleEJ1ZmZlclxuXHR7XG5cdFx0dGhyb3cgbmV3IEFic3RyYWN0TWV0aG9kRXJyb3IoKTtcblx0fVxuXG5cdHB1YmxpYyBjcmVhdGVUZXh0dXJlKHdpZHRoOm51bWJlciwgaGVpZ2h0Om51bWJlciwgZm9ybWF0OnN0cmluZywgb3B0aW1pemVGb3JSZW5kZXJUb1RleHR1cmU6Ym9vbGVhbiwgc3RyZWFtaW5nTGV2ZWxzOm51bWJlciA9IDApOklUZXh0dXJlXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0cHVibGljIGNyZWF0ZUN1YmVUZXh0dXJlKHNpemU6bnVtYmVyLCBmb3JtYXQ6c3RyaW5nLCBvcHRpbWl6ZUZvclJlbmRlclRvVGV4dHVyZTpib29sZWFuLCBzdHJlYW1pbmdMZXZlbHM6bnVtYmVyID0gMCk6SUN1YmVUZXh0dXJlXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0cHVibGljIGNyZWF0ZVByb2dyYW0oKTpJUHJvZ3JhbVxuXHR7XG5cdFx0dGhyb3cgbmV3IEFic3RyYWN0TWV0aG9kRXJyb3IoKTtcblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlKClcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgcHJlc2VudCgpXG5cdHtcblxuXHR9XG5cblx0cHVibGljIHNldFJlbmRlclRvVGV4dHVyZSh0YXJnZXQ6SVRleHR1cmVCYXNlLCBlbmFibGVEZXB0aEFuZFN0ZW5jaWw6Ym9vbGVhbiA9IGZhbHNlLCBhbnRpQWxpYXM6bnVtYmVyID0gMCwgc3VyZmFjZVNlbGVjdG9yOm51bWJlciA9IDApXG5cdHtcblxuXHR9XG5cblx0cHVibGljIHNldFJlbmRlclRvQmFja0J1ZmZlcigpXG5cdHtcblxuXHR9XG5cblx0cHVibGljIHNldFNjaXNzb3JSZWN0YW5nbGUocmVjdGFuZ2xlOlJlY3RhbmdsZSlcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgc2V0VGV4dHVyZUF0KHNhbXBsZXI6bnVtYmVyLCB0ZXh0dXJlOklUZXh0dXJlQmFzZSlcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgc2V0VmVydGV4QnVmZmVyQXQoaW5kZXg6bnVtYmVyLCBidWZmZXI6SVZlcnRleEJ1ZmZlciwgYnVmZmVyT2Zmc2V0Om51bWJlciA9IDAsIGZvcm1hdDpzdHJpbmcgPSBudWxsKVxuXHR7XG5cblx0fVxuXG5cdHB1YmxpYyBzZXRQcm9ncmFtKHByb2dyYW06SVByb2dyYW0pXG5cdHtcblxuXHR9XG5cblx0cHVibGljIHJlZ2lzdGVyUHJvZ3JhbShwcm9ncmFtRGF0YTpQcm9ncmFtRGF0YSlcblx0e1xuXHRcdHZhciBpOm51bWJlciA9IDA7XG5cdFx0d2hpbGUgKHRoaXMuX3Byb2dyYW1EYXRhW2ldICE9IG51bGwpXG5cdFx0XHRpKys7XG5cblx0XHR0aGlzLl9wcm9ncmFtRGF0YVtpXSA9IHByb2dyYW1EYXRhO1xuXHRcdHByb2dyYW1EYXRhLmlkID0gaTtcblx0fVxuXG5cdHB1YmxpYyB1blJlZ2lzdGVyUHJvZ3JhbShwcm9ncmFtRGF0YTpQcm9ncmFtRGF0YSlcblx0e1xuXHRcdHRoaXMuX3Byb2dyYW1EYXRhW3Byb2dyYW1EYXRhLmlkXSA9IG51bGw7XG5cdFx0cHJvZ3JhbURhdGEuaWQgPSAtMTtcblx0fVxuXG5cblx0LyoqXG5cdCAqIHRlc3QgaWYgYW5pbWF0aW9uIHdpbGwgYmUgYWJsZSB0byBydW4gb24gZ3B1IEJFRk9SRSBjb21waWxpbmcgbWF0ZXJpYWxzXG5cdCAqIHRlc3QgaWYgdGhlIHNoYWRlciBvYmplY3RzIHN1cHBvcnRzIGFuaW1hdGluZyB0aGUgYW5pbWF0aW9uIHNldCBpbiB0aGUgdmVydGV4IHNoYWRlclxuXHQgKiBpZiBhbnkgb2JqZWN0IHVzaW5nIHRoaXMgbWF0ZXJpYWwgZmFpbHMgdG8gc3VwcG9ydCBhY2NlbGVyYXRlZCBhbmltYXRpb25zIGZvciBhbnkgb2YgdGhlIHNoYWRlciBvYmplY3RzLFxuXHQgKiB3ZSBzaG91bGQgZG8gZXZlcnl0aGluZyBvbiBjcHUgKG90aGVyd2lzZSB3ZSBoYXZlIHRoZSBjb3N0IG9mIGJvdGggZ3B1ICsgY3B1IGFuaW1hdGlvbnMpXG5cdCAqL1xuXHRwcml2YXRlIGdldEVuYWJsZWRHUFVBbmltYXRpb24obWF0ZXJpYWw6U3RhZ2VHTE1hdGVyaWFsQmFzZSwgbWF0ZXJpYWxEYXRhUGFzc2VzOkFycmF5PE1hdGVyaWFsUGFzc0RhdGE+KTpib29sZWFuXG5cdHtcblx0XHRpZiAobWF0ZXJpYWwuYW5pbWF0aW9uU2V0KSB7XG5cdFx0XHRtYXRlcmlhbC5hbmltYXRpb25TZXQucmVzZXRHUFVDb21wYXRpYmlsaXR5KCk7XG5cblx0XHRcdHZhciBvd25lcnM6QXJyYXk8SU1hdGVyaWFsT3duZXI+ID0gbWF0ZXJpYWwuaU93bmVycztcblx0XHRcdHZhciBudW1Pd25lcnM6bnVtYmVyID0gb3duZXJzLmxlbmd0aDtcblxuXHRcdFx0dmFyIGxlbjpudW1iZXIgPSBtYXRlcmlhbERhdGFQYXNzZXMubGVuZ3RoO1xuXHRcdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgbGVuOyBpKyspXG5cdFx0XHRcdGZvciAodmFyIGo6bnVtYmVyID0gMDsgaiA8IG51bU93bmVyczsgaisrKVxuXHRcdFx0XHRcdGlmIChvd25lcnNbal0uYW5pbWF0b3IpXG5cdFx0XHRcdFx0XHQoPEFuaW1hdG9yQmFzZT4gb3duZXJzW2pdLmFuaW1hdG9yKS50ZXN0R1BVQ29tcGF0aWJpbGl0eShtYXRlcmlhbERhdGFQYXNzZXNbaV0uc2hhZGVyT2JqZWN0KTtcblxuXHRcdFx0cmV0dXJuICFtYXRlcmlhbC5hbmltYXRpb25TZXQudXNlc0NQVTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRwdWJsaWMgY2FsY0FuaW1hdGlvbkNvZGUobWF0ZXJpYWw6U3RhZ2VHTE1hdGVyaWFsQmFzZSwgbWF0ZXJpYWxQYXNzRGF0YTpNYXRlcmlhbFBhc3NEYXRhKVxuXHR7XG5cdFx0Ly9yZXNldCBrZXkgc28gdGhhdCB0aGUgcHJvZ3JhbSBpcyByZS1jYWxjdWxhdGVkXG5cdFx0bWF0ZXJpYWxQYXNzRGF0YS5rZXkgPSBcIlwiO1xuXHRcdG1hdGVyaWFsUGFzc0RhdGEuYW5pbWF0aW9uVmVydGV4Q29kZSA9IFwiXCI7XG5cdFx0bWF0ZXJpYWxQYXNzRGF0YS5hbmltYXRpb25GcmFnbWVudENvZGUgPSBcIlwiO1xuXG5cdFx0dmFyIHNoYWRlck9iamVjdDpTaGFkZXJPYmplY3RCYXNlID0gbWF0ZXJpYWxQYXNzRGF0YS5zaGFkZXJPYmplY3Q7XG5cblx0XHQvL2NoZWNrIHRvIHNlZSBpZiBHUFUgYW5pbWF0aW9uIGlzIHVzZWRcblx0XHRpZiAobWF0ZXJpYWxQYXNzRGF0YS51c2VzQW5pbWF0aW9uKSB7XG5cblx0XHRcdHZhciBhbmltYXRpb25TZXQ6QW5pbWF0aW9uU2V0QmFzZSA9IDxBbmltYXRpb25TZXRCYXNlPiBtYXRlcmlhbC5hbmltYXRpb25TZXQ7XG5cblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEuYW5pbWF0aW9uVmVydGV4Q29kZSArPSBhbmltYXRpb25TZXQuZ2V0QUdBTFZlcnRleENvZGUoc2hhZGVyT2JqZWN0KTtcblxuXHRcdFx0aWYgKHNoYWRlck9iamVjdC51dkRlcGVuZGVuY2llcyA+IDAgJiYgIXNoYWRlck9iamVjdC51c2VzVVZUcmFuc2Zvcm0pXG5cdFx0XHRcdG1hdGVyaWFsUGFzc0RhdGEuYW5pbWF0aW9uVmVydGV4Q29kZSArPSBhbmltYXRpb25TZXQuZ2V0QUdBTFVWQ29kZShzaGFkZXJPYmplY3QpO1xuXG5cdFx0XHRpZiAoc2hhZGVyT2JqZWN0LnVzZXNGcmFnbWVudEFuaW1hdGlvbilcblx0XHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5hbmltYXRpb25GcmFnbWVudENvZGUgKz0gYW5pbWF0aW9uU2V0LmdldEFHQUxGcmFnbWVudENvZGUoc2hhZGVyT2JqZWN0LCBtYXRlcmlhbFBhc3NEYXRhLnNoYWRlZFRhcmdldCk7XG5cblx0XHRcdGFuaW1hdGlvblNldC5kb25lQUdBTENvZGUoc2hhZGVyT2JqZWN0KTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBzaW1wbHkgd3JpdGUgYXR0cmlidXRlcyB0byB0YXJnZXRzLCBkbyBub3QgYW5pbWF0ZSB0aGVtXG5cdFx0XHQvLyBwcm9qZWN0aW9uIHdpbGwgcGljayB1cCBvbiB0YXJnZXRzWzBdIHRvIGRvIHRoZSBwcm9qZWN0aW9uXG5cdFx0XHR2YXIgbGVuOm51bWJlciA9IHNoYWRlck9iamVjdC5hbmltYXRhYmxlQXR0cmlidXRlcy5sZW5ndGg7XG5cdFx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCBsZW47ICsraSlcblx0XHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5hbmltYXRpb25WZXJ0ZXhDb2RlICs9IFwibW92IFwiICsgc2hhZGVyT2JqZWN0LmFuaW1hdGlvblRhcmdldFJlZ2lzdGVyc1tpXSArIFwiLCBcIiArIHNoYWRlck9iamVjdC5hbmltYXRhYmxlQXR0cmlidXRlc1tpXSArIFwiXFxuXCI7XG5cblx0XHRcdGlmIChzaGFkZXJPYmplY3QudXZEZXBlbmRlbmNpZXMgPiAwICYmICFzaGFkZXJPYmplY3QudXNlc1VWVHJhbnNmb3JtKVxuXHRcdFx0XHRtYXRlcmlhbFBhc3NEYXRhLmFuaW1hdGlvblZlcnRleENvZGUgKz0gXCJtb3YgXCIgKyBzaGFkZXJPYmplY3QudXZUYXJnZXQgKyBcIixcIiArIHNoYWRlck9iamVjdC51dlNvdXJjZSArIFwiXFxuXCI7XG5cdFx0fVxuXHR9XG59XG5cbmV4cG9ydCA9IENvbnRleHRHTEJhc2U7Il19