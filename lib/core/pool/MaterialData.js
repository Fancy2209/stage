var MaterialPassDataPool = require("awayjs-stagegl/lib/core/pool/MaterialPassDataPool");
/**
 *
 * @class away.pool.MaterialData
 */
var MaterialData = (function () {
    function MaterialData(pool, context, material) {
        this.invalidAnimation = true;
        this._pool = pool;
        this.context = context;
        this.material = material;
        this._materialPassDataPool = new MaterialPassDataPool(material);
    }
    MaterialData.prototype.getMaterialPass = function (materialPass, profile) {
        var materialPassData = this._materialPassDataPool.getItem(materialPass);
        if (!materialPassData.shaderObject) {
            materialPassData.shaderObject = materialPass.createShaderObject(profile);
            materialPassData.invalid = true;
        }
        if (materialPassData.invalid) {
            materialPassData.invalid = false;
            var compiler = materialPassData.shaderObject.createCompiler(this.material, materialPass);
            compiler.compile();
            materialPassData.shadedTarget = compiler.shadedTarget;
            materialPassData.vertexCode = compiler.vertexCode;
            materialPassData.fragmentCode = compiler.fragmentCode;
            materialPassData.postAnimationFragmentCode = compiler.postAnimationFragmentCode;
            materialPassData.key = "";
        }
        return materialPassData;
    };
    MaterialData.prototype.getMaterialPasses = function (profile) {
        if (this._passes == null) {
            var passes = this.material._iScreenPasses;
            var numPasses = passes.length;
            //reset the material passes in MaterialData
            this._passes = new Array(numPasses);
            for (var i = 0; i < numPasses; i++)
                this._passes[i] = this.getMaterialPass(passes[i], profile);
        }
        return this._passes;
    };
    /**
     *
     */
    MaterialData.prototype.dispose = function () {
        this._materialPassDataPool.disposePool();
        this._materialPassDataPool = null;
        this._pool.disposeItem(this.material);
        this._passes = null;
    };
    /**
     *
     */
    MaterialData.prototype.invalidateMaterial = function () {
        this._passes = null;
        this.invalidateAnimation();
    };
    /**
     *
     */
    MaterialData.prototype.invalidateAnimation = function () {
        this.invalidAnimation = true;
    };
    return MaterialData;
})();
module.exports = MaterialData;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvcmUvcG9vbC9tYXRlcmlhbGRhdGEudHMiXSwibmFtZXMiOlsiTWF0ZXJpYWxEYXRhIiwiTWF0ZXJpYWxEYXRhLmNvbnN0cnVjdG9yIiwiTWF0ZXJpYWxEYXRhLmdldE1hdGVyaWFsUGFzcyIsIk1hdGVyaWFsRGF0YS5nZXRNYXRlcmlhbFBhc3NlcyIsIk1hdGVyaWFsRGF0YS5kaXNwb3NlIiwiTWF0ZXJpYWxEYXRhLmludmFsaWRhdGVNYXRlcmlhbCIsIk1hdGVyaWFsRGF0YS5pbnZhbGlkYXRlQW5pbWF0aW9uIl0sIm1hcHBpbmdzIjoiQUFJQSxJQUFPLG9CQUFvQixXQUFhLG1EQUFtRCxDQUFDLENBQUM7QUFPN0YsQUFJQTs7O0dBREc7SUFDRyxZQUFZO0lBZ0JqQkEsU0FoQktBLFlBQVlBLENBZ0JMQSxJQUFxQkEsRUFBRUEsT0FBcUJBLEVBQUVBLFFBQTRCQTtRQUYvRUMscUJBQWdCQSxHQUFXQSxJQUFJQSxDQUFDQTtRQUl0Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFDbEJBLElBQUlBLENBQUNBLE9BQU9BLEdBQUdBLE9BQU9BLENBQUNBO1FBQ3ZCQSxJQUFJQSxDQUFDQSxRQUFRQSxHQUFHQSxRQUFRQSxDQUFDQTtRQUV6QkEsSUFBSUEsQ0FBQ0EscUJBQXFCQSxHQUFHQSxJQUFJQSxvQkFBb0JBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBO0lBQ2pFQSxDQUFDQTtJQUVNRCxzQ0FBZUEsR0FBdEJBLFVBQXVCQSxZQUE2QkEsRUFBRUEsT0FBY0E7UUFFbkVFLElBQUlBLGdCQUFnQkEsR0FBb0JBLElBQUlBLENBQUNBLHFCQUFxQkEsQ0FBQ0EsT0FBT0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0E7UUFFekZBLEVBQUVBLENBQUNBLENBQUNBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDcENBLGdCQUFnQkEsQ0FBQ0EsWUFBWUEsR0FBR0EsWUFBWUEsQ0FBQ0Esa0JBQWtCQSxD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ImZpbGUiOiJjb3JlL3Bvb2wvTWF0ZXJpYWxEYXRhLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9yb2JiYXRlbWFuL1dlYnN0b3JtUHJvamVjdHMvYXdheWpzLXN0YWdlZ2wvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IElNYXRlcmlhbERhdGFcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9jb3JlL3Bvb2wvSU1hdGVyaWFsRGF0YVwiKTtcblxuaW1wb3J0IE1hdGVyaWFsRGF0YVBvb2xcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3Bvb2wvTWF0ZXJpYWxEYXRhUG9vbFwiKTtcbmltcG9ydCBNYXRlcmlhbFBhc3NEYXRhXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9wb29sL01hdGVyaWFsUGFzc0RhdGFcIik7XG5pbXBvcnQgTWF0ZXJpYWxQYXNzRGF0YVBvb2xcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvY29yZS9wb29sL01hdGVyaWFsUGFzc0RhdGFQb29sXCIpO1xuaW1wb3J0IENvbnRleHRHTEJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvQ29udGV4dEdMQmFzZVwiKTtcbmltcG9ydCBTdGFnZUdMTWF0ZXJpYWxCYXNlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL21hdGVyaWFscy9TdGFnZUdMTWF0ZXJpYWxCYXNlXCIpO1xuaW1wb3J0IE1hdGVyaWFsUGFzc0Jhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9tYXRlcmlhbHMvcGFzc2VzL01hdGVyaWFsUGFzc0Jhc2VcIik7XG5pbXBvcnQgU2hhZGVyQ29tcGlsZXJCYXNlXHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL21hdGVyaWFscy9jb21waWxhdGlvbi9TaGFkZXJDb21waWxlckJhc2VcIik7XG5pbXBvcnQgU2hhZGVyT2JqZWN0QmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL21hdGVyaWFscy9jb21waWxhdGlvbi9TaGFkZXJPYmplY3RCYXNlXCIpO1xuXG4vKipcbiAqXG4gKiBAY2xhc3MgYXdheS5wb29sLk1hdGVyaWFsRGF0YVxuICovXG5jbGFzcyBNYXRlcmlhbERhdGEgaW1wbGVtZW50cyBJTWF0ZXJpYWxEYXRhXG57XG5cdHByaXZhdGUgX3Bvb2w6TWF0ZXJpYWxEYXRhUG9vbDtcblxuXHRwcml2YXRlIF9tYXRlcmlhbFBhc3NEYXRhUG9vbDpNYXRlcmlhbFBhc3NEYXRhUG9vbDtcblxuXHRwcml2YXRlIF9wYXNzZXM6QXJyYXk8TWF0ZXJpYWxQYXNzRGF0YT47XG5cblx0cHVibGljIGNvbnRleHQ6Q29udGV4dEdMQmFzZTtcblxuXHRwdWJsaWMgbWF0ZXJpYWw6U3RhZ2VHTE1hdGVyaWFsQmFzZTtcblxuXHRwdWJsaWMgcmVuZGVyT3JkZXJJZDpudW1iZXI7XG5cblx0cHVibGljIGludmFsaWRBbmltYXRpb246Ym9vbGVhbiA9IHRydWU7XG5cblx0Y29uc3RydWN0b3IocG9vbDpNYXRlcmlhbERhdGFQb29sLCBjb250ZXh0OkNvbnRleHRHTEJhc2UsIG1hdGVyaWFsOlN0YWdlR0xNYXRlcmlhbEJhc2UpXG5cdHtcblx0XHR0aGlzLl9wb29sID0gcG9vbDtcblx0XHR0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuXHRcdHRoaXMubWF0ZXJpYWwgPSBtYXRlcmlhbDtcblxuXHRcdHRoaXMuX21hdGVyaWFsUGFzc0RhdGFQb29sID0gbmV3IE1hdGVyaWFsUGFzc0RhdGFQb29sKG1hdGVyaWFsKTtcblx0fVxuXG5cdHB1YmxpYyBnZXRNYXRlcmlhbFBhc3MobWF0ZXJpYWxQYXNzOk1hdGVyaWFsUGFzc0Jhc2UsIHByb2ZpbGU6c3RyaW5nKTpNYXRlcmlhbFBhc3NEYXRhXG5cdHtcblx0XHR2YXIgbWF0ZXJpYWxQYXNzRGF0YTpNYXRlcmlhbFBhc3NEYXRhID0gdGhpcy5fbWF0ZXJpYWxQYXNzRGF0YVBvb2wuZ2V0SXRlbShtYXRlcmlhbFBhc3MpO1xuXG5cdFx0aWYgKCFtYXRlcmlhbFBhc3NEYXRhLnNoYWRlck9iamVjdCkge1xuXHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5zaGFkZXJPYmplY3QgPSBtYXRlcmlhbFBhc3MuY3JlYXRlU2hhZGVyT2JqZWN0KHByb2ZpbGUpO1xuXHRcdFx0bWF0ZXJpYWxQYXNzRGF0YS5pbnZhbGlkID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZiAobWF0ZXJpYWxQYXNzRGF0YS5pbnZhbGlkKSB7XG5cdFx0XHRtYXRlcmlhbFBhc3NEYXRhLmludmFsaWQgPSBmYWxzZTtcblx0XHRcdHZhciBjb21waWxlcjpTaGFkZXJDb21waWxlckJhc2UgPSBtYXRlcmlhbFBhc3NEYXRhLnNoYWRlck9iamVjdC5jcmVhdGVDb21waWxlcih0aGlzLm1hdGVyaWFsLCBtYXRlcmlhbFBhc3MpO1xuXHRcdFx0Y29tcGlsZXIuY29tcGlsZSgpO1xuXG5cdFx0XHRtYXRlcmlhbFBhc3NEYXRhLnNoYWRlZFRhcmdldCA9IGNvbXBpbGVyLnNoYWRlZFRhcmdldDtcblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEudmVydGV4Q29kZSA9IGNvbXBpbGVyLnZlcnRleENvZGU7XG5cdFx0XHRtYXRlcmlhbFBhc3NEYXRhLmZyYWdtZW50Q29kZSA9IGNvbXBpbGVyLmZyYWdtZW50Q29kZTtcblx0XHRcdG1hdGVyaWFsUGFzc0RhdGEucG9zdEFuaW1hdGlvbkZyYWdtZW50Q29kZSA9IGNvbXBpbGVyLnBvc3RBbmltYXRpb25GcmFnbWVudENvZGU7XG5cdFx0XHRtYXRlcmlhbFBhc3NEYXRhLmtleSA9IFwiXCI7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG1hdGVyaWFsUGFzc0RhdGE7XG5cdH1cblxuXHRwdWJsaWMgZ2V0TWF0ZXJpYWxQYXNzZXMocHJvZmlsZTpzdHJpbmcpOkFycmF5PE1hdGVyaWFsUGFzc0RhdGE+XG5cdHtcblx0XHRpZiAodGhpcy5fcGFzc2VzID09IG51bGwpIHtcblx0XHRcdHZhciBwYXNzZXM6QXJyYXk8TWF0ZXJpYWxQYXNzQmFzZT4gPSA8QXJyYXk8TWF0ZXJpYWxQYXNzQmFzZT4+IHRoaXMubWF0ZXJpYWwuX2lTY3JlZW5QYXNzZXM7XG5cdFx0XHR2YXIgbnVtUGFzc2VzOm51bWJlciA9IHBhc3Nlcy5sZW5ndGg7XG5cblx0XHRcdC8vcmVzZXQgdGhlIG1hdGVyaWFsIHBhc3NlcyBpbiBNYXRlcmlhbERhdGFcblx0XHRcdHRoaXMuX3Bhc3NlcyA9IG5ldyBBcnJheTxNYXRlcmlhbFBhc3NEYXRhPihudW1QYXNzZXMpO1xuXG5cdFx0XHQvL2dldCB0aGUgc2hhZGVyIG9iamVjdCBmb3IgZWFjaCBzY3JlZW4gcGFzcyBhbmQgc3RvcmVcblx0XHRcdGZvciAodmFyIGk6bnVtYmVyID0gMDsgaSA8IG51bVBhc3NlczsgaSsrKVxuXHRcdFx0XHR0aGlzLl9wYXNzZXNbaV0gPSB0aGlzLmdldE1hdGVyaWFsUGFzcyhwYXNzZXNbaV0sIHByb2ZpbGUpO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzLl9wYXNzZXM7XG5cdH1cblxuXHQvKipcblx0ICpcblx0ICovXG5cdHB1YmxpYyBkaXNwb3NlKClcblx0e1xuXHRcdHRoaXMuX21hdGVyaWFsUGFzc0RhdGFQb29sLmRpc3Bvc2VQb29sKCk7XG5cblx0XHR0aGlzLl9tYXRlcmlhbFBhc3NEYXRhUG9vbCA9IG51bGw7XG5cblx0XHR0aGlzLl9wb29sLmRpc3Bvc2VJdGVtKHRoaXMubWF0ZXJpYWwpO1xuXG5cdFx0dGhpcy5fcGFzc2VzID0gbnVsbDtcblx0fVxuXG5cdC8qKlxuXHQgKlxuXHQgKi9cblx0cHVibGljIGludmFsaWRhdGVNYXRlcmlhbCgpXG5cdHtcblx0XHR0aGlzLl9wYXNzZXMgPSBudWxsO1xuXG5cdFx0dGhpcy5pbnZhbGlkYXRlQW5pbWF0aW9uKCk7XG5cdH1cblxuXHQvKipcblx0ICpcblx0ICovXG5cdHB1YmxpYyBpbnZhbGlkYXRlQW5pbWF0aW9uKClcblx0e1xuXHRcdHRoaXMuaW52YWxpZEFuaW1hdGlvbiA9IHRydWU7XG5cdH1cbn1cblxuZXhwb3J0ID0gTWF0ZXJpYWxEYXRhOyJdfQ==