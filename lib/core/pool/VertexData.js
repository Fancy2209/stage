var SubGeometryBase = require("awayjs-core/lib/core/base/SubGeometryBase");
var SubGeometryEvent = require("awayjs-core/lib/events/SubGeometryEvent");
/**
 *
 */
var VertexData = (function () {
    function VertexData(subGeometry, dataType) {
        var _this = this;
        this._dataDirty = true;
        this.invalid = new Array(8);
        this.buffers = new Array(8);
        this.contexts = new Array(8);
        this._subGeometry = subGeometry;
        this._dataType = dataType;
        this._onVerticesUpdatedDelegate = function (event) { return _this._onVerticesUpdated(event); };
        this._subGeometry.addEventListener(SubGeometryEvent.VERTICES_UPDATED, this._onVerticesUpdatedDelegate);
    }
    VertexData.prototype.updateData = function (originalIndices, indexMappings) {
        if (originalIndices === void 0) { originalIndices = null; }
        if (indexMappings === void 0) { indexMappings = null; }
        if (this._dataDirty) {
            this._dataDirty = false;
            this.dataPerVertex = this._subGeometry.getStride(this._dataType);
            var vertices = this._subGeometry[this._dataType];
            if (indexMappings == null) {
                this.setData(vertices);
            }
            else {
                var splitVerts = new Array(originalIndices.length * this.dataPerVertex);
                var originalIndex;
                var splitIndex;
                var i = 0;
                var j = 0;
                while (i < originalIndices.length) {
                    originalIndex = originalIndices[i];
                    splitIndex = indexMappings[originalIndex] * this.dataPerVertex;
                    originalIndex *= this.dataPerVertex;
                    for (j = 0; j < this.dataPerVertex; j++)
                        splitVerts[splitIndex + j] = vertices[originalIndex + j];
                    i++;
                }
                this.setData(splitVerts);
            }
        }
    };
    VertexData.prototype.dispose = function () {
        for (var i = 0; i < 8; ++i) {
            if (this.contexts[i]) {
                this.contexts[i].disposeVertexData(this);
                this.contexts[i] = null;
            }
        }
    };
    /**
     * @private
     */
    VertexData.prototype.disposeBuffers = function () {
        for (var i = 0; i < 8; ++i) {
            if (this.buffers[i]) {
                this.buffers[i].dispose();
                this.buffers[i] = null;
            }
        }
    };
    /**
     * @private
     */
    VertexData.prototype.invalidateBuffers = function () {
        for (var i = 0; i < 8; ++i)
            this.invalid[i] = true;
    };
    /**
     *
     * @param data
     * @param dataPerVertex
     * @private
     */
    VertexData.prototype.setData = function (data) {
        if (this.data && this.data.length != data.length)
            this.disposeBuffers();
        else
            this.invalidateBuffers();
        this.data = data;
    };
    /**
     * //TODO
     *
     * @param event
     * @private
     */
    VertexData.prototype._onVerticesUpdated = function (event) {
        var dataType = this._subGeometry.concatenateArrays ? SubGeometryBase.VERTEX_DATA : event.dataType;
        if (dataType == this._dataType)
            this._dataDirty = true;
    };
    return VertexData;
})();
module.exports = VertexData;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvcmUvcG9vbC92ZXJ0ZXhkYXRhLnRzIl0sIm5hbWVzIjpbIlZlcnRleERhdGEiLCJWZXJ0ZXhEYXRhLmNvbnN0cnVjdG9yIiwiVmVydGV4RGF0YS51cGRhdGVEYXRhIiwiVmVydGV4RGF0YS5kaXNwb3NlIiwiVmVydGV4RGF0YS5kaXNwb3NlQnVmZmVycyIsIlZlcnRleERhdGEuaW52YWxpZGF0ZUJ1ZmZlcnMiLCJWZXJ0ZXhEYXRhLnNldERhdGEiLCJWZXJ0ZXhEYXRhLl9vblZlcnRpY2VzVXBkYXRlZCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBTyxlQUFlLFdBQWMsMkNBQTJDLENBQUMsQ0FBQztBQUNqRixJQUFPLGdCQUFnQixXQUFjLHlDQUF5QyxDQUFDLENBQUM7QUFLaEYsQUFHQTs7R0FERztJQUNHLFVBQVU7SUFpQmZBLFNBakJLQSxVQUFVQSxDQWlCSEEsV0FBMkJBLEVBQUVBLFFBQWVBO1FBakJ6REMsaUJBeUhDQTtRQXBIUUEsZUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0E7UUFFbkJBLFlBQU9BLEdBQWtCQSxJQUFJQSxLQUFLQSxDQUFVQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUUvQ0EsWUFBT0EsR0FBd0JBLElBQUlBLEtBQUtBLENBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUUzREEsYUFBUUEsR0FBd0JBLElBQUlBLEtBQUtBLENBQWdCQSxDQUFDQSxDQUFDQSxDQUFDQTtRQVFsRUEsSUFBSUEsQ0FBQ0EsWUFBWUEsR0FBR0EsV0FBV0EsQ0FBQ0E7UUFDaENBLElBQUlBLENBQUNBLFNBQVNBLEdBQUdBLFFBQVFBLENBQUNBO1FBRTFCQSxJQUFJQSxDQUFDQSwwQkFBMEJBLEdBQUdBLFVBQUNBLEtBQXNCQSxJQUFLQSxPQUFBQSxLQUFJQSxDQUFDQSxrQkFBa0JBLENBQUNBLEtBQUtBLENBQUNBLEVBQTlCQSxDQUE4QkEsQ0FBQ0E7UUFDN0ZBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsZ0JBQWdCQSxDQUFDQSxnQkFB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LFFBQVFBLEdBQVVBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLGlCQUFpQkEsR0FBRUEsZUFBZUEsQ0FBQ0EsV0FBV0EsR0FBR0EsS0FBS0EsQ0FBQ0EsUUFBUUEsQ0FBQ0E7UUFFeEdBLEVBQUVBLENBQUNBLENBQUNBLFFBQVFBLElBQUlBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBO1lBQzlCQSxJQUFJQSxDQUFDQSxVQUFVQSxHQUFHQSxJQUFJQSxDQUFDQTtJQUN6QkEsQ0FBQ0E7SUFDRlAsaUJBQUNBO0FBQURBLENBekhBLEFBeUhDQSxJQUFBO0FBRUQsQUFBb0IsaUJBQVgsVUFBVSxDQUFDIiwiZmlsZSI6ImNvcmUvcG9vbC9WZXJ0ZXhEYXRhLmpzIiwic291cmNlUm9vdCI6Ii9Vc2Vycy9yb2JiYXRlbWFuL1dlYnN0b3JtUHJvamVjdHMvYXdheWpzLXN0YWdlZ2wvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFN1Ykdlb21ldHJ5QmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2NvcmUvYmFzZS9TdWJHZW9tZXRyeUJhc2VcIik7XG5pbXBvcnQgU3ViR2VvbWV0cnlFdmVudFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2V2ZW50cy9TdWJHZW9tZXRyeUV2ZW50XCIpO1xuXG5pbXBvcnQgQ29udGV4dEdMQmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2NvcmUvc3RhZ2VnbC9Db250ZXh0R0xCYXNlXCIpO1xuaW1wb3J0IElWZXJ0ZXhCdWZmZXJcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9jb3JlL3N0YWdlZ2wvSVZlcnRleEJ1ZmZlclwiKTtcblxuLyoqXG4gKlxuICovXG5jbGFzcyBWZXJ0ZXhEYXRhXG57XG5cdHByaXZhdGUgX29uVmVydGljZXNVcGRhdGVkRGVsZWdhdGU6KGV2ZW50OlN1Ykdlb21ldHJ5RXZlbnQpID0+IHZvaWQ7XG5cdHByaXZhdGUgX3N1Ykdlb21ldHJ5OlN1Ykdlb21ldHJ5QmFzZTtcblx0cHJpdmF0ZSBfZGF0YVR5cGU6c3RyaW5nO1xuXHRwcml2YXRlIF9kYXRhRGlydHkgPSB0cnVlO1xuXG5cdHB1YmxpYyBpbnZhbGlkOkFycmF5PGJvb2xlYW4+ID0gbmV3IEFycmF5PGJvb2xlYW4+KDgpO1xuXG5cdHB1YmxpYyBidWZmZXJzOkFycmF5PElWZXJ0ZXhCdWZmZXI+ID0gbmV3IEFycmF5PElWZXJ0ZXhCdWZmZXI+KDgpO1xuXG5cdHB1YmxpYyBjb250ZXh0czpBcnJheTxDb250ZXh0R0xCYXNlPiA9IG5ldyBBcnJheTxDb250ZXh0R0xCYXNlPig4KTtcblxuXHRwdWJsaWMgZGF0YTpBcnJheTxudW1iZXI+O1xuXG5cdHB1YmxpYyBkYXRhUGVyVmVydGV4Om51bWJlcjtcblxuXHRjb25zdHJ1Y3RvcihzdWJHZW9tZXRyeTpTdWJHZW9tZXRyeUJhc2UsIGRhdGFUeXBlOnN0cmluZylcblx0e1xuXHRcdHRoaXMuX3N1Ykdlb21ldHJ5ID0gc3ViR2VvbWV0cnk7XG5cdFx0dGhpcy5fZGF0YVR5cGUgPSBkYXRhVHlwZTtcblxuXHRcdHRoaXMuX29uVmVydGljZXNVcGRhdGVkRGVsZWdhdGUgPSAoZXZlbnQ6U3ViR2VvbWV0cnlFdmVudCkgPT4gdGhpcy5fb25WZXJ0aWNlc1VwZGF0ZWQoZXZlbnQpO1xuXHRcdHRoaXMuX3N1Ykdlb21ldHJ5LmFkZEV2ZW50TGlzdGVuZXIoU3ViR2VvbWV0cnlFdmVudC5WRVJUSUNFU19VUERBVEVELCB0aGlzLl9vblZlcnRpY2VzVXBkYXRlZERlbGVnYXRlKTtcblx0fVxuXG5cdHB1YmxpYyB1cGRhdGVEYXRhKG9yaWdpbmFsSW5kaWNlczpBcnJheTxudW1iZXI+ID0gbnVsbCwgaW5kZXhNYXBwaW5nczpBcnJheTxudW1iZXI+ID0gbnVsbClcblx0e1xuXHRcdGlmICh0aGlzLl9kYXRhRGlydHkpIHtcblx0XHRcdHRoaXMuX2RhdGFEaXJ0eSA9IGZhbHNlO1xuXG5cdFx0XHR0aGlzLmRhdGFQZXJWZXJ0ZXggPSB0aGlzLl9zdWJHZW9tZXRyeS5nZXRTdHJpZGUodGhpcy5fZGF0YVR5cGUpO1xuXG5cdFx0XHR2YXIgdmVydGljZXM6QXJyYXk8bnVtYmVyPiA9IHRoaXMuX3N1Ykdlb21ldHJ5W3RoaXMuX2RhdGFUeXBlXTtcblxuXHRcdFx0aWYgKGluZGV4TWFwcGluZ3MgPT0gbnVsbCkge1xuXHRcdFx0XHR0aGlzLnNldERhdGEodmVydGljZXMpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIHNwbGl0VmVydHM6QXJyYXk8bnVtYmVyPiA9IG5ldyBBcnJheTxudW1iZXI+KG9yaWdpbmFsSW5kaWNlcy5sZW5ndGgqdGhpcy5kYXRhUGVyVmVydGV4KTtcblx0XHRcdFx0dmFyIG9yaWdpbmFsSW5kZXg6bnVtYmVyO1xuXHRcdFx0XHR2YXIgc3BsaXRJbmRleDpudW1iZXI7XG5cdFx0XHRcdHZhciBpOm51bWJlciA9IDA7XG5cdFx0XHRcdHZhciBqOm51bWJlciA9IDA7XG5cdFx0XHRcdHdoaWxlKGkgPCBvcmlnaW5hbEluZGljZXMubGVuZ3RoKSB7XG5cdFx0XHRcdFx0b3JpZ2luYWxJbmRleCA9IG9yaWdpbmFsSW5kaWNlc1tpXTtcblxuXHRcdFx0XHRcdHNwbGl0SW5kZXggPSBpbmRleE1hcHBpbmdzW29yaWdpbmFsSW5kZXhdKnRoaXMuZGF0YVBlclZlcnRleDtcblx0XHRcdFx0XHRvcmlnaW5hbEluZGV4ICo9IHRoaXMuZGF0YVBlclZlcnRleDtcblxuXHRcdFx0XHRcdGZvciAoaiA9IDA7IGogPCB0aGlzLmRhdGFQZXJWZXJ0ZXg7IGorKylcblx0XHRcdFx0XHRcdHNwbGl0VmVydHNbc3BsaXRJbmRleCArIGpdID0gdmVydGljZXNbb3JpZ2luYWxJbmRleCArIGpdO1xuXG5cdFx0XHRcdFx0aSsrO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5zZXREYXRhKHNwbGl0VmVydHMpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlKClcblx0e1xuXHRcdGZvciAodmFyIGk6bnVtYmVyID0gMDsgaSA8IDg7ICsraSkge1xuXHRcdFx0aWYgKHRoaXMuY29udGV4dHNbaV0pIHtcblx0XHRcdFx0dGhpcy5jb250ZXh0c1tpXS5kaXNwb3NlVmVydGV4RGF0YSh0aGlzKTtcblx0XHRcdFx0dGhpcy5jb250ZXh0c1tpXSA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHRwcml2YXRlIGRpc3Bvc2VCdWZmZXJzKClcblx0e1xuXHRcdGZvciAodmFyIGk6bnVtYmVyID0gMDsgaSA8IDg7ICsraSkge1xuXHRcdFx0aWYgKHRoaXMuYnVmZmVyc1tpXSkge1xuXHRcdFx0XHR0aGlzLmJ1ZmZlcnNbaV0uZGlzcG9zZSgpO1xuXHRcdFx0XHR0aGlzLmJ1ZmZlcnNbaV0gPSBudWxsO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0cHJpdmF0ZSBpbnZhbGlkYXRlQnVmZmVycygpXG5cdHtcblx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCA4OyArK2kpXG5cdFx0XHR0aGlzLmludmFsaWRbaV0gPSB0cnVlO1xuXHR9XG5cblx0LyoqXG5cdCAqXG5cdCAqIEBwYXJhbSBkYXRhXG5cdCAqIEBwYXJhbSBkYXRhUGVyVmVydGV4XG5cdCAqIEBwcml2YXRlXG5cdCAqL1xuXHRwcml2YXRlIHNldERhdGEoZGF0YTpBcnJheTxudW1iZXI+KVxuXHR7XG5cdFx0aWYgKHRoaXMuZGF0YSAmJiB0aGlzLmRhdGEubGVuZ3RoICE9IGRhdGEubGVuZ3RoKVxuXHRcdFx0dGhpcy5kaXNwb3NlQnVmZmVycygpO1xuXHRcdGVsc2Vcblx0XHRcdHRoaXMuaW52YWxpZGF0ZUJ1ZmZlcnMoKTtcblxuXHRcdHRoaXMuZGF0YSA9IGRhdGE7XG5cdH1cblxuXHQvKipcblx0ICogLy9UT0RPXG5cdCAqXG5cdCAqIEBwYXJhbSBldmVudFxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0cHJpdmF0ZSBfb25WZXJ0aWNlc1VwZGF0ZWQoZXZlbnQ6U3ViR2VvbWV0cnlFdmVudClcblx0e1xuXHRcdHZhciBkYXRhVHlwZTpzdHJpbmcgPSB0aGlzLl9zdWJHZW9tZXRyeS5jb25jYXRlbmF0ZUFycmF5cz8gU3ViR2VvbWV0cnlCYXNlLlZFUlRFWF9EQVRBIDogZXZlbnQuZGF0YVR5cGU7XG5cblx0XHRpZiAoZGF0YVR5cGUgPT0gdGhpcy5fZGF0YVR5cGUpXG5cdFx0XHR0aGlzLl9kYXRhRGlydHkgPSB0cnVlO1xuXHR9XG59XG5cbmV4cG9ydCA9IFZlcnRleERhdGE7Il19