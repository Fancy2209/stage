var AbstractMethodError = require("awayjs-core/lib/errors/AbstractMethodError");
var RenderTexture = require("awayjs-core/lib/textures/RenderTexture");
var TextureDataPool = require("awayjs-stagegl/lib/pool/TextureDataPool");
var ProgramDataPool = require("awayjs-stagegl/lib/pool/ProgramDataPool");
var ContextGLClearMask = require("awayjs-stagegl/lib/base/ContextGLClearMask");
var ContextGLTextureFormat = require("awayjs-stagegl/lib/base/ContextGLTextureFormat");
/**
 * Stage provides a proxy class to handle the creation and attachment of the Context
 * (and in turn the back buffer) it uses. Stage should never be created directly,
 * but requested through StageManager.
 *
 * @see away.managers.StageManager
 *
 */
var ContextGLBase = (function () {
    function ContextGLBase(stageIndex) {
        this._programData = new Array();
        //private static _frameEventDriver:Shape = new Shape(); // TODO: add frame driver / request animation frame
        this._stageIndex = -1;
        this._antiAlias = 0;
        this._renderTarget = null;
        this._renderSurfaceSelector = 0;
        this._stageIndex = stageIndex;
        this._texturePool = new TextureDataPool(this);
        this._programDataPool = new ProgramDataPool(this);
    }
    Object.defineProperty(ContextGLBase.prototype, "container", {
        get: function () {
            return this._pContainer;
        },
        enumerable: true,
        configurable: true
    });
    ContextGLBase.prototype.getProgramData = function (key) {
        return this._programDataPool.getItem(key);
    };
    ContextGLBase.prototype.setRenderTarget = function (target, enableDepthAndStencil, surfaceSelector) {
        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = false; }
        if (surfaceSelector === void 0) { surfaceSelector = 0; }
        if (this._renderTarget === target && surfaceSelector == this._renderSurfaceSelector && this._enableDepthAndStencil == enableDepthAndStencil)
            return;
        this._renderTarget = target;
        this._renderSurfaceSelector = surfaceSelector;
        this._enableDepthAndStencil = enableDepthAndStencil;
        if (target instanceof RenderTexture) {
            this.setRenderToTexture(this.getRenderTexture(target), enableDepthAndStencil, this._antiAlias, surfaceSelector);
        }
        else {
            this.setRenderToBackBuffer();
            this.configureBackBuffer(this._width, this._height, this._antiAlias, this._enableDepthAndStencil);
        }
    };
    ContextGLBase.prototype.getRenderTexture = function (textureProxy) {
        var textureData = this._texturePool.getItem(textureProxy);
        if (!textureData.texture)
            textureData.texture = this.createTexture(textureProxy.width, textureProxy.height, ContextGLTextureFormat.BGRA, true);
        return textureData.texture;
    };
    /**
     * Assigns an attribute stream
     *
     * @param index The attribute stream index for the vertex shader
     * @param buffer
     * @param offset
     * @param stride
     * @param format
     */
    ContextGLBase.prototype.activateBuffer = function (index, buffer, offset, format) {
        if (!buffer.contexts[this._stageIndex])
            buffer.contexts[this._stageIndex] = this;
        if (!buffer.buffers[this._stageIndex]) {
            buffer.buffers[this._stageIndex] = this.createVertexBuffer(buffer.data.length / buffer.dataPerVertex, buffer.dataPerVertex);
            buffer.invalid[this._stageIndex] = true;
        }
        if (buffer.invalid[this._stageIndex]) {
            buffer.buffers[this._stageIndex].uploadFromArray(buffer.data, 0, buffer.data.length / buffer.dataPerVertex);
            buffer.invalid[this._stageIndex] = false;
        }
        this.setVertexBufferAt(index, buffer.buffers[this._stageIndex], offset, format);
    };
    ContextGLBase.prototype.disposeVertexData = function (buffer) {
        buffer.buffers[this._stageIndex].dispose();
        buffer.buffers[this._stageIndex] = null;
    };
    ContextGLBase.prototype.activateRenderTexture = function (index, textureProxy) {
        this.setTextureAt(index, this.getRenderTexture(textureProxy));
    };
    ContextGLBase.prototype.activateTexture = function (index, textureProxy) {
        var textureData = this._texturePool.getItem(textureProxy);
        if (!textureData.texture) {
            textureData.texture = this.createTexture(textureProxy.width, textureProxy.height, ContextGLTextureFormat.BGRA, true);
            textureData.invalid = true;
        }
        if (textureData.invalid) {
            textureData.invalid = false;
            if (textureProxy.generateMipmaps) {
                var mipmapData = textureProxy._iGetMipmapData();
                var len = mipmapData.length;
                for (var i = 0; i < len; i++)
                    textureData.texture.uploadFromData(mipmapData[i], i);
            }
            else {
                textureData.texture.uploadFromData(textureProxy._iGetTextureData(), 0);
            }
        }
        this.setTextureAt(index, textureData.texture);
    };
    ContextGLBase.prototype.activateCubeTexture = function (index, textureProxy) {
        var textureData = this._texturePool.getItem(textureProxy);
        if (!textureData.texture) {
            textureData.texture = this.createCubeTexture(textureProxy.size, ContextGLTextureFormat.BGRA, false);
            textureData.invalid = true;
        }
        if (textureData.invalid) {
            textureData.invalid = false;
            for (var i = 0; i < 6; ++i) {
                if (textureProxy.generateMipmaps) {
                    var mipmapData = textureProxy._iGetMipmapData(i);
                    var len = mipmapData.length;
                    for (var j = 0; j < len; j++)
                        textureData.texture.uploadFromData(mipmapData[j], i, j);
                }
                else {
                    textureData.texture.uploadFromData(textureProxy._iGetTextureData(i), i, 0);
                }
            }
        }
        this.setTextureAt(index, textureData.texture);
    };
    /**
     * Retrieves the VertexBuffer object that contains triangle indices.
     * @param context The ContextWeb for which we request the buffer
     * @return The VertexBuffer object that contains triangle indices.
     */
    ContextGLBase.prototype.getIndexBuffer = function (buffer) {
        if (!buffer.contexts[this._stageIndex])
            buffer.contexts[this._stageIndex] = this;
        if (!buffer.buffers[this._stageIndex]) {
            buffer.buffers[this._stageIndex] = this.createIndexBuffer(buffer.data.length);
            buffer.invalid[this._stageIndex] = true;
        }
        if (buffer.invalid[this._stageIndex]) {
            buffer.buffers[this._stageIndex].uploadFromArray(buffer.data, 0, buffer.data.length);
            buffer.invalid[this._stageIndex] = false;
        }
        return buffer.buffers[this._stageIndex];
    };
    ContextGLBase.prototype.disposeIndexData = function (buffer) {
        buffer.buffers[this._stageIndex].dispose();
        buffer.buffers[this._stageIndex] = null;
    };
    ContextGLBase.prototype.clear = function (red, green, blue, alpha, depth, stencil, mask) {
        if (red === void 0) { red = 0; }
        if (green === void 0) { green = 0; }
        if (blue === void 0) { blue = 0; }
        if (alpha === void 0) { alpha = 1; }
        if (depth === void 0) { depth = 1; }
        if (stencil === void 0) { stencil = 0; }
        if (mask === void 0) { mask = ContextGLClearMask.ALL; }
    };
    ContextGLBase.prototype.configureBackBuffer = function (width, height, antiAlias, enableDepthAndStencil) {
        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = true; }
        this._width = width;
        this._height = height;
    };
    ContextGLBase.prototype.createIndexBuffer = function (numIndices) {
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createVertexBuffer = function (numVertices, data32PerVertex) {
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createTexture = function (width, height, format, optimizeForRenderToTexture, streamingLevels) {
        if (streamingLevels === void 0) { streamingLevels = 0; }
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createCubeTexture = function (size, format, optimizeForRenderToTexture, streamingLevels) {
        if (streamingLevels === void 0) { streamingLevels = 0; }
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.createProgram = function () {
        throw new AbstractMethodError();
    };
    ContextGLBase.prototype.dispose = function () {
    };
    ContextGLBase.prototype.present = function () {
    };
    ContextGLBase.prototype.setRenderToTexture = function (target, enableDepthAndStencil, antiAlias, surfaceSelector) {
        if (enableDepthAndStencil === void 0) { enableDepthAndStencil = false; }
        if (antiAlias === void 0) { antiAlias = 0; }
        if (surfaceSelector === void 0) { surfaceSelector = 0; }
    };
    ContextGLBase.prototype.setRenderToBackBuffer = function () {
    };
    ContextGLBase.prototype.setScissorRectangle = function (rectangle) {
    };
    ContextGLBase.prototype.setTextureAt = function (sampler, texture) {
    };
    ContextGLBase.prototype.setVertexBufferAt = function (index, buffer, bufferOffset, format) {
        if (bufferOffset === void 0) { bufferOffset = 0; }
        if (format === void 0) { format = null; }
    };
    ContextGLBase.prototype.setProgram = function (program) {
    };
    ContextGLBase.prototype.registerProgram = function (programData) {
        var i = 0;
        while (this._programData[i] != null)
            i++;
        this._programData[i] = programData;
        programData.id = i;
    };
    ContextGLBase.prototype.unRegisterProgram = function (programData) {
        this._programData[programData.id] = null;
        programData.id = -1;
    };
    return ContextGLBase;
})();
module.exports = ContextGLBase;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL2NvbnRleHRnbGJhc2UudHMiXSwibmFtZXMiOlsiQ29udGV4dEdMQmFzZSIsIkNvbnRleHRHTEJhc2UuY29uc3RydWN0b3IiLCJDb250ZXh0R0xCYXNlLmNvbnRhaW5lciIsIkNvbnRleHRHTEJhc2UuZ2V0UHJvZ3JhbURhdGEiLCJDb250ZXh0R0xCYXNlLnNldFJlbmRlclRhcmdldCIsIkNvbnRleHRHTEJhc2UuZ2V0UmVuZGVyVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuYWN0aXZhdGVCdWZmZXIiLCJDb250ZXh0R0xCYXNlLmRpc3Bvc2VWZXJ0ZXhEYXRhIiwiQ29udGV4dEdMQmFzZS5hY3RpdmF0ZVJlbmRlclRleHR1cmUiLCJDb250ZXh0R0xCYXNlLmFjdGl2YXRlVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuYWN0aXZhdGVDdWJlVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuZ2V0SW5kZXhCdWZmZXIiLCJDb250ZXh0R0xCYXNlLmRpc3Bvc2VJbmRleERhdGEiLCJDb250ZXh0R0xCYXNlLmNsZWFyIiwiQ29udGV4dEdMQmFzZS5jb25maWd1cmVCYWNrQnVmZmVyIiwiQ29udGV4dEdMQmFzZS5jcmVhdGVJbmRleEJ1ZmZlciIsIkNvbnRleHRHTEJhc2UuY3JlYXRlVmVydGV4QnVmZmVyIiwiQ29udGV4dEdMQmFzZS5jcmVhdGVUZXh0dXJlIiwiQ29udGV4dEdMQmFzZS5jcmVhdGVDdWJlVGV4dHVyZSIsIkNvbnRleHRHTEJhc2UuY3JlYXRlUHJvZ3JhbSIsIkNvbnRleHRHTEJhc2UuZGlzcG9zZSIsIkNvbnRleHRHTEJhc2UucHJlc2VudCIsIkNvbnRleHRHTEJhc2Uuc2V0UmVuZGVyVG9UZXh0dXJlIiwiQ29udGV4dEdMQmFzZS5zZXRSZW5kZXJUb0JhY2tCdWZmZXIiLCJDb250ZXh0R0xCYXNlLnNldFNjaXNzb3JSZWN0YW5nbGUiLCJDb250ZXh0R0xCYXNlLnNldFRleHR1cmVBdCIsIkNvbnRleHRHTEJhc2Uuc2V0VmVydGV4QnVmZmVyQXQiLCJDb250ZXh0R0xCYXNlLnNldFByb2dyYW0iLCJDb250ZXh0R0xCYXNlLnJlZ2lzdGVyUHJvZ3JhbSIsIkNvbnRleHRHTEJhc2UudW5SZWdpc3RlclByb2dyYW0iXSwibWFwcGluZ3MiOiJBQUdBLElBQU8sbUJBQW1CLFdBQWEsNENBQTRDLENBQUMsQ0FBQztBQUVyRixJQUFPLGFBQWEsV0FBYyx3Q0FBd0MsQ0FBQyxDQUFDO0FBWTVFLElBQU8sZUFBZSxXQUFjLHlDQUF5QyxDQUFDLENBQUM7QUFFL0UsSUFBTyxlQUFlLFdBQWMseUNBQXlDLENBQUMsQ0FBQztBQUUvRSxJQUFPLGtCQUFrQixXQUFhLDRDQUE0QyxDQUFDLENBQUM7QUFDcEYsSUFBTyxzQkFBc0IsV0FBWSxnREFBZ0QsQ0FBQyxDQUFDO0FBUTNGLEFBUUE7Ozs7Ozs7R0FERztJQUNHLGFBQWE7SUEwQmxCQSxTQTFCS0EsYUFBYUEsQ0EwQk5BLFVBQWlCQTtRQXhCckJDLGlCQUFZQSxHQUFzQkEsSUFBSUEsS0FBS0EsRUFBZUEsQ0FBQ0E7UUFXbkVBLDJHQUEyR0E7UUFFbkdBLGdCQUFXQSxHQUFVQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUN4QkEsZUFBVUEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFFdEJBLGtCQUFhQSxHQUFvQkEsSUFBSUEsQ0FBQ0E7UUFDdENBLDJCQUFzQkEsR0FBVUEsQ0FBQ0EsQ0FBQ0E7UUFTekNBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLFVBQVVBLENBQUNBO1FBQzlCQSxJQUFJQSxDQUFDQSxZQUFZQSxHQUFHQSxJQUFJQSxlQUFlQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtRQUM5Q0EsSUFBSUEsQ0FBQ0EsZ0JBQWdCQSxHQUFHQSxJQUFJQSxlQUFlQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQTtJQUNuREEsQ0FBQ0E7SUFWREQsc0JBQVdBLG9DQUFTQTthQUFwQkE7WUFFQ0UsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0E7UUFDekJBLENBQUNBOzs7T0FB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SUFBSUE7WUFDbENBLENBQUNBLEVBQUVBLENBQUNBO1FBRUxBLElBQUlBLENBQUNBLFlBQVlBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLFdBQVdBLENBQUNBO1FBQ25DQSxXQUFXQSxDQUFDQSxFQUFFQSxHQUFHQSxDQUFDQSxDQUFDQTtJQUNwQkEsQ0FBQ0E7SUFFTTVCLHlDQUFpQkEsR0FBeEJBLFVBQXlCQSxXQUF1QkE7UUFFL0M2QixJQUFJQSxDQUFDQSxZQUFZQSxDQUFDQSxXQUFXQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQTtRQUN6Q0EsV0FBV0EsQ0FBQ0EsRUFBRUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFDckJBLENBQUNBO0lBQ0Y3QixvQkFBQ0E7QUFBREEsQ0FoUkEsQUFnUkNBLElBQUE7QUFFRCxBQUF1QixpQkFBZCxhQUFhLENBQUMiLCJmaWxlIjoiYmFzZS9Db250ZXh0R0xCYXNlLmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCaXRtYXBEYXRhXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9iYXNlL0JpdG1hcERhdGFcIik7XG5pbXBvcnQgTWF0cml4M0RcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9NYXRyaXgzRFwiKTtcbmltcG9ydCBSZWN0YW5nbGVcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vUmVjdGFuZ2xlXCIpO1xuaW1wb3J0IEFic3RyYWN0TWV0aG9kRXJyb3JcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXJyb3JzL0Fic3RyYWN0TWV0aG9kRXJyb3JcIik7XG5pbXBvcnQgQ3ViZVRleHR1cmVCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvdGV4dHVyZXMvQ3ViZVRleHR1cmVCYXNlXCIpO1xuaW1wb3J0IFJlbmRlclRleHR1cmVcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi90ZXh0dXJlcy9SZW5kZXJUZXh0dXJlXCIpO1xuaW1wb3J0IFRleHR1cmUyREJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi90ZXh0dXJlcy9UZXh0dXJlMkRCYXNlXCIpO1xuaW1wb3J0IFRleHR1cmVQcm94eUJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi90ZXh0dXJlcy9UZXh0dXJlUHJveHlCYXNlXCIpO1xuaW1wb3J0IEJ5dGVBcnJheVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvdXRpbHMvQnl0ZUFycmF5XCIpO1xuXG5pbXBvcnQgSU1hdGVyaWFsT3duZXJcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0lNYXRlcmlhbE93bmVyXCIpO1xuaW1wb3J0IENhbWVyYVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9DYW1lcmFcIik7XG5pbXBvcnQgTWF0ZXJpYWxCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9tYXRlcmlhbHMvTWF0ZXJpYWxCYXNlXCIpO1xuXG5pbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9TdGFnZVwiKTtcbmltcG9ydCBJbmRleERhdGFcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL3Bvb2wvSW5kZXhEYXRhXCIpO1xuaW1wb3J0IFRleHR1cmVEYXRhXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9wb29sL1RleHR1cmVEYXRhXCIpO1xuaW1wb3J0IFRleHR1cmVEYXRhUG9vbFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL3Bvb2wvVGV4dHVyZURhdGFQb29sXCIpO1xuaW1wb3J0IFByb2dyYW1EYXRhXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9wb29sL1Byb2dyYW1EYXRhXCIpO1xuaW1wb3J0IFByb2dyYW1EYXRhUG9vbFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL3Bvb2wvUHJvZ3JhbURhdGFQb29sXCIpO1xuaW1wb3J0IFZlcnRleERhdGFcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL3Bvb2wvVmVydGV4RGF0YVwiKTtcbmltcG9ydCBDb250ZXh0R0xDbGVhck1hc2tcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9Db250ZXh0R0xDbGVhck1hc2tcIik7XG5pbXBvcnQgQ29udGV4dEdMVGV4dHVyZUZvcm1hdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9Db250ZXh0R0xUZXh0dXJlRm9ybWF0XCIpO1xuaW1wb3J0IElDdWJlVGV4dHVyZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9JQ3ViZVRleHR1cmVcIik7XG5pbXBvcnQgSUluZGV4QnVmZmVyXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0lJbmRleEJ1ZmZlclwiKTtcbmltcG9ydCBJUHJvZ3JhbVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0lQcm9ncmFtXCIpO1xuaW1wb3J0IElUZXh0dXJlXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvSVRleHR1cmVcIik7XG5pbXBvcnQgSVRleHR1cmVCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0lUZXh0dXJlQmFzZVwiKTtcbmltcG9ydCBJVmVydGV4QnVmZmVyXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtc3RhZ2VnbC9saWIvYmFzZS9JVmVydGV4QnVmZmVyXCIpO1xuXG4vKipcbiAqIFN0YWdlIHByb3ZpZGVzIGEgcHJveHkgY2xhc3MgdG8gaGFuZGxlIHRoZSBjcmVhdGlvbiBhbmQgYXR0YWNobWVudCBvZiB0aGUgQ29udGV4dFxuICogKGFuZCBpbiB0dXJuIHRoZSBiYWNrIGJ1ZmZlcikgaXQgdXNlcy4gU3RhZ2Ugc2hvdWxkIG5ldmVyIGJlIGNyZWF0ZWQgZGlyZWN0bHksXG4gKiBidXQgcmVxdWVzdGVkIHRocm91Z2ggU3RhZ2VNYW5hZ2VyLlxuICpcbiAqIEBzZWUgYXdheS5tYW5hZ2Vycy5TdGFnZU1hbmFnZXJcbiAqXG4gKi9cbmNsYXNzIENvbnRleHRHTEJhc2Vcbntcblx0cHJpdmF0ZSBfcHJvZ3JhbURhdGE6QXJyYXk8UHJvZ3JhbURhdGE+ID0gbmV3IEFycmF5PFByb2dyYW1EYXRhPigpO1xuXG5cdHB1YmxpYyBfcENvbnRhaW5lcjpIVE1MRWxlbWVudDtcblxuXHRwcml2YXRlIF90ZXh0dXJlUG9vbDpUZXh0dXJlRGF0YVBvb2w7XG5cblx0cHJpdmF0ZSBfcHJvZ3JhbURhdGFQb29sOlByb2dyYW1EYXRhUG9vbDtcblxuXHRwcml2YXRlIF93aWR0aDpudW1iZXI7XG5cdHByaXZhdGUgX2hlaWdodDpudW1iZXI7XG5cblx0Ly9wcml2YXRlIHN0YXRpYyBfZnJhbWVFdmVudERyaXZlcjpTaGFwZSA9IG5ldyBTaGFwZSgpOyAvLyBUT0RPOiBhZGQgZnJhbWUgZHJpdmVyIC8gcmVxdWVzdCBhbmltYXRpb24gZnJhbWVcblxuXHRwcml2YXRlIF9zdGFnZUluZGV4Om51bWJlciA9IC0xO1xuXHRwcml2YXRlIF9hbnRpQWxpYXM6bnVtYmVyID0gMDtcblx0cHJpdmF0ZSBfZW5hYmxlRGVwdGhBbmRTdGVuY2lsOmJvb2xlYW47XG5cdHByaXZhdGUgX3JlbmRlclRhcmdldDpUZXh0dXJlUHJveHlCYXNlID0gbnVsbDtcblx0cHJpdmF0ZSBfcmVuZGVyU3VyZmFjZVNlbGVjdG9yOm51bWJlciA9IDA7XG5cblx0cHVibGljIGdldCBjb250YWluZXIoKTpIVE1MRWxlbWVudFxuXHR7XG5cdFx0cmV0dXJuIHRoaXMuX3BDb250YWluZXI7XG5cdH1cblxuXHRjb25zdHJ1Y3RvcihzdGFnZUluZGV4Om51bWJlcilcblx0e1xuXHRcdHRoaXMuX3N0YWdlSW5kZXggPSBzdGFnZUluZGV4O1xuXHRcdHRoaXMuX3RleHR1cmVQb29sID0gbmV3IFRleHR1cmVEYXRhUG9vbCh0aGlzKTtcblx0XHR0aGlzLl9wcm9ncmFtRGF0YVBvb2wgPSBuZXcgUHJvZ3JhbURhdGFQb29sKHRoaXMpO1xuXHR9XG5cblx0cHVibGljIGdldFByb2dyYW1EYXRhKGtleTpzdHJpbmcpOlByb2dyYW1EYXRhXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fcHJvZ3JhbURhdGFQb29sLmdldEl0ZW0oa2V5KTtcblx0fVxuXG5cdHB1YmxpYyBzZXRSZW5kZXJUYXJnZXQodGFyZ2V0OlRleHR1cmVQcm94eUJhc2UsIGVuYWJsZURlcHRoQW5kU3RlbmNpbDpib29sZWFuID0gZmFsc2UsIHN1cmZhY2VTZWxlY3RvcjpudW1iZXIgPSAwKVxuXHR7XG5cdFx0aWYgKHRoaXMuX3JlbmRlclRhcmdldCA9PT0gdGFyZ2V0ICYmIHN1cmZhY2VTZWxlY3RvciA9PSB0aGlzLl9yZW5kZXJTdXJmYWNlU2VsZWN0b3IgJiYgdGhpcy5fZW5hYmxlRGVwdGhBbmRTdGVuY2lsID09IGVuYWJsZURlcHRoQW5kU3RlbmNpbClcblx0XHRcdHJldHVybjtcblxuXHRcdHRoaXMuX3JlbmRlclRhcmdldCA9IHRhcmdldDtcblx0XHR0aGlzLl9yZW5kZXJTdXJmYWNlU2VsZWN0b3IgPSBzdXJmYWNlU2VsZWN0b3I7XG5cdFx0dGhpcy5fZW5hYmxlRGVwdGhBbmRTdGVuY2lsID0gZW5hYmxlRGVwdGhBbmRTdGVuY2lsO1xuXHRcdGlmICh0YXJnZXQgaW5zdGFuY2VvZiBSZW5kZXJUZXh0dXJlKSB7XG5cdFx0XHR0aGlzLnNldFJlbmRlclRvVGV4dHVyZSh0aGlzLmdldFJlbmRlclRleHR1cmUoPFJlbmRlclRleHR1cmU+IHRhcmdldCksIGVuYWJsZURlcHRoQW5kU3RlbmNpbCwgdGhpcy5fYW50aUFsaWFzLCBzdXJmYWNlU2VsZWN0b3IpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnNldFJlbmRlclRvQmFja0J1ZmZlcigpO1xuXHRcdFx0dGhpcy5jb25maWd1cmVCYWNrQnVmZmVyKHRoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHQsIHRoaXMuX2FudGlBbGlhcywgdGhpcy5fZW5hYmxlRGVwdGhBbmRTdGVuY2lsKTtcblx0XHR9XG5cdH1cblxuXHRwdWJsaWMgZ2V0UmVuZGVyVGV4dHVyZSh0ZXh0dXJlUHJveHk6UmVuZGVyVGV4dHVyZSk6SVRleHR1cmVCYXNlXG5cdHtcblx0XHR2YXIgdGV4dHVyZURhdGE6VGV4dHVyZURhdGEgPSB0aGlzLl90ZXh0dXJlUG9vbC5nZXRJdGVtKHRleHR1cmVQcm94eSk7XG5cblx0XHRpZiAoIXRleHR1cmVEYXRhLnRleHR1cmUpXG5cdFx0XHR0ZXh0dXJlRGF0YS50ZXh0dXJlID0gdGhpcy5jcmVhdGVUZXh0dXJlKHRleHR1cmVQcm94eS53aWR0aCwgdGV4dHVyZVByb3h5LmhlaWdodCwgQ29udGV4dEdMVGV4dHVyZUZvcm1hdC5CR1JBLCB0cnVlKTtcblxuXHRcdHJldHVybiB0ZXh0dXJlRGF0YS50ZXh0dXJlO1xuXHR9XG5cblx0LyoqXG5cdCAqIEFzc2lnbnMgYW4gYXR0cmlidXRlIHN0cmVhbVxuXHQgKlxuXHQgKiBAcGFyYW0gaW5kZXggVGhlIGF0dHJpYnV0ZSBzdHJlYW0gaW5kZXggZm9yIHRoZSB2ZXJ0ZXggc2hhZGVyXG5cdCAqIEBwYXJhbSBidWZmZXJcblx0ICogQHBhcmFtIG9mZnNldFxuXHQgKiBAcGFyYW0gc3RyaWRlXG5cdCAqIEBwYXJhbSBmb3JtYXRcblx0ICovXG5cdHB1YmxpYyBhY3RpdmF0ZUJ1ZmZlcihpbmRleDpudW1iZXIsIGJ1ZmZlcjpWZXJ0ZXhEYXRhLCBvZmZzZXQ6bnVtYmVyLCBmb3JtYXQ6c3RyaW5nKVxuXHR7XG5cdFx0aWYgKCFidWZmZXIuY29udGV4dHNbdGhpcy5fc3RhZ2VJbmRleF0pXG5cdFx0XHRidWZmZXIuY29udGV4dHNbdGhpcy5fc3RhZ2VJbmRleF0gPSB0aGlzO1xuXG5cdFx0aWYgKCFidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XSkge1xuXHRcdFx0YnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0gPSB0aGlzLmNyZWF0ZVZlcnRleEJ1ZmZlcihidWZmZXIuZGF0YS5sZW5ndGgvYnVmZmVyLmRhdGFQZXJWZXJ0ZXgsIGJ1ZmZlci5kYXRhUGVyVmVydGV4KTtcblx0XHRcdGJ1ZmZlci5pbnZhbGlkW3RoaXMuX3N0YWdlSW5kZXhdID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZiAoYnVmZmVyLmludmFsaWRbdGhpcy5fc3RhZ2VJbmRleF0pIHtcblx0XHRcdGJ1ZmZlci5idWZmZXJzW3RoaXMuX3N0YWdlSW5kZXhdLnVwbG9hZEZyb21BcnJheShidWZmZXIuZGF0YSwgMCwgYnVmZmVyLmRhdGEubGVuZ3RoL2J1ZmZlci5kYXRhUGVyVmVydGV4KTtcblx0XHRcdGJ1ZmZlci5pbnZhbGlkW3RoaXMuX3N0YWdlSW5kZXhdID0gZmFsc2U7XG5cdFx0fVxuXG5cdFx0dGhpcy5zZXRWZXJ0ZXhCdWZmZXJBdChpbmRleCwgYnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0sIG9mZnNldCwgZm9ybWF0KTtcblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlVmVydGV4RGF0YShidWZmZXI6VmVydGV4RGF0YSlcblx0e1xuXHRcdGJ1ZmZlci5idWZmZXJzW3RoaXMuX3N0YWdlSW5kZXhdLmRpc3Bvc2UoKTtcblx0XHRidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XSA9IG51bGw7XG5cdH1cblxuXHRwdWJsaWMgYWN0aXZhdGVSZW5kZXJUZXh0dXJlKGluZGV4Om51bWJlciwgdGV4dHVyZVByb3h5OlJlbmRlclRleHR1cmUpXG5cdHtcblx0XHR0aGlzLnNldFRleHR1cmVBdChpbmRleCwgdGhpcy5nZXRSZW5kZXJUZXh0dXJlKHRleHR1cmVQcm94eSkpO1xuXHR9XG5cblx0cHVibGljIGFjdGl2YXRlVGV4dHVyZShpbmRleDpudW1iZXIsIHRleHR1cmVQcm94eTpUZXh0dXJlMkRCYXNlKVxuXHR7XG5cdFx0dmFyIHRleHR1cmVEYXRhOlRleHR1cmVEYXRhID0gPFRleHR1cmVEYXRhPiB0aGlzLl90ZXh0dXJlUG9vbC5nZXRJdGVtKHRleHR1cmVQcm94eSk7XG5cblx0XHRpZiAoIXRleHR1cmVEYXRhLnRleHR1cmUpIHtcblx0XHRcdHRleHR1cmVEYXRhLnRleHR1cmUgPSB0aGlzLmNyZWF0ZVRleHR1cmUodGV4dHVyZVByb3h5LndpZHRoLCB0ZXh0dXJlUHJveHkuaGVpZ2h0LCBDb250ZXh0R0xUZXh0dXJlRm9ybWF0LkJHUkEsIHRydWUpO1xuXHRcdFx0dGV4dHVyZURhdGEuaW52YWxpZCA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKHRleHR1cmVEYXRhLmludmFsaWQpIHtcblx0XHRcdHRleHR1cmVEYXRhLmludmFsaWQgPSBmYWxzZTtcblx0XHRcdGlmICh0ZXh0dXJlUHJveHkuZ2VuZXJhdGVNaXBtYXBzKSB7XG5cdFx0XHRcdHZhciBtaXBtYXBEYXRhOkFycmF5PEJpdG1hcERhdGE+ID0gdGV4dHVyZVByb3h5Ll9pR2V0TWlwbWFwRGF0YSgpO1xuXHRcdFx0XHR2YXIgbGVuOm51bWJlciA9IG1pcG1hcERhdGEubGVuZ3RoO1xuXHRcdFx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCBsZW47IGkrKylcblx0XHRcdFx0XHQoPElUZXh0dXJlPiB0ZXh0dXJlRGF0YS50ZXh0dXJlKS51cGxvYWRGcm9tRGF0YShtaXBtYXBEYXRhW2ldLCBpKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCg8SVRleHR1cmU+IHRleHR1cmVEYXRhLnRleHR1cmUpLnVwbG9hZEZyb21EYXRhKHRleHR1cmVQcm94eS5faUdldFRleHR1cmVEYXRhKCksIDApO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuc2V0VGV4dHVyZUF0KGluZGV4LCB0ZXh0dXJlRGF0YS50ZXh0dXJlKTtcblx0fVxuXG5cdHB1YmxpYyBhY3RpdmF0ZUN1YmVUZXh0dXJlKGluZGV4Om51bWJlciwgdGV4dHVyZVByb3h5OkN1YmVUZXh0dXJlQmFzZSlcblx0e1xuXHRcdHZhciB0ZXh0dXJlRGF0YTpUZXh0dXJlRGF0YSA9IDxUZXh0dXJlRGF0YT4gdGhpcy5fdGV4dHVyZVBvb2wuZ2V0SXRlbSh0ZXh0dXJlUHJveHkpO1xuXG5cdFx0aWYgKCF0ZXh0dXJlRGF0YS50ZXh0dXJlKSB7XG5cdFx0XHR0ZXh0dXJlRGF0YS50ZXh0dXJlID0gdGhpcy5jcmVhdGVDdWJlVGV4dHVyZSh0ZXh0dXJlUHJveHkuc2l6ZSwgQ29udGV4dEdMVGV4dHVyZUZvcm1hdC5CR1JBLCBmYWxzZSk7XG5cdFx0XHR0ZXh0dXJlRGF0YS5pbnZhbGlkID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRpZiAodGV4dHVyZURhdGEuaW52YWxpZCkge1xuXHRcdFx0dGV4dHVyZURhdGEuaW52YWxpZCA9IGZhbHNlO1xuXHRcdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgNjsgKytpKSB7XG5cdFx0XHRcdGlmICh0ZXh0dXJlUHJveHkuZ2VuZXJhdGVNaXBtYXBzKSB7XG5cdFx0XHRcdFx0dmFyIG1pcG1hcERhdGE6QXJyYXk8Qml0bWFwRGF0YT4gPSB0ZXh0dXJlUHJveHkuX2lHZXRNaXBtYXBEYXRhKGkpO1xuXHRcdFx0XHRcdHZhciBsZW46bnVtYmVyID0gbWlwbWFwRGF0YS5sZW5ndGg7XG5cdFx0XHRcdFx0Zm9yICh2YXIgajpudW1iZXIgPSAwOyBqIDwgbGVuOyBqKyspXG5cdFx0XHRcdFx0XHQoPElDdWJlVGV4dHVyZT4gdGV4dHVyZURhdGEudGV4dHVyZSkudXBsb2FkRnJvbURhdGEobWlwbWFwRGF0YVtqXSwgaSwgaik7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0KDxJQ3ViZVRleHR1cmU+IHRleHR1cmVEYXRhLnRleHR1cmUpLnVwbG9hZEZyb21EYXRhKHRleHR1cmVQcm94eS5faUdldFRleHR1cmVEYXRhKGkpLCBpLCAwKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMuc2V0VGV4dHVyZUF0KGluZGV4LCB0ZXh0dXJlRGF0YS50ZXh0dXJlKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXRyaWV2ZXMgdGhlIFZlcnRleEJ1ZmZlciBvYmplY3QgdGhhdCBjb250YWlucyB0cmlhbmdsZSBpbmRpY2VzLlxuXHQgKiBAcGFyYW0gY29udGV4dCBUaGUgQ29udGV4dFdlYiBmb3Igd2hpY2ggd2UgcmVxdWVzdCB0aGUgYnVmZmVyXG5cdCAqIEByZXR1cm4gVGhlIFZlcnRleEJ1ZmZlciBvYmplY3QgdGhhdCBjb250YWlucyB0cmlhbmdsZSBpbmRpY2VzLlxuXHQgKi9cblx0cHVibGljIGdldEluZGV4QnVmZmVyKGJ1ZmZlcjpJbmRleERhdGEpOklJbmRleEJ1ZmZlclxuXHR7XG5cdFx0aWYgKCFidWZmZXIuY29udGV4dHNbdGhpcy5fc3RhZ2VJbmRleF0pXG5cdFx0XHRidWZmZXIuY29udGV4dHNbdGhpcy5fc3RhZ2VJbmRleF0gPSB0aGlzO1xuXG5cdFx0aWYgKCFidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XSkge1xuXHRcdFx0YnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0gPSB0aGlzLmNyZWF0ZUluZGV4QnVmZmVyKGJ1ZmZlci5kYXRhLmxlbmd0aCk7XG5cdFx0XHRidWZmZXIuaW52YWxpZFt0aGlzLl9zdGFnZUluZGV4XSA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKGJ1ZmZlci5pbnZhbGlkW3RoaXMuX3N0YWdlSW5kZXhdKSB7XG5cdFx0XHRidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XS51cGxvYWRGcm9tQXJyYXkoYnVmZmVyLmRhdGEsIDAsIGJ1ZmZlci5kYXRhLmxlbmd0aCk7XG5cdFx0XHRidWZmZXIuaW52YWxpZFt0aGlzLl9zdGFnZUluZGV4XSA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdHJldHVybiBidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XTtcblx0fVxuXG5cdHB1YmxpYyBkaXNwb3NlSW5kZXhEYXRhKGJ1ZmZlcjpJbmRleERhdGEpXG5cdHtcblx0XHRidWZmZXIuYnVmZmVyc1t0aGlzLl9zdGFnZUluZGV4XS5kaXNwb3NlKCk7XG5cdFx0YnVmZmVyLmJ1ZmZlcnNbdGhpcy5fc3RhZ2VJbmRleF0gPSBudWxsO1xuXHR9XG5cblx0cHVibGljIGNsZWFyKHJlZDpudW1iZXIgPSAwLCBncmVlbjpudW1iZXIgPSAwLCBibHVlOm51bWJlciA9IDAsIGFscGhhOm51bWJlciA9IDEsIGRlcHRoOm51bWJlciA9IDEsIHN0ZW5jaWw6bnVtYmVyID0gMCwgbWFzazpudW1iZXIgPSBDb250ZXh0R0xDbGVhck1hc2suQUxMKVxuXHR7XG5cblx0fVxuXG5cdHB1YmxpYyBjb25maWd1cmVCYWNrQnVmZmVyKHdpZHRoOm51bWJlciwgaGVpZ2h0Om51bWJlciwgYW50aUFsaWFzOm51bWJlciwgZW5hYmxlRGVwdGhBbmRTdGVuY2lsOmJvb2xlYW4gPSB0cnVlKVxuXHR7XG5cdFx0dGhpcy5fd2lkdGggPSB3aWR0aDtcblx0XHR0aGlzLl9oZWlnaHQgPSBoZWlnaHQ7XG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlSW5kZXhCdWZmZXIobnVtSW5kaWNlczpudW1iZXIpOklJbmRleEJ1ZmZlclxuXHR7XG5cdFx0dGhyb3cgbmV3IEFic3RyYWN0TWV0aG9kRXJyb3IoKTtcblx0fVxuXG5cdHB1YmxpYyBjcmVhdGVWZXJ0ZXhCdWZmZXIobnVtVmVydGljZXM6bnVtYmVyLCBkYXRhMzJQZXJWZXJ0ZXg6bnVtYmVyKTpJVmVydGV4QnVmZmVyXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0cHVibGljIGNyZWF0ZVRleHR1cmUod2lkdGg6bnVtYmVyLCBoZWlnaHQ6bnVtYmVyLCBmb3JtYXQ6c3RyaW5nLCBvcHRpbWl6ZUZvclJlbmRlclRvVGV4dHVyZTpib29sZWFuLCBzdHJlYW1pbmdMZXZlbHM6bnVtYmVyID0gMCk6SVRleHR1cmVcblx0e1xuXHRcdHRocm93IG5ldyBBYnN0cmFjdE1ldGhvZEVycm9yKCk7XG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlQ3ViZVRleHR1cmUoc2l6ZTpudW1iZXIsIGZvcm1hdDpzdHJpbmcsIG9wdGltaXplRm9yUmVuZGVyVG9UZXh0dXJlOmJvb2xlYW4sIHN0cmVhbWluZ0xldmVsczpudW1iZXIgPSAwKTpJQ3ViZVRleHR1cmVcblx0e1xuXHRcdHRocm93IG5ldyBBYnN0cmFjdE1ldGhvZEVycm9yKCk7XG5cdH1cblxuXHRwdWJsaWMgY3JlYXRlUHJvZ3JhbSgpOklQcm9ncmFtXG5cdHtcblx0XHR0aHJvdyBuZXcgQWJzdHJhY3RNZXRob2RFcnJvcigpO1xuXHR9XG5cblx0cHVibGljIGRpc3Bvc2UoKVxuXHR7XG5cblx0fVxuXG5cdHB1YmxpYyBwcmVzZW50KClcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgc2V0UmVuZGVyVG9UZXh0dXJlKHRhcmdldDpJVGV4dHVyZUJhc2UsIGVuYWJsZURlcHRoQW5kU3RlbmNpbDpib29sZWFuID0gZmFsc2UsIGFudGlBbGlhczpudW1iZXIgPSAwLCBzdXJmYWNlU2VsZWN0b3I6bnVtYmVyID0gMClcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgc2V0UmVuZGVyVG9CYWNrQnVmZmVyKClcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgc2V0U2Npc3NvclJlY3RhbmdsZShyZWN0YW5nbGU6UmVjdGFuZ2xlKVxuXHR7XG5cblx0fVxuXG5cdHB1YmxpYyBzZXRUZXh0dXJlQXQoc2FtcGxlcjpudW1iZXIsIHRleHR1cmU6SVRleHR1cmVCYXNlKVxuXHR7XG5cblx0fVxuXG5cdHB1YmxpYyBzZXRWZXJ0ZXhCdWZmZXJBdChpbmRleDpudW1iZXIsIGJ1ZmZlcjpJVmVydGV4QnVmZmVyLCBidWZmZXJPZmZzZXQ6bnVtYmVyID0gMCwgZm9ybWF0OnN0cmluZyA9IG51bGwpXG5cdHtcblxuXHR9XG5cblx0cHVibGljIHNldFByb2dyYW0ocHJvZ3JhbTpJUHJvZ3JhbSlcblx0e1xuXG5cdH1cblxuXHRwdWJsaWMgcmVnaXN0ZXJQcm9ncmFtKHByb2dyYW1EYXRhOlByb2dyYW1EYXRhKVxuXHR7XG5cdFx0dmFyIGk6bnVtYmVyID0gMDtcblx0XHR3aGlsZSAodGhpcy5fcHJvZ3JhbURhdGFbaV0gIT0gbnVsbClcblx0XHRcdGkrKztcblxuXHRcdHRoaXMuX3Byb2dyYW1EYXRhW2ldID0gcHJvZ3JhbURhdGE7XG5cdFx0cHJvZ3JhbURhdGEuaWQgPSBpO1xuXHR9XG5cblx0cHVibGljIHVuUmVnaXN0ZXJQcm9ncmFtKHByb2dyYW1EYXRhOlByb2dyYW1EYXRhKVxuXHR7XG5cdFx0dGhpcy5fcHJvZ3JhbURhdGFbcHJvZ3JhbURhdGEuaWRdID0gbnVsbDtcblx0XHRwcm9ncmFtRGF0YS5pZCA9IC0xO1xuXHR9XG59XG5cbmV4cG9ydCA9IENvbnRleHRHTEJhc2U7Il19